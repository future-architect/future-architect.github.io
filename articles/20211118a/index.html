<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <!--
    ███████╗██╗░░░██╗████████╗██╗░░░██╗██████╗░███████╗
    ██╔════╝██║░░░██║╚══██╔══╝██║░░░██║██╔══██╗██╔════╝
    █████╗░░██║░░░██║░░░██║░░░██║░░░██║██████╔╝█████╗░░
    ██╔══╝░░██║░░░██║░░░██║░░░██║░░░██║██╔══██╗██╔══╝░░
    ██║░░░░░╚██████╔╝░░░██║░░░╚██████╔╝██║░░██║███████╗
    ╚═╝░░░░░░╚═════╝░░░░╚═╝░░░░╚═════╝░╚═╝░░╚═╝╚══════╝
    ████████╗███████╗░█████╗░██╗░░██╗
    ╚══██╔══╝██╔════╝██╔══██╗██║░░██║
    ░░░██║░░░█████╗░░██║░░╚═╝███████║
    ░░░██║░░░██╔══╝░░██║░░██╗██╔══██║
    ░░░██║░░░███████╗╚█████╔╝██║░░██║
    ░░░╚═╝░░░╚══════╝░╚════╝░╚═╝░░╚═╝
    ██████╗░██╗░░░░░░█████╗░░██████╗░
    ██╔══██╗██║░░░░░██╔══██╗██╔════╝░
    ██████╦╝██║░░░░░██║░░██║██║░░██╗░
    ██╔══██╗██║░░░░░██║░░██║██║░░╚██╗
    ██████╦╝███████╗╚█████╔╝╚██████╔╝
    ╚═════╝░╚══════╝░╚════╝░░╚═════╝░
    Welcome engineer.
    https://www.future.co.jp/recruit/
  -->
  
  <title>Go Conference Online 2021 Autumnが開催されました＆作って学ぶシェル | フューチャー技術ブログ</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  <meta name="description" content="Go Conference Online 2021 Autumnが開催されました。スタッフのみなさん、登壇者、参加者のみなさん、お疲れ様でした。フューチャーは今回もブロンズスポンサーでした。また、フューチャーからは伊藤（真）、辻、渋川の三人が登壇しました。   その中の、渋川の発表内容を紹介します。タイトルは「Learning Computer Systems by Crafting: Shell">
<meta property="og:type" content="article">
<meta property="og:title" content="Go Conference Online 2021 Autumnが開催されました＆作って学ぶシェル | フューチャー技術ブログ">
<meta property="og:url" content="https://future-architect.github.io/articles/20211118a/index.html">
<meta property="og:site_name" content="フューチャー技術ブログ">
<meta property="og:description" content="Go Conference Online 2021 Autumnが開催されました。スタッフのみなさん、登壇者、参加者のみなさん、お疲れ様でした。フューチャーは今回もブロンズスポンサーでした。また、フューチャーからは伊藤（真）、辻、渋川の三人が登壇しました。   その中の、渋川の発表内容を紹介します。タイトルは「Learning Computer Systems by Crafting: Shell">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://future-architect.github.io/images/20211118a/3I3nVBN6Jla9J7j1636787586_1636787641.png">
<meta property="og:image" content="https://future-architect.github.io/images/20211118a/image_(15).png">
<meta property="og:image" content="https://future-architect.github.io/images/20211118a/スクリーンショット_2021-11-13_16.10.13.png">
<meta property="article:published_time" content="2021-11-17T15:00:00.000Z">
<meta property="article:modified_time" content="2021-12-12T13:33:00.816Z">
<meta property="article:tag" content="登壇レポート">
<meta property="article:tag" content="カンファレンス">
<meta property="article:tag" content="Go">
<meta property="article:tag" content="GoConference">
<meta property="article:tag" content="ShellScript">
<meta property="article:tag" content="システムプログラム">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://future-architect.github.io/images/20211118a/3I3nVBN6Jla9J7j1636787586_1636787641.png">
  
  <link rel="alternate" href="/atom.xml" title="フューチャー技術ブログ" type="application/atom+xml">
  
  <link rel="icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes='180x180' href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes='57x57' href="/apple-touch-icon-57x57.png">
  <link rel="canonical" href="https://future-architect.github.io/articles/20211118a/">
  <meta content="登壇レポート,カンファレンス,Go,GoConference,ShellScript,システムプログラム" name="keywords">
  <meta content="澁川喜規" name="author">
  <link rel="preload" as="image" href="/banner.jpg" />
  <link rel='manifest' href='/manifest.webmanifest'/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <link rel="stylesheet" href="/metronic/assets/style.css">
  <link rel="stylesheet" href="/css/theme-styles.css">
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="corporate">
  <div class="wrap" itemscope itemtype="https://schema.org/TechArticle">
  <!-- BEGIN HEADER -->
<header class="header">
	<div class="header-overlay">
		<div class="header-menu"></div>
		<div class="header-title"><a href="/">Future Tech Blog</a></div>
		<div class="header-title-sub">フューチャー技術ブログ</div>
	</div>
</header>
<!-- Header END -->

  <div class="container">
  <ul class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/articles/">Blog</a></li>
    <li class="active">Post</li>
  </ul>
  <section id="main" class="margin-top-30">
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Programming/">Programmingカテゴリ</a>
  </div>


    <h2 itemprop="name" class="article-title">Go Conference Online 2021 Autumnが開催されました＆作って学ぶシェル
  
  <a target="_blank" rel="noopener" href="https://github.com/future-architect/tech-blog/edit/master/source/_posts/20211118a_Go_Conference_Online_2021_Autumnが開催されました＆作って学ぶシェル.md" title="Suggest Edits" class="github-edit"><i class="github-edit-icon"></i></a>
  
</h2>

    <div class="row">
  <main class="col-md-9 blog-posts">
    <article id="post-20211118a_Go_Conference_Online_2021_Autumnが開催されました＆作って学ぶシェル" class="article article-type-post blog-item" itemscope itemprop="blogPost">
      <div class="article-inner">
        
        <header class="article-header">
          <ul class="blog-info">
            <li class="blog-info-item"><a href="/articles/2021/" class="publish-date"><time datetime="2021-11-17T15:00:00.000Z" itemprop="datePublished">2021.11.18</time></a>
</li>
            <li class="blog-info-item"><li><a href="/authors/%E6%BE%81%E5%B7%9D%E5%96%9C%E8%A6%8F" title="澁川喜規さんの記事一覧へ" class="post-author">澁川喜規</a></li></li>
            <li class="blog-info-item">
  
    
    <a href="/tags/登壇レポート/" title="登壇レポートタグの記事へ" class="tag-list-link">登壇レポート</a>
  
    
    <a href="/tags/カンファレンス/" title="カンファレンスタグの記事へ" class="tag-list-link">カンファレンス</a>
  
    
    <a href="/tags/Go/" title="Goタグの記事へ" class="tag-list-link">Go言語</a>
  
    
    <a href="/tags/GoConference/" title="GoConferenceタグの記事へ" class="tag-list-link">GoConference</a>
  
    
    <a href="/tags/ShellScript/" title="ShellScriptタグの記事へ" class="tag-list-link">ShellScript</a>
  
    
    <a href="/tags/システムプログラム/" title="システムプログラムタグの記事へ" class="tag-list-link">システムプログラム</a>
  

</li>
          </ul>
          </header>
        
        <div class="article-entry" itemprop="articleBody">
          
            <p>Go Conference Online 2021 Autumnが開催されました。スタッフのみなさん、登壇者、参加者のみなさん、お疲れ様でした。フューチャーは今回もブロンズスポンサーでした。また、フューチャーからは伊藤（真）、辻、渋川の三人が登壇しました。</p>
<img src="/images/20211118a/3I3nVBN6Jla9J7j1636787586_1636787641.png" alt="3I3nVBN6Jla9J7j1636787586_1636787641.png" width="1000" height="514" loading="lazy">

<p>その中の、渋川の発表内容を紹介します。タイトルは「Learning Computer Systems by Crafting: Shell 〜作って学ぶシェル〜」で、シェルの動作の紹介をしつつ、自分で実装してみるには、という感じの解説でした。<a target="_blank" rel="noopener" href="https://ascii.jp/serialarticles/1235262/">Goならわかるシステムプログラミング</a>（書籍は<a target="_blank" rel="noopener" href="https://www.lambdanote.com/products/go">こちら</a>)では詳しく触れていなかったシェルについて詳しく説明する追加コンテンツです。</p>
<img src="/images/20211118a/image_(15).png" alt="image_(15).png" width="1200" height="646" loading="lazy">

<p>発表資料はこちらです。</p>
<iframe src="https://docs.google.com/presentation/d/e/2PACX-1vTjNhH-Fh3WwUe-hLT777OI4YOAxtG5YUqIfEzt63nwyvzNra-7leKPz4YcwWSuHt-jBJxAbuPliWXg/embed?start=false&loop=false&delayms=3000" frameborder="0" width="95%" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

<p>Twitter等でたまに話題になるのは、次のようなことです。</p>
<blockquote>
<p>「若い人の中にはシェルの概念をあまり知らない人もいる」<br>「はたしてそのような人はどのようなきっかけ（経路）でシェルを知るようになるのか」</p>
</blockquote>
<p>踏み台へのsshなど、現在でもシェル操作そのものが要求されますし、コードを書いているとgo mod initなりnpm installなりのいくつかの操作が必要となります。中には、flutterコマンドとか、Gitのように優秀なIDEプラグインやGUIツールのおかげで、「GUIツールだけで済ます」ということも可能な領域もありますが、まだまだそうでない領域もあります。</p>
<p>シェルを使うにあたっては、いくつものコマンド以外に、内部状態や、裏でシェルがやってくれることを知る必要があります。</p>
<ul>
<li>PATH</li>
<li>環境変数＆変数展開</li>
<li>ワイルドカード</li>
<li>パイプ＆リダイレクト　etc…</li>
</ul>
<p>今日のセッションでは、この「シェルが何者か」という説明をします。このページに検索して辿り着いた人はシェルが何かがわかっている人の方が多いかもしれませんが、もし周りにシェルがよくわからん、という人がいればこのブログのリンクを送ってもらうような使い方をしてもらえたらな、と思っています。</p>
<h1 id="シェルとは何か？"><a href="#シェルとは何か？" class="headerlink" title="シェルとは何か？"></a>シェルとは何か？</h1><ul>
<li>どんなソフトウェアを思い浮かべますか？<ul>
<li>bash、zsh、fish、黒い怖い画面（コマンドプロンプト）、PowerShell</li>
</ul>
</li>
<li>WindowsのGUI（Explorer.exe）もシェルと呼ばれることもある<ul>
<li>キオスクモードだと、そこで起動されるアプリケーションも<a target="_blank" rel="noopener" href="https://docs.microsoft.com/ja-jp/windows/configuration/kiosk-shelllauncher">シェル</a></li>
</ul>
</li>
<li>PythonやNode.js、Rubyのirbなど、多くのプログラミング言語が備えるREPL（Read-Eval-Print Loop）画面もシェルと呼ばれることもある<ul>
<li>→Interactive Shell</li>
</ul>
</li>
</ul>
<p>もともとの意味は人間とコンピュータの境界となるソフトウェアという意味なので、幅広いソフトウェアがシェルと呼ばれます。</p>
<h1 id="より狭い意味で使われるシェル＝コマンドシェル"><a href="#より狭い意味で使われるシェル＝コマンドシェル" class="headerlink" title="より狭い意味で使われるシェル＝コマンドシェル"></a>より狭い意味で使われるシェル＝コマンドシェル</h1><p>「外部コマンド実行でシェルを利用する」、「シェルを/bin/falseにして、ログインできないシステムユーザーを作る」などの文脈で使われる、開発者がよく目にするCUIのプログラムランチャーがコマンドシェルです。</p>
<p>いわゆる黒い画面でファイル操作をしたりプログラムを起動したりするソフトウェア（bashとかzsh）。</p>
<p>Unix系のシェルではファイル管理のコマンド群は外部の独立したコマンドであるが、MS-DOSのcommand.comは内部コマンドでそのような機能も持っています。</p>
<p>いわゆる「黒い画面」はターミナルエミュレータと呼ばれる別のソフトウェアで、シェルに対してキーボードの入力や画面（文字描画）を提供するものです。「人とソフトウェアの境界」というと、こちらの方がシェルなのでは、という気がしないでもないですが、昔はここは専用のハードウェア(vt100とか)だったこともあり、「本来はハードウェアだが、ソフトウェアでエミュレーションしている」という扱いです。</p>
<h1 id="もっと狭い定義のシェル-POSIXシェル"><a href="#もっと狭い定義のシェル-POSIXシェル" class="headerlink" title="もっと狭い定義のシェル=POSIXシェル"></a>もっと狭い定義のシェル=POSIXシェル</h1><p><a target="_blank" rel="noopener" href="https://pubs.opengroup.org/onlinepubs/9699919799/">Single UNIX Specification</a>(SUS)とも呼ばれる、UNIXを名乗るために必要な規格があります。</p>
<ul>
<li>標準準拠のシステムで提供されるべきC言語のヘッダーファイルの一覧</li>
<li>シェルのコマンド（ユーティリティ）および、シェルの言語仕様</li>
<li>OSとのやりとりに利用するシステムコールやライブラリ関数の定義</li>
</ul>
<p>シェルは人間の入力で動かすものではありますが、この規格の中には、コマンド実行文をテキストファイルに並べて、連続実行するシェルスクリプトやその文法（制御構文など）も定義されています。「シェルスクリプト」と呼ばれるときの「シェル」はこちらです。</p>
<p>bash/zshなどは「互換シェル」ではあるが、大きく拡張している部分もあれば、非互換なところもあります。</p>
<p>だいたい、いままで紹介してきたものを並べると以下のような感じになるでしょう。</p>
<img src="/images/20211118a/スクリーンショット_2021-11-13_16.10.13.png" alt="スクリーンショット_2021-11-13_16.10.13.png" width="1200" height="635" loading="lazy">

<p>このエントリーでは主にコマンドシェルとPOSIXシェルについて紹介します。</p>
<h1 id="コマンドシェルがコマンドを実行するまで"><a href="#コマンドシェルがコマンドを実行するまで" class="headerlink" title="コマンドシェルがコマンドを実行するまで"></a>コマンドシェルがコマンドを実行するまで</h1><p>だいたいこんな感じで処理されているでしょう。</p>
<ol>
<li>ユーザーが入力したテキストを取り出す</li>
<li>コマンドの文字列をパースして、コマンドと引数に分ける</li>
<li>環境変数参照があれば展開する</li>
<li>ファイルのワイルドカードがあれば展開する</li>
<li>コマンドをPATH環境変数で指定されているフォルダから探し出す</li>
<li>見つけたコマンドに引数を渡して実行する</li>
</ol>
<p>まずはユーザーがキーボードからコマンドを入力します。改行が入力されたらそこで1行取り込みます。</p>
<p>その後、文字列をパースして、コマンドと引数に分けていきます。必要に応じて（エスケープとかに注意しながら）、環境変数があれば展開します。ワイルドカード（<code>*</code>とか<code>？</code>とか)も展開します。展開されるとマッチするファイルのリストに置き換えられます。なお、Windowsのシェルはワイルドカードの展開はシェルは行わず、各プログラムが行います。</p>
<p>環境変数はマップのような文字列がキーで文字列を値として持つデータ構造で、親プロセスで定義したものが子プロセスに伝搬していきます。あえて子プロセス起動時にリセットしない限りは自動で伝搬していきます。プログラムやシェルスクリプトなどは固定されたままで、外部から必要な設定を差し込むことができるため、今時のクラウド系のシステムでは設定の手段としてかなり活用されています。コンテナの定義時に設定したり、クラウドへのアプリケーションのデプロイ時やインフラの構成時に環境変数が設定できるようになっています。コマンド実行ログにも表示されないため、クレデンシャルを設定する手段としても活用されています。</p>
<p>PATH環境変数はコロン区切り（Windows以外）、セミコロン区切りでフォルダのパスを列挙して格納します。シェルはこの <code>PATH</code>に登録されているフォルダを先頭から順番に探索して実行を再開します。</p>
<p>PATH環境変数にフォルダを追加して、実行したいプログラムが発見できるようにすることを「パスを通す」と呼びます。</p>
<p>それ以外にもいろいろな仕事をしています。</p>
<ul>
<li>パイプやリダイレクトの場合、パイプやファイルを開いてファイルディスクリプタをOSに作ってもらい、起動するプロセスに設定する</li>
<li>ワークフォルダをプロセスに設定する</li>
<li>環境変数はプロセス起動時のオプションとして設定する</li>
</ul>
<p>Goのコードを見ると、gidとかchrootの設定とか、ホストとコンテナ内のUIDとGIDのマッピングとか、プロセスをフォワードに持ってくるとか、いろいろやっていますね。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/golang/go/blob/master/src/syscall/exec_linux.go">https://github.com/golang/go/blob/master/src/syscall/exec_linux.go</a> のforkAndExecInChild1()</p>
<h1 id="ちょっと裏方っぽいシェルのお仕事"><a href="#ちょっと裏方っぽいシェルのお仕事" class="headerlink" title="ちょっと裏方っぽいシェルのお仕事"></a>ちょっと裏方っぽいシェルのお仕事</h1><p>自作のプログラムから外部プロセスを呼び出すには、「シェルを経由する実行」と、「シェルを経由しない実行」の2つの実行形態があります。プログラミング言語のライブラリをみると、だいたいこっそり書かれています。</p>
<p>シェル経由で実行の場合、コマンドライン引数の分解はシェルがやってくれるので、パラメータこみで丸ごと起動したいコマンドを単一の文字列を引数として取ります。</p>
<p>シェルを経由しない実行の場合、直接コマンドを実行します。引数の分解とかはしてくれないため、呼び出し側のプログラムで行う必要があります、引数を文字列の配列として渡す。ただし、コマンドをPATHからの探索はどの言語のライブラリもやってくれそう（Goも）。</p>
<p>C言語は標準ライブラリの<code>system()</code>はシェル経由、POSIXのunistd.hの<code>exec()</code>ファミリーはシェルを経由しない外部プロセス実行です。Pythonの<code>subprocess.run()</code>とかPHPの<code>proc_open()</code>にはシェルを経由するかどうかのフラグがあります。RubyやDockerは文字列でコマンドを渡すか、配列で渡すかでシェル経由かシェルを経由しないかの動作が変わります。</p>
<p>Goの<code>os/exec</code>はシェルを経由しない実行のみをサポートしています。シェル経由の実行をエミュレーションするには、次のようにします。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cmd *exec.Cmd</span><br><span class="line"><span class="keyword">if</span> runtime.GOOS == <span class="string">&quot;windows&quot;</span> &#123;</span><br><span class="line">	cmd = exec.Command(<span class="string">&quot;cmd.exe&quot;</span>, <span class="string">&quot;/C&quot;</span>, <span class="string">&quot;timeout 5&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	cmd = exec.Command(os.Getenv(<span class="string">&quot;SHELL&quot;</span>), <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;sleep 5&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">cmd.Run()</span><br></pre></td></tr></table></figure>

<p>PATH環境変数の中のコマンドの探索は裏で自動でやってくれますし、独立した関数（<code>os/exec</code>パッケージの<code>LookPath()</code>関数)としても利用できます。</p>
<h1 id="コマンドシェルを作ってみよう"><a href="#コマンドシェルを作ってみよう" class="headerlink" title="コマンドシェルを作ってみよう"></a>コマンドシェルを作ってみよう</h1><p>シェルがどのような仕事をしているか説明してきました。それぞれの項目は、次のように実現できます。</p>
<ul>
<li><strong>ループでユーザーの入力を受ける</strong></li>
<li><strong>コマンドと引数を分解</strong></li>
<li><strong>環境変数を展開</strong></li>
<li><strong>ワイルドカードを展開</strong></li>
<li><strong>リダイレクトとパイプ</strong></li>
<li><strong>環境変数とワークフォルダを設定して実行</strong></li>
</ul>
<p>カレントディレクトリや環境変数は子プロセスに渡すものを設定できるが親プロセスの持っている状態は変更できません。シェルから子プロセスを呼び出すときにシェル側の状態を変えることはできないので、カレントディレクトリと環境変数の変更（<code>cd</code>と<code>export</code>)は「内部コマンド」として実装する必要があります。</p>
<h2 id="ループでユーザーの入力を受ける"><a href="#ループでユーザーの入力を受ける" class="headerlink" title="ループでユーザーの入力を受ける"></a>ループでユーザーの入力を受ける</h2><p><code>github.com/peterh/liner</code>を使いました。”tui golang”あたりでググればいろいろライブラリが出てくるのでお好きなものを選ぶと良いです。<code>fmt.Scanf</code>とかでもいいですが、コード補完とかヒストリーとかいろいろ機能があるのでこの手のライブラリの方が良いです。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/peterh/liner&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	line := liner.NewLiner()</span><br><span class="line">	line.SetCtrlCAborts(<span class="literal">true</span>)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> cmd, err := line.Prompt(<span class="string">&quot; &quot;</span>); err == <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> cmd == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// ここでコマンドを処理する</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> errors.Is(err, io.EOF) &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> err == liner.ErrPromptAborted &#123;</span><br><span class="line">			log.Print(<span class="string">&quot;Aborted&quot;</span>)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			log.Print(<span class="string">&quot;Error reading line: &quot;</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="コマンドと引数を分解"><a href="#コマンドと引数を分解" class="headerlink" title="コマンドと引数を分解"></a>コマンドと引数を分解</h2><p>コードの分解には<code>github.com/google/shlex</code>を使います。Pythonの標準ライブラリにshlexがあり、どの言語でもたいてい、同様のライブラリはこれの移植で、この名前であることが多いです。大雑把にはこんな感じで使います。自分でパースするのも良いですが、ダブルクオートのエスケープみたいなややこしいものをやってくれるので、使った方が楽ですね。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/google/shlex&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">parseCmd</span><span class="params">(cmdStr)</span> <span class="params">(cmd <span class="keyword">string</span>, args []<span class="keyword">string</span>, err error)</span></span> &#123;</span><br><span class="line">	l := shlex.NewLexer(strings.NewReader(cmdStr))</span><br><span class="line">	cmd, err = l.Next()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> ; token, err := l.Next(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		args = <span class="built_in">append</span>(args, token)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ただし、バッククオート（別のコマンドを実行して、その結果を文字列として引数などに設定する）の中をさらにパースしたり、POSIXシェルのリダイレクトやらパイプをフルサポートするために、次のような記号で文字列を複数のコマンドに分割すると言った処理は頑張る必要があります。オライリーの「Go言語でつくるインタプリタ」を読んで、ステートマシンを作る練習に最適です。</p>
<ul>
<li><code>|</code> <code>;</code> <code>||</code> <code>&amp;&amp;</code> <code>&lt;</code> <code>&gt;</code> <code>&gt;&gt;</code> <code>2&gt;</code> <code>2&gt;&gt;</code> <code>&amp;&gt;</code> <code>&amp;&gt;&gt;</code></li>
</ul>
<h2 id="環境変数を展開"><a href="#環境変数を展開" class="headerlink" title="環境変数を展開"></a>環境変数を展開</h2><p>通常のプログラムであれば、<code>os.ExpandEnv()</code>を使えば文字列中の環境変数（<code>$&#123;ENV&#125;</code>)を環境変数の値に置き換えてくれます。しかし、これはGoのプログラムのプロセス自体が持っている環境変数をもとにしてしまいます。シェルは自分の子プロセスのための環境変数を持つものなのでこれは使えません。<code>os.ExpandEnv()</code>の低レベル版の<code>os.Expand()</code>であれば、変換するキーと値の交換を関数で指定するのでこれが使えます。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> args []<span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> env <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> <span class="comment">// ←ここに環境変数が入っているものとする</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, arg := <span class="keyword">range</span> origArgs &#123;</span><br><span class="line">	p.Args = <span class="built_in">append</span>(p.Args, os.Expand(arg, <span class="function"><span class="keyword">func</span><span class="params">(key <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">		<span class="keyword">return</span> env[key]</span><br><span class="line">	&#125;))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ワイルドカードを展開"><a href="#ワイルドカードを展開" class="headerlink" title="ワイルドカードを展開"></a>ワイルドカードを展開</h2><p><code>path/filepath</code>か、<code>io/fs</code>の<code>Glob()</code>関数でワイルドカード(<code>*</code>, <code>?</code>, <code>[]</code>)展開ができます。シェルはマッチするファイルのリストに展開するので、引数の数が膨れることがあります。Globでマッチする前に、パスを絶対パスにしておきます。そうでないと、作業フォルダが現在のシェル自身の作業フォルダとずれている場合に、相対パスでマッチするファイルが変わってしまうので要注意です。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">expandPath</span><span class="params">(dir, workDir <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> filepath.IsAbs(path) &#123;</span><br><span class="line">		<span class="keyword">return</span> path</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> filepath.Join(workDir, path)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">expandWildcard</span><span class="params">(arg, workDir <span class="keyword">string</span>)</span> <span class="params">([]<span class="keyword">string</span>, error)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> !strings.ContainsAny(arg, <span class="string">&quot;*?[&quot;</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> []<span class="keyword">string</span>&#123;arg&#125;, <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	files, err := filepath.Glob(expandPath(arg, workDir))</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(files) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, ErrWildcardNoMatchError</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> files, err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="リダイレクトとパイプ"><a href="#リダイレクトとパイプ" class="headerlink" title="リダイレクトとパイプ"></a>リダイレクトとパイプ</h2><p>パイプ(<code>|</code>)がコマンド列にあったら、前のコマンドの標準出力の結果を、次のコマンドの標準入力に直接流し込む指定になります。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">reader, writer := io.Pipe()</span><br><span class="line">c1.Stdout = writer</span><br><span class="line">c2.Stdin = reader</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">wg.Add(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">	c1.Start()</span><br><span class="line">	c1.Wait()</span><br><span class="line">	writer.Close()</span><br><span class="line">	wg.Done()</span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">	c2.Start()</span><br><span class="line">	c2.Wait()</span><br><span class="line">	wg.Done()</span><br><span class="line">&#125;()</span><br><span class="line">wg.Wait()</span><br></pre></td></tr></table></figure>

<p>標準出力のリダイレクトの場合、ファイルを開いて、標準出力につなげます。<code>&gt; FILE</code>という形式であれば上書きなので<code>O_TRUNC</code>フラグをつけます。<code>&gt;&gt; FILE</code>という形式であれば、<code>O_APPEND</code>をつけます。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">flag := os.O_CREATE | os.O_WRONLY</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">append</span> &#123;</span><br><span class="line">	flag += os.O_APPEND</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	flag += os.O_TRUNC</span><br><span class="line">&#125;</span><br><span class="line">f, err := os.OpenFile(p.Shell.ExpandPath(path), flag, <span class="number">0</span>o777)</span><br><span class="line"><span class="keyword">defer</span> f.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line">c.Stdout = f</span><br><span class="line">c.Start()</span><br><span class="line">c.Wait()</span><br></pre></td></tr></table></figure>

<h2 id="環境変数とワークフォルダを設定して実行"><a href="#環境変数とワークフォルダを設定して実行" class="headerlink" title="環境変数とワークフォルダを設定して実行"></a>環境変数とワークフォルダを設定して実行</h2><p>これは通常の<code>os/exec</code>の<code>Cmd</code>構造体（<code>exec.CommandContext()</code>のレスポンス)の<code>Dir</code>と<code>Env</code>に格納してあげると、実行時に考慮されます。<code>Start()</code>を呼ぶ前に設定しましょう。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cmd.Dir = workDir</span><br><span class="line"><span class="keyword">var</span> env []<span class="keyword">string</span></span><br><span class="line"><span class="keyword">for</span> key, value := <span class="keyword">range</span> envs &#123;</span><br><span class="line">	env = <span class="built_in">append</span>(env, key + <span class="string">&quot;=&quot;</span> + value)</span><br><span class="line">&#125;</span><br><span class="line">cmd.Env = env</span><br></pre></td></tr></table></figure>

<h1 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h1><p>これらのコーディングの要素を駆使すればコマンドシェルが実装できるでしょう。コマンドをパースしたタイミングで、内部コマンドとして実装したコマンドがあればそれを、なければ外部コマンドの実行をするようにすることになるでしょう。内部コマンドが充実すればするほど、OS間のポータビリティもあがると思います。</p>
<p>一年ぐらい前に、Markdownに書かれているコード片をパースして処理する処理系作れば、Go関連のタスク実行の手段でmakeを使っている代わりが作れるのではないか、ということで、ぼちぼち調べたりしていました。Markdownなら、文芸的プログラミング的だし、きっとメンテナンス性も良いだろうと。ただし作るからにはある程度インストール系のタスクで使われるコマンドをいろいろ内部コマンドとして作り込もうとしたり、リダイレクトとかバッククオートとかいろいろ対応しなきゃ、ということで長らくのんびり作業をしておりました。</p>
<p>それはそうと、「シェルをどう学べばいいか」というTwitterで話題になることについて、「内部の挙動を知れば解になるだろう」ということでシェルっぽいものを作っていた知識を書き出してみたのが今回の発表です。もちろん、トップダウンで使い方から学ぶ方が良い人もいれば、今回のようにボトムアップで学んだ方がイメージがつきやすい人もいるはずで、後者の人のヒントになれば、と思っています。</p>

          
        </div>
        <footer>
          <section class="social-area">
          <!-- シェアボタン START -->
  <ul class="social-button">
    
    <!-- Twitter -->
    <li>
      <a class="social-btn twitter-btn" target="_blank" href="https://twitter.com/share?url=https://future-architect.github.io/articles/20211118a/&related=twitterapi%2Ctwitter&text=Go%20Conference%20Online%202021%20Autumn%E3%81%8C%E9%96%8B%E5%82%AC%E3%81%95%E3%82%8C%E3%81%BE%E3%81%97%E3%81%9F%EF%BC%86%E4%BD%9C%E3%81%A3%E3%81%A6%E5%AD%A6%E3%81%B6%E3%82%B7%E3%82%A7%E3%83%AB%20%7C%20%E3%83%95%E3%83%A5%E3%83%BC%E3%83%81%E3%83%A3%E3%83%BC%E6%8A%80%E8%A1%93%E3%83%96%E3%83%AD%E3%82%B0" rel="nofollow noopener">
        <i></i><span class="social-btn-label">36</span>
      </a>
    </li>
    <!-- Facebook -->
    <li>
      <a class="social-btn fb-btn" target="_blank" href="http://www.facebook.com/share.php?u=https://future-architect.github.io/articles/20211118a/&t=Go%20Conference%20Online%202021%20Autumn%E3%81%8C%E9%96%8B%E5%82%AC%E3%81%95%E3%82%8C%E3%81%BE%E3%81%97%E3%81%9F%EF%BC%86%E4%BD%9C%E3%81%A3%E3%81%A6%E5%AD%A6%E3%81%B6%E3%82%B7%E3%82%A7%E3%83%AB" rel="nofollow noopener">
        <i></i><span class="social-btn-label">シェア</span>
      </a>
    </li>
    <!-- hatebu -->
    <li>
      <a class="social-btn hatebu-btn" target="_blank" href="https://b.hatena.ne.jp/entry/s/future-architect.github.io/articles/20211118a/" rel="nofollow noopener">
        <i></i><span class="social-btn-label">4</span>
      </a>
    </li>
    <!-- pocket -->
    <li>
      <a class="social-btn pocket-btn" target="_blank" href="https://getpocket.com/save?url=https://future-architect.github.io/articles/20211118a/" rel="nofollow noopener">
        <i></i><span class="social-btn-label">6</span>
      </a>
    </li>
    
  </ul>
<!-- シェアボタン END -->

          </section>
          <aside>
            <section class="related-post margin-bottom-40 nav">
              <h2 id="related"><a href="#related" class="headerlink" title="関連記事"></a>関連記事</h2>
              
  <div class="widget">
    <ul class="nav related-post-link"><li class="related-posts-item"><span>2020.10.11</span><span class="snscount">&#9825;1</span><a href=/articles/20201011/ title="あいにくの天気でしたが、GoCon仙台で発表してきました。当初は2月予定だったのが状況が厳しいということで7月にずらして公開したが、それでも状況は好転しなかったので10月に延期、とスタッフの方々はいろいろ気を揉んで大変だったと思います。子供と見ていたシンカリオンに出てきて気になっていたチキン弁当！"> GoCon仙台で発表してきました</a></li><li class="related-posts-item"><span>2021.11.22</span><span class="snscount">&#9825;25</span><a href=/articles/20211122a/ title="Go Conference Online 2021 Autumnに登壇しました。Go Conference Autumn には2019年にも登壇しているので、2年ぶり2度目の出場になります。2019年はGoの特徴である並行処理に焦点を当てた、Goによる並列のシミュレーテッドアニーニングの実装、というマニアックな内容でしたが、今回はGoの静的解析、という身近なテーマで登壇しました。"> Go Conference 2021 Autumn にGoの静的解析で登壇しました</a></li><li class="related-posts-item"><span>2021.11.19</span><span class="snscount">&#9825;40</span><a href=/articles/20211119a/ title="Go Conference 2021 Autumnに登壇させていただきました、リモート登壇です。contextはGoでアプリケーションを実装する上でお世話にならない方が少ないくらいのパッケージだと思います。"> 「Contextを完全に理解する」というテーマでGo Conference 2021 Autumnに登壇しました</a></li><li class="related-posts-item"><span>2021.04.30</span><span class="snscount">&#9825;7</span><a href=/articles/20210430a/ title="こんにちは、辻です。先日開催されました [Go Conference 2021 spring] にTIGから渋川、辻の計2名が登壇しました。Go Conference'20 in Autumnではオンラインとオフラインのハイブリッドな構成でしたが、今回はGo Conference史上初となるフルオンラインでの開催となりました。"> Go Conference 2021 Springに登壇しました</a></li><li class="related-posts-item"><span>2020.10.10</span><span class="snscount">&#9825;4</span><a href=/articles/20201010/ title="TIGの伊藤真彦です先日[Go Conference’20 in Autumn SENDAI]に登壇させていただきました、リモート登壇の為残念ながら現地には行きませんでした。発表資料はこちらです。"> 「Go on DockerスタイルでのバックエンドAPI構築」というテーマでGo Conference’20 in Autumn SENDAIに登壇しました</a></li><li class="related-posts-item"><span>2019.12.03</span><span class="snscount">&#9825;8</span><a href=/articles/20191203/ title="Go Conferenceの📛を作る。このプログラムを実行する前に、まずはスポンサーしますというのを宣言します。フューチャーもイベント協賛はいろいろやっていますし、特にうちのユニットはGo案件の割合も多いので、OKはもらいやすくて助かります。今回は参加者、スピーカー、スポンサーあわせて240人とかで、なおかつ1つ120円ということが分かったので、コスト的にはイベントスポンサーと考えると費用対効果は高いです。"> Go Conferenceの📛を作る</a></li></ul>
  </div>
            </section>
            <section class="reference-post margin-bottom-40 nav">
              
            </section>
          </aside>
        </footer>
      </div>
    </article>
  </main>
  <aside class="col-md-3 blog-sidebar">
    <!-- START SIDEBAR  -->


<section class="toc-section">
  <h2 class="margin-top-30">目次</h2>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%82%B7%E3%82%A7%E3%83%AB%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B%EF%BC%9F"><span class="toc-text">シェルとは何か？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%82%88%E3%82%8A%E7%8B%AD%E3%81%84%E6%84%8F%E5%91%B3%E3%81%A7%E4%BD%BF%E3%82%8F%E3%82%8C%E3%82%8B%E3%82%B7%E3%82%A7%E3%83%AB%EF%BC%9D%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%B7%E3%82%A7%E3%83%AB"><span class="toc-text">より狭い意味で使われるシェル＝コマンドシェル</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%82%82%E3%81%A3%E3%81%A8%E7%8B%AD%E3%81%84%E5%AE%9A%E7%BE%A9%E3%81%AE%E3%82%B7%E3%82%A7%E3%83%AB-POSIX%E3%82%B7%E3%82%A7%E3%83%AB"><span class="toc-text">もっと狭い定義のシェル&#x3D;POSIXシェル</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%B7%E3%82%A7%E3%83%AB%E3%81%8C%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B%E3%81%BE%E3%81%A7"><span class="toc-text">コマンドシェルがコマンドを実行するまで</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%81%A1%E3%82%87%E3%81%A3%E3%81%A8%E8%A3%8F%E6%96%B9%E3%81%A3%E3%81%BD%E3%81%84%E3%82%B7%E3%82%A7%E3%83%AB%E3%81%AE%E3%81%8A%E4%BB%95%E4%BA%8B"><span class="toc-text">ちょっと裏方っぽいシェルのお仕事</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%B7%E3%82%A7%E3%83%AB%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86"><span class="toc-text">コマンドシェルを作ってみよう</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%83%AB%E3%83%BC%E3%83%97%E3%81%A7%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AE%E5%85%A5%E5%8A%9B%E3%82%92%E5%8F%97%E3%81%91%E3%82%8B"><span class="toc-text">ループでユーザーの入力を受ける</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%A8%E5%BC%95%E6%95%B0%E3%82%92%E5%88%86%E8%A7%A3"><span class="toc-text">コマンドと引数を分解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0%E3%82%92%E5%B1%95%E9%96%8B"><span class="toc-text">環境変数を展開</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%83%AF%E3%82%A4%E3%83%AB%E3%83%89%E3%82%AB%E3%83%BC%E3%83%89%E3%82%92%E5%B1%95%E9%96%8B"><span class="toc-text">ワイルドカードを展開</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%83%AA%E3%83%80%E3%82%A4%E3%83%AC%E3%82%AF%E3%83%88%E3%81%A8%E3%83%91%E3%82%A4%E3%83%97"><span class="toc-text">リダイレクトとパイプ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0%E3%81%A8%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%97%E3%81%A6%E5%AE%9F%E8%A1%8C"><span class="toc-text">環境変数とワークフォルダを設定して実行</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%81%BE%E3%81%A8%E3%82%81"><span class="toc-text">まとめ</span></a></li></ol>
</section>

<section class="category">
<h2 class="margin-top-30">カテゴリー</h2>
<div class="widget">
  <ul class="nav sidebar-categories margin-bottom-40">
  
  <li class=""><a href="/categories/Programming/">Programming (256)</a></li>
<li class=""><a href="/categories/Infrastructure/">Infrastructure (165)</a></li>
<li class=""><a href="/categories/Culture/">Culture (63)</a></li>
<li class=""><a href="/categories/DataScience/">DataScience (38)</a></li>
<li class=""><a href="/categories/IoT/">IoT (21)</a></li>
<li class=""><a href="/categories/DB/">DB (15)</a></li>
<li class=""><a href="/categories/Management/">Management (12)</a></li>
<li class=""><a href="/categories/VR/">VR (10)</a></li>
<li class=""><a href="/categories/Design/">Design (10)</a></li>
<li class=""><a href="/categories/%E8%AA%8D%E8%A8%BC%E8%AA%8D%E5%8F%AF/">認証認可 (10)</a></li>
<li class=""><a href="/categories/DevOps/">DevOps (7)</a></li>
<li class=""><a href="/categories/Business/">Business (4)</a></li>
<li class=""><a href="/categories/Security/">Security (3)</a></li>

  </ul>
</div>

</section>
<section class="podcast-link">
<h2 class="margin-top-30">Tech Cast</h2>

  <div class="class="widget-wrap">
  <div class="widget">
    <ul class="nav techcast">
      <li><a href="https://anchor.fm/futuretechcast/episodes/17-Real-World-HTTP2-e1bamm7" title="フューチャーがお届けするポッドキャストです。#17 Real World HTTP著者の澁川さんと語り尽くす会その2" target="_blank" rel="noopener"><span class="newitem">NEW</span> #17 Real World HTTP著者の澁川さんと語り尽くす会その2</a></li>
<li><a href="https://anchor.fm/futuretechcast/episodes/16-IT-e1au7ul" title="フューチャーがお届けするポッドキャストです。#16 IT未経験からアジャイル開発と基幹系開発の両方を経験した柏木さんに聞いてみた" target="_blank" rel="noopener"> #16 IT未経験からアジャイル開発と基幹系開発の両方を経験した柏木さんに聞いてみた</a></li>
<li><a href="https://anchor.fm/futuretechcast/episodes/15-IT-e19jfjr" title="フューチャーがお届けするポッドキャストです。#15 ITコンサルから起業にチャレンジした千葉駿さんと話してみた" target="_blank" rel="noopener"> #15 ITコンサルから起業にチャレンジした千葉駿さんと話してみた</a></li>
    </ul>
  </div>
  </div>
  
</section>
<section class="advent-calendar">
<h2 class="margin-top-30">アドベントカレンダー</h2>
<div class="widget">
  <ul class="nav-flex">
    <li><a href="http://qiita.com/advent-calendar/2021/future" title="フューチャー Advent Calendar 2021 #Qiita" target="_blank" rel="noopener">2021年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2020/future" title="フューチャー Advent Calendar 2020 #Qiita" target="_blank" rel="noopener">2020年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2019/future" title="フューチャー Advent Calendar 2019 #Qiita" target="_blank" rel="noopener">2019年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2018/future" title="フューチャー Advent Calendar 2018 #Qiita" target="_blank" rel="noopener">2018年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2017/future" title="フューチャー Advent Calendar 2017 #Qiita" target="_blank" rel="noopener">2017年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2016/future" title="フューチャー Advent Calendar 2016 #Qiita" target="_blank" rel="noopener">2016年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2015/future" title="フューチャー Advent Calendar 2015 #Qiita" target="_blank" rel="noopener">2015年</a></li>
  </ul>
</div>

</section>
<!-- END SIDEBAR -->

  </aside>
</div>

  </section>
</div>

      <!-- BEGIN PRE-FOOTER -->
    <footer>
      <div class="pre-footer">
        <div class="container">
          <div class="row">
            <div class="col-lg-4 col-md-4 col-sm-6 col-6 pre-footer-col">
              <h2>About Us</h2>
              <p>経営とITをデザインする、フューチャーの技術ブログです。業務で利用している幅広い技術について紹介します。<br /><br /><a target="_blank" rel="noopener" href="http://www.future.co.jp/">http://www.future.co.jp/</a></p>
              <div class="social-btn twitter-btn twitter-follow-btn">
                <a href="https://twitter.com/intent/follow?screen_name=future_techblog " target="_blank" rel="nofollow noopener">
                  <i></i><span class="tw-btn-label">フューチャー技術ブログをフォロー</span>
                </a>
              </div>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-4 col-4 pre-footer-col">
              <h2>Contact</h2>
              <address class="margin-bottom-40">
                <a href="https://www.future.co.jp/recruit/recruit/rec-fresh/" title="新卒採用" target="_blank" rel="noopener">新卒採用</a><br>
                <a href="https://www.future.co.jp/recruit/recruit/rec-career/" title="キャリア採用" target="_blank" rel="noopener">キャリア採用</a><br>
                <a href="https://www.future.co.jp/contact_us/" title="お問い合わせページ" target="_blank" rel="noopener">お問い合わせ</a><br>
                <a href="https://www.future.co.jp/architect/socialmediapolicy/" title="ソーシャルメディアポリシー" target="_blank" rel="noopener">メディアポリシー</a><br><br>
                <a href="mailto:techblog@future.co.jp">techblog@future.co.jp</a>
              </address>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-6 col-6 pre-footer-col">
              <h2>Contents</h2>
              <a href="https://future-architect.github.io/coding-standards/" title="Future Enterprise Coding Standards" target="_blank" rel="noopener">コーディング規約</a><br>
              <a href="https://future-architect.github.io/typescript-guide/" title="仕事ですぐに使えるTypeScript" target="_blank" rel="noopener">仕事ですぐに使えるTypeScript</a><br>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-3 col-3 pre-footer-col">
              <h2>Event</h2>
              <a href="https://future.connpass.com/" title="経営とITをデザインするフューチャーの勉強会です" target="_blank" rel="noopener">connpass</a><br>
              <a href="https://www.future.co.jp/futureinsightseminar/" title="フューチャーインサイトセミナー" target="_blank" rel="noopener">Webセミナー</a><br>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-3 col-3 pre-footer-col">
              <h2>SNS</h2>
              <a href="https://github.com/future-architect" title="Future's official open source repositories" target="_blank" rel="noopener">GitHub</a><br>
              <a href="https://qiita.com/organizations/future" title="フューチャーのQiita Organizationです" target="_blank" rel="noopener">Qiita</a><br>
              <a href="https://note.future.co.jp/" title="フューチャーの公式note" target="_blank" rel="noopener">未来報</a><br>
              <a href="https://www.youtube.com/channel/UCJUSwYYd0CkGgmEKAW7QVpw" title="フューチャーYoutubeチャネル" target="_blank" rel="noopener">Youtube</a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer">
        <div class="container">
          <div class="row">
            <div class="col-md-6 col-sm-6 padding-top-10">
              &copy; 2021 フューチャー技術ブログ<br>
            </div>
          </div>
        </div>
      </div>
    </footer>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-74047147-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-74047147-1');
</script>

  </div>
</body>
</html>
