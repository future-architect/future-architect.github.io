<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <!--
    ███████╗██╗░░░██╗████████╗██╗░░░██╗██████╗░███████╗
    ██╔════╝██║░░░██║╚══██╔══╝██║░░░██║██╔══██╗██╔════╝
    █████╗░░██║░░░██║░░░██║░░░██║░░░██║██████╔╝█████╗░░
    ██╔══╝░░██║░░░██║░░░██║░░░██║░░░██║██╔══██╗██╔══╝░░
    ██║░░░░░╚██████╔╝░░░██║░░░╚██████╔╝██║░░██║███████╗
    ╚═╝░░░░░░╚═════╝░░░░╚═╝░░░░╚═════╝░╚═╝░░╚═╝╚══════╝
    ████████╗███████╗░█████╗░██╗░░██╗
    ╚══██╔══╝██╔════╝██╔══██╗██║░░██║
    ░░░██║░░░█████╗░░██║░░╚═╝███████║
    ░░░██║░░░██╔══╝░░██║░░██╗██╔══██║
    ░░░██║░░░███████╗╚█████╔╝██║░░██║
    ░░░╚═╝░░░╚══════╝░╚════╝░╚═╝░░╚═╝
    ██████╗░██╗░░░░░░█████╗░░██████╗░
    ██╔══██╗██║░░░░░██╔══██╗██╔════╝░
    ██████╦╝██║░░░░░██║░░██║██║░░██╗░
    ██╔══██╗██║░░░░░██║░░██║██║░░╚██╗
    ██████╦╝███████╗╚█████╔╝╚██████╔╝
    ╚═════╝░╚══════╝░╚════╝░░╚═════╝░
    Welcome engineer.
    https://www.future.co.jp/recruit/
  -->
  
  <title>実世界データの特徴と処理方法 | フューチャー技術ブログ</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  <meta name="description" content="こんにちは。TIG DXユニットの村上です。 私は大学時代から深層強化学習の研究をしていますが、分野的にほとんど実世界のデータを扱うことがありませんでした。そんな私ですが、実務で実世界データの分析を行う機会があり、その違いに多くの学びがありました。 実世界データのデータ分析を行った結果見えてきた、実世界データの特徴と欠損値や不正データの処理について解説しようと思います。 簡易的ですがソースコードも">
<meta property="og:type" content="article">
<meta property="og:title" content="実世界データの特徴と処理方法 | フューチャー技術ブログ">
<meta property="og:url" content="https://future-architect.github.io/articles/20210423b/index.html">
<meta property="og:site_name" content="フューチャー技術ブログ">
<meta property="og:description" content="こんにちは。TIG DXユニットの村上です。 私は大学時代から深層強化学習の研究をしていますが、分野的にほとんど実世界のデータを扱うことがありませんでした。そんな私ですが、実務で実世界データの分析を行う機会があり、その違いに多くの学びがありました。 実世界データのデータ分析を行った結果見えてきた、実世界データの特徴と欠損値や不正データの処理について解説しようと思います。 簡易的ですがソースコードも">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://future-architect.github.io/images/20210423b/search-4083722_640.jpg">
<meta property="og:image" content="https://future-architect.github.io/images/20210423b/flow_chart.png">
<meta property="og:image" content="https://future-architect.github.io/images/20210423b/image.png">
<meta property="article:published_time" content="2021-04-22T15:00:01.000Z">
<meta property="article:modified_time" content="2022-07-04T14:47:53.348Z">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="データ分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://future-architect.github.io/images/20210423b/search-4083722_640.jpg">
  
  <link rel="alternate" href="/atom.xml" title="フューチャー技術ブログ" type="application/atom+xml">
  
  <link rel="icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes='180x180' href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes='57x57' href="/apple-touch-icon-57x57.png">
  <link rel="canonical" href="https://future-architect.github.io/articles/20210423b/">
  <meta content="Python,データ分析" name="keywords">
  <meta content="村上知優" name="author">
  <link rel="preload" as="image" href="/banner.jpg" />
  <link rel='manifest' href='/manifest.webmanifest'/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <link rel="stylesheet" href="/metronic/assets/style.css">
  <link rel="stylesheet" href="/css/theme-styles.css">
<meta name="generator" content="Hexo 5.4.2"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body class="corporate">
  <div class="wrap" itemscope itemtype="https://schema.org/TechArticle">
  <!-- BEGIN HEADER -->
<header class="header">
	<div class="header-overlay">
		<div class="header-menu"></div>
		<div class="header-title"><a href="/">Future Tech Blog</a></div>
		<div class="header-title-sub">フューチャー技術ブログ</div>
	</div>
</header>
<!-- Header END -->

  <div class="container">
  <ul class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/articles/">Blog</a></li>
    <li class="active">Post</li>
  </ul>
  <section id="main" class="margin-top-30">
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/DataScience/">DataScienceカテゴリ</a>
  </div>


    <h2 itemprop="name" class="article-title">実世界データの特徴と処理方法
  
  <a target="_blank" rel="noopener" href="https://github.com/future-architect/tech-blog/edit/master/source/_posts/20210423b_実世界データの特徴と処理方法.md" title="Suggest Edits" class="github-edit"><i class="github-edit-icon"></i></a>
  
</h2>

    <div class="row">
  <main class="col-md-9 blog-posts">
    <article id="post-20210423b_実世界データの特徴と処理方法" class="article article-type-post blog-item" itemscope itemprop="blogPost">
      <div class="article-inner">
        
        <header class="article-header">
          <ul class="blog-info">
            <li class="blog-info-item"><a href="/articles/2021/" class="publish-date"><time datetime="2021-04-22T15:00:01.000Z" itemprop="datePublished">2021.04.23</time></a>
</li>
            <li class="blog-info-item"><li><a href="/authors/%E6%9D%91%E4%B8%8A%E7%9F%A5%E5%84%AA" title="村上知優さんの記事一覧へ" class="post-author">村上知優</a></li></li>
            <li class="blog-info-item">
  
    
    <a href="/tags/Python/" title="Pythonタグの記事へ" class="tag-list-link">Python</a>
  
    
    <a href="/tags/データ分析/" title="データ分析タグの記事へ" class="tag-list-link">データ分析</a>
  

</li>
          </ul>
          </header>
        
        <div class="article-entry" itemprop="articleBody">
          
            <p>こんにちは。TIG DXユニットの村上です。</p>
<p>私は大学時代から深層強化学習の研究をしていますが、分野的にほとんど実世界のデータを扱うことがありませんでした。そんな私ですが、実務で実世界データの分析を行う機会があり、その違いに多くの学びがありました。</p>
<p>実世界データのデータ分析を行った結果見えてきた、実世界データの特徴と欠損値や不正データの処理について解説しようと思います。</p>
<p>簡易的ですがソースコードも示していますので、参考になれば幸いです。</p>
<h1 id="実世界データとは"><a href="#実世界データとは" class="headerlink" title="実世界データとは"></a>実世界データとは</h1><img src="/images/20210423b/search-4083722_640.jpg" alt="" title="mohamed HassanによるPixabayからの画像" class="img-middle-size">


<p>内容に入る前に、本記事での実世界データの定義を行っておきます。ここでは以下2点を満たすものを実世界データと呼ぶことにします。</p>
<ul>
<li>もともとはアナログデータである</li>
<li>データ品質を高める処理が行われていない生のデータ</li>
</ul>
<p>例えば身近なものだと、温度計や湿度計から取得されたデータは実世界データとなります。これらに欠損値補完 <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>などのデータ品質を高める処理を施した後は実世界データと呼ばないことにします。</p>
<p>また、機械学習用のデータセットや、システムのモニタリングデータなどは実世界データではありません。</p>
<h1 id="実世界データの品質"><a href="#実世界データの品質" class="headerlink" title="実世界データの品質"></a>実世界データの品質</h1><p>実世界データのデータ品質は基本的に<code>悪い</code>です。欠損値が含まれていたり、不正なデータが存在するのが当たり前です。主な理由は物理的、人間の意志的な影響を受けるからです。これらの作用により、主に以下2ケースのデータ品質悪化が起こります。</p>
<ol>
<li><a href="#%E2%91%A0%E6%AC%A0%E6%90%8D%E5%80%A4%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B">欠損値が発生する</a></li>
<li><a href="#%E2%91%A1%E4%B8%8D%E6%AD%A3%E3%81%AA%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E6%B7%B7%E5%85%A5%E3%81%99%E3%82%8B">不正なデータが混入する</a></li>
</ol>
<p>これらの発生原因と対処法について解説します。</p>
<h2 id="①欠損値が発生する"><a href="#①欠損値が発生する" class="headerlink" title="①欠損値が発生する"></a>①欠損値が発生する</h2><p>例えば、データの発生源であるIoTデバイスが屋外に設置されている場合、気象の影響を受けます。台風の時に固いものが飛んできてIoTデバイスに直撃、データを送信できなくなるなんてことも有り得ます。また、単純に電波不良などでデータがサーバに到達しなかったという状況も十分あり得ます。</p>
<p>このように挙げたらきりがありませんが、実世界ではデータがが発生したにも関わらずそれが取得できないことがよくあります。</p>
<h2 id="欠損値処理"><a href="#欠損値処理" class="headerlink" title="欠損値処理"></a>欠損値処理</h2><p>欠損値の処理に関しては、そのデータを使ってどのような分析を行うかで適切な処理の仕方が変わってきます。ここでは様々な処理方法とそのユースケースを解説します。</p>
<h3 id="欠損値を削除する"><a href="#欠損値を削除する" class="headerlink" title="欠損値を削除する"></a>欠損値を削除する</h3><p>欠損値が無視できるものであれば、削除してしまうのが手っ取り早いです。ではどのような時に無視しても良いのかですが、以下のケースがそれにあたります。</p>
<ol>
<li>後続のデータ分析で利用しない</li>
<li>データ数が減っても問題ない</li>
</ol>
<p>1番は分りやすいと思いますが、2番は要注意です。極端な例ではありますが、以下のような天気と気温のデータがあるとします。</p>
<p>見ての通り、データの発生源である温度計は雨が降ると高確率でデータを取得できない残念な仕様になっていたとします。</p>
<div class="scroll"><table>
<thead>
<tr>
<th align="center">データ</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">9</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>天気</strong></td>
<td align="center">晴れ</td>
<td align="center">晴れ</td>
<td align="center">晴れ</td>
<td align="center">雨</td>
<td align="center">雨</td>
<td align="center">雨</td>
<td align="center">曇り</td>
<td align="center">曇り</td>
<td align="center">曇り</td>
</tr>
<tr>
<td align="center"><strong>気温</strong></td>
<td align="center">25℃</td>
<td align="center">24℃</td>
<td align="center">26℃</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">18℃</td>
<td align="center">18℃</td>
<td align="center">20℃</td>
<td align="center">19℃</td>
</tr>
</tbody></table></div>
<p>このような温度計から得られたデータに対して欠損値削除を行い、気温から天気を予測するモデルを構築するとしたらどうなるでしょうか？おそらくそのモデルの予測結果は晴れか曇りのみになります。雨のデータがほとんど存在しないので、とりあえず晴れか曇りと予測しておけば正答率は高くなるということです。このように、データ数が減ること自体が問題になるケースが存在します。</p>
<p>以上を踏まえて、欠損値を削除しても問題ない場合はpandasを用いて簡単に削除することができます。<br>例として、以下のデータに対して欠損値削除を行います。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">         name gender  profession</span><br><span class="line"><span class="number">0</span>  Goodfellow    man         NaN</span><br><span class="line"><span class="number">1</span>        Mnih    man  researcher</span><br><span class="line"><span class="number">2</span>      Graves    NaN  researcher</span><br><span class="line"><span class="number">3</span>         NaN    NaN         NaN</span><br></pre></td></tr></table></figure>

<ul>
<li>全ての項目が欠損値の場合にその行を削除</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.dropna(how=<span class="string">'all'</span>)</span><br><span class="line">         name gender  profession</span><br><span class="line"><span class="number">0</span>  Goodfellow    man         NaN</span><br><span class="line"><span class="number">1</span>        Mnih    man  researcher</span><br><span class="line"><span class="number">2</span>      Graves    NaN  researcher</span><br></pre></td></tr></table></figure>

<ul>
<li>1つでも欠損値があればその行を削除</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.dropna(how=<span class="string">'any'</span>)</span><br><span class="line">   name gender  profession</span><br><span class="line"><span class="number">1</span>  Mnih    man  researcher</span><br></pre></td></tr></table></figure>

<h3 id="特定の値で補完する"><a href="#特定の値で補完する" class="headerlink" title="特定の値で補完する"></a>特定の値で補完する</h3><p>欠損値が削除できない場合、何らかの値で補完します。どのような値で補完するかはそのデータに対してどのような分析を行うかに依存するため、目的をよく考えて補完する値を選ぶ必要があります。補完する値の候補と主なユースケースは以下です。</p>
<ul>
<li>固定値：その項目に表れる値があらかじめ決まっている場合</li>
<li>平均値：その項目の値の分散が小さい場合</li>
<li>中央値：その項目の値の分散が大きい場合</li>
</ul>
<p>例えば平均値による補完を行う場合は次のようになります。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line">    age</span><br><span class="line"><span class="number">0</span>  <span class="number">20.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">21.0</span></span><br><span class="line"><span class="number">2</span>   NaN</span><br><span class="line"><span class="number">3</span>  <span class="number">22.0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b.fillna(b.mean())</span><br><span class="line">    age</span><br><span class="line"><span class="number">0</span>  <span class="number">20.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">21.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">21.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">22.0</span></span><br></pre></td></tr></table></figure>

<h3 id="一定のアルゴリズムに従って補完する"><a href="#一定のアルゴリズムに従って補完する" class="headerlink" title="一定のアルゴリズムに従って補完する"></a>一定のアルゴリズムに従って補完する</h3><p>欠損値が一定のアルゴリズムに従って推定できる場合、以下の補完方法が有効です。</p>
<ul>
<li>線形補完：前後のデータ間の中間の値で補完</li>
<li>スプライン補完：スプライン曲線を用いて値を推定</li>
</ul>
<p>例えば線形補完をする場合は以下のようになります。今回は分りやすいようにmethodを明示的に指定していますが、デフォルトで<code>linear</code>なので、線形補完する場合はmethodの指定は省略可能です。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line">    age</span><br><span class="line"><span class="number">0</span>  <span class="number">20.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">21.0</span></span><br><span class="line"><span class="number">2</span>   NaN</span><br><span class="line"><span class="number">3</span>  <span class="number">22.0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b.interpolate(method=<span class="string">'linear'</span>)</span><br><span class="line">    age</span><br><span class="line"><span class="number">0</span>  <span class="number">20.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">21.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">21.5</span></span><br><span class="line"><span class="number">3</span>  <span class="number">22.0</span></span><br></pre></td></tr></table></figure>

<p>これら以外にも様々な補完アルゴリズムが存在します。いずれもpandasで簡単に行うことができるので、<a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.interpolate.html">公式ドキュメント</a>を参考にしてみてください。</p>
<h2 id="②不正なデータが混入する"><a href="#②不正なデータが混入する" class="headerlink" title="②不正なデータが混入する"></a>②不正なデータが混入する</h2><p>このケースはデータの生成過程で人間による入力が存在する場合、容易に発生し得るものです。また、データの生成過程に人間が介入しないとしても、何らかの事情でデータを手動で作成して差し込む場合もあります。</p>
<p>このケースの厄介な点は、それが正しいデータなのか、不正なデータなのかの判断が難しいことです。理論上有り得ないデータであればバリデーションチェックを行うことで正確に判断できるのですが、そうでない場合は不正なデータであることに気づくことが困難です。仮に怪しいデータを発見したとしても、それが不正なデータである裏付けを取るためには、そのデータの生成過程を精査する必要があり、多くの手間がかかります。</p>
<h3 id="不正データの検出方法"><a href="#不正データの検出方法" class="headerlink" title="不正データの検出方法"></a>不正データの検出方法</h3><p>次に不正なデータの検出方法を説明します。以下のフローチャートに従ってデータをチェックするのが効率的です。</p>
<img src="/images/20210423b/flow_chart.png" alt="不正なデータのチェックフロー" loading="lazy">


<p>①番、②番について詳しく見ていきます。</p>
<h4 id="①理論上有り得るデータかチェック（バリデーションチェック）"><a href="#①理論上有り得るデータかチェック（バリデーションチェック）" class="headerlink" title="①理論上有り得るデータかチェック（バリデーションチェック）"></a>①理論上有り得るデータかチェック（バリデーションチェック）</h4><p>この段階では確実に不正であるデータを検出します。そのために、まずは正しいデータとはどのようなデータかをしっかりと定義する必要があります。この定義に間違いがあると、本当は正しいデータでも不正なデータとして検出されてしまう可能性があります。さらに、そのデータの発生源に対して何らかのシステム的、人間の意思決定的な側面から変更が加わる場合、同時に正しいデータの定義にも変更が必要な可能性があります。</p>
<p>従って、正しいデータの定義は一度決めたらそれで終了ではなく、適時変更が入ることを前提とするのがベターです。</p>
<p>次にバリデーションチェックのやり方ですが、これはpandera <sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>というpandasの拡張ライブラリを使うのがおすすめです。以下のように正しいデータの値域などを定義し、定義を満たさないものを検出することができます。</p>
<p>以下は<a target="_blank" rel="noopener" href="https://pandera.readthedocs.io/en/stable/">pandera公式ドキュメント</a>からの引用です。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pandera <span class="keyword">import</span> Column, DataFrameSchema, Int, Check</span><br><span class="line"></span><br><span class="line">simple_schema = DataFrameSchema({</span><br><span class="line">    <span class="string">"column1"</span>: Column(</span><br><span class="line">        Int, Check(<span class="keyword">lambda</span> x: <span class="number">0</span> &lt;= x &lt;= <span class="number">10</span>, element_wise=<span class="literal">True</span>,  <span class="comment"># ここで正しいデータを定義</span></span><br><span class="line">                   error=<span class="string">"range checker [0, 10]"</span>))  <span class="comment"># 弾かれた際のメッセージも定義できる</span></span><br><span class="line">})</span><br><span class="line"></span><br><span class="line"><span class="comment"># データをDataFrameに入力</span></span><br><span class="line">fail_check_df = pd.DataFrame({</span><br><span class="line">    <span class="string">"column1"</span>: [-<span class="number">20</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">30</span>],  <span class="comment"># 0 &lt;= x &lt;= 10 が正しいデータなので、-20と30は不正データ</span></span><br><span class="line">})</span><br><span class="line"></span><br><span class="line">simple_schema(fail_check_df)  <span class="comment"># バリデーションチェックを実行</span></span><br></pre></td></tr></table></figure>

<p>バリデーションチェックの実行結果は次のようになります。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">...</span><br><span class="line">SchemaError: &lt;Schema Column: <span class="string">'column1'</span> <span class="built_in">type</span>=<span class="built_in">int</span>&gt; failed element-wise validator <span class="number">0</span>:</span><br><span class="line">&lt;Check &lt;<span class="keyword">lambda</span>&gt;: <span class="built_in">range</span> checker [<span class="number">0</span>, <span class="number">10</span>]&gt;</span><br><span class="line">failure cases:</span><br><span class="line">   index  failure_case</span><br><span class="line"><span class="number">0</span>      <span class="number">0</span>           -<span class="number">20</span></span><br><span class="line"><span class="number">1</span>      <span class="number">3</span>            <span class="number">30</span></span><br></pre></td></tr></table></figure>

<h4 id="②データの分布から逸脱していないかチェック"><a href="#②データの分布から逸脱していないかチェック" class="headerlink" title="②データの分布から逸脱していないかチェック"></a>②データの分布から逸脱していないかチェック</h4><p>①番で弾かれなかったデータは必ず正しいデータという訳ではありません。理論上有り得るデータだが、入力ミスなどで真のデータと少し異なってしまうケースもあります。</p>
<p>このような、バリデーションチェックで検出できなかったデータから不正データを見つけるのはものによりますが、一般的には難しいと思います。ここではデータの分布という観点から、不正データの検出手法を解説します。</p>
<h5 id="データをソートして検出"><a href="#データをソートして検出" class="headerlink" title="データをソートして検出"></a>データをソートして検出</h5><p>一番簡単な方法として、データを昇順や降順に並べ替えて、明らかに他のデータの値から逸脱しているものを検出するというものがあります。エクセルでも簡単に行うことができるため、まずはこの方法から入ると良いかもしれません。</p>
<p>この手法はお手軽に行うことができる一方で、統計学的妥当性はありません。本質的には人間の感覚による判断になっているため、注意が必要です。</p>
<h5 id="正規分布による外れ値検出"><a href="#正規分布による外れ値検出" class="headerlink" title="正規分布による外れ値検出"></a>正規分布による外れ値検出</h5><p>データが正規分布 <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>に従う場合、この手法が有効です。正規分布では <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.489ex;" xmlns="http://www.w3.org/2000/svg" width="6.553ex" height="1.995ex" role="img" focusable="false" viewBox="0 -666 2896.4 882"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D707" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z"></path></g><g data-mml-node="mo" transform="translate(825.2,0)"><path data-c="B1" d="M56 320T56 333T70 353H369V502Q369 651 371 655Q376 666 388 666Q402 666 405 654T409 596V500V353H707Q722 345 722 333Q722 320 707 313H409V40H707Q722 32 722 20T707 0H70Q56 7 56 20T70 40H369V313H70Q56 320 56 333Z"></path></g><g data-mml-node="mn" transform="translate(1825.4,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(2325.4,0)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g></g></g></svg></mjx-container> 以内にデータの約95%、 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.489ex;" xmlns="http://www.w3.org/2000/svg" width="6.553ex" height="1.995ex" role="img" focusable="false" viewBox="0 -666 2896.4 882"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D707" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z"></path></g><g data-mml-node="mo" transform="translate(825.2,0)"><path data-c="B1" d="M56 320T56 333T70 353H369V502Q369 651 371 655Q376 666 388 666Q402 666 405 654T409 596V500V353H707Q722 345 722 333Q722 320 707 313H409V40H707Q722 32 722 20T707 0H70Q56 7 56 20T70 40H369V313H70Q56 320 56 333Z"></path></g><g data-mml-node="mn" transform="translate(1825.4,0)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g><g data-mml-node="mi" transform="translate(2325.4,0)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g></g></g></svg></mjx-container> 以内に約99.7%が含まれることが知られています。※ <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.489ex;" xmlns="http://www.w3.org/2000/svg" width="1.364ex" height="1.489ex" role="img" focusable="false" viewBox="0 -442 603 658"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D707" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z"></path></g></g></g></svg></mjx-container> は平均、 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.292ex" height="1ex" role="img" focusable="false" viewBox="0 -431 571 442"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g></g></g></svg></mjx-container> は標準偏差</p>
<img src="/images/20210423b/image.png" alt="正規分布" loading="lazy">

<p>引用：<a target="_blank" rel="noopener" href="https://ai-trend.jp/basic-study/normal-distribution/normal-distribution/">https://ai-trend.jp/basic-study/normal-distribution/normal-distribution/</a></p>
<p>従って、これらを逸脱したデータを不正データの可能性有りとみなすのは、一定の統計学的妥当性があります。</p>
<p>実装例として、<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.423ex" height="1.532ex" role="img" focusable="false" viewBox="0 -666 1071 677"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g></g></g></svg></mjx-container>を越えたものが検出される様子を以下に示します。10番目の<code>10000</code>のデータが外れ値（不正データ）の想定です。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">    price</span><br><span class="line"><span class="number">0</span>     <span class="number">100</span></span><br><span class="line"><span class="number">1</span>     <span class="number">200</span></span><br><span class="line"><span class="number">2</span>     <span class="number">100</span></span><br><span class="line"><span class="number">3</span>      <span class="number">50</span></span><br><span class="line"><span class="number">4</span>     <span class="number">120</span></span><br><span class="line"><span class="number">5</span>     <span class="number">200</span></span><br><span class="line"><span class="number">6</span>     <span class="number">150</span></span><br><span class="line"><span class="number">7</span>     <span class="number">100</span></span><br><span class="line"><span class="number">8</span>      <span class="number">80</span></span><br><span class="line"><span class="number">9</span>      <span class="number">20</span></span><br><span class="line"><span class="number">10</span>  <span class="number">10000</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mean = df.mean()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>std = df.std()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="string">'price'</span>] &gt; (mean + <span class="number">2</span> * std).values[<span class="number">0</span>]</span><br><span class="line"><span class="number">0</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">1</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">3</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">4</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">5</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">6</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">7</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">8</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">9</span>     <span class="literal">False</span></span><br><span class="line"><span class="number">10</span>     <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<p>10番目のデータがTrueになり、外れ値（不正データ）が検出できています。</p>
<h3 id="不正データの再発防止"><a href="#不正データの再発防止" class="headerlink" title="不正データの再発防止"></a>不正データの再発防止</h3><p>不正データを検出し、それらに対して削除などの対応を行った場合、それで終わりではまた再発する可能性があります。</p>
<p>例えば、不正データの発生原因が人間の介入によるものであった場合、人間が介入する割合を最小限に抑えるようシステム化を進める、人間が介入した際はそのデータのチェックを2人以上で行うなど、人間の作業フローを交えて不正データが発生しない仕組み作りを行う必要があります。</p>
<p>また、不正データの発生原因がシステムの故障によるものである場合、そのシステムを監視し、異常が検知された場合はその期間のデータを別の場所に隔離するなどの対応が必要になると思います。</p>
<p>このように、不正データを検知した際は、恒久、暫定的な再発防止策を早急に考える必要があります。</p>
<h1 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h1><p>今回は実世界データの品質が悪いことと、その対処法について解説しました。</p>
<p>これからの時代は増々データの品質が重視されると思いますので、引き続きデータに対する知識を深めていきたいと思います！</p>
<p>最後まで読んでくださり、ありがとうございました！</p>
<div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="vertical-align: top; padding-right: 10px;">1.</span><span style="vertical-align: top;">欠損値補完： <a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.interpolate.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.interpolate.html</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="vertical-align: top; padding-right: 10px;">2.</span><span style="vertical-align: top;">pandera： <a target="_blank" rel="noopener" href="https://pandera.readthedocs.io/en/stable/">https://pandera.readthedocs.io/en/stable/</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="vertical-align: top; padding-right: 10px;">3.</span><span style="vertical-align: top;">正規分布の性質： <a target="_blank" rel="noopener" href="https://ai-trend.jp/basic-study/normal-distribution/normal-distribution/">https://ai-trend.jp/basic-study/normal-distribution/normal-distribution/</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li></ol></div></div>
          
        </div>
        <footer>
          <section class="social-area">
          <!-- シェアボタン START -->
  <ul class="social-button">
    
    <!-- Twitter -->
    <li>
      <a class="social-btn twitter-btn" target="_blank" href="https://twitter.com/share?url=https://future-architect.github.io/articles/20210423b/&related=twitterapi%2Ctwitter&text=%E5%AE%9F%E4%B8%96%E7%95%8C%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E7%89%B9%E5%BE%B4%E3%81%A8%E5%87%A6%E7%90%86%E6%96%B9%E6%B3%95%20%7C%20%E3%83%95%E3%83%A5%E3%83%BC%E3%83%81%E3%83%A3%E3%83%BC%E6%8A%80%E8%A1%93%E3%83%96%E3%83%AD%E3%82%B0" rel="nofollow noopener">
        <i></i><span class="social-btn-label">ツイート</span>
      </a>
    </li>
    <!-- Facebook -->
    <li>
      <a class="social-btn fb-btn" target="_blank" href="http://www.facebook.com/share.php?u=https://future-architect.github.io/articles/20210423b/&t=%E5%AE%9F%E4%B8%96%E7%95%8C%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E7%89%B9%E5%BE%B4%E3%81%A8%E5%87%A6%E7%90%86%E6%96%B9%E6%B3%95" rel="nofollow noopener">
        <i></i><span class="social-btn-label">シェア</span>
      </a>
    </li>
    <!-- hatebu -->
    <li>
      <a class="social-btn hatebu-btn" target="_blank" href="https://b.hatena.ne.jp/entry/s/future-architect.github.io/articles/20210423b/" rel="nofollow noopener">
        <i></i><span class="social-btn-label">1</span>
      </a>
    </li>
    <!-- pocket -->
    <li>
      <a class="social-btn pocket-btn" target="_blank" href="https://getpocket.com/save?url=https://future-architect.github.io/articles/20210423b/" rel="nofollow noopener">
        <i></i><span class="social-btn-label">3</span>
      </a>
    </li>
    
  </ul>
<!-- シェアボタン END -->

          </section>
          <aside>
            <section class="related-post margin-bottom-40 nav">
              <h2 id="related"><a href="#related" class="headerlink" title="関連記事"></a>関連記事</h2>
              
  <div class="widget">
    <ul class="nav related-post-link"><li class="related-posts-item"><span>2021.02.25</span><span class="snscount">&#9825;13</span><a href=/articles/20210225/ title="こんにちは。TIG DXユニット所属の村上です。最近データ分析絡みでDynamoDBを触る機会が多く、DynamoDBが体の一部みたいになってきました。本記事の結論はこれです。">DynamoDBから効率的に大量のデータを取得する方法</a></li><li class="related-posts-item"><span>2020.11.19</span><span class="snscount">&#9825;37</span><a href=/articles/20201119/ title="私の所属しているプロジェクトでは、Go言語を使ってWeb APIを構築しています。私は元々Pythonを主に書いていましたが、Go言語を書くのは初めてでした。そんな私がPythonからGo言語へ入門する際に、苦労した経験や発見を共有したいと思います！">PythonistaがGo言語に入門してみた</a></li><li class="related-posts-item"><span>2017.05.26</span><span class="snscount">&#9825;154</span><a href=/articles/20170526/ title="AI(機械学習・Deep Learning等)を用いて、 **大量にある顔画像の中から同一人物をクラスタリングし、頻出する顔画像の抽出** を行い、常連さんの判定を行いたいと思います。">AIを使って顔画像から「常連さん」を判定しよう！</a></li><li class="related-posts-item"><span>2022.11.16</span><span class="snscount">&#9825;13</span><a href=/articles/20221116a/ title="現在業務でいわゆるビッグデータを扱っていまして、アウトプットを可視化する機会が多くあります。Pythonでデータ可視化といえばmatplotlibが定番で、メンバー単位でのアウトプット共有なら特に不便は無いのですが、クライアントへの説明資料などに使い回すことを考えると、もう少し見栄え良く仕上げたくなる時があります。">Plotly.pyによるデータ可視化のすすめ<span class="newitem">NEW</span></a></li><li class="related-posts-item"><span>2022.08.05</span><span class="snscount">&#9825;18</span><a href=/articles/20220805a/ title="Go 1.19リリース連載の5本目です。関数やレシーバのジェネリクスの微修正についてご紹介します。">Go 1.19 Genericsのアップデート</a></li><li class="related-posts-item"><span>2022.03.03</span><span class="snscount">&#9825;9</span><a href=/articles/20220303a/ title="Pyright を LSP  サーバとした自作クライアントを実装しますが、その前に経緯について説明します。アルバイトの前は、Future のインターン Engineer Camp で Python のソースコード解析に取り組んでいました。当時は Python の AST モジュールを活用する方針で、それ以外は自前で解析を行っていました。アルバイトでも引き続き解析に取り組んでいますが、次第に型推論などの技術が必要になってきており、全てを自前で実装することは困難な状況です。そこで現在は、既存のツールを拡張する方針を取っています。ツールの候補としては、Mypy および Pyright が挙がりましたが...">Pyright を LSP サーバとした自作 LSP クライアント（実装編）</a></li></ul>
  </div>
            </section>
            <section class="reference-post margin-bottom-40 nav">
              
            </section>
          </aside>
        </footer>
      </div>
    </article>
  </main>
  <aside class="col-md-3 blog-sidebar">
    <!-- START SIDEBAR  -->


<section class="toc-section">
  <h2 class="margin-top-30">目次</h2>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9F%E4%B8%96%E7%95%8C%E3%83%87%E3%83%BC%E3%82%BF%E3%81%A8%E3%81%AF"><span class="toc-text">実世界データとは</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9F%E4%B8%96%E7%95%8C%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%93%81%E8%B3%AA"><span class="toc-text">実世界データの品質</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%91%A0%E6%AC%A0%E6%90%8D%E5%80%A4%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B"><span class="toc-text">①欠損値が発生する</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A0%E6%90%8D%E5%80%A4%E5%87%A6%E7%90%86"><span class="toc-text">欠損値処理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A0%E6%90%8D%E5%80%A4%E3%82%92%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B"><span class="toc-text">欠損値を削除する</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E3%81%AE%E5%80%A4%E3%81%A7%E8%A3%9C%E5%AE%8C%E3%81%99%E3%82%8B"><span class="toc-text">特定の値で補完する</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E5%AE%9A%E3%81%AE%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%81%AB%E5%BE%93%E3%81%A3%E3%81%A6%E8%A3%9C%E5%AE%8C%E3%81%99%E3%82%8B"><span class="toc-text">一定のアルゴリズムに従って補完する</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%91%A1%E4%B8%8D%E6%AD%A3%E3%81%AA%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E6%B7%B7%E5%85%A5%E3%81%99%E3%82%8B"><span class="toc-text">②不正なデータが混入する</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E6%AD%A3%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%A4%9C%E5%87%BA%E6%96%B9%E6%B3%95"><span class="toc-text">不正データの検出方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A0%E7%90%86%E8%AB%96%E4%B8%8A%E6%9C%89%E3%82%8A%E5%BE%97%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8B%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%EF%BC%88%E3%83%90%E3%83%AA%E3%83%87%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%EF%BC%89"><span class="toc-text">①理論上有り得るデータかチェック（バリデーションチェック）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A1%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%88%86%E5%B8%83%E3%81%8B%E3%82%89%E9%80%B8%E8%84%B1%E3%81%97%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E3%81%8B%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF"><span class="toc-text">②データの分布から逸脱していないかチェック</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E6%AD%A3%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%86%8D%E7%99%BA%E9%98%B2%E6%AD%A2"><span class="toc-text">不正データの再発防止</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%81%BE%E3%81%A8%E3%82%81"><span class="toc-text">まとめ</span></a></li></ol>
</section>

<section class="category">
<h2 class="margin-top-30">カテゴリー</h2>
<div class="widget">
  <ul class="nav sidebar-categories margin-bottom-40">
  
  <li class=""><a href="/categories/Programming/">Programming (342)</a></li>
<li class=""><a href="/categories/Infrastructure/">Infrastructure (198)</a></li>
<li class=""><a href="/categories/Culture/">Culture (84)</a></li>
<li class=""><a href="/categories/DataScience/">DataScience (44)</a></li>
<li class=""><a href="/categories/IoT/">IoT (31)</a></li>
<li class=""><a href="/categories/DB/">DB (20)</a></li>
<li class=""><a href="/categories/Business/">Business (19)</a></li>
<li class=""><a href="/categories/%E8%AA%8D%E8%A8%BC%E8%AA%8D%E5%8F%AF/">認証認可 (18)</a></li>
<li class=""><a href="/categories/Management/">Management (13)</a></li>
<li class=""><a href="/categories/VR/">VR (12)</a></li>
<li class=""><a href="/categories/DevOps/">DevOps (12)</a></li>
<li class=""><a href="/categories/Design/">Design (11)</a></li>
<li class=""><a href="/categories/Security/">Security (6)</a></li>

  </ul>
</div>

</section>
<section class="podcast-link">
<h2 class="margin-top-30">Tech Cast</h2>

  <div class="class="widget-wrap">
  <div class="widget">
    <ul class="nav techcast">
      <li><a href="https://anchor.fm/futuretechcast/episodes/35-MLOps-e1qe4st" title="フューチャーがお届けするポッドキャストです。#35 MLOpsエンジニアって何やるの？（後編）" target="_blank" rel="noopener"><span class="newitem">NEW</span> #35 MLOpsエンジニアって何やるの？（後編）</a></li>
<li><a href="https://anchor.fm/futuretechcast/episodes/34-MLOps-e1polbj" title="フューチャーがお届けするポッドキャストです。#34 MLOpsエンジニアって何やるの？（前編）" target="_blank" rel="noopener"> #34 MLOpsエンジニアって何やるの？（前編）</a></li>
<li><a href="https://anchor.fm/futuretechcast/episodes/33-IT-e1pcaon" title="フューチャーがお届けするポッドキャストです。#33 ヘルスケアグループリーダーの中元さんと語る「医療業界におけるITコンサルとビジネスイノベーション」（後編）" target="_blank" rel="noopener"> #33 ヘルスケアグループリーダーの中元さんと語る「医療業界におけるITコンサルとビジネスイノベーション」（後編）</a></li>
    </ul>
  </div>
  </div>
  
</section>
<section class="advent-calendar">
<h2 class="margin-top-30">アドベントカレンダー</h2>
<div class="widget">
  <ul class="nav-flex">
    <li><a href="http://qiita.com/advent-calendar/2022/future" title="フューチャー Advent Calendar 2022 #Qiita" target="_blank" rel="noopener">2022年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2021/future" title="フューチャー Advent Calendar 2021 #Qiita" target="_blank" rel="noopener">2021年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2020/future" title="フューチャー Advent Calendar 2020 #Qiita" target="_blank" rel="noopener">2020年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2019/future" title="フューチャー Advent Calendar 2019 #Qiita" target="_blank" rel="noopener">2019年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2018/future" title="フューチャー Advent Calendar 2018 #Qiita" target="_blank" rel="noopener">2018年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2017/future" title="フューチャー Advent Calendar 2017 #Qiita" target="_blank" rel="noopener">2017年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2016/future" title="フューチャー Advent Calendar 2016 #Qiita" target="_blank" rel="noopener">2016年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2015/future" title="フューチャー Advent Calendar 2015 #Qiita" target="_blank" rel="noopener">2015年</a></li>
  </ul>
</div>

</section>
<!-- END SIDEBAR -->

  </aside>
</div>

  </section>
</div>

      <!-- BEGIN PRE-FOOTER -->
    <footer>
      <div class="pre-footer">
        <div class="container">
          <div class="row">
            <div class="col-lg-4 col-md-4 col-sm-6 col-6 pre-footer-col">
              <h2>About Us</h2>
              <p>経営とITをデザインする、フューチャーの技術ブログです。業務で利用している幅広い技術について紹介します。<br /><br /><a target="_blank" rel="noopener" href="http://www.future.co.jp/">http://www.future.co.jp/</a></p>
              <div class="social-btn twitter-btn twitter-follow-btn">
                <a href="https://twitter.com/intent/follow?screen_name=future_techblog " target="_blank" rel="nofollow noopener">
                  <i></i><span class="tw-btn-label">フューチャー技術ブログをフォロー</span>
                </a>
              </div>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-4 col-4 pre-footer-col">
              <h2>Contact</h2>
              <address class="margin-bottom-40">
                <a href="https://www.future.co.jp/recruit/recruit/rec-fresh/" title="新卒採用" target="_blank" rel="noopener">新卒採用</a><br>
                <a href="https://www.future.co.jp/recruit/recruit/rec-career/" title="キャリア採用" target="_blank" rel="noopener">キャリア採用</a><br>
                <a href="https://www.future.co.jp/contact_us/" title="お問い合わせページ" target="_blank" rel="noopener">お問い合わせ</a><br>
                <a href="https://www.future.co.jp/architect/socialmediapolicy/" title="ソーシャルメディアポリシー" target="_blank" rel="noopener">メディアポリシー</a><br><br>
                <a href="mailto:techblog@future.co.jp">techblog@future.co.jp</a>
              </address>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-6 col-6 pre-footer-col">
              <h2>Contents</h2>
              <a href="https://future-architect.github.io/coding-standards/" title="Future Enterprise Coding Standards" target="_blank" rel="noopener">コーディング規約</a><br>
              <a href="https://future-architect.github.io/typescript-guide/" title="仕事ですぐに使えるTypeScript" target="_blank" rel="noopener">仕事ですぐに使えるTypeScript</a><br>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-3 col-3 pre-footer-col">
              <h2>Event</h2>
              <a href="https://future.connpass.com/" title="経営とITをデザインするフューチャーの勉強会です" target="_blank" rel="noopener">connpass</a><br>
              <a href="https://www.future.co.jp/futureinsightseminar/" title="フューチャーインサイトセミナー" target="_blank" rel="noopener">Webセミナー</a><br>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-3 col-3 pre-footer-col">
              <h2>SNS</h2>
              <a href="https://github.com/future-architect" title="Future's official open source repositories" target="_blank" rel="noopener">GitHub</a><br>
              <a href="https://qiita.com/organizations/future" title="フューチャーのQiita Organizationです" target="_blank" rel="noopener">Qiita</a><br>
              <a href="https://note.future.co.jp/" title="フューチャーの公式note" target="_blank" rel="noopener">未来報</a><br>
              <a href="https://www.youtube.com/channel/UCJUSwYYd0CkGgmEKAW7QVpw" title="フューチャーYoutubeチャネル" target="_blank" rel="noopener">Youtube</a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer">
        <div class="container">
          <div class="row">
            <div class="col-md-6 col-sm-6 padding-top-10">
              &copy; 2022 フューチャー技術ブログ<br>
            </div>
          </div>
        </div>
      </div>
    </footer>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X1C28R8H0M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-X1C28R8H0M');
  gtag('config', 'UA-74047147-1'); // 過渡期対応
</script>

  </div>
</body>
</html>
