<!DOCTYPE html>
<!--[if IE 8]> <html lang="ja" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="ja" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="ja">
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  <!--
    ███████╗██╗░░░██╗████████╗██╗░░░██╗██████╗░███████╗
    ██╔════╝██║░░░██║╚══██╔══╝██║░░░██║██╔══██╗██╔════╝
    █████╗░░██║░░░██║░░░██║░░░██║░░░██║██████╔╝█████╗░░
    ██╔══╝░░██║░░░██║░░░██║░░░██║░░░██║██╔══██╗██╔══╝░░
    ██║░░░░░╚██████╔╝░░░██║░░░╚██████╔╝██║░░██║███████╗
    ╚═╝░░░░░░╚═════╝░░░░╚═╝░░░░╚═════╝░╚═╝░░╚═╝╚══════╝
    ████████╗███████╗░█████╗░██╗░░██╗
    ╚══██╔══╝██╔════╝██╔══██╗██║░░██║
    ░░░██║░░░█████╗░░██║░░╚═╝███████║
    ░░░██║░░░██╔══╝░░██║░░██╗██╔══██║
    ░░░██║░░░███████╗╚█████╔╝██║░░██║
    ░░░╚═╝░░░╚══════╝░╚════╝░╚═╝░░╚═╝
    ██████╗░██╗░░░░░░█████╗░░██████╗░
    ██╔══██╗██║░░░░░██╔══██╗██╔════╝░
    ██████╦╝██║░░░░░██║░░██║██║░░██╗░
    ██╔══██╗██║░░░░░██║░░██║██║░░╚██╗
    ██████╦╝███████╗╚█████╔╝╚██████╔╝
    ╚═════╝░╚══════╝░╚════╝░░╚═════╝░
    Welcome engineer.
    https://www.future.co.jp/recruit/
  -->
  
  <title>「リアクティブコントローラ」導入がもたらすかもしれないウェブフロントエンド設計の変化 | フューチャー技術ブログ</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  <meta name="description" content="フロントエンド連載2日目のエントリーです。 あまり話題になっていないような気がしますが、Web Componentsを実装するためのフレームワークのLit-Element v3がバージョンアップして、ついでにリブランディングしてLit v2.0となりました。ロゴも変わり、ウェブサイトも新しくなりました。    Introducing “Lit” for Web Components  本当はこのL">
<meta property="og:type" content="article">
<meta property="og:title" content="「リアクティブコントローラ」導入がもたらすかもしれないウェブフロントエンド設計の変化 | フューチャー技術ブログ">
<meta property="og:url" content="https://future-architect.github.io/articles/20210615a/index.html">
<meta property="og:site_name" content="フューチャー技術ブログ">
<meta property="og:description" content="フロントエンド連載2日目のエントリーです。 あまり話題になっていないような気がしますが、Web Componentsを実装するためのフレームワークのLit-Element v3がバージョンアップして、ついでにリブランディングしてLit v2.0となりました。ロゴも変わり、ウェブサイトも新しくなりました。    Introducing “Lit” for Web Components  本当はこのL">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://future-architect.github.io/images/20210615a/スクリーンショット_2021-06-12_9.19.45.png">
<meta property="og:image" content="https://future-architect.github.io/images/20210615a/スクリーンショット_2021-06-12_12.39.29.png">
<meta property="og:image" content="https://future-architect.github.io/images/20210615a/スクリーンショット_2021-06-12_9.55.02.png">
<meta property="og:image" content="https://future-architect.github.io/images/20210615a/スクリーンショット_2021-06-12_12.25.43.png">
<meta property="article:published_time" content="2021-06-14T15:00:00.000Z">
<meta property="article:modified_time" content="2021-06-15T03:31:09.012Z">
<meta property="article:tag" content="WebComponents">
<meta property="article:tag" content="フロントエンド">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://future-architect.github.io/images/20210615a/スクリーンショット_2021-06-12_9.19.45.png">
  
  <link rel="alternate" href="/atom.xml" title="フューチャー技術ブログ" type="application/atom+xml">
  
  
  <link rel="icon" href="/favicon.ico">
  
  <link rel="canonical" href="https://future-architect.github.io/articles/20210615a/">
  <meta content="WebComponents,フロントエンド" name="keywords">
  <meta content="澁川喜規" name="author">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha384-pdapHxIh7EYuwy6K7iE41uXVxGCXY0sAjBzaElYGJUrzwodck3Lx6IE2lA0rFREo" crossorigin="anonymous">
  <link rel="stylesheet" href="/metronic/assets/style.css">
  <link rel="stylesheet" href="/css/theme-styles.css">
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="corporate">
  <div class="wrap" itemscope itemtype="https://schema.org/TechArticle">
  <!-- BEGIN HEADER -->
<header class="header">
	<div class="header-overlay">
		<div class="header-menu"></div>
		<div class="header-title"><a href="/">Future Tech Blog</a></div>
		<div class="header-title-sub">フューチャー技術ブログ</div>
	</div>
</header>
<!-- Header END -->

  <div class="container">
  <ul class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/articles/">Blog</a></li>
    <li class="active">Post</li>
  </ul>
  <section id="main">
    
  <h2 itemprop="name">
    <a class="article-title" href="/articles/20210615a/">「リアクティブコントローラ」導入がもたらすかもしれないウェブフロントエンド設計の変化</a>
  </h2>


    <div class="row">
  <main class="col-md-9 col-sm-9 blog-posts">
    <article id="post-20210615a_「リアクティブコントローラ」導入がもたらすかもしれないウェブフロントエンド設計の変化" class="article article-type-post blog-item" itemscope itemprop="blogPost">
      <div class="article-inner">
        
        <header class="article-header">
          <ul class="blog-info">
            <li class="blog-info-item"><li><a href="/authors/%E6%BE%81%E5%B7%9D%E5%96%9C%E8%A6%8F">澁川喜規</a></li></li>
            <li class="blog-info-item"><a href="/articles/2021/"><time datetime="2021-06-14T15:00:00.000Z" itemprop="datePublished">2021.06.15</time></a>
</li>
            <li class="blog-info-item">
  <ul>
  
    <li><a href="/tags/WebComponents/" title="WebComponents">WebComponents</a></li> 
  
    <li><a href="/tags/%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89/" title="フロントエンド">フロントエンド</a>
  
  </ul>

</li>
          </ul>
          
  <div class="article-category">
    
    Category:
    
    <a class="article-category-link" href="/categories/Programming/">Programming</a>
  </div>


        </header>
        
        <div class="article-entry" itemprop="articleBody">
          
            <p><a href="/articles/20210614a/">フロントエンド連載</a>2日目のエントリーです。</p>
<p>あまり話題になっていないような気がしますが、Web Componentsを実装するためのフレームワークのLit-Element v3がバージョンアップして、ついでにリブランディングしてLit v2.0となりました。ロゴも変わり、<a target="_blank" rel="noopener" href="https://lit.dev/">ウェブサイトも新しく</a>なりました。</p>
<img src="/images/20210615a/スクリーンショット_2021-06-12_9.19.45.png" alt="Lit-Elementトップページ" width="1200" height="801">

<ul>
<li><a target="_blank" rel="noopener" href="https://zenn.dev/takanorip/articles/640f9fe9c6c8ca">Introducing “Lit” for Web Components</a></li>
</ul>
<p>本当はこのLitの紹介をこの連載でしようとしたのですが、上記のウェブサイトがすごく詳しいので、単に紹介するだけの記事だとあまり価値がないので、この中のコントローラ機能のみをとりあげようと思いますが、まずはWeb Componentsとは、というところを説明します。</p>
<h1 id="n回目のWeb-Components元年"><a href="#n回目のWeb-Components元年" class="headerlink" title="n回目のWeb Components元年"></a>n回目のWeb Components元年</h1><p>以前次のような記事を書きました。最初のPolymerというフレームワークが推進していたころよりも、ブラウザ対応も進み、ReactやVueといった人気のフレームワークとも気軽に組み合わせられるようになり、使えるところがぐん、と増えました。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://qiita.com/shibukawa/items/5a36147ec103d35c1b5e">2019年はWebComponents元年(2回目)！WebComponentsをReact/Angular/Vueと一緒に使う</a></li>
</ul>
<p>jxckさんの発表で、3回目の元年な話もあります。主にWebPackingなどのAPIの進化がこれからWeb Componentsの普及に一役買うのでは、という内容のようです。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://speakerdeck.com/jxck/web-components-first-year-v3">Web Components 元年 v3 / Web Components first year v3</a></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://headlessui.dev/">Headless UI</a>がもしWeb Components版を出してくれたら、世のWeb/CSSデザイナーの人たちのポートフォリオに載せやすいものとなって作ろう、という人は増えるのでは？という気はするのですが、それがなかったとしても、2021年は本当の元年になってくれそうな気がすごいしています。</p>
<p>Web Componentsが普及したあかつきには、多種多様なコンポーネント集が手に入り、ReactでもVueでもSvelteでもなんでもフロントエンド開発のときに各フロントエンド専用のUI部品集だけでなく「Web Components製の部品も利用の選択肢に入る」状態になると思います。そのためにはWeb Componentsで作られた部品集がたくさん世の中に作られることが大事だと思っていましたが、リニューアルされたLitのウェブサイトのフッター付近にたくさん部品集のリンクがあります。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://opensource.adobe.com/spectrum-web-components/">Adobe: Spectrum Web Components</a></li>
<li><a target="_blank" rel="noopener" href="https://auro.alaskaair.com/philosophy">Alaska Airlines: Auro Design System</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/momentum-design/momentum-ui/tree/master/web-components">Cisco Systems: Momentum UI</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/home-assistant/frontend">Home Assistant: Frontend UI</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/carbon-design-system/carbon-web-components">IBM: Carbon Web Components</a></li>
<li><a target="_blank" rel="noopener" href="https://lion-web.netlify.app/">ING Bank: Lion Web Components</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/pwa-builder/pwa-starter">Microsoft: PWA Starter</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/1-Platform">Red Hat: One Platform Components</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/SAP/ui5-webcomponents/blob/master/docs/dev/Developing%20Web%20Components.md">SAP: UI5 Web Components</a></li>
<li><a target="_blank" rel="noopener" href="https://shoelace.style/">Shoelace Components</a></li>
<li><a target="_blank" rel="noopener" href="https://vaadin.com/docs/latest/fusion/overview">Vaadin Ltd: Fusion Framework</a></li>
<li><a target="_blank" rel="noopener" href="https://clarity.design/storybook/core/">VMWare: Clarity Core</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/rough-stuff/wired-elements">Wired Elements</a></li>
</ul>
<p>注目はアラスカエアラインのフライト情報コンポーネントですね。こういうのがWeb Componentsっぽい。このサイトの、コンポーネントの背景を斜めストライプにすることでコンポーネントのビジュアルと背景の区別がつきやすくなっているの、めちゃ良いですね。Storybookとかでコンポーネント集作る人はみんなやっても良さそう。</p>
<img src="/images/20210615a/スクリーンショット_2021-06-12_12.39.29.png" alt="アラスカエアラインのコンポーネント一覧" width="1200" height="801">


<p>それらのコンポーネント集以上の起爆剤となりそうと思っているのが、Google I/O 2021で発表されたAndroidの新UIコンセプトのMaterial Youです。</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">✨ Announcing Material You, a transformation in design at Google ✨<br> <br>Be a co-creator of your digital experiences. Coming first to Pixel with <a target="_blank" rel="noopener" href="https://twitter.com/hashtag/Android12?src=hash&amp;ref_src=twsrc%5Etfw">#Android12</a><br> <br>Learn more about the <a target="_blank" rel="noopener" href="https://twitter.com/hashtag/MaterialDesign?src=hash&amp;ref_src=twsrc%5Etfw">#MaterialDesign</a> vision 👉<a target="_blank" rel="noopener" href="https://t.co/Otb86qTQRR">https://t.co/Otb86qTQRR</a> <a target="_blank" rel="noopener" href="https://t.co/04ARxOTbVa">pic.twitter.com/04ARxOTbVa</a></p>&mdash; Material Design (@materialdesign) <a target="_blank" rel="noopener" href="https://twitter.com/materialdesign/status/1394718542562430977?ref_src=twsrc%5Etfw">May 18, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Material Designが発表されたときも、モバイルからウェブまで全部をカバーするUIコンセプトということで、CSSも提供され、<a target="_blank" rel="noopener" href="https://getmdl.io/">material-design-lite</a>というライブラリが出たり、それらを元にしたBootstrapのテーマが出たりしつつ、React向けには<a target="_blank" rel="noopener" href="https://material-ui.com/">Material UI</a>、Vue.jsには<a target="_blank" rel="noopener" href="https://vuetifyjs.com/en/">Vuetify</a>、Angularでは<a target="_blank" rel="noopener" href="https://material.angular.io/">Angular Material</a>がそれぞれ開発されています。ですが、「とりあえずこれ使っておこう」となるまでには年単位の時間がかかっていました。</p>
<p>一方で、細々と<a target="_blank" rel="noopener" href="https://github.com/material-components/material-components-web-components">Material DesignのUI部品のLit Element実装も行われている</a>な、と思っていたら、Material Design本家のチュートリアルもいつのまにか<a target="_blank" rel="noopener" href="https://material.io/develop/web/getting-started">Web Components前提</a>となっていますし、なにより、Material YouはLitで実装する==Web Componentsになるよ、と中の人からレスポンスが！！</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Material You for web will be <a target="_blank" rel="noopener" href="https://twitter.com/hashtag/builtWithLit?src=hash&amp;ref_src=twsrc%5Etfw">#builtWithLit</a></p>&mdash; Elliott (@techytacos) <a target="_blank" rel="noopener" href="https://twitter.com/techytacos/status/1395564894456406016?ref_src=twsrc%5Etfw">May 21, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Material UIやVuetifyやAngular MaterialがMaterial Youに対応するか、別のそういうバージョンが実装されるよりも、Web Components版を使った方が圧倒的に早い、ということになりそうです。やったね！！</p>
<h1 id="Litの新機能のリアクティブコントローラとは何者か"><a href="#Litの新機能のリアクティブコントローラとは何者か" class="headerlink" title="Litの新機能のリアクティブコントローラとは何者か"></a>Litの新機能のリアクティブコントローラとは何者か</h1><p>Lit Elementからの変化は<a target="_blank" rel="noopener" href="https://zenn.dev/takanorip/articles/640f9fe9c6c8ca">こちら</a>をみていただくのが確実ですが軽くリストアップします。</p>
<ul>
<li>ビルド結果のサイズはより小さく(minify時で30%)、より高速に(初期表示が5-20%、更新が7-15%)</li>
<li>リアクティブコントローラというコンセプトが入った</li>
<li>experimental: Reactコンポーネントを作るアダプターが導入</li>
<li>experimental: サーバーサイドレンダリングができるようになる</li>
</ul>
<p>ここでとりあげるのはコントローラです。ライフサイクルイベントのハンドラーをどこにどう実装するのか、というのはいろいろ試行錯誤があり、クラスのメソッドだったり、Hooksが導入されたり、といろいろ変わってきました。Hooksもライフサイクルイベントのハンドラーの再利用がしやすくなる仕組みでしたが、コントローラはこのハンドラーのセットをオブジェクトして切り出しておける機能となります。Javaとかのオブジェクト指向をやっていた人にはわかりやすいものかと思います。</p>
<p>コントローラという概念自体はモバイルな開発では以前から使われているアイディアで、<a target="_blank" rel="noopener" href="https://developer.apple.com/tutorials/app-dev-training/setting-up-a-table-view">iOSの開発でも見かける</a>し、<a target="_blank" rel="noopener" href="https://medium.com/@ntaoo/widget%E3%81%8B%E3%82%89controller%E3%82%92%E5%88%86%E9%9B%A2%E3%81%99%E3%82%8B-cf2f0c646e78">Flutterにもあります</a>ね。Jetpack Composeはユーザーがロジックを定義する対象ではないのかな？<a target="_blank" rel="noopener" href="https://developer.android.com/jetpack/compose/navigation">ナビゲーション周りぐらいでしかコントローラという言葉が出てこなく</a>て、UIを持たない提供ロジックの置き場っぽい使われ方っぽいですね。一般名詞なのでフレームワークごとに用法が違ってきがちですが、iOS的なコントローラに近そうです。</p>
<p>Litのドキュメント中はたんにコントローラと書かれているところもありますが、ページや段落の初出時には「Reactive Controller」と書かれているので正式名称はこちらっぽいです。APIのインタフェース名もこれになっています。一般名詞を特定用法で振り回すのはあんまり好きじゃない（用語を大切にするはずのDDDがリポジトリとかサービスとかといった名前でよく混乱を引き起こしている）ので、この記事でもリアクティブコントローラと書くようにします。</p>
<p>Litのリアクティブコントローラの設計は単にLitに閉じるものではなく、他のフレームワークからも使えるようなアダプターが提供されようとしています。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lit/lit/issues/1682">https://github.com/lit/lit/issues/1682</a></p>
<img src="/images/20210615a/スクリーンショット_2021-06-12_9.55.02.png" alt="litのIssue1682" width="1200" height="1154">

<h1 id="リアクティブコントローラのAPI"><a href="#リアクティブコントローラのAPI" class="headerlink" title="リアクティブコントローラのAPI"></a>リアクティブコントローラのAPI</h1><p>リアクティブコントローラを実装するにはReactiveController interfaceを実装したクラスを作ります。コンストラクタの中で呼び出している<code>addConttoller()</code>で、ホストとなるコンポーネントと接続されます。リアクティブコントローラからはホストの<code>requestUpdate()</code>メソッドを呼び出すことで変更を通知します。</p>
<p>次のサンプルはLit.devにあったタイマーのコントローラです。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;ReactiveController, ReactiveControllerHost&#125; <span class="keyword">from</span> <span class="string">&#x27;lit&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ClockController</span> <span class="title">implements</span> <span class="title">ReactiveController</span> </span>&#123;</span><br><span class="line">  host: ReactiveControllerHost;</span><br><span class="line"></span><br><span class="line">  value = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  timeout: <span class="built_in">number</span>;</span><br><span class="line">  <span class="keyword">private</span> _timerID?: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">host: ReactiveControllerHost, timeout = <span class="number">1000</span></span>)</span> &#123;</span><br><span class="line">    (<span class="built_in">this</span>.host = host).addController(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.timeout = timeout;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">hostConnected</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// Start a timer when the host is connected</span></span><br><span class="line">    <span class="built_in">this</span>._timerID = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.value = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">      <span class="comment">// Update the host with new value</span></span><br><span class="line">      <span class="built_in">this</span>.host.requestUpdate();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">hostDisconnected</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// Clear the timer when the host is disconnected</span></span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="built_in">this</span>._timerID);</span><br><span class="line">    <span class="built_in">this</span>._timerID = <span class="literal">undefined</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>この手のやつが欲しくなるのって、Cheetah-GridとかagGridとかのテーブルコンポーネント系や、ツリービューとかですよね。プロパティに値を入れたらその通りにステートレスで仮想DOMやらなんやらで表示される、というのが今時のウェブ開発の目指すところですが、テーブル部品が入ると途端にその構造が大きく変更されがちです。</p>
<p>そもそも、外から与えるのは初期データで、更新後のデータは内部だけ、とかの設計になっている部品なら良いのですが（ReactのuseState的な)、全部のデータを上流に戻す前提とか、更新のトリガーは中と外のどちらが担当するか、など、まあたいてい再利用できないし、そこだけ大きく重力場が歪む感じがあります。ライフサイクルメソッドを駆使する形になるし、　ReduxとかVuex的なストアとの共存もまた厳しいものがあります。</p>
<p>この手のデータは、データを取得してくるキーは少なく、実態のデータが多くなりがちです。例えば、キーとなる入力はページ番号とソートキーの2つだけど、持っているデータは1ページ分の100行のデータ、といった具合です。ReactとかVueのプログラミングモデルとちょっと相性が悪いのはこの部分かな、と思います。</p>
<p>テーブルコンポーネントの場合、固定のデータをとってくるのか、無限スクロール的にデータを取ってくるのか、ページングなのか、いくつか選択肢があります。そのあたり、ユーザーが自分の使いたいユースケースに合わせて選択できると夢が広がります。</p>
<h1 id="コントローラを外から設定する"><a href="#コントローラを外から設定する" class="headerlink" title="コントローラを外から設定する"></a>コントローラを外から設定する</h1><p>ドキュメントを隅から隅まで読んでも、コントローラをコンポーネントの外から渡すというのはサンプルはありませんでしたが、イベントとして処理すれば良さそうです。こんな感じで書けばconnectedと表示されました。これでテーブルデータの更新をお任せすることが可能な気がします。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; LitElement, html, css &#125; <span class="keyword">from</span> <span class="string">&#x27;lit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; customElement, property &#125; <span class="keyword">from</span> <span class="string">&#x27;lit/decorators.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@customElement</span>(<span class="string">&#x27;my-component&#x27;</span>)</span><br><span class="line"><span class="comment">// eslint-disable-next-line @typescript-eslint/no-unused-vars</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">LitElement</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> controller?: ReactiveController;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> html`<span class="xml">&lt;div`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">firstUpdated</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> myEvent = <span class="keyword">new</span> CustomEvent(<span class="string">&#x27;oninit&#x27;</span>, &#123;</span><br><span class="line">            detail: &#123; <span class="attr">message</span>: <span class="string">&#x27;onInit happened.&#x27;</span> &#125;,</span><br><span class="line">            bubbles: <span class="literal">true</span>,</span><br><span class="line">            composed: <span class="literal">true</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="built_in">this</span>.dispatchEvent(myEvent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">setController</span>(<span class="params">controller: ReactiveController</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.controller = controller;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">my-component</span> <span class="attr">oninit</span>=<span class="string">&quot;console.log&quot;</span> <span class="attr">id</span>=<span class="string">&quot;host&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">constructor</span>(<span class="params">host</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.host = host;</span></span><br><span class="line"><span class="javascript">                host.addController(<span class="built_in">this</span>);</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">hostConnected</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">&#x27;connected&#x27;</span>);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">&#x27;host&#x27;</span>).addEventListener(<span class="string">&#x27;oninit&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            e.target.setController(<span class="string">&#x27;test&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        &#125;, &#123; <span class="attr">once</span>: <span class="literal">true</span>&#125;);</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>これは生DOM APIを読んでいるので冗長な感じですが、Vueとかならイベントハンドラはタグ宣言の中で行えますし、そこまで大変ではないかなと思います。まあ、将来的にReactラッパーみたいな感じで、各コンポーネント向けのラッパーが簡単に作れるようになれば・・・</p>
<h1 id="テーブルのデータ取得用のコントローラを作ってみる"><a href="#テーブルのデータ取得用のコントローラを作ってみる" class="headerlink" title="テーブルのデータ取得用のコントローラを作ってみる"></a>テーブルのデータ取得用のコントローラを作ってみる</h1><p>みんな大好き<a href="https://future-architect.github.io/cheetah-grid/#/">Cheetah-Grid</a>のデータを取ってくるコントローラを作ってみます。ただ、サンプルとして作っているので、そこまで実用的ではないです。たいていのこの手のコンポーネントは、データ元を表すオブジェクトが提供されており、それをコンポーネントに渡せばだいたいやりたいことはできてしまいます。Cheetah-Gridも例に漏れず、<a href="https://future-architect.github.io/cheetah-grid/documents/api/js/grid_data/#using-array-object">DataSource</a>で無限スクロールな用途での内部のキャッシュやら描画やらはいい感じにやってくれます。</p>
<p>ですが、ちょっとダサいページングなUIを要望された、という想定で、ページングのデータ取得のリアクティブコントローラを実装してみます。</p>
<p>本当は<a target="_blank" rel="noopener" href="https://devlog.grapecity.co.jp/wijmo-webcomponents/">GrapeCityのWijmo</a>のサンプルみたいにカラム定義もタグで書きたかったけど、まあ今回はリアクティブコントローラのサンプルなのでそこは省略しておきます。</p>
<p>データソースはどこかのウェブサイトかもしれないし、固定テーブルかもしれないし、計算で作るかもしれません。テーブルのユーザーは次のインタフェースを実装し、その中でデータ取得を行うものとします。</p>
<figure class="highlight ts"><figcaption><span>DataSourceController.ts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ReactiveController &#125; <span class="keyword">from</span> <span class="string">&#x27;lit&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> DataSourceController <span class="keyword">extends</span> ReactiveController &#123;</span><br><span class="line">    setPage(page: <span class="built_in">number</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>setPage()</code>が呼ばれたら中でデータを取得。中でホストの<code>setData()</code>を呼ぶ。</li>
<li>サーバー側で更新がかかったらそれを検知できるように、変更検知時にはホストの<code>setData()</code>を呼んでもいいものとする</li>
</ul>
<p>データをどこから取ってくるかを利用者が定義できるようになりますね。<code>ReactiveController</code>インタフェースを<code>extends</code>していますが、これにも対応することで、コンポーネントが表示されているかどうかが検知できるのでサーバー接続を開始したり終了したりといったこともコントローラ実装者が制御できるようになりますね。</p>
<p>とりあえず、何も考えず、数値と、それを7で割った余りの数値をリストアップするという実用的じゃないサンプルを作ってみます。本当はかっこいいCheetah-Gridをとりあえず固定長テーブル表示で使うWeb Componentsはこんな感じでできます。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; LitElement, html, css, ReactiveController &#125; <span class="keyword">from</span> <span class="string">&#x27;lit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; customElement &#125; <span class="keyword">from</span> <span class="string">&#x27;lit/decorators.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, Ref, createRef &#125; <span class="keyword">from</span> <span class="string">&#x27;lit/directives/ref.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ListGrid &#125; <span class="keyword">from</span> <span class="string">&#x27;cheetah-grid&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> DataSourceController <span class="keyword">extends</span> ReactiveController &#123;</span><br><span class="line">    setPage(page: <span class="built_in">number</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@customElement</span>(<span class="string">&#x27;page-grid&#x27;</span>)</span><br><span class="line"><span class="comment">// eslint-disable-next-line @typescript-eslint/no-unused-vars</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PageGrid</span> <span class="keyword">extends</span> <span class="title">LitElement</span> </span>&#123;</span><br><span class="line">    tagRef: Ref&lt;HTMLDivElement&gt; = createRef();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> controller?: DataSourceController&lt;&#123; <span class="attr">num</span>: <span class="built_in">number</span>; rem: <span class="built_in">number</span> &#125;&gt;;</span><br><span class="line"></span><br><span class="line">    listGrid?: ListGrid&lt;&#123; <span class="attr">num</span>: <span class="built_in">number</span>; rem: <span class="built_in">number</span> &#125;&gt;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> styles = css`</span><br><span class="line"><span class="css">        <span class="selector-tag">div</span><span class="selector-class">.grid</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">height</span>: 600<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">border</span>: <span class="selector-tag">solid</span> 1<span class="selector-tag">px</span> <span class="selector-id">#ddd</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    `</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> html`<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;grid&quot;</span> </span></span><span class="subst">$&#123;ref(<span class="built_in">this</span>.tagRef)&#125;</span><span class="xml"><span class="tag"> /&gt;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">firstUpdated</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;firstUpdated&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> tag = <span class="built_in">this</span>.tagRef.value;</span><br><span class="line">        <span class="built_in">this</span>.listGrid = <span class="keyword">new</span> ListGrid(&#123;</span><br><span class="line">            parentElement: tag,</span><br><span class="line">            header: [</span><br><span class="line">                &#123; <span class="attr">field</span>: <span class="string">&#x27;num&#x27;</span>, <span class="attr">caption</span>: <span class="string">&#x27;num&#x27;</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">field</span>: <span class="string">&#x27;rem&#x27;</span>, <span class="attr">caption</span>: <span class="string">&#x27;rem 7&#x27;</span> &#125;,</span><br><span class="line">            ],</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">const</span> myEvent = <span class="keyword">new</span> CustomEvent(<span class="string">&#x27;oninit&#x27;</span>, &#123;</span><br><span class="line">            detail: &#123; <span class="attr">message</span>: <span class="string">&#x27;onInit happened.&#x27;</span> &#125;,</span><br><span class="line">            bubbles: <span class="literal">true</span>,</span><br><span class="line">            composed: <span class="literal">true</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="built_in">this</span>.dispatchEvent(myEvent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setController(</span><br><span class="line">        controller: DataSourceController&lt;&#123; <span class="attr">num</span>: <span class="built_in">number</span>; rem: <span class="built_in">number</span> &#125;&gt;</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="built_in">this</span>.controller = controller;</span><br><span class="line">        <span class="built_in">this</span>.addController(controller);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">setData</span>(<span class="params">data: &#123; num: <span class="built_in">number</span>; rem: <span class="built_in">number</span> &#125;[]</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.listGrid) &#123;</span><br><span class="line">            <span class="built_in">this</span>.listGrid.records = data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>利用側はこんな感じで、コントローラを作成し、初期化のコールバックでコントローラを設定します。ページング機構を作るのがめんどくさかったので、一秒間に1ページ進むようにしています。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">page-grid</span> <span class="attr">oninit</span>=<span class="string">&quot;console.log&quot;</span> <span class="attr">id</span>=<span class="string">&quot;grid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">page-grid</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">constructor</span>(<span class="params">host</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.host = host;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">setPage</span>(<span class="params">page</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">const</span> data = [];</span></span><br><span class="line"><span class="javascript">                <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span></span><br><span class="line">                    data.push(&#123; num: i + page * 10, rem: (i + page * 10) % 7 &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.host.setData(data);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">&#x27;grid&#x27;</span>).addEventListener(<span class="string">&#x27;oninit&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> controller = <span class="keyword">new</span> MyController(e.target);</span></span><br><span class="line">            e.target.setController(controller);</span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> page = <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line">                controller.setPage(++page);</span><br><span class="line">            &#125;, 1000);</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ユーザーがデータ取得をリアクティブコントローラでカスタマイズ可能なWebComponentsのテーブルコンポーネントが簡単にできました。</p>
<img src="/images/20210615a/スクリーンショット_2021-06-12_12.25.43.png" alt="テーブルコンポーネント" width="436" height="728">

<h1 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h1><p>データソースをリアクティブコントローラとして分離する実装について解説しました。まあコントローラを外部から与えるという方法は公式ドキュメントにないので、本当にこれでいいのかは不明ですが、今まで悩みの種だった、ちょっと大きめなデータを扱うコンポーネント、テーブルとかツリービューを実装するときの光明になりそうです。仮想DOMではなく、Cheetah-GridのようにCanvas描画で超高速みたいにうたう高性能な部品に、大きめのデータをフレームワークの中でどう渡すかというところで、フレームワークとステート管理機構で、データ取得のキーだけ管理して、実体の生データはリアクティブコントローラが保持して、高性能な部品に渡す、ということになれば、ライブラリとの接合部分がスパゲティになりがちなところが簡潔になるんじゃないかと思います。</p>
<p>この機構はLitだけではなく、他のコンポーネントでも活用できそうなところもいいですね。うちの会社だと技術選定はお客さんの要望次第なところもあってここ三年でReactもVueもAngularも全部さわりました。Web ComponentsでUI部品も共通化されるといいな、といつも思っていましたが、ちょっとしたロジック、たとえばページを開いたタイミングでサーバーからデータ取得とかそういうのも再利用したり、結合が疎になってテストしやすくなるとさらに良いですね。</p>
<p>あとはMaterial YouのリリースでLit製コンポーネントをみんなが使うようになるのが楽しみですね。2021年がWeb Componentsの3回目の元年だとして、4回目と言わなくても済むぐらい広まって欲しいですね。</p>

          
        </div>
        <footer>
          <section class="social-area">
          <!-- シェアボタン START -->
  <ul class="social-button">
    
    <!-- Twitter -->
    <li>
      <a class="social-btn twitter-btn" target="_blank" href="https://twitter.com/share?url=https://future-architect.github.io/articles/20210615a/&via=future_techblog&related=twitterapi%2Ctwitter&text=%E3%80%8C%E3%83%AA%E3%82%A2%E3%82%AF%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%80%8D%E5%B0%8E%E5%85%A5%E3%81%8C%E3%82%82%E3%81%9F%E3%82%89%E3%81%99%E3%81%8B%E3%82%82%E3%81%97%E3%82%8C%E3%81%AA%E3%81%84%E3%82%A6%E3%82%A7%E3%83%96%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E8%A8%AD%E8%A8%88%E3%81%AE%E5%A4%89%E5%8C%96" rel="nofollow noopener">
        <i></i><span class="social-btn-label">34</span>
      </a>
    </li>
    <!-- Facebook -->
    <li>
      <a class="social-btn fb-btn" target="_blank" href="http://www.facebook.com/share.php?u=https://future-architect.github.io/articles/20210615a/&t=%E3%80%8C%E3%83%AA%E3%82%A2%E3%82%AF%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%80%8D%E5%B0%8E%E5%85%A5%E3%81%8C%E3%82%82%E3%81%9F%E3%82%89%E3%81%99%E3%81%8B%E3%82%82%E3%81%97%E3%82%8C%E3%81%AA%E3%81%84%E3%82%A6%E3%82%A7%E3%83%96%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E8%A8%AD%E8%A8%88%E3%81%AE%E5%A4%89%E5%8C%96" rel="nofollow noopener">
        <i></i><span class="social-btn-label">シェア</span>
      </a>
    </li>
    <!-- hatebu -->
    <li>
      <a class="social-btn hatebu-btn" target="_blank" href="https://b.hatena.ne.jp/entry/s/future-architect.github.io/articles/20210615a/" rel="nofollow noopener">
        <i></i><span class="social-btn-label">52</span>
      </a>
    </li>
    <!-- pocket -->
    <li>
      <a class="social-btn pocket-btn" target="_blank" href="https://getpocket.com/save?url=https://future-architect.github.io/articles/20210615a/" rel="nofollow noopener">
        <i></i><span class="social-btn-label">31</span>
      </a>
    </li>
    
  </ul>
<!-- シェアボタン END -->

          </section>
          <aside>
            <section class="related-post margin-bottom-20 nav">
              <h2>関連記事</h2>
              
  <div class="widget">
    <ul class="nav related-posts"><li class="related-posts-item"><span>2020.11.11</span><span class="snscount">&#9825;4</span><a class="related-posts-link" href=/articles/20201111/ title="以前、TypeScriptのバンドラーとしてParcelの紹介をしました。* [今あえてTypeScriptのビルド＆バンドルツールを探してみる]その後、6月ぐらいに2.0のbeta.1がリリースされていましたので試してみました。ウェブサイトも公開されています。https://v2.parceljs.org/">Parcel 2.0 beta.1を試す</a></li><li class="related-posts-item"><span>2020.05.01</span><span class="snscount">&#9825;536</span><a class="related-posts-link" href=/articles/20200501/ title="プロダクションコードでたくさんRedux周りにもreducerなどを実装しなくてはいけなくなったときの次のステップとして、Redux Toolkitの紹介をします。">TypeScriptでReactをやるときは、小さいアプリでもReduxを最初から使ってもいいかもねというお話</a></li><li class="related-posts-item"><span>2020.03.19</span><span class="snscount">&#9825;100</span><a class="related-posts-link" href=/articles/20200319/ title="ちょっとしたフロントエンドの開発で、TypeScriptに最初から対応していて、簡単に使えるものは何かないかな、と調べてみたメモです。React/Vue/Angularの場合はそれぞれの初期化コマンドで何から何まで用意してくれます。Next.js、Nuxt.js、Gatsbyなども、これらのビルドのステップを簡略化するコマンドを提供しています。基本的にこれらのウェブフロントエンドを開発するときには、小規模・中規模ぐらいならあんまり気にしなくておまかせでもいいと思います。今回は、それらのフレームワーク固有のビルドツールとは別に環境を作りたい人で、TypeScriptの環境が欲しい、ウェブの開発がしたい、という前提でいろいろ探してみました。">今あえてTypeScriptのビルド＆バンドルツールを探してみる</a></li><li class="related-posts-item"><span>2019.06.12</span><span class="snscount">&#9825;702</span><a class="related-posts-link" href=/articles/20190612/ title="2019年頭より少しずつ書いていたTypeScriptの教育コンテンツを[クリエイティブ・コモンズ4.0の表示 - 継承 （CC BY-SA 4.0）]で公開します。といっても完成版ではなく、アーリーアクセス版のような品質であることをご了承ください。">TypeScript教育用コンテンツ公開のお知らせ</a></li></ul>
  </div>
            </section>
            <section class="featured-post margin-bottom-20 nav">
              <h2>注目の記事</h2>
              <!-- BEGIN FEATURED POSTS -->
<div class="widget-wrap">
  
  <div class="widget">
    <ul class="nav featured-post-link">
      
    <li><span>2020.03.11</span><span class="snscount">&#9825;526</span> <a href="/articles/20200311/" title="Java to Go in-depth tutorialの日本語訳です。原文の著者に許諾を得て翻訳・公開いたします。このチュートリアルは、JavaプログラマーがすばやくGo言語にキャッチアップできるようにすることを目的としています。">JavaプログラマーのためのGo言語入門</a></li>

    <li><span>2019.07.13</span><span class="snscount">&#9825;744</span> <a href="/articles/20190713/" title="他の言語になれた人が、初めてGoを書いた時にわかりにくいな、と思った部分はどういうところがあるのか、難しいポイントはどこか、という情報を自分の経験や、会社の内外の人に聞いたりしてまとめてみました。">Goを学ぶときにつまずきやすいポイントFAQ</a></li>

    <li><span>2020.07.09</span><span class="snscount">&#9825;652</span> <a href="/articles/20200709/" title="最近Goで主にバックエンドのWebAPIや、AWS Lambdaで動くETLアプリ、たまにCLIツールを開発する時に、2回以上同じ指摘したコメントをまとめてます。Go言語特有ぽいところを中心にしています。レビュイーのスキルセットは..">GoでWebアプリ開発時にあるあるだったレビューコメント</a></li>

    <li><span>2021.06.04</span><span class="snscount">&#9825;157</span> <a href="/articles/20210604a/" title="巨大な学習済みの機械学習モデルとか、検索用インデックスをデプロイする場合に、どうやってデプロイするか、というのは色々選択肢があります。以前、ちょびっとだけ「どうやってデプロイしましょうかね」というのを悩んだ時期があったのですが、今回、こんな方式が考えられるんじゃないか、というのを改めて調べてリストアップしてみました。">続・サーバーレス検索エンジン：巨大な静的ファイルを扱うケースについて考える</a></li>
    </ul>
  </div>
  
</div>
<!-- END FEATURED POSTS -->

            </section>
          </aside>
        </footer>
      </div>
    </article>
  </main>
  <aside class="col-md-3 col-sm-3 blog-sidebar">
    <!-- START SIDEBAR  -->

<section class="toc-section">
  <h2 class="margin-top-30">目次</h2>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#n%E5%9B%9E%E7%9B%AE%E3%81%AEWeb-Components%E5%85%83%E5%B9%B4"><span class="toc-text">n回目のWeb Components元年</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Lit%E3%81%AE%E6%96%B0%E6%A9%9F%E8%83%BD%E3%81%AE%E3%83%AA%E3%82%A2%E3%82%AF%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%81%A8%E3%81%AF%E4%BD%95%E8%80%85%E3%81%8B"><span class="toc-text">Litの新機能のリアクティブコントローラとは何者か</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%83%AA%E3%82%A2%E3%82%AF%E3%83%86%E3%82%A3%E3%83%96%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%81%AEAPI"><span class="toc-text">リアクティブコントローラのAPI</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%82%92%E5%A4%96%E3%81%8B%E3%82%89%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B"><span class="toc-text">コントローラを外から設定する</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E7%94%A8%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B"><span class="toc-text">テーブルのデータ取得用のコントローラを作ってみる</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%81%BE%E3%81%A8%E3%82%81"><span class="toc-text">まとめ</span></a></li></ol>
</section>

<section class="category">
<h2 class="margin-top-30">カテゴリー</h2>

<div class="widget-wrap">
  <div class="widget">
    <ul class="nav sidebar-categories margin-bottom-40">
    
      <li class=""><a href="/categories/Culture/">Culture (52)</a></li>
    
      <li class=""><a href="/categories/IoT/">IoT (15)</a></li>
    
      <li class=""><a href="/categories/VR/">VR (10)</a></li>
    
      <li class=""><a href="/categories/Security/">Security (2)</a></li>
    
      <li class=""><a href="/categories/Design/">Design (8)</a></li>
    
      <li class=""><a href="/categories/Programming/">Programming (182)</a></li>
    
      <li class=""><a href="/categories/Management/">Management (9)</a></li>
    
      <li class=""><a href="/categories/Infrastructure/">Infrastructure (140)</a></li>
    
      <li class=""><a href="/categories/DB/">DB (14)</a></li>
    
      <li class=""><a href="/categories/DataScience/">DataScience (33)</a></li>
    
      <li class=""><a href="/categories/DevOps/">DevOps (4)</a></li>
    
      <li class=""><a href="/categories/%E8%AA%8D%E8%A8%BC%E8%AA%8D%E5%8F%AF/">認証認可 (7)</a></li>
    
      <li class=""><a href="/categories/Business/">Business (4)</a></li>
    
    </ul>
  </div>
</div>


</section>
<section class="other-blog-link">
<h2 class="margin-top-30">リンク</h2>
<div class="widget-wrap">
  <div class="widget">
    <ul class="nav">
      <li><a href="https://anchor.fm/futuretechcast" title="フューチャーグループの技術について深堀りするPodcastです" target="_blank" rel="noopener">ポッドキャスト</a></li>
      <li><a href="https://future.connpass.com/" title="経営とITをデザインするフューチャーの勉強会です" target="_blank" rel="noopener">勉強会Connpass</a></li>
      <li><a href="https://github.com/future-architect" title="Future's official open source repositories" target="_blank" rel="noopener">GitHub</a></li>
      <li><a href="https://qiita.com/organizations/future" title="フューチャーのQiita Organizationです" target="_blank" rel="noopener">Qiita</a></li>
      <li><a href="https://note.future.co.jp/" title="フューチャーの公式note" target="_blank" rel="noopener">未来報</a></li>
      <li><a href="https://future-fintech.github.io/" title="Future Fintech EyE - 金融の未来を語るブログ" target="_blank" rel="noopener">Future Fintech EYE</a></li>
    </ul>
  </div>
</div>

</section>
<section class="advent-calendar">
<h2 class="margin-top-30">アドベントカレンダー</h2>
<div class="widget-wrap">
  <div class="widget">
    <ul class="nav">
      <li><a href="http://qiita.com/advent-calendar/2020/future" title="フューチャー Advent Calendar 2020 #Qiita" target="_blank" rel="noopener">2020年</a></li>
      <li><a href="http://qiita.com/advent-calendar/2019/future" title="フューチャー Advent Calendar 2019 #Qiita" target="_blank" rel="noopener">2019年</a></li>
      <li><a href="http://qiita.com/advent-calendar/2018/future" title="フューチャー Advent Calendar 2018 #Qiita" target="_blank" rel="noopener">2018年</a></li>
      <li><a href="http://qiita.com/advent-calendar/2017/future" title="フューチャー Advent Calendar 2017 #Qiita" target="_blank" rel="noopener">2017年</a></li>
      <li><a href="http://qiita.com/advent-calendar/2016/future" title="フューチャー Advent Calendar 2016 #Qiita" target="_blank" rel="noopener">2016年</a></li>
      <li><a href="http://qiita.com/advent-calendar/2015/future" title="フューチャー Advent Calendar 2015 #Qiita" target="_blank" rel="noopener">2015年</a></li>
    </ul>
  </div>
</div>

</section>
<!-- END SIDEBAR -->

  </aside>
</div>

  </section>
</div>

      <!-- BEGIN PRE-FOOTER -->
    <footer>
      <div class="pre-footer">
        <div class="container">
          <div class="row">
            <!-- BEGIN BOTTOM ABOUT BLOCK -->
            <div class="col-md-4 col-sm-6 pre-footer-col">
              <h2>About Us</h2>
              <p>経営とITをデザインする、フューチャーの技術ブログです。業務で利用している幅広い技術について紹介します。記事についてのお問い合わせはTwitterのDMで連絡いただけると幸いです。<br /><br /><a target="_blank" rel="noopener" href="http://www.future.co.jp/">http://www.future.co.jp/</a></p>
            </div>
            <!-- END BOTTOM ABOUT BLOCK -->
            <!-- BEGIN BOTTOM CONTACTS -->
            <div class="col-md-4 col-sm-6 pre-footer-col">
              <h2>Contact</h2>
              <address class="margin-bottom-40">
                東京都品川区大崎1-2-2<br>
                アートヴィレッジ大崎セントラルタワー<br><br>
                Email: <a href="mailto:techblog@future.co.jp">techblog@future.co.jp</a><br>
              </address>
            </div>
            <!-- END BOTTOM CONTACTS -->
            <!-- Twitter Share. ページ毎に1度初期化できれば良い -->
            <script>window.twttr = (function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0], t = window.twttr || {};
              if (d.getElementById(id)) return t;
              js = d.createElement(s);
              js.id = id;
              js.src = "https://platform.twitter.com/widgets.js";
              fjs.parentNode.insertBefore(js, fjs);
              t._e = [];
              t.ready = function(f) {
                t._e.push(f);
              };
              return t;
            }(document, "script", "twitter-wjs"));</script>
            
              <!-- BEGIN TWITTER BLOCK -->
              <div class="col-md-4 col-sm-6 pre-footer-col">
                <!-- Twitterフォローボタン -->
                <div class="social-btn twitter-btn twitter-follow-btn">
                  <a href="https://twitter.com/intent/follow?screen_name=future_techblog " target="_blank" rel="nofollow noopener">
                    <i></i><span class="tw-btn-label">@future_techblogさんをフォロー</span>
                  </a>
                </div>
                <!-- Twitterタイムライン -->
                <a data-tweet-limit="1" class="twitter-timeline" target="_blank" rel="noopener" href="https://twitter.com/future_techblog?ref_src=twsrc%5Etfw" data-lang="ja" data-dnt="true">Tweets by @future_techblog</a>
              </div>
              <!-- END TWITTER BLOCK -->
            
          </div>
        </div>
      </div>
      <!-- END PRE-FOOTER -->
      <!-- BEGIN FOOTER -->
      <div class="footer">
        <div class="container">
          <div class="row">
            <!-- BEGIN COPYRIGHT -->
            <div class="col-md-6 col-sm-6 padding-top-10">
              &copy; 2021 フューチャー技術ブログ<br>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- END FOOTER -->

  <!-- START INTEGRATIONS -->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-74047147-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


<!-- END INTEGRATIONS -->

  </div>
</body>
</html>
