<!DOCTYPE html>
<!--[if IE 8]> <html lang="ja" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="ja" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="ja">
<!--<![endif]-->
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>「基幹業務もHadoopで!!」のその後　〜性能編〜 | Tech Blog - Future Architect</title>

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  
  <meta name="description" content="こんにちは、須田です。
今年の初めに「基幹業務もHadoopで!! -ローソンにおける店舗発注業務へのHadoop + Hive導入と その取り組みについて-」と題しまして、Hadoop / Spark Conference Japan 2016にて発表させて頂きました。
カンファレンスでの発表時は絶賛開発中だったこともあり、いかに業務要件を設計/実装に落としていったかという話を中心に行いました">
<meta property="og:type" content="article">
<meta property="og:title" content="「基幹業務もHadoopで!!」のその後　〜性能編〜">
<meta property="og:url" content="https://future-architect.github.io/articles/20161005/index.html">
<meta property="og:site_name" content="Tech Blog - Future Architect">
<meta property="og:description" content="こんにちは、須田です。
今年の初めに「基幹業務もHadoopで!! -ローソンにおける店舗発注業務へのHadoop + Hive導入と その取り組みについて-」と題しまして、Hadoop / Spark Conference Japan 2016にて発表させて頂きました。
カンファレンスでの発表時は絶賛開発中だったこともあり、いかに業務要件を設計/実装に落としていったかという話を中心に行いました">
<meta property="og:image" content="https://future-architect.github.io/images/photo_20161005_00.png">
<meta property="og:image" content="https://future-architect.github.io/images/photo_20161005_01.png">
<meta property="og:image" content="https://future-architect.github.io/images/photo_20161005_02.png">
<meta property="og:image" content="https://future-architect.github.io/images/photo_20161005_03.png">
<meta property="og:updated_time" content="2017-03-19T02:34:02.523Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="「基幹業務もHadoopで!!」のその後　〜性能編〜">
<meta name="twitter:description" content="こんにちは、須田です。
今年の初めに「基幹業務もHadoopで!! -ローソンにおける店舗発注業務へのHadoop + Hive導入と その取り組みについて-」と題しまして、Hadoop / Spark Conference Japan 2016にて発表させて頂きました。
カンファレンスでの発表時は絶賛開発中だったこともあり、いかに業務要件を設計/実装に落としていったかという話を中心に行いました">
<meta name="twitter:image" content="https://future-architect.github.io/images/photo_20161005_00.png">
  
    <link rel="alternative" href="/atom.xml" title="Tech Blog - Future Architect" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  

  <meta content="「基幹業務もHadoopで!!」のその後　〜性能編〜 | Tech Blog - Future Architect" name="description">
  <meta content="「基幹業務もHadoopで!!」のその後　〜性能編〜,Tech Blog - Future Architect,フューチャーアーキテクト,Future Architect,フューチャー,Future,Tech Blog,技術ブログ,技術,ブログ" name="keywords">
  <meta content="Future Architect Consultant" name="author">

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|Audiowide|PT+Sans+Narrow|Source+Sans+Pro:200,300,400,600,700,900&amp;subset=all" rel="stylesheet" type="text/css">

  <!-- Global styles START -->
  <link rel="stylesheet" href="/metronic/assets/plugins/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/metronic/assets/plugins/bootstrap/css/bootstrap.min.css">
  <!-- Global styles END -->

  <!-- Theme styles START -->
  <link rel="stylesheet" href="/metronic/assets/corporate/css/style.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/style-responsive.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/themes/red.css">
  <link rel="stylesheet" href="/css/theme-styles.css">
  <!-- Theme styles END --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body class="corporate">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- BEGIN HEADER -->
<div class="header">
	<div class="header-overlay">
		<!--<a class="site-logo" href="/" id="logo">Tech Blog - Future Architect</a>-->
		<div class="header-menu">
			<a class="site-logo" href="/">
				<img src="/metronic/assets/corporate/img/site_logo.png" alt="logo" class="logo-img">
			</a>
			<a href="javascript:void(0);" class="mobi-toggler"><i class="fa fa-bars"></i></a>
			<!-- BEGIN NAVIGATION -->
			<div class="header-navigation pull-right font-transform-inherit">
				<ul>
					
					<li class="">
						<a href="/"><i class="fa fa-home"></i>Home</a>
					</li>
					
					<li class="">
						<a href="/articles/"><i class="fa fa-newspaper-o"></i>Blog</a>
					</li>
					
					<li class="">
						<a href="/events/"><i class="fa fa-flag-o"></i>Event</a>
					</li>
					
					<li class="">
						<a href="/slides/"><i class="fa fa-slideshare"></i>Slide</a>
					</li>
					
					<li class="">
						<a href="https://github.com/future-architect"><i class="fa fa-github"></i>GitHub</a>
					</li>
					
					<li class="">
						<a href="http://qiita.com/organizations/future"><i class="fa fa-users"></i>Qiita</a>
					</li>
					
					<li class="">
						<a href="https://www.facebook.com/future.saiyo/"><i class="fa fa-facebook-square"></i>Facebook</a>
					</li>
					
					<!-- BEGIN TOP SEARCH -->
					<li class="menu-search">
						<span class="sep"></span>
						<i class="fa fa-search search-btn"></i>
						<div class="search-box">
							<form action="#" class="googleSearch" onsubmit="googleSearch();">
								<div class="input-group">
									<input type="text" placeholder="Search" class="form-control">
									<span class="input-group-btn">
										<button class="btn btn-primary" type="submit">Search</button>
									</span>
								</div>
							</form>
						</div>
					</li>
					<!-- END TOP SEARCH -->
				</ul>
			</div>
		</div>
		<!-- END NAVIGATION -->
		<div class="header-title">Tech Blog</div>
        <div class="header-title-sub">フューチャーアーキテクト開発者ブログ</div>
	</div>
</div>
<!-- Header END -->

  <div class="container">
  <ul class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/articles/">Blog</a></li>
    <li class="active">Post</li>
  </ul>
  <section id="main">
    
    <h2 itemprop="name">
      <a class="article-title" href="/articles/20161005/">「基幹業務もHadoopで!!」のその後　〜性能編〜</a>
    </h2>


    <div class="row">
<div class="col-md-9 col-sm-9 blog-posts">
<article id="post-20161005-hadoop-md" class="article article-type-post blog-item" itemscope itemprop="blogPost">
  <div class="article-meta">
  </div>
  <div class="article-inner">
    
    <header class="article-header">
      <ul class="blog-info">
	<li><i class="fa fa-user"></i> 須田桂伍</li>
	<li><i class="fa fa-calendar"></i>
	  <time datetime="2016-10-05T04:34:31.000Z" itemprop="datePublished">2016/10/05</time>

	</li>

    <li class="hidden-xs"><i class="fa fa-tags"></i>
	  
  
    <a href="/tags/Hadoop/" title="Hadoop">Hadoop</a>,
  
    <a href="/tags/Hive/" title="Hive">Hive</a>,
  
    <a href="/tags/YARN/" title="YARN">YARN</a>,
  
    <a href="/tags/AWS/" title="AWS">AWS</a>,
  
    <a href="/tags/EMR/" title="EMR">EMR</a>
  


	</li>
      </ul>
      
  <div class="article-category">
    
    Category: 
    
    Categories:
    <a class="article-category-link" href="/categories/開発/">開発</a>
  </div>
  <br>


    </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/images/photo_20161005_00.png"></p>
<p>こんにちは、須田です。</p>
<p>今年の初めに<strong>「基幹業務もHadoopで!! -ローソンにおける店舗発注業務へのHadoop + Hive導入と その取り組みについて-」</strong>と題しまして、<a href="http://hadoop.apache.jp/hcj2016-program/" target="_blank" rel="external">Hadoop / Spark Conference Japan 2016</a>にて発表させて頂きました。</p>
<p>カンファレンスでの発表時は絶賛開発中だったこともあり、いかに業務要件を設計/実装に落としていったかという話を中心に行いました。</p>
<p>本エントリでは、<strong>「カンファレンスのその後」</strong>と題しまして、開発後の性能テストを通じて、いかにプロダクト環境に耐えられる品質にまで高めていったのかについて記載します。</p>
<p>ピーク時では数百HiveQL/秒を処理するこのシステムにおいて、どういった課題があり、そのために実施した対策やチューニングポイントについてまとめます。<br>主にHiveおよびYARNを中心にその取り組みについて記載していきます。</p>
<p>ぜひ本エントリを読み進めて頂く前に、カンファレンス時の資料を一読して頂ければと思います。</p>
<p><iframe src="//www.slideshare.net/slideshow/embed_code/key/deltaDtgJAnbpQ" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/keigosuda/hadoop-hadoop-hive" title="基幹業務もHadoopで!! -ローソンにおける店舗発注業務へのHadoop + Hive導入と その取り組みについて-" target="_blank">基幹業務もHadoopで!! -ローソンにおける店舗発注業務へのHadoop + Hive導入と その取り組みについて-</a> </strong> from <strong><a target="_blank" href="//www.slideshare.net/keigosuda">Keigo Suda</a></strong> </div></p>
<p><br></p>
<h2 id="対応内容-ざっと整理"><a href="#対応内容-ざっと整理" class="headerlink" title="対応内容(ざっと整理)"></a><strong>対応内容(ざっと整理)</strong></h2><p>チューニングの一環として検討・確認を行った項目は以下の通りです。</p>
<table>
<thead>
<tr>
<th>対象</th>
<th>対応内容</th>
<th>対応詳細</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hive</td>
<td>クエリチューニング</td>
<td>・パーティショニング <br>・作成ワーク数の削減</td>
</tr>
<tr>
<td>Hive</td>
<td>ファイルフォーマットの変更</td>
<td>-</td>
</tr>
<tr>
<td>Hive</td>
<td>データ圧縮</td>
<td>・圧縮アルゴリズムの選択 <br>・中間データの圧縮 <br>・転送データの圧縮</td>
</tr>
<tr>
<td>Hive</td>
<td>アクセスプランの効率化</td>
<td>・Vectrizationの有効化 <br>・CBO有効化</td>
</tr>
<tr>
<td>Hive</td>
<td>処理プロセス(スレッド数)の効率化</td>
<td>・Reducer数の調整 <br>・Shuffleコネクション数の調整</td>
</tr>
<tr>
<td>Hive</td>
<td>結合処理の最適化</td>
<td>・バケットの利用 <br>・MapJoinの利用</td>
</tr>
<tr>
<td>Hive</td>
<td>リソース利用の最適化</td>
<td>・JVMヒープサイズの変更 <br>・Tezコンテナの再利用</td>
</tr>
<tr>
<td>YARN</td>
<td>コンテナ配布の最適化</td>
<td>・割当コンテナサイズの範囲調整 <br>・コンテナサイズの変更</td>
</tr>
<tr>
<td>YARN</td>
<td>スケジューラ調整</td>
<td>・スケジューラの変更 <br>・処理用キューの設定</td>
</tr>
<tr>
<td>HDFS</td>
<td>NameNode関連</td>
<td>・NameNode処理スレッド数調整</td>
</tr>
<tr>
<td>その他</td>
<td>システム構成変更</td>
<td>タスクインスタンスグループの追加</td>
</tr>
</tbody>
</table>
<p>上記に記した項目は一通り性能数値を取得し比較検討を行ったものです。<br>中にはそもそも採用に至らなかったものもあります。</p>
<p>今回は上記の中でも特に効果のあったものや、本システムで特徴的だったもののみをピックアップして取り扱います。<br>以下のパートに分けてこの後対応内容の詳細について記載します。</p>
<ul>
<li><strong>1. Hive編</strong></li>
<li><strong>2. YARN編</strong></li>
</ul>
<p><br></p>
<h1 id="1-Hive編"><a href="#1-Hive編" class="headerlink" title="1. Hive編"></a><strong>1. Hive編</strong></h1><p>まずはHiveに関連するチューニング対応の内容について記載します。<br>対応内容としては大きく以下の2つです。</p>
<ul>
<li><strong>1-1. HiveQLチューニング</strong></li>
<li><strong>1-2. Hiveパラメータチューニング</strong></li>
</ul>
<p>対応した内容の中でも効果が大きかったもの、本システムに特徴的なものを中心に取り上げていきます。</p>
<h2 id="1-1-HiveQLチューニング"><a href="#1-1-HiveQLチューニング" class="headerlink" title="1-1. HiveQLチューニング"></a><strong>1-1. HiveQLチューニング</strong></h2><p>HiveQLのチューニングは正攻法で行っています。</p>
<p>開発に入る前にHiveQLのコーディング規約を整備しておいたおかげで、処理負荷が特定ノードに寄ってしまうような処理(ソート処理など)は最低限に留めることができていました。<br>そのため、チューニングの観点としては以下にHiveにとって効率的に処理ができるようにワーク作成処理を組み替えていくか、作りかえていくかというものでした。</p>
<p>主に実施したHiveQLチューニングは以下の通りです。</p>
<ul>
<li><strong>a) 作成ワーク数の削減</strong></li>
<li><strong>b) パーティション作成の廃止</strong></li>
</ul>
<p><br></p>
<h3 id="a-作成ワーク数の削減"><a href="#a-作成ワーク数の削減" class="headerlink" title="a) 作成ワーク数の削減"></a><strong>a) 作成ワーク数の削減</strong></h3><p>ソースコードおよびHive実行プランの可読性を上げる(効率の悪い書き方をしているクエリがないかといったレビュー観点でも見通しが良くなる)ために小さい単位でワーク作成処理を行うことを大方針としていました。<br>そのため、HiveQLの開発規約の中ではワークテーブルの作成基準を明確にしていました。<br>例えば以下のような感じです。</p>
<ul>
<li><strong>１ワーク処理の中での結合数に上限を設け、その上限を超えるようであればワークを分割する</strong></li>
<li><strong>インラインビューが2段階以上になる場合はワークを分割する  etc</strong></li>
</ul>
<p><br></p>
<p>基本的には規約に基づくワーク分割の方針で問題なかったのですが、規約に厳密に則ったために、かえって不効率なワーク処理も見受けられました。<br>例えば、1つのクエリで結合できるテーブル数に上限(最大5としていました)を設けていたために、同一のワークテーブルに追記していくような処理も、クエリが分割されていました。<br>そのためさばくデータ量的にも一つのクエリとしてまとめあげて処理した方がIO効率が良さそうな処理も細かく割れてしまってました。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">//これまでは規約に則っていたので、以下のようにクエリが分割されてしまっているものもあった</div><div class="line"></div><div class="line"><span class="comment">-- *****************************************************************************</span></div><div class="line"><span class="comment">-- 処理名　　xxxxxx</span></div><div class="line"><span class="comment">-- 処理概要   xxxxxx</span></div><div class="line"><span class="comment">-- *****************************************************************************</span></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span></div><div class="line">    WORK_TABLE</div><div class="line"><span class="keyword">SELECT</span></div><div class="line">	COL1</div><div class="line">,	COL2</div><div class="line">,	COL3</div><div class="line"><span class="keyword">FROM</span></div><div class="line">	TABLE02</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></div><div class="line">	COL1</div><div class="line">,	COL2</div><div class="line"><span class="keyword">HAVING</span></div><div class="line">	<span class="keyword">MAX</span>(COL3)	!=	<span class="string">'some_value'</span></div><div class="line">;</div><div class="line"></div><div class="line"><span class="comment">-- *****************************************************************************</span></div><div class="line"><span class="comment">-- 処理名　　xxxxxx</span></div><div class="line"><span class="comment">-- 処理概要   xxxxxx</span></div><div class="line"><span class="comment">-- *****************************************************************************</span></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span></div><div class="line">    WORK_TABLE</div><div class="line"><span class="keyword">SELECT</span></div><div class="line">	COL1</div><div class="line">,	COL2</div><div class="line">,	COL3</div><div class="line"><span class="keyword">FROM</span>	TABLE03</div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">	TABLE04</div><div class="line"><span class="keyword">ON</span></div><div class="line">	TABLE03.COL1	=	TABLE04.COL1</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">	TABLE03.COL2	=	<span class="string">'some_value'</span></div><div class="line">;</div></pre></td></tr></table></figure>
<p>こういった同一のワークテーブルへのSELECT INSERT処理のようなものはUNION(もしくはUNION ALL)などでまとめあげて1処理に集約していきました。</p>
<p>UNION(もしくはUNION ALL)で繋ぐぶんには、コメントで区切るなどで極端なソースの可読性劣化もなかったので許容することにしました。<br>また、プランの可読性についても、UNION ALLでまとめていく分には、どこが処理の境目になっているかがわかりやすいので、依然として把握しやすい状態を保てていたため特段問題とはなりませんでした。</p>
<p><br></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">//同一ワークテーブルへの追記処理はまとめあげる</div><div class="line"></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span></div><div class="line">    WORK_TABLE</div><div class="line"><span class="keyword">SELECT</span></div><div class="line">	COL1</div><div class="line">,	COL2</div><div class="line">,	COL3</div><div class="line"><span class="keyword">FROM</span></div><div class="line">	TABLE02</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></div><div class="line">	COL1</div><div class="line">,	COL2</div><div class="line"><span class="keyword">HAVING</span></div><div class="line">	<span class="keyword">MAX</span>(COL3)	!=	<span class="string">'some_value'</span></div><div class="line"><span class="keyword">UNION</span> ALL</div><div class="line"><span class="comment">-- *****************************************************************************</span></div><div class="line"><span class="comment">-- 処理名　　xxxxxx</span></div><div class="line"><span class="comment">-- 処理概要   xxxxxx</span></div><div class="line"><span class="comment">-- *****************************************************************************</span></div><div class="line"><span class="keyword">SELECT</span></div><div class="line">	COL1</div><div class="line">,	COL2</div><div class="line">,	COL3</div><div class="line"><span class="keyword">FROM</span>	TABLE03</div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">	TABLE04</div><div class="line"><span class="keyword">ON</span></div><div class="line">	TABLE03.COL1	=	TABLE04.COL1</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">	TABLE03.COL2	=	<span class="string">'some_value'</span></div><div class="line"><span class="keyword">UNION</span> ALL</div><div class="line">・・・・</div></pre></td></tr></table></figure>
<p><br></p>
<h3 id="b-パーティション作成の廃止"><a href="#b-パーティション作成の廃止" class="headerlink" title="b) パーティション作成の廃止"></a><strong>b) パーティション作成の廃止</strong></h3><p>パーティション作成はいわゆるHiveにおける王道チューニングかもしれませんが、本システムでは利用していません。<br>当初は全マスタデータ作成処理の結合時に利用される共通キー(店舗コード)をもとにdynamic partitionによる動的パーティショニングを実施していました。<br>実際に本番相当の各種データを準備してみると、全部が全部巨大なデータサイズではなかったこともあり、逆に無理にパーティショニングすることで以下の弊害がありました。</p>
<ul>
<li><strong>パーティション後のファイルサイズが小さくなりがちで、結果IO効率が悪くなっていった</strong></li>
<li><strong>パーティション作成処理のオーバーヘッドの積み重ねが処理時間のウェイトを占めるようになっていた</strong></li>
</ul>
<p><br></p>
<p>本システムで主に扱うのがマスタデータということもあり、その性質上トランザクション系のデータに比べてボリュームがそれほど大きくないということから、パーティションは作成せずパワーでやりきる方が全体としてパフォーマンスが良い結果となりました。</p>
<p><br></p>
<h2 id="1-2-Hiveパラメータチューニング"><a href="#1-2-Hiveパラメータチューニング" class="headerlink" title="1-2. Hiveパラメータチューニング"></a><strong>1-2. Hiveパラメータチューニング</strong></h2><p>特に効果があった対応としては以下のものでした。</p>
<ul>
<li><strong>a) Hive on Tezへの変更</strong></li>
<li><strong>b) MapJoinの積極的活用</strong></li>
<li><strong>c) Reducer数の変更</strong></li>
<li><strong>d) 圧縮とファイルフォーマット</strong></li>
</ul>
<p><br></p>
<h3 id="a-Hive-on-Tezへの変更"><a href="#a-Hive-on-Tezへの変更" class="headerlink" title="a) Hive on Tezへの変更"></a><strong>a) Hive on Tezへの変更</strong></h3><p>発表当時は以下の理由によりHiveエンジンの実行エンジンMapReduceを利用していました。</p>
<ul>
<li><strong>当時のEMRの公開バージョンではTezが正式サポートされていなかった</strong></li>
<li><strong>巨大なデータの結合を繰り返す処理が多く、オンメモリでの扱いに慎重だった</strong></li>
</ul>
<p><br></p>
<p>前者については、EMRの起動時にインストールアプリケーションとして標準で提供されていなかったことをさしています。<br>EMRへのTezインストールスクリプトは提供されていたため、ステップ処理でインストール処理を記述すればインストール自体は可能だったため、事前検証は上記提供スクリプトを利用していました。</p>
<p>また、後者ですが確実にクエリが流れ切るということを重視し、必ずディスクを介するMapReduceでの処理する方が安心感がありました。</p>
<p>しかし、開発後の性能テストにて本番相当のデータ量を用いてテストを実施すると、どうしてもMapReduce特有のオーバーヘッドやディスクIOによるIOネックが顕著になってしまい、思っていた以上に処理性能が出ませんでした。</p>
<p>特に本システムの開発においては、ソースコードおよびHiveQL実行プランの可読性を重視するため、なるべくワークテーブルは小さく保ち、小さいワークテーブルを経ながら処理を実施する方針としていたために、上記のオーバーヘッドがチリツモで大きくなっていました。</p>
<p>そんな矢先、EMRバージョン4.7にて正式にTezサポートされたこともあり、Hiveの実行エンジンをMapReduceからTezへ切り替えることにしました。<br>その結果、Tezへの切り替えのみで処理時間をおよそ<strong>1/3</strong>にまで減らすことができました。</p>
<p>以下はデータノードのHDFSへのデータ読み取り・書き込み時のブロック操作数ですが、かなり顕著に差が出ていました。</p>
<p><img src="/images/photo_20161005_01.png"></p>
<p><img src="/images/photo_20161005_02.png"></p>
<p>しかし、メモリ関連のパラメータチューニングは必須で、そのためメモリ関連のパラメータ、特にYARNでのTezコンテナサイズの調整をメインに対応していきました。<br>この詳細については後半の<strong>YARN編</strong>にて記載します。</p>
<p><br></p>
<h3 id="b-MapJoinの積極的活用"><a href="#b-MapJoinの積極的活用" class="headerlink" title="b) MapJoinの積極的活用"></a><strong>b) MapJoinの積極的活用</strong></h3><p>本システムでは実行されるクエリ数も多く、各クエリを見極めてヒント句でMapJoinに縛るのが難しかったこともあり、以下パラメータにより自動的にMapJoinへ誘導する運用としました。</p>
<ul>
<li><strong>hive.auto.convert.join</strong></li>
<li><strong>hive.auto.convert.join.noconditionaltask.size</strong></li>
</ul>
<p><strong>hive.auto.convert.join.noconditionaltask.size</strong>の値ですが、これは性能テストの中で本番相当のデータ量をもとに実行サイズを調整していきました。</p>
<p><br></p>
<h3 id="c-Reducer数の変更"><a href="#c-Reducer数の変更" class="headerlink" title="c) Reducer数の変更"></a><strong>c) Reducer数の変更</strong></h3><p>Tezの変更により、中間データのディスクIOは減らせたものの、最終的にできあがるマスタデータのうち、データサイズが大きなものは依然として最後のHDFSへのファイル書き込みがボトルネックとなってしまっていました。</p>
<p>そこで以下パラメータにより起動するReducer数を調整していきました。</p>
<ul>
<li><strong>hive.exec.reducers.bytes.per.reducer</strong></li>
</ul>
<p><br></p>
<p>最後の書き込み処理だけを考慮してReducer数を起動しすぎてしまうと、ワーク処理の過程にも影響がでてしまう(プロセスが起動しすぎてしまう)のもあり、これは性能テストの中で調整をしていきました。<br>現状は<strong>一律64MB</strong>としています。</p>
<p>Reducer数を上げすぎてしまうと、ファイルが小さくなりすぎてIO効率が悪くなってしまうのではないかと思われるかもしれません。<br>本システムにおいては、最終的にできあがったマスタデータはRDSへエクスポートして利用されます。<br>そのため、できあがったマスタデータが細かくファイルが割れてしまったとしても、直接EMRに対して検索クエリを実行するわけではなかったので、このような対応としました。</p>
<p><br></p>
<h3 id="d-圧縮とファイルフォーマット"><a href="#d-圧縮とファイルフォーマット" class="headerlink" title="d) 圧縮とファイルフォーマット"></a><strong>d) 圧縮とファイルフォーマット</strong></h3><p>これもまたまた王道チューニングですね。<br>圧縮オプションとファイルフォーマットの組み合わせは、ファイル分割が可能な組み合わせとなるよう考慮し、性能テストの中で最も性能がよかった以下の組み合わせを採用しています。</p>
<ul>
<li>ファイルフォーマット：SequeanceFile</li>
<li>圧縮オプション: Snappy</li>
</ul>
<p><br></p>
<p>実現可能な組み合わせのパターンは一通り試したのですが、本システムでは結合をメインとしたワーク処理を積み重ねていく処理のためか、ORCなどのカラムなファイルフォーマットだと処理性能が出ず、Sequence Fileを採用することになりました。</p>
<p><br></p>
<h1 id="2-YARN編"><a href="#2-YARN編" class="headerlink" title="2. YARN編"></a><strong>2. YARN編</strong></h1><p>本システムで一番肝となったのがYARN関連の対応でした。<br>具体的には以下の対応を中心に実施しました。</p>
<ul>
<li><strong>2-1. コンテナサイズの調整</strong></li>
<li><strong>2-2. 処理特性に応じたキュー設定</strong></li>
</ul>
<p>なおYARNの基本的な仕組みについての説明は省略いたしますのでご了承ください。</p>
<p><br></p>
<h2 id="2-1-コンテナサイズの調整"><a href="#2-1-コンテナサイズの調整" class="headerlink" title="2-1. コンテナサイズの調整"></a><strong>2-1. コンテナサイズの調整</strong></h2><p>今回YARNのリソースコントロール配下におかれるアプリケーションは以下でした。</p>
<ul>
<li><strong>a) MRアプリケーション(Apache Sqoopで利用)</strong></li>
<li><strong>b) Tezアプリケーション</strong></li>
</ul>
<p>アプリケーションごとに基準となるコンテナサイズ(主にメモリサイズ)を変えています。</p>
<p><br></p>
<h3 id="a-MRアプリケーション"><a href="#a-MRアプリケーション" class="headerlink" title="a) MRアプリケーション"></a><strong>a) MRアプリケーション</strong></h3><p>MRアプリケーションについて、SqoopによるRDSからのインポート/エクスポート処理はsqoopコマンド実行時にmap数の指定が可能です。<br>そのため、消費コンテナ数を調整可能なので、パフォーマンスは落とさず1コンテナあたりのメモリサイズをどこまで減らすことができるかという観点でメモリサイズの調整行っていきました。</p>
<p><br></p>
<h3 id="b-Tezアプリケーション"><a href="#b-Tezアプリケーション" class="headerlink" title="b) Tezアプリケーション"></a><strong>b) Tezアプリケーション</strong></h3><p>Tezアプリケーションの場合、Sqoopのような利用コンテナ数の調整は難しいため、性能テストの中でコンテナサイズを調整していきました。<br>主に以下の観点でコンテナサイズの調整を実施しました。</p>
<ul>
<li><strong>MapJoinを行えるだけのメモリ確保が可能か(同時にhive.auto.convert.join.noconditionaltask.sizeの調整も実施)</strong></li>
<li><strong>同時実行されるジョブ数に割り当てられるだけのコンテナサイズの確保が可能か</strong></li>
</ul>
<p><br></p>
<p>なおコンテナサイズで指定したメモリの利用内訳については、下記を参考にしました。</p>
<blockquote>
<p><a href="https://community.hortonworks.com/articles/14309/demystify-tez-tuning-step-by-step.html" target="_blank" rel="external">Demystify Apache Tez Memory Tuning - Step by Step</a></p>
</blockquote>
<p>これはもう地道に様々なコンテナサイズで処理を回してみて、適切な値を出しました。<br>最終的にTezアプリケーションでのコンテナサイズは<strong>メモリ4GB・vCPU1コア/コンテナ</strong>が標準として落ち着きました。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-- コンテナサイズ</div><div class="line">SET hive.tez.container.size=4096;</div><div class="line">SET hive.tez.java.opts=-Xmx3200m;</div><div class="line">SET hive.tez.cpu.vcores=1;</div></pre></td></tr></table></figure>
<p>ただし、Hive編で記載した通り、MapJoinに処理をよせるにあたり、作成するマスタデータによってはコンテナあたりのメモリサイズを大きくする必要がありました。<br>そういったマスタデータ作成処理のみ例外的にコンテナのメモリサイズを大きくするといった対応を実施しています。</p>
<p>なお、処理ピーク時に同時稼働ジョブがかなり多くこともあり、なるべくクラスタトータルでメモリの使用を抑えたかったこともあり、TezアプリケーションもMRアプリケーションも起動するApplication Master用のコンテナサイズをデフォルトから小さくしています。</p>
<p><br></p>
<h2 id="2-2-処理特性に応じたキュー設定"><a href="#2-2-処理特性に応じたキュー設定" class="headerlink" title="2-2. 処理特性に応じたキュー設定"></a><strong>2-2. 処理特性に応じたキュー設定</strong></h2><p>本システムではピーク時では常に数百のクエリを処理し続けるといったかなりハードワークです。<br>また作成するマスタデータごとに処理の複雑度合や利用するテーブルのデータサイズなどかなりまちまちです。<br>そのため、作成するマスタデータの業務優先度やそのワークロードに応じたリソース配分が必要となりました。</p>
<p>そのために以下の対応を実施しました。</p>
<ul>
<li><strong>a) YARNのスケジューラの変更</strong></li>
<li><strong>b) 業務優先度や処理特性に応じたキュー設定とリソース制御</strong></li>
</ul>
<p><br></p>
<h3 id="a-YARNのスケジューラ変更"><a href="#a-YARNのスケジューラ変更" class="headerlink" title="a) YARNのスケジューラ変更"></a><strong>a) YARNのスケジューラ変更</strong></h3><p>YARNのデフォルトのスケジューラはFIFO(First in First Out)であるため、最初に実行されたジョブに利用可能なコンテナをほとんど持って行かれてしまい、同時に複数ジョブを投入してもペンディングが多発していました。<br>そのためジョブの実行多重度をあげるために他のスケジューリングアルゴリズムを採用することにしました。</p>
<p>YARNでは他にFair Scheduler、Capacity Schedulerといったスケジューリングアルゴリズムを選択可能なのですが、今回はFair Schedulerを採用することにしました。</p>
<p>Capacity Schedulerでは、利用リソース量に基づいたスケジューリングが可能なのです。</p>
<p>ただFair Shcedulerでもキュー単位でリソース使用量や重み付けが可能であったのと、Capacity Schedulerの場合、キュー間ではリソース利用に応じて細かな制御は可能なのですが、同一キューに投入されたジョブはFIFOで処理されていたため、今回の要件には少し不足気味だったため採用を見送りました。(もしかしたら挙動を変える方法があった・・・？)</p>
<p><br></p>
<h3 id="b-業務優先度や処理特性に応じたキュー設定とリソース制御"><a href="#b-業務優先度や処理特性に応じたキュー設定とリソース制御" class="headerlink" title="b) 業務優先度や処理特性に応じたキュー設定とリソース制御"></a><strong>b) 業務優先度や処理特性に応じたキュー設定とリソース制御</strong></h3><p>クラスタ上で複数のジョブが同時に走るようになったものの、FairSchedulerでは特に設定をしない限りはクラスタに投入されたジョブはみな等しくリソースが按分されて処理が行われます。</p>
<p>そのため、それほどリソースを利用しなくても処理が十分回るもの、そうでないものも全て同じくリソースが按分されることになります。</p>
<p>今回のバッチ処理の特性としては、実行多重度がかなり高く、ひとつひとつの作成処理量の重さもばらつきがあります。</p>
<p>そのため、同時に処理する量が増えてくるほど一向に処理が完了しないマスタ作成処理もでてきてしまうといった事態が発生していました。</p>
<p>そこで必要となるリソース量や業務的な優先度を鑑みて、ジョブを投入するキューを分けることにしました。<br>キュー見直し後の構成は以下のようになりました。</p>
<p><img src="/images/photo_20161005_03.png"></p>
<p>キュー単位に指定している利用可能なリソースウェイトですが、これは最大ピーク時の多重度を考慮した割合としています。<br>実際に性能数値を確認しながら最も全体として短い時間で終わるような重み付けを探っていった具体です。<br>そのため、ピーク時間帯以外で他キューに空きがあればその分のリソースを他キューからも利用できるようにしています。</p>
<p>キュー単位でのリソース制御ですが、リソースを絶対量で指定もできますが、割合による重み付けを利用しています。<br>理由としては、今後クラスタサイズが変更になりトータルのリソース量が変わってしまった際に都度細かな数値を見直さなくても大丈夫なようにするためです。</p>
<h2 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a><strong>最後に</strong></h2><p>ざっとですが、これまでの取り組みについて記載しました。<br>実はもう一つ大きな戦いがあって、EMRで作成したマスタデータをAPI参照のためにRDS(MySQL)へSqoopでエクスポートする処理がなかなか性能がでず、ごりごりMySQLチューニングを実施した話とか、その頑張りをあっさりAmazon Auroraに追いつかれてしまった話などまだまだ話は尽きないのですが、それはまた別の機会に。</p>
<p>お付き合い頂きありがとうございました。</p>

      
    </div>
  </div>
    
  <!-- シェアボタン START -->
  <div class="social-area">
  <ul class="social-button">

      <!-- twitter -->
      <li class="sc-tw social-button-twitter">
          <a href="https://twitter.com/share" class="twitter-share-button" data-via="future_techblog" data-lang="ja" data-hashtags="future_architect">ツイート</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      </li>
      
      <!-- Facebookいいね -->
      <li class="social-button-fb">
          <div id="fb-root"></div>
          <script>(function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0];
              if (d.getElementById(id)) return;
              js = d.createElement(s); js.id = id;
              js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.8";
              fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));</script>
          <div class="fb-like" data-href="https://future-architect.github.io/articles/20161005/" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="true"></div>
      </li>

      <!-- 	google+ -->
      <li class="social-button-g">
      <script src="https://apis.google.com/js/platform.js" async defer>
      {lang: 'ja'}
      </script>
      <div class="g-plusone" data-size="medium"></div>
      </li>

      <!-- はてなブックマーク -->
      <li class="social-button-hatebu"><a href="http://b.hatena.ne.jp/entry/https://future-architect.github.io/articles/20161005/" class="hatena-bookmark-button" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script></li>

      <!-- pocket -->
      <li class="social-button-pocket"><a data-pocket-label="pocket" data-pocket-count="horizontal" class="pocket-btn" data-lang="en"></a>
          <script type="text/javascript">!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script>
      </li>

  </ul>
  </div>
<!-- シェアボタン END -->


  
    
<nav id="article-nav">
  
    <a href="/articles/20161013/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          第五回社内LT大会～頑張る人は光るらしい
        
      </div>
    </a>
  
  
    <a href="/articles/20160920/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">マネージャーがうれしいRedmineデータのグラフ表示方法を公開します！！</div>
    </a>
  
</nav>

  
  <br>
</article>

</div>
<div class="col-md-3 col-sm-3 blog-sidebar">
  <!-- OSS LOGO START -->
<h2 class="margin-top-30">OSS</h2>
<div class="widget-wrap">
  <div class="widget">
    <ul class="list-inline oss">
      <li>
        <a href="https://github.com/future-architect/vuls" target="_blank">
          <img src="/metronic/assets/corporate/img/Vuls.png" alt="Vuls">
      </a>
      </li>
      <li>
        <a href="https://future-architect.github.io/uroborosql-doc/" target="_blank">
          <img src="/metronic/assets/corporate/img/uroboroSQL-logo.png" alt="uroboroSQL">
      </a>
      </li>
      <li>
        <a href="http://future-architect.github.io/urushi/" target="_blank">
          <img src="/metronic/assets/corporate/img/Urushi-logo.png" alt="Urushi">
      </a>
      </li>
    </ul>
  </div>
</div>


<!-- OSS LOGO START -->

<!-- CATEGORIES START -->
<h2 class="margin-top-30">Categories</h2>

<div class="widget-wrap">
  <div class="widget">
    <ul class="nav sidebar-categories margin-bottom-40">
      
	<li>
	  <a href="/categories/RP-告知/">RP/告知 (2)</a>
	</li>
      
	<li>
	  <a href="/categories/制度/">制度 (2)</a>
	</li>
      
	<li>
	  <a href="/categories/告知/">告知 (4)</a>
	</li>
      
	<li>
	  <a href="/categories/社内制度/">社内制度 (5)</a>
	</li>
      
	<li>
	  <a href="/categories/カンファレンス/">カンファレンス (2)</a>
	</li>
      
	<li>
	  <a href="/categories/素材/">素材 (1)</a>
	</li>
      
	<li>
	  <a href="/categories/開発/">開発 (2)</a>
	</li>
      
	<li>
	  <a href="/categories/プロジェクトマネジメント/">プロジェクトマネジメント (2)</a>
	</li>
      
	<li>
	  <a href="/categories/PR/">PR (2)</a>
	</li>
      
	<li>
	  <a href="/categories/DB/">DB (1)</a>
	</li>
      
	<li>
	  <a href="/categories/調査/">調査 (1)</a>
	</li>
      
	<li>
	  <a href="/categories/VR/">VR (1)</a>
	</li>
      
	<li>
	  <a href="/categories/モノづくり/">モノづくり (1)</a>
	</li>
      
	<li>
	  <a href="/categories/海外視察/">海外視察 (2)</a>
	</li>
      
	<li>
	  <a href="/categories/インフラ/">インフラ (1)</a>
	</li>
      
	<li>
	  <a href="/categories/SQL/">SQL (1)</a>
	</li>
      
	<li>
	  <a href="/categories/データ分析/">データ分析 (1)</a>
	</li>
      
    </ul>
  </div>
</div>


<!-- CATEGORIES END -->

<!-- BEGIN FEATURED POSTS -->
<h2>Featured Posts</h2>
<div class="recent-news margin-bottom-10">
  
  
    
      
        <a href="https://future-architect.github.io/articles/20170314/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0026.jpg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>世論調査の内閣支持率を統計学的に解釈すると…?</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170323/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0029.jpg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>ヒカ☆ラボ初参戦！AWS x IoTで若手エンジニアが登壇してきました</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170321/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0027.jpg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>スタンフォード大学で食べたピーナッツサラダは、格別だった♥</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170327/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0030.jpg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>オープンソースカンファレンス2017 Tokyo/Spring登壇＆ブース出展レポート</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170228/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0025.png" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>SQL開発者を幸せにする！？ Sublime Text 3でも使える uroboroSQL Formatter を公開しました</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170109/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0021.jpg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>インフラ入門vol.1</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170322/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0028.jpg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>ぶらりシリコンバレー巡礼</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170127/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0022.jpg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>3Dプリンタを使ってサービス開発やってみた</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170210/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0023.jpeg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>会社に届いたHoloLensを使ってみた</h3>
            </div>
          </div>
        </a>
      
	
  
    
      
        <a href="https://future-architect.github.io/articles/20170119/">
          <div class="row margin-bottom-10">
            <div class="col-md-4">
              <img src="/images/thumbnail_0016.jpg" class="img-responsive ">
            </div>
            <div class="col-md-8">
              <h3>マネージャーがうれしいRedmineデータのEVM表示方法を公開します！！</h3>
            </div>
          </div>
        </a>
      
	
  
    
  
    
      
	
  
    
      
	
  
    
  
    
  
    
      
	
  
    
      
	
  
    
      
	
  
    
      
	
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</div>
<!-- END FEATURED POSTS -->

<!-- BEGIN BLOG TAGS -->
<div class="blog-tags margin-bottom-20">
  <h2>Tags</h2>
  
  <div class="widget-wrap">
    <div class="widget">
      
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/3Dプリンタ/"><i class='fa fa-tags'></i>3Dプリンタ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AWS/"><i class='fa fa-tags'></i>AWS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bloom-Filter/"><i class='fa fa-tags'></i>Bloom_Filter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cygwin/"><i class='fa fa-tags'></i>Cygwin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/"><i class='fa fa-tags'></i>DB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DesignThinking/"><i class='fa fa-tags'></i>DesignThinking</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EMR/"><i class='fa fa-tags'></i>EMR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/"><i class='fa fa-tags'></i>Elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elastic-ON/"><i class='fa fa-tags'></i>Elastic{ON}</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/"><i class='fa fa-tags'></i>Hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/"><i class='fa fa-tags'></i>Hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HoloLens/"><i class='fa fa-tags'></i>HoloLens</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IoT/"><i class='fa fa-tags'></i>IoT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JANOG38/"><i class='fa fa-tags'></i>JANOG38</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/"><i class='fa fa-tags'></i>Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kibana/"><i class='fa fa-tags'></i>Kibana</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OSS/"><i class='fa fa-tags'></i>OSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/"><i class='fa fa-tags'></i>Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redmine/"><i class='fa fa-tags'></i>Redmine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/"><i class='fa fa-tags'></i>SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Silicon-Valley/"><i class='fa fa-tags'></i>Silicon Valley</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stanford/"><i class='fa fa-tags'></i>Stanford</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Timelion/"><i class='fa fa-tags'></i>Timelion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Urushi/"><i class='fa fa-tags'></i>Urushi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YARN/"><i class='fa fa-tags'></i>YARN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slideshare/"><i class='fa fa-tags'></i>slideshare</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uroboroSQL/"><i class='fa fa-tags'></i>uroboroSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuls/"><i class='fa fa-tags'></i>vuls</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/あいさつ/"><i class='fa fa-tags'></i>あいさつ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/アイコン/"><i class='fa fa-tags'></i>アイコン</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/アカリクTechTalk/"><i class='fa fa-tags'></i>アカリクTechTalk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/イベント/"><i class='fa fa-tags'></i>イベント</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/インフラ/"><i class='fa fa-tags'></i>インフラ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/カンファレンス/"><i class='fa fa-tags'></i>カンファレンス</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/コーディング規約/"><i class='fa fa-tags'></i>コーディング規約</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/セキュリティ/"><i class='fa fa-tags'></i>セキュリティ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ニコニコ動画/"><i class='fa fa-tags'></i>ニコニコ動画</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ニコ生放送/"><i class='fa fa-tags'></i>ニコ生放送</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ハッカソン/"><i class='fa fa-tags'></i>ハッカソン</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ヒカ☆ラボ/"><i class='fa fa-tags'></i>ヒカ☆ラボ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ビックデータ/"><i class='fa fa-tags'></i>ビックデータ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/沖縄/"><i class='fa fa-tags'></i>沖縄</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/社内イベント/"><i class='fa fa-tags'></i>社内イベント</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/統計学/"><i class='fa fa-tags'></i>統計学</a></li></ul>
    </div>
  </div>


</div>
<!-- END BLOG TAGS -->


</div>
</div>

  </section>
</div>

    <!-- BEGIN PRE-FOOTER -->
    <div class="pre-footer">
      <div class="container">
        <div class="row">
          <!-- BEGIN BOTTOM ABOUT BLOCK -->
          <div class="col-md-4 col-sm-6 pre-footer-col">
            <h2>About Us</h2>
            <p>経営とITをデザインする、フューチャーアーキテクトの技術ブログです<br /><br /><a href="http://www.future.co.jp/">http://www.future.co.jp/</a></p>
          </div>
          <!-- END BOTTOM ABOUT BLOCK -->

          <!-- BEGIN BOTTOM CONTACTS -->
          <div class="col-md-4 col-sm-6 pre-footer-col">
            <h2>Contact</h2>
            <address class="margin-bottom-40">
              東京都品川区大崎1-2-2<br>
              アートヴィレッジ大崎セントラルタワー<br><br>
              Email: <a href="mailto:techblog@future.co.jp">techblog@future.co.jp</a><br>
            </address>
          </div>
          <!-- END BOTTOM CONTACTS -->

	
          <!-- BEGIN TWITTER BLOCK -->
          <div class="col-md-4 col-sm-6 pre-footer-col">

	  <a data-tweet-limit="1" class="twitter-timeline"
	  href="https://twitter.com/future_techblog"
	  data-widget-id="732749663766372354">Tweets by @future_techblog</a>

	  <script>!function(d,s,id){var
	  js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

          </div>
          <!-- END TWITTER BLOCK -->
	
        </div>
      </div>
    </div>
    <!-- END PRE-FOOTER -->

    <!-- BEGIN FOOTER -->
    <div class="footer">
      <div class="container">
        <div class="row">
          <!-- BEGIN COPYRIGHT -->
          <div class="col-md-6 col-sm-6 padding-top-10">
                  &copy; 2017 Tech Blog - Future Architect<br>
 <!-- <a href="javascript:;">Privacy Policy</a> | <a href="javascript:;">Terms of Service</a> -->
          </div>
          <!-- END COPYRIGHT -->
	  <!-- BEGIN SOCIAL -->
<div class="col-md-6 col-sm-6">
  <ul class="social-footer list-unstyled list-inline pull-right">
    
      
      <li><a href="https://github.com/future-architect"><i class="fa fa-github"></i></a></li>
      
  
      
      <li><a href="https://twitter.com/future_techblog"><i class="fa fa-twitter"></i></a></li>
      
  
      
      <li><a href="https://www.facebook.com/future.saiyo"><i class="fa fa-facebook"></i></a></li>
      
  
      
      <li>
        <a href="http://qiita.com/organizations/future">
            <i class="fa fa-pencil-square-o"></i>
        </a>
      </li>
      
  
      
      <li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li>
      
  
  </ul>
</div>
<!-- END SOCIAL -->

        </div>
      </div>
    </div>
    <!-- END FOOTER -->

  <!-- BEGIN CORE PLUGINS (REQUIRED FOR ALL PAGES) -->
<!--[if lt IE 9]>
<script src="/metronic/assets/plugins/respond.min.js"></script>
<![endif]-->
<script src="/metronic/assets/plugins/jquery.min.js"></script>
<script src="/metronic/assets/plugins/jquery-migrate.min.js"></script>
<script src="/metronic/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="/metronic/assets/corporate/scripts/back-to-top.js"></script>
<script src="/metronic/assets/corporate/scripts/layout.js"></script>
<script src="/js/script.js"></script>

<script type="text/javascript">
    jQuery(document).ready(function() {
        Layout.init();
        Layout.initTwitter();
        Layout.initFixHeaderWithPreHeader(); /* Switch On Header Fixing (only if you have pre-header) */
        Layout.initNavScrolling();
    });
</script>
<!-- END CORE PLUGINS -->
<!-- START INTEGRATIONS -->

<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-74047147-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<!-- END INTEGRATIONS --><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
