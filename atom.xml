<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼æŠ€è¡“ãƒ–ãƒ­ã‚°</title>
  
  <subtitle>Future Tech Blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://future-architect.github.io/"/>
  <updated>2020-08-13T03:46:20.555Z</updated>
  <id>https://future-architect.github.io/</id>
  
  <author>
    <name>Future Architect Consultants</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>GCPã®Regioné–“ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‹ã‚‰ã‚µãƒ¼ãƒ“ã‚¹ã®Regioné›†ç´„ã‚’è€ƒå¯Ÿã™ã‚‹</title>
    <link href="https://future-architect.github.io/articles/20200813/"/>
    <id>https://future-architect.github.io/articles/20200813/</id>
    <published>2020-08-12T15:00:00.000Z</published>
    <updated>2020-08-13T03:46:20.555Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://future-architect.github.io/articles/20200726/">ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶é€£è¼‰</a>ã®9å›ç›®ã§ã™ã€‚</p><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>ã“ã‚“ã«ã¡ã¯ã€TIG DXãƒ¦ãƒ‹ãƒƒãƒˆã®è¥¿ç”°ã¨ç”³ã—ã¾ã™ã€‚</p><p>æ¥­å‹™ã§ã¯ <code>GCP</code> ã®ã‚¤ãƒ³ãƒ•ãƒ©ã®è¨­è¨ˆ/æ§‹ç¯‰/é‹ç”¨ã‚’æ‹…å½“ã—ã¦ãŠã‚Šã¾ã™ã€‚ç§ã¯å‰è·ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é ˜åŸŸã®ã‚­ãƒ£ãƒªã‚¢ãŒé•·ã‹ã£ãŸäº‹ã‚‚ã‚ã‚Šã€ç¾è·ã§ã¯ <code>GCP</code> ã®ä¸­ã§ã‚‚ç‰¹ã«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«é–¢ã™ã‚‹éƒ¨åˆ†ã‚’è¦‹ã¦ã„ã¾ã™ã€‚ä»Šå›ã®è‡ªç”±ç ”ç©¶ã‚‚ãã‚Œã«é–¢é€£ã™ã‚‹è€ƒå¯Ÿã‚’ã—ã¦ã„ãã¾ã™ã€‚</p><h1 id="è¨˜äº‹ã«ã¤ã„ã¦"><a href="#è¨˜äº‹ã«ã¤ã„ã¦" class="headerlink" title="è¨˜äº‹ã«ã¤ã„ã¦"></a>è¨˜äº‹ã«ã¤ã„ã¦</h1><p>ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã§ã€ãƒ¯ãƒ¼ãƒ«ãƒ‰ãƒ¯ã‚¤ãƒ‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œã‚‹ã¨ãã€<strong>ã€ã©ã‚Œãã‚‰ã„ã®å¯†åº¦ã§ã©ã® Region ã«ã‚µãƒ¼ãƒã‚’ç«‹ã¦ã‚Œã°ã‚ˆã„ã®ã‹ï¼Ÿã€</strong>ã£ã¦ã€æ‚©ã¿ã¾ã›ã‚“ã‹ï¼Ÿã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå‘ã‘ã®Webã‚µãƒ¼ãƒ“ã‚¹ã ã£ãŸã‚‰ <code>CDN</code> ã§å¯¾å‡¦ã™ã‚Œã°åŸºæœ¬çš„ã«ã¯OKã§ã™ãŒã€ã‚¤ãƒ³ãƒˆãƒ©ãƒãƒƒãƒˆã ã‘ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã•ã›ãŸã„ç¤¾å†…ã‚µãƒ¼ãƒ“ã‚¹ã€Backend ç³»ã®ã‚µãƒ¼ãƒ“ã‚¹ã€Webã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ãªã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒå‡ºã¦ãã¾ã™ã‚ˆã­ã€‚<br>é¸æŠè‚¢ã¨ã—ã¦ã¯ä»¥ä¸‹ã§ã™ã€‚</p><ul><li>å…¨ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚µãƒ¼ãƒã‚’æ§‹ç¯‰ã™ã‚‹<ul><li>æ—¥æœ¬ã®å ´åˆã€æ±äº¬ã€å¤§é˜ªã«ãã‚Œãã‚Œæ§‹ç¯‰ã™ã‚‹</li></ul></li><li>è¿‘å‚ã®å›½ã‚’1ã¤ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¾ã¨ã‚ã‚‹<ul><li>æ—¥æœ¬ã®å ´åˆã€æ±äº¬ã ã‘ã«é›†ç´„ã™ã‚‹</li></ul></li></ul><p>ä»Šå›ã¯ã€è‡ªç”±ç ”ç©¶ã¨ã„ã†äº‹ã§ã€æ—¥é ƒæ¥­å‹™ã§ä½¿ã£ã¦ã„ã‚‹ <code>GCP</code> ã‚’é¡Œæã«ã—ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®è¦³ç‚¹ã‹ã‚‰è€ƒå¯Ÿã—ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚å…ˆã«ç”³ã—ä¸Šã’ã¦ãŠãã¾ã™ã¨ã€ä¸€è¦³ç‚¹ã‹ã‚‰ã®è€ƒå¯Ÿãªã®ã§ã€å®Ÿéš›ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒæä¾›ã—ã¦ã„ã‚‹SLAã«ãƒãƒƒãƒã™ã‚‹ã‹ã©ã†ã‹ã¯åˆ¥å•é¡Œãªã®ã§ã€ãã“ã¯ã”å®¹èµ¦ãã ã•ã„ğŸ™‡â€â™‚ï¸</p><h1 id="è‡ªç”±ç ”ç©¶ã§è€ƒå¯Ÿã™ã‚‹è¦³ç‚¹"><a href="#è‡ªç”±ç ”ç©¶ã§è€ƒå¯Ÿã™ã‚‹è¦³ç‚¹" class="headerlink" title="è‡ªç”±ç ”ç©¶ã§è€ƒå¯Ÿã™ã‚‹è¦³ç‚¹"></a>è‡ªç”±ç ”ç©¶ã§è€ƒå¯Ÿã™ã‚‹è¦³ç‚¹</h1><p>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®è¦³ç‚¹ã¨è¨€ã£ã¦ã‚‚ã€ã„ãã¤ã‹ã‚ã‚Šã¾ã™ã‚ˆã­ã€‚</p><ul><li>ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆï¼š<code>ã€‡Gbps</code> ãªã©ã®å¸¯åŸŸã®è©±ã€‚ã€ã‚®ã‚¬ãŒãªããªã£ãŸã€ã¨ã‹ã®ã‚®ã‚¬ã¨ã¯å°‘ã—é•ã„ã¾ã™ã€‚</li><li>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ï¼šãƒ‘ã‚±ãƒƒãƒˆã®å¾€å¾©ã®æ™‚é–“</li><li>ã‚¸ãƒƒã‚¿ãƒ¼ï¼šä¸Šè¨˜ã®æ™‚é–“ã®æºã‚‰ãã€‚æ—©ã„ã¨ãã¨é…ã„ã¨ãã®ã°ã‚‰ã¤ãåº¦åˆã„</li></ul><p>ä»Šå›ã¯ã€ã“ã®ä¸­ã§ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã ã‘ã«æ³¨ç›®ã—ã¦è€ƒå¯Ÿã—ã¾ã™ã€‚<br>ï¼ˆãƒ‡ãƒ¼ã‚¿é‡ãŒãã“ãã“ã‚ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®å ´åˆã¯ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚‚æ°—ã«ã™ã‚‹ã¹ãã§ã™ãŒã€æœ¬è¨˜äº‹ã§ã¯ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã®ã¿ã«æ³¨ç›®ï¼‰</p><h1 id="GCP-ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã¯ï¼Ÿ"><a href="#GCP-ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã¯ï¼Ÿ" class="headerlink" title="GCP ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã¯ï¼Ÿ"></a>GCP ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã¯ï¼Ÿ</h1><p>ã“ã¡ã‚‰ã«ä¸–ç•Œåœ°å›³ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚±ãƒ¼ãƒ–ãƒ«ã®æ¦‚è¦ãŒæ²è¼‰ã•ã‚Œã¦ãŠã‚Šã¾ã™ã€‚<br><a href="https://cloud.google.com/about/locations?hl=ja#network" target="_blank" rel="noopener">https://cloud.google.com/about/locations?hl=ja#network</a><br>ã“ã®ç·šã‚’é€šã£ã¦ãƒ‘ã‚±ãƒƒãƒˆãŒã‚„ã‚Šå–ã‚Šã•ã‚Œã‚‹ã‚ã‘ã§ã™ãŒã€è¿‘ã„ã¨ã“ã‚ã¯æ—©ãå¿œç­”ãŒè¿”ã£ã¦ãã‚‹ã—ã€é ã„ã¨ã“ã‚ã¯å¿œç­”ãŒé…ã„ã¨ã„ã†äº‹ã§ã™ã€‚<br>ã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ç›®ç·šã§è¨€ã†ã¨ã€ã©ã‚Œãã‚‰ã„é›†ç´„ã§ãã‚‹ã‚“ã§ã—ã‚‡ã†ã‹ã­ï¼Ÿ</p><h1 id="é›†ç´„ã™ã‚‹åŸºæº–"><a href="#é›†ç´„ã™ã‚‹åŸºæº–" class="headerlink" title="é›†ç´„ã™ã‚‹åŸºæº–"></a>é›†ç´„ã™ã‚‹åŸºæº–</h1><p>ã¾ãšã€é›†ç´„ã™ã‚‹åŸºæº–ã‚’æ±ºã‚ã¦ãŠãã¾ã™ã€‚<br>ã‹ãªã‚Šæ„Ÿè¦šè«–ã§ã™ã—ã€ã‚µãƒ¼ãƒ“ã‚¹ã®ç¨®é¡ã‚„ä½œã‚Šã«ã‚‚å½“ç„¶ä¾å­˜ã—ã¾ã™ãŒã€å¤§ä½“ç§ã®çµŒé¨“ä¸Šã¯ã“ã‚Œãã‚‰ã„ã§ã™ã€‚</p><table><thead><tr><th align="left">ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·</th><th align="left">æ—¥å¸¸ä½¿ç”¨ã§åŒç¨‹åº¦ãªãƒ¢ãƒ</th><th align="left">ä½“æ„Ÿ</th></tr></thead><tbody><tr><td align="left">20ms ä»¥ä¸‹</td><td align="left">å›ºå®šã®å…‰å›ç·š</td><td align="left">ã¨ã¦ã‚‚é€Ÿã„ã€‚ã•ãã•ã</td></tr><tr><td align="left">60ms ä»¥ä¸‹</td><td align="left">ã‚¹ãƒãƒ›4Gãã‚‰ã„</td><td align="left">ã¾ãã“ã‚Œãã‚‰ã„ã¯æˆ‘æ…¢å‡ºæ¥ã‚‹</td></tr><tr><td align="left">ãã‚Œä»¥ä¸Š</td><td align="left">4Gã§é…ã„æ™‚/3Gåˆ©ç”¨ãªã©</td><td align="left">ã“ã‚Œã¯é…ã„â€¦ä½¿ã„ãŸããªã„</td></tr></tbody></table><p>ãªã®ã§ã€<strong><code>60ms</code> ã¾ã§ã¯é›†ç´„å¯èƒ½</strong>ã¨åˆ¤æ–­ã™ã‚‹äº‹ã«ã—ã¾ã™ã€‚<br>â€»é‡ã­ã¦ã«ãªã‚Šã¾ã™ãŒã€æä¾›ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®ç¨®é¡/ä½œã‚Šã«ã“ã®åŸºæº–ã¯å¤§ããä¾å­˜ã—ã¾ã™ã€‚éŸ³å£°ç³»ãƒ»æ˜ åƒç³»ã ã¨é…ã„ã¨è‡´å‘½çš„ãªå½±éŸ¿ã‚’å—ã‘ã¾ã™ãŒã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒã®æ§˜ãªã‚µãƒ¼ãƒ“ã‚¹ã ã¨ã‚‚ã†å°‘ã—åŸºæº–ã‚’ä¸‹ã’ã‚‰ã‚Œã‚‹ã€ãªã©ã¯ã‚ã‚Šå¾—ã¾ã™ã€‚</p><h1 id="GCP-ã®å…¨-Region-é–“ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’è¨ˆæ¸¬ã™ã‚‹"><a href="#GCP-ã®å…¨-Region-é–“ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’è¨ˆæ¸¬ã™ã‚‹" class="headerlink" title="GCP ã®å…¨ Region é–“ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’è¨ˆæ¸¬ã™ã‚‹"></a>GCP ã®å…¨ Region é–“ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’è¨ˆæ¸¬ã™ã‚‹</h1><h3 id="è¨ˆæ¸¬å¯¾è±¡"><a href="#è¨ˆæ¸¬å¯¾è±¡" class="headerlink" title="è¨ˆæ¸¬å¯¾è±¡"></a>è¨ˆæ¸¬å¯¾è±¡</h3><p>ã“ã¡ã‚‰ã® <a href="https://cloud.google.com/compute/docs/regions-zones?hl=ja" target="_blank" rel="noopener">Compute Engine ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã‚¾ãƒ¼ãƒ³</a> ã«è¨˜è¼‰ã®å…¨Region ã‚’å¯¾è±¡ã«ã—ã¾ã™ã€‚<br>â€»ã™ã„ã¾ã›ã‚“ã€ãƒ ãƒ³ãƒã‚¤ã ã‘ã€QuotaãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§CPUS:0ã¨ãªã£ã¦ãŠã‚Šã€ä¸Šã’ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡ºã—ãŸã‚“ã§ã™ãŒã€æ‹’å¦ã•ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸã€‚ãã®é–¢ä¿‚ã§ã€ãƒ ãƒ³ãƒã‚¤ã ã‘è¨ˆæ¸¬ãŒå‡ºæ¥ã¾ã›ã‚“ã§ã—ãŸğŸ™‡â€â™‚ï¸<br><img src="/images/20200813/2020-08-02_233921.png" alt=""></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><ul><li>ãƒ•ãƒ«ãƒ¡ãƒƒã‚·ãƒ¥ã§è¨ˆæ¸¬</li><li>Ping ã‚’ 100ms æ¯ã« 100 å›æ‰“ã£ã¦ã€ãã®è¿”ç­”ã®å¹³å‡å€¤</li></ul><p>â€»ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ§‹ç¯‰ã®ãŸã‚ã® <code>Terraform</code> ã‚³ãƒ¼ãƒ‰ã€è¨ˆæ¸¬ã®ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯Appendixã«è¼‰ã›ã¦ãŠãã¾ã™ã€‚<br>ã€€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä¸¦åˆ—å‡¦ç†ã‚’ã™ã‚‹ã¹ãã§ã—ãŸã€‚ãã“ã¯ã¡ã‚‡ã£ã¨ä½œã‚Šè¶³ã‚Šãªã„æ„ŸãŒã‚ã‚Šã¾ã™ã€‚</p><h3 id="è¨ˆæ¸¬çµæœ"><a href="#è¨ˆæ¸¬çµæœ" class="headerlink" title="è¨ˆæ¸¬çµæœ"></a>è¨ˆæ¸¬çµæœ</h3><p>è¨ˆæ¸¬çµæœã¯ä»¥ä¸‹ã§ã™ã€‚</p><ul><li>é’ï¼š20msã€‚ã‚µã‚¯ã‚µã‚¯</li><li>é»„ï¼š60msã€‚ã‚®ãƒªã‚®ãƒªæˆ‘æ…¢ã§ãã‚‹ãƒ¬ãƒ™ãƒ«</li><li>èµ¤ï¼šãã‚Œä»¥ä¸Šã€‚ã“ã‚Œã¯ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ã¯ã‚ˆã‚ã—ããªã„<br><img src="/images/20200813/2020-08-02_231622.jpg" alt=""></li></ul><h1 id="è€ƒå¯Ÿ"><a href="#è€ƒå¯Ÿ" class="headerlink" title="è€ƒå¯Ÿ"></a>è€ƒå¯Ÿ</h1><p>è€ƒå¯Ÿã«å½“ãŸã£ã¦ã¯ã€å°‘ã—ã‚’å‰æã‚’ç½®ãã¾ã™ã€‚</p><ul><li>å¯¾è±¡ã¨ãªã‚‹ä¼æ¥­ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹ã—ã¦ã„ã‚‹æ—¥æœ¬ä¼æ¥­ï¼ˆ<code>Japanese Multinational Corporations</code>ï¼‰ã§ã‚ã‚Šã€Japan ã« Global Headquarters(<code>GHQ</code>) ãŒå­˜åœ¨ã™ã‚‹ã€‚<ul><li>äººæ•°çš„ã«ã¯ã€Japan ãŒæœ€ã‚‚å¾“æ¥­å“¡/é¡§å®¢ãŒå¤šã„ã€‚</li></ul></li><li>å„å›½ã®æ”¯ç¤¾/æ”¯éƒ¨ãŒã‚¤ãƒ³ãƒˆãƒ©ãƒãƒƒãƒˆã‚’é€šã˜ã¦ç¤¾å†…å‘ã‘ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚</li></ul><p>å‰²ã¨ç¾å®Ÿçš„ãªå‰æã§ã™ã‚ˆã­ã€‚ãã®å‰æã‚’å…ƒã«ã€è€ƒãˆã‚‹ã¨ã€ä»¥ä¸‹ã®æ§˜ã«ãªã‚Šã¾ã™ã€‚</p><ul><li>æ±äº¬ï¼šæ—¥æœ¬/éŸ“å›½/å°æ¹¾/é¦™æ¸¯ã‚’é›†ç´„ï¼ˆå°æ¹¾/é¦™æ¸¯ã¯ã€é¦™æ¸¯ã«åˆ¥ã ã—ã§ã‚‚è‰¯ã„ç§’æ•°ï¼‰<ul><li>GHQãŒã‚ã‚‹ã®ã§ã€ã¾ãšã¯ã‚³ã‚³ã‚’èµ·ç‚¹ã«è€ƒãˆã¾ã™ã€‚</li></ul></li><li>ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ï¼šæ±å—ã‚¢ã‚¸ã‚¢åœ°åŸŸã‚’ã‚«ãƒãƒ¼</li><li>ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ï¼šã‚ªã‚»ã‚¢ãƒ‹ã‚¢åœ°åŸŸã€‚ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã¾ã§çµæ§‹é ã„ã‚“ã§ã™ã­ã€‚</li><li>ãƒ‰ã‚¤ãƒ„ï¼šãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘åœ°åŸŸã€‚ï¼ˆåŒ—æ¬§ã ã‘ã¯åˆ¥ã ã—ã§ã‚‚è‰¯ã„ç§’æ•°ï¼‰</li><li>ç±³å›½ã‚¢ã‚¤ã‚ªãƒ¯ï¼šåŒ—ã‚¢ãƒ¡ãƒªã‚«åœ°åŸŸã€‚ï¼ˆæ±è¥¿ã§åˆ†ã‘ã¦ã‚‚è‰¯ã„ç§’æ•°ï¼‰</li><li>ãƒ–ãƒ©ã‚¸ãƒ«</li></ul><p>ã¾ãã€ãªã‚“ã¦ã„ã†ã‹ã€‚ã€‚ã€‚ã€ã¾ããã†ã ã‚ˆã­ã€æ„Ÿã®ã‚ã‚‹è€ƒå¯Ÿã«ãªã‚Šã¾ã™ã­ã€‚ã€‚ã€‚<br>å®Ÿéš›ã€ã“ã‚Œãã‚‰ã„ã‚’ãƒ™ãƒ¼ã‚¹ã«ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é›†ç´„ã—ã¦ã„ã‚‹äº‹ãŒå¤šã„ã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚ãã“ã«å¯¾ã—ã¦ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã¨ã„ã†è¦³ç‚¹ã§ã®ä¸€ã¤ã®è£ä»˜ã‘ã«ã¯ãªã£ãŸã‹ãªã¨æ€ã„ã¾ã™ã€‚</p><h1 id="çµ‚ã‚ã‚Šã«"><a href="#çµ‚ã‚ã‚Šã«" class="headerlink" title="çµ‚ã‚ã‚Šã«"></a>çµ‚ã‚ã‚Šã«</h1><p>ä»Šå›ã¯ã€è‡ªç”±ç ”ç©¶ã€ã¨ã„ã†äº‹ã§ã€æ—¥é ƒä½¿ã£ã¦ã„ã‚‹ãƒ„ãƒ¼ãƒ«ã«é–¢ã—ã¦ã€å°‘ã—æ·±æ˜ã£ã¦ã¿ã¾ã—ãŸã€‚<br>ä»–ã«ã‚‚ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«é–¢ã™ã‚‹è€ƒå¯Ÿã‚„ã€Peering, HA VPN ã®ä½¿ã„åˆ†ã‘ã«é–¢ã™ã‚‹è€ƒå¯Ÿã‚‚è‡ªåˆ†ã®ä¸­ã§ã¯ã‚ã‚‹ã®ã§ã€ã©ã“ã‹ã§æ·±å €ã‚Šã—ã¦ã„ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚</p><h1 id="ã¤ã„ã§ã«-GCPã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã«ã¤ã„ã¦"><a href="#ã¤ã„ã§ã«-GCPã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã«ã¤ã„ã¦" class="headerlink" title="ã¤ã„ã§ã«(GCPã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã«ã¤ã„ã¦)"></a>ã¤ã„ã§ã«(GCPã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã«ã¤ã„ã¦)</h1><p>ç†è«–å€¤ã¨ã„ã†ã‹ã€UDPãƒ™ãƒ¼ã‚¹ã§ã¯ã“ã®æ§˜ã«ãªã‚Šã¾ã™ã€‚</p><ul><li>Region é–“ï¼š<code>2Gbps</code> ãŒä¸Šé™</li><li>åŒä¸€Regionï¼š<code>2Gbps/CPU</code> ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ãŒã€ä¸Šé™ã¯ 8CPU ã® <code>16Gbps</code><ul><li>n1-standard-1 : <code>2 Gbps</code></li><li>n1-standard-4 : <code>8 Gbps</code></li><li>n1-standard-8 : <code>16 Gbps</code>ï¼ˆä»¥é™ã€CPUã‚’å¢—ã‚„ã—ã¦ã‚‚ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã¯å¢—ãˆãªã„ï¼‰</li></ul></li></ul><p>â€»TCP ãƒ™ãƒ¼ã‚¹ã ã¨ã€TCPã®ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡ã®é–¢ä¿‚ã§ä¸Šè¨˜ã»ã©ã®æ•°å€¤ã‚’å‡ºã™ãŸã‚ã«ã¯OSã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¿æ•´ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚</p><h1 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h1><h2 id="Terraform-ã‚³ãƒ¼ãƒ‰"><a href="#Terraform-ã‚³ãƒ¼ãƒ‰" class="headerlink" title="Terraform ã‚³ãƒ¼ãƒ‰"></a>Terraform ã‚³ãƒ¼ãƒ‰</h2><figure class="highlight sh"><figcaption><span>gce.tf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">resource <span class="string">"google_compute_instance"</span> <span class="string">"GCE_instances"</span> &#123;</span><br><span class="line">  count        = length(local.gce_instances_list)</span><br><span class="line">  name         = local.gce_instances_list[count.index].name</span><br><span class="line">  machine_type = <span class="string">"f1-micro"</span></span><br><span class="line">  zone         = local.gce_instances_list[count.index].zone</span><br><span class="line">  project      = local.project.id</span><br><span class="line"></span><br><span class="line">  boot_disk &#123;</span><br><span class="line">    auto_delete = <span class="literal">false</span></span><br><span class="line">    <span class="built_in">source</span>      = google_compute_disk.GCE_disks[count.index].self_link</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  network_interface &#123;</span><br><span class="line">    network = google_compute_network.test_network.name</span><br><span class="line">    access_config &#123;</span><br><span class="line">      // Ephemeral IP</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  service_account &#123;</span><br><span class="line">    email  = google_service_account.nw_tester.email</span><br><span class="line">    scopes = [<span class="string">"cloud-platform"</span>]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  metadata = &#123;</span><br><span class="line">    <span class="built_in">enable</span>-oslogin = <span class="string">"true"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource <span class="string">"google_compute_disk"</span> <span class="string">"GCE_disks"</span> &#123;</span><br><span class="line">  count   = length(local.gce_instances_list)</span><br><span class="line">  name    = <span class="string">"<span class="variable">$&#123;local.gce_instances_list[count.index].name&#125;</span>-disk"</span></span><br><span class="line">  project = local.project.id</span><br><span class="line">  zone    = local.gce_instances_list[count.index].zone</span><br><span class="line">  <span class="built_in">type</span>    = <span class="string">"pd-standard"</span></span><br><span class="line">  size    = 20</span><br><span class="line">  image   = <span class="string">"centos-cloud/centos-8"</span></span><br><span class="line"></span><br><span class="line">  lifecycle &#123;</span><br><span class="line">    ignore_changes = [labels]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight sh"><figcaption><span>network.tf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">resource <span class="string">"google_compute_network"</span> <span class="string">"test_network"</span> &#123;</span><br><span class="line">  project                 = local.project.id</span><br><span class="line">  name                    = <span class="string">"test-network"</span></span><br><span class="line">  auto_create_subnetworks = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource <span class="string">"google_compute_firewall"</span> <span class="string">"ingress_test_network_iap"</span> &#123;</span><br><span class="line">  project = local.project.id</span><br><span class="line">  name    = <span class="string">"ingress-test-network-iap"</span></span><br><span class="line">  network = google_compute_network.test_network.self_link</span><br><span class="line"></span><br><span class="line">  direction = <span class="string">"INGRESS"</span></span><br><span class="line">  priority  = 1000</span><br><span class="line"></span><br><span class="line">  allow &#123;</span><br><span class="line">    protocol = <span class="string">"tcp"</span></span><br><span class="line">    ports    = [<span class="string">"22"</span>]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  source_ranges = [<span class="string">"35.235.240.0/20"</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource <span class="string">"google_compute_firewall"</span> <span class="string">"ingress_test_network_internal"</span> &#123;</span><br><span class="line">  project = local.project.id</span><br><span class="line">  name    = <span class="string">"ingress-test-network-internal"</span></span><br><span class="line">  network = google_compute_network.test_network.self_link</span><br><span class="line"></span><br><span class="line">  direction = <span class="string">"INGRESS"</span></span><br><span class="line">  priority  = 1000</span><br><span class="line"></span><br><span class="line">  allow &#123;</span><br><span class="line">    protocol = <span class="string">"all"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  source_ranges = [<span class="string">"10.0.0.0/8"</span>, <span class="string">"172.16.0.0/12"</span>, <span class="string">"192.168.0.0/16"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight sh"><figcaption><span>service_account.tf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">resource <span class="string">"google_service_account"</span> <span class="string">"nw_tester"</span> &#123;</span><br><span class="line">  project      = local.project.id</span><br><span class="line">  account_id   = <span class="string">"nw-tester"</span></span><br><span class="line">  display_name = <span class="string">"nw-tester"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource <span class="string">"google_project_iam_member"</span> <span class="string">"nw_tester"</span> &#123;</span><br><span class="line">  project = local.project.id</span><br><span class="line">  member  = <span class="string">"serviceAccount:<span class="variable">$&#123;google_service_account.nw_tester.email&#125;</span>"</span></span><br><span class="line">  role    = <span class="string">"roles/compute.viewer"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight sh"><figcaption><span>veriable.tf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">locals &#123;</span><br><span class="line">  project = &#123;</span><br><span class="line">    id = <span class="string">"project_id"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // GCE Instances</span><br><span class="line">  gce_instance_name = <span class="string">"instance-test-nsd"</span></span><br><span class="line">  gce_instances_list = [</span><br><span class="line">    &#123; region = <span class="string">"asia-northeast1"</span>, zone = <span class="string">"asia-northeast1-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-northeast1-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"asia-northeast1"</span>, zone = <span class="string">"asia-northeast1-b"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-northeast1-b"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"asia-northeast1"</span>, zone = <span class="string">"asia-northeast1-c"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-northeast1-c"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"asia-northeast2"</span>, zone = <span class="string">"asia-northeast2-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-northeast2-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"asia-northeast3"</span>, zone = <span class="string">"asia-northeast3-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-northeast3-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"asia-east1"</span>, zone = <span class="string">"asia-east1-b"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-east1-b"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"asia-east2"</span>, zone = <span class="string">"asia-east2-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-east2-a"</span> &#125;,</span><br><span class="line">//    &#123; region = <span class="string">"asia-south1"</span>, zone = <span class="string">"asia-south1-c"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-south1-c"</span> &#125;, </span><br><span class="line">    &#123; region = <span class="string">"asia-southeast1"</span>, zone = <span class="string">"asia-southeast1-b"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-southeast1-b"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"asia-southeast2"</span>, zone = <span class="string">"asia-southeast2-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-asia-southeast2-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"australia-southeast1"</span>, zone = <span class="string">"australia-southeast1-b"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-australia-southeast1-b"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"europe-north1"</span>, zone = <span class="string">"europe-north1-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-europe-north1-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"europe-west1"</span>, zone = <span class="string">"europe-west1-b"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-europe-west1-b"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"europe-west2"</span>, zone = <span class="string">"europe-west2-c"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-europe-west2-c"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"europe-west3"</span>, zone = <span class="string">"europe-west3-c"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-europe-west3-c"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"europe-west4"</span>, zone = <span class="string">"europe-west4-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-europe-west4-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"europe-west6"</span>, zone = <span class="string">"europe-west6-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-europe-west6-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"northamerica-northeast1"</span>, zone = <span class="string">"northamerica-northeast1-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-northamerica-northeast1-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"southamerica-east1"</span>, zone = <span class="string">"southamerica-east1-b"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-southamerica-east1-b"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"us-central1"</span>, zone = <span class="string">"us-central1-c"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-us-central1-c"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"us-east1"</span>, zone = <span class="string">"us-east1-b"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-us-east1-b"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"us-east4"</span>, zone = <span class="string">"us-east4-c"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-us-east4-c"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"us-west1"</span>, zone = <span class="string">"us-west1-b"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-us-west1-b"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"us-west2"</span>, zone = <span class="string">"us-west2-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-us-west2-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"us-west3"</span>, zone = <span class="string">"us-west3-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-us-west3-a"</span> &#125;,</span><br><span class="line">    &#123; region = <span class="string">"us-west4"</span>, zone = <span class="string">"us-west4-a"</span>, name = <span class="string">"<span class="variable">$&#123;local.gce_instance_name&#125;</span>-us-west4-a"</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight sh"><figcaption><span>versions.tf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">terraform &#123;</span><br><span class="line">  required_version = <span class="string">"&gt;= 0.12"</span></span><br><span class="line">&#125;</span><br><span class="line">provider <span class="string">"google"</span> &#123;</span><br><span class="line">  version = <span class="string">"~&gt; 3.30.0"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å„ç¨®script"><a href="#å„ç¨®script" class="headerlink" title="å„ç¨®script"></a>å„ç¨®script</h2><figure class="highlight sh"><figcaption><span>ping-all-instances-in-VPC.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">project_name=<span class="string">""</span></span><br><span class="line">vpc_name=<span class="string">"test-network"</span></span><br><span class="line">ping_count=100</span><br><span class="line">src_host=`hostname`</span><br><span class="line">src_zone=`gcloud compute instances list --filter <span class="string">"NAME=<span class="variable">$&#123;src_host&#125;</span>"</span> --format=<span class="string">"csv(ZONE)"</span> | sed <span class="string">'1d'</span>`</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;src_host&#125;</span> at `date +<span class="string">"%Y-%m-%d %H:%M:%S.%3N"</span>`</span><br><span class="line"></span><br><span class="line">gce_list=`gcloud compute instances list --filter <span class="string">"networkInterfaces[].network:<span class="variable">$&#123;vpc_name&#125;</span>"</span> --format=<span class="string">"csv(NAME,ZONE,INTERNAL_IP)"</span> | sed <span class="string">'1d'</span>`</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> gce <span class="keyword">in</span> <span class="variable">$&#123;gce_list&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  dst_host=`<span class="built_in">echo</span> <span class="variable">$&#123;gce&#125;</span> | cut -d <span class="string">','</span> -f 1` </span><br><span class="line">  dst_zone=`<span class="built_in">echo</span> <span class="variable">$&#123;gce&#125;</span> | cut -d <span class="string">','</span> -f 2`</span><br><span class="line">  dest_ip=`<span class="built_in">echo</span> <span class="variable">$&#123;gce&#125;</span> | cut -d <span class="string">','</span> -f 3`</span><br><span class="line">  rs_ping=`sudo ping -i0.1 <span class="variable">$&#123;dest_ip&#125;</span> -c <span class="variable">$&#123;ping_count&#125;</span> -q`</span><br><span class="line">  avg=`<span class="built_in">echo</span> <span class="variable">$&#123;rs_ping&#125;</span> | sed -r <span class="string">'s/.*rtt min\/avg\/max\/mdev = (.+?)\/(.+?)\/(.+?)\/(.+?)$/\2/'</span>`</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$&#123;src_host&#125;</span>,<span class="variable">$&#123;src_zone&#125;</span>,<span class="variable">$&#123;dst_host&#125;</span>,<span class="variable">$&#123;dst_zone&#125;</span>,<span class="variable">$&#123;dest_ip&#125;</span>,<span class="variable">$&#123;avg&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><figcaption><span>sh-exec.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Started at `date +<span class="string">"%Y-%m-%d %H:%M:%S.%3N"</span>`</span><br><span class="line"></span><br><span class="line">project_name=<span class="string">""</span></span><br><span class="line">vpc_name=<span class="string">"test-network"</span></span><br><span class="line">shell_file=<span class="string">"ping-all-instances-in-VPC.sh"</span></span><br><span class="line"></span><br><span class="line">format=<span class="string">"csv(NAME,ZONE,INTERNAL_IP)"</span></span><br><span class="line">gce_list=`gcloud compute instances list --filter <span class="string">"networkInterfaces[].network:<span class="variable">$&#123;vpc_name&#125;</span>"</span> --format=<span class="string">"csv(NAME,ZONE)"</span> | sed <span class="string">'1d'</span>`</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> gce <span class="keyword">in</span> <span class="variable">$&#123;gce_list&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  host=`<span class="built_in">echo</span> <span class="variable">$&#123;gce&#125;</span> | cut -d <span class="string">','</span> -f 1` </span><br><span class="line">  zone=`<span class="built_in">echo</span> <span class="variable">$&#123;gce&#125;</span> | cut -d <span class="string">','</span> -f 2`</span><br><span class="line"></span><br><span class="line">  gcloud compute scp <span class="variable">$&#123;shell_file&#125;</span> <span class="variable">$&#123;host&#125;</span>:~/<span class="variable">$&#123;shell_file&#125;</span> --zone <span class="variable">$&#123;zone&#125;</span> --tunnel-through-iap</span><br><span class="line">  <span class="built_in">wait</span></span><br><span class="line">  gcloud compute ssh <span class="variable">$&#123;host&#125;</span> --<span class="built_in">command</span>=<span class="string">"sh ~/<span class="variable">$&#123;shell_file&#125;</span>"</span> --zone <span class="variable">$&#123;zone&#125;</span> --tunnel-through-iap</span><br><span class="line">  <span class="built_in">wait</span></span><br><span class="line">  gcloud compute ssh <span class="variable">$&#123;host&#125;</span> --<span class="built_in">command</span>=<span class="string">"rm ~/<span class="variable">$&#123;shell_file&#125;</span>"</span> --zone <span class="variable">$&#123;zone&#125;</span> --tunnel-through-iap</span><br><span class="line">  <span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> Finished at `date +<span class="string">"%Y-%m-%d %H:%M:%S.%3N"</span>`</span><br></pre></td></tr></table></figure><h1 id="ä½¿ã„æ–¹"><a href="#ä½¿ã„æ–¹" class="headerlink" title="ä½¿ã„æ–¹"></a>ä½¿ã„æ–¹</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh sh-exec.sh</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://future-architect.github.io/articles/20200726/&quot;&gt;ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶é€£è¼‰&lt;/a&gt;ã®9å›ç›®ã§ã™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;a href=&quot;#ã¯ã˜ã‚ã«&quot; class=&quot;heade
      
    
    </summary>
    
    
      <category term="Infrastructure" scheme="https://future-architect.github.io/categories/Infrastructure/"/>
    
    
      <category term="Network" scheme="https://future-architect.github.io/tags/Network/"/>
    
      <category term="GCP" scheme="https://future-architect.github.io/tags/GCP/"/>
    
      <category term="Terraform" scheme="https://future-architect.github.io/tags/Terraform/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
  </entry>
  
  <entry>
    <title>Marpã§ä¼šç¤¾ã®ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ä½œã£ã¦ã¿ã‚‹</title>
    <link href="https://future-architect.github.io/articles/20200812/"/>
    <id>https://future-architect.github.io/articles/20200812/</id>
    <published>2020-08-11T15:00:00.000Z</published>
    <updated>2020-08-13T03:47:35.687Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/20200812/marp.png" alt=""></p><p><a href="https://future-architect.github.io/articles/20200726/">ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶é€£è¼‰</a>ã®8å›ç›®ã§ã™ã€‚</p><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>ã“ã‚“ã«ã¡ã¯ã€‚åŠ è—¤å‘¨å¹³ã§ã™ã€‚</p><p>ã¿ãªã•ã‚“ã€Marpã¯ã”å­˜ã˜ã§ã—ã‚‡ã†ã‹ï¼Ÿ</p><p>Marpã¨ã¯ã€Markdownè¨˜è¿°å½¢å¼ã§ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ä½œæˆã™ã‚‹ãŒã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚VSCodeã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã§ã€VSCodeä¸Šã§ã‚¹ãƒ©ã‚¤ãƒ‰ã®ä½œæˆã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã¾ã•ã«ã‚ã£ãŸã‚‰ã„ã„ãªãŒå…·ç¾åŒ–ã—ãŸã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã‚‚ã¡ã‚ã‚“ã€Marpã‹ã‚‰ä½œæˆã•ã‚ŒãŸã‚¹ãƒ©ã‚¤ãƒ‰ã¯ãƒ‘ãƒ¯ãƒã§ã®å†ç·¨é›†ã‚‚å¯èƒ½ã§ã€éª¨å­ã¥ãã‚Šã¯Marpã€ä»•ä¸Šã’ã¯ãƒ‘ãƒ¯ãƒã€ãªã‚“ã¦åˆã‚ã›æŠ€ã‚‚è¡Œãˆã¾ã™ã€‚</p><p>ä»Šå›ã¯ãã‚“ãª<a href="https://marp.app/" target="_blank" rel="noopener">Marp</a>ã‚’æ¥­å‹™ã§ã‚‚å¹³å¸¸åˆ©ç”¨ã§ãã‚‹çŠ¶æ…‹ã«æŒã£ã¦ã„ãã¹ãã€ã‚¹ãƒ©ã‚¤ãƒ‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä»•è¾¼ã¿ã‚’ã‚„ã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚</p><p>â€»åŸºæœ¬çš„ãªMarpã®ç†è§£ã‚„åˆ©ç”¨æ–¹æ³•ã¯ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚<br><a href="https://qiita.com/tomo_makes/items/aafae4021986553ae1d8" target="_blank" rel="noopener">ã€VS Code + Marpã€‘Markdownã‹ã‚‰çˆ†é€Ÿãƒ»è‡ªç”±è‡ªåœ¨ãªãƒ‡ã‚¶ã‚¤ãƒ³ã§ã€ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ä½œã‚‹</a></p><h2 id="ç›®æŒ‡ã™ã¨ã“ã‚"><a href="#ç›®æŒ‡ã™ã¨ã“ã‚" class="headerlink" title="ç›®æŒ‡ã™ã¨ã“ã‚"></a>ç›®æŒ‡ã™ã¨ã“ã‚</h2><p>ã“ã‚“ãªã®ã‚’Marpä¸Šã§ã‚‚å†ç¾ã§ããªã„ã‹ã€ã¨ã„ã†ã®ã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚<br>â€»å®Ÿéš›ã«ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ã§åˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚¹ãƒ©ã‚¤ãƒ‰ã¨ã¯ç•°ãªã‚Šã¾ã™ã€‚</p><p><img src="/images/20200812/template.png" alt=""></p><h2 id="Marpã‚’VSCodeã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"><a href="#Marpã‚’VSCodeã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" class="headerlink" title="Marpã‚’VSCodeã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"></a>Marpã‚’VSCodeã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2><p>VSCodeã‚’é–‹ã„ã¦æ‹¡å¼µæ©Ÿèƒ½ã‹ã‚‰ã€ŒMarp for VSCodeã€ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚<br><img src="/images/20200812/vscode.png" alt=""></p><h2 id="themeã®ä½œæˆ"><a href="#themeã®ä½œæˆ" class="headerlink" title="themeã®ä½œæˆ"></a>themeã®ä½œæˆ</h2><h3 id="CSSãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ"><a href="#CSSãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ" class="headerlink" title="CSSãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ"></a>CSSãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ</h3><p>ä»Šå›ã¯ã€Œfuture.cssã€ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ä¸Šã«ä½œæˆã—ã¾ã—ãŸã€‚</p><h3 id="ãƒ‘ã‚¹ã‚’é€šã™"><a href="#ãƒ‘ã‚¹ã‚’é€šã™" class="headerlink" title="ãƒ‘ã‚¹ã‚’é€šã™"></a>ãƒ‘ã‚¹ã‚’é€šã™</h3><p><code>Ctrl + ,</code>ã§è¨­å®šã‚’é–‹ãã€<code>Markdown: Styles</code>ã«ä½œæˆã—ãŸCSSãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚<br><img src="/images/20200812/path.png" alt=""></p><p>ç¶šã„ã¦<code>Markdown&gt; Marp:Themes</code>ã«CSSã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è¨˜è¼‰ã—ã¾ã™ã€‚<br><img src="/images/20200812/add_css_file.png" alt=""></p><p><code>template.md</code>ã®<code>front-matter</code>ã«ä»¥ä¸‹ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">marp:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">future</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>ã“ã‚Œã§CSSãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®ç´ã¥ã‘ãŒå®Œäº†ã§ã™ã€‚</p><h3 id="ãƒ†ãƒ³ãƒ—ãƒ¬ä½œã‚Š"><a href="#ãƒ†ãƒ³ãƒ—ãƒ¬ä½œã‚Š" class="headerlink" title="ãƒ†ãƒ³ãƒ—ãƒ¬ä½œã‚Š"></a>ãƒ†ãƒ³ãƒ—ãƒ¬ä½œã‚Š</h3><p>ã‚ã¨ã¯ã²ãŸã™ã‚‰CSSã‚’æ›¸ã„ã¦ã„ãã ã‘ã§ã™ã€‚<br>çµæœã¯ã“ã†ãªã‚Šã¾ã—ãŸã€‚</p><p><img src="/images/20200812/image.png" alt=""></p><p>ã†ï½ã‚“ã€‚ã€‚ã€‚ã½ã„ã€ã‘ã©é ã„ã€‚ã€‚</p><p>ã‚³ãƒ¼ãƒ‰ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚</p><p><code>template.md</code>ã¯ä»¥ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">marp:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">future</span></span><br><span class="line"><span class="attr">header:</span> <span class="string">future</span></span><br><span class="line"><span class="attr">footer:</span> <span class="string">Footer</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã—ãŸ</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p><code>future.css</code>ã¯ä»¥ä¸‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* @theme future */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@import</span> <span class="string">'default'</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">section</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">1920px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">1080px</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">40px</span>;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">40px</span>;</span><br><span class="line"><span class="attribute">background-image</span>: <span class="built_in">url</span>(./logo.png);</span><br><span class="line"><span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line"><span class="attribute">background-position</span>: right top;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">header</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">1px</span>;</span><br><span class="line"><span class="attribute">color</span>: palevioletred;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, palevioletred, white);</span><br><span class="line"><span class="attribute">top</span>: <span class="number">120px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">footer</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">background-color</span>: silver;</span><br><span class="line"><span class="attribute">color</span>: black;</span><br><span class="line"><span class="attribute">text-align</span>: left;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line"><span class="attribute">font-style</span>: oblique;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">90px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#09c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ã‚‚ã‚„ã£ã¨ã—ãŸã“ã¨-æ¬¡å›ã¸ã®çŸ¥è¦‹"><a href="#ã‚‚ã‚„ã£ã¨ã—ãŸã“ã¨-æ¬¡å›ã¸ã®çŸ¥è¦‹" class="headerlink" title="ã‚‚ã‚„ã£ã¨ã—ãŸã“ã¨/æ¬¡å›ã¸ã®çŸ¥è¦‹"></a>ã‚‚ã‚„ã£ã¨ã—ãŸã“ã¨/æ¬¡å›ã¸ã®çŸ¥è¦‹</h3><ul><li>headerã¯æ–‡å­—åˆ—ä¸è¦ã ã£ãŸã®ã§ã™ãŒã€mdã®<code>front-matter</code>ã«ã¦ç©ºæ–‡å­—ã§headerã‚’å®£è¨€ã™ã‚‹ã“ã¨ãŒã§ããšã€ã—ã‹ãŸãªã<code>future</code>æ–‡å­—åˆ—ã‚’è¨˜è¼‰ï¼†backgroundã®è‰²ã«åˆã‚ã›ã¦éš ã—ã¦ã„ã¾ã™</li><li>footerã‚„headerã‚¯ãƒ©ã‚¹ã‚’è¤‡æ•°å®£è¨€ã™ã‚‹æ–¹æ³•ãŒåˆ†ã‹ã‚‰ãšã€ãƒ•ãƒƒã‚¿ãƒ¼ã®ãƒšãƒ¼ã‚¸ç•ªå·ã®å®Ÿè£…ã¾ã§ã§ãã¾ã›ã‚“ã§ã—ãŸï¼ˆæœ¬å½“ã¯footerã‚’è¤‡æ•°é‡ã­ã¦è¡¨ç¾ã—ãŸã‹ã£ãŸï¼‰</li><li>ä»Šå›ã¯CSSã®æ–¹ã§<code>@import default</code>ã‚’å®£è¨€ã—ã€Marpã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ã‚¹ãƒ©ã‚¤ãƒ‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ã®ä¸Šã«Futureã‚¹ãƒ©ã‚¤ãƒ‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ä½œã£ã¦ã„ãã€ã¨ã„ã†ã‚ˆã†ãªä½œæ¥­ã‚’è¡Œã„ã¾ã—ãŸã€‚å®Ÿéš›ã«ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ä½œæˆï¼†ç¤¾å†…é…å¸ƒã™ã‚‹ã“ã¨ã‚’è€ƒãˆãŸæ™‚ã«ã¯importã›ãšã«1ã‹ã‚‰ä½œã£ã¦ã„ãæ–¹ãŒç¶ºéº—ã‹ãªã¨æ€ã„ã¾ã—ãŸ</li></ul><h3 id="çµ‚ã‚ã‚Šã«"><a href="#çµ‚ã‚ã‚Šã«" class="headerlink" title="çµ‚ã‚ã‚Šã«"></a>çµ‚ã‚ã‚Šã«</h3><p>å¤§ã—ãŸé‡ã‚’æ›¸ã„ã¦ã¾ã›ã‚“ãŒCSSã‚’è§¦ã‚‹ã®ã¯æ–°äººç ”ä¿®ã¶ã‚Šã ã£ãŸã®ã§å‹‰å¼·ã«ãªã‚Šã¾ã—ãŸã€‚</p><p>Markdownã§è¨˜è¼‰ã—ãŸã‚‚ã®ãŒã™ãã‚¹ãƒ©ã‚¤ãƒ‰ã«åæ˜ ã•ã‚Œã‚‹æŒ™å‹•ã¯è»½å¿«ã§ã€æ“ä½œã—ã¦ã„ã¦ã‹ãªã‚Šæ°—æŒã¡ãŒè‰¯ã‹ã£ãŸã§ã™ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/20200812/marp.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://future-architect.github.io/articles/20200726/&quot;&gt;ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶é€£è¼‰&lt;/a&gt;ã®8
      
    
    </summary>
    
    
      <category term="Design" scheme="https://future-architect.github.io/categories/Design/"/>
    
    
      <category term="VSCode" scheme="https://future-architect.github.io/tags/VSCode/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
      <category term="Marp" scheme="https://future-architect.github.io/tags/Marp/"/>
    
      <category term="CSS" scheme="https://future-architect.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>ãƒ€ã‚¤ã‚¨ãƒƒãƒˆé£Ÿã®ãƒ–ãƒ¬ã‚¤ã‚¯ã‚¹ãƒ«ãƒ¼ï¼ä½æ¸©èª¿ç†å™¨ã‚’è‡ªä½œã—ã¦é¶ã‚€ã­è‚‰ã‚’ç¾å‘³ã—ãé£Ÿã¹ã‚‹</title>
    <link href="https://future-architect.github.io/articles/20200811/"/>
    <id>https://future-architect.github.io/articles/20200811/</id>
    <published>2020-08-10T15:00:00.000Z</published>
    <updated>2020-08-11T02:24:26.907Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://future-architect.github.io/articles/20200726/">ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶é€£è¼‰</a>ã®7å›ç›®ã§ã™ã€‚</p><p>ã“ã‚“ã«ã¡ã¯ã€‚ç­’äº•ã§ã™ã€‚</p><p>ã€Œã‚³ãƒ­ãƒŠå¤ªã‚Šã€ã¨ã„ã†å˜èªã‚’ã‚ˆãç›®ã«ã™ã‚‹ä»Šæ—¥ã“ã®é ƒã§ã™ãŒã€çš†ã•ã‚“ã®ãŠè…¹ã®å…·åˆã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚</p><p>ã“ã‚Œã‹ã‚‰ãƒ€ã‚¤ã‚¨ãƒƒãƒˆã«å–ã‚Šçµ„ã‚‚ã†ã¨ã„ã†æ–¹ã¯ã€ãŠãã‚‰ãé¶ã‚€ã­è‚‰ã•ã‚“ã®ãŠä¸–è©±ã«ãªã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚é¶ã‚€ã­è‚‰ã¯é«˜ãŸã‚“ã±ãè³ªã§ã€çš®ã‚’å‰¥ã„ã§ã—ã¾ãˆã°è„‚è³ªã‚‚ä½ã„é£Ÿæã§ã™ã€‚ã—ã‹ã—ã€èª¿ç†æ–¹æ³•ã«ä¸€å·¥å¤«åŠ ãˆãªã„ã¨ã±ã•ã¤ã„ãŸé£Ÿæ„Ÿã«ãªã£ã¦ã—ã¾ã†ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã—ãŸã€‚</p><p>ã—ã‹ã—ã“ã“æ•°å¹´ã€ä½æ¸©èª¿ç†ã€ã‚ã‚‹ã„ã¯Sous videã¨å‘¼ã°ã‚Œã‚‹èª¿ç†æ³•ãŒç™»å ´ã—ã€é¶ã‚€ã­è‚‰ãŒã¨ã¦ã‚‚ç¾å‘³ã—ãé£Ÿã¹ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p><p>å¸‚å ´ã«ã¯Anovaã‚„BONIQã¨ã„ã£ãŸå°‚ç”¨ã®è£½å“ãŒã‚ã‚Šã¾ã™ãŒã€ã›ã£ã‹ããªã®ã§è‡ªä½œã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p><h2 id="è¨­è¨ˆã¨éƒ¨å“é¸å®š"><a href="#è¨­è¨ˆã¨éƒ¨å“é¸å®š" class="headerlink" title="è¨­è¨ˆã¨éƒ¨å“é¸å®š"></a>è¨­è¨ˆã¨éƒ¨å“é¸å®š</h2><p>ä½æ¸©èª¿ç†ã«å¿…è¦ãªæ©Ÿèƒ½ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã€40â„ƒï½70â„ƒç¨‹åº¦ã®æ°´æ¸©ã‚’ã‚­ãƒ¼ãƒ—ã™ã‚‹ã ã‘ã§ã™ã€‚</p><p>ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®æ§‹æˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ç›®æ¨™æ¸©åº¦ã¨æ¸¬å®šã—ãŸæ°´æ¸©ã®å·®ãŒã‚¼ãƒ­ã«ãªã‚‹ã‚ˆã†ã«ãƒ’ãƒ¼ã‚¿ã®å‡ºåŠ›ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚</p><p><img src="/images/20200811/block_diagram.png" alt=""></p><p>ã¾ãšãƒ’ãƒ¼ã‚¿ã«ã¯ã€ç†±å¸¯é­šã®æ°´æ§½ç”¨ã®ã‚‚ã®ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚æ¸©åº¦è¨ˆã¯è‡ªåˆ†ã§ã“ã—ã‚‰ãˆã‚‹ã®ã§ã€ã‚µãƒ¼ãƒ¢ã‚¹ã‚¿ãƒƒãƒˆä»˜ãã®ã‚‚ã®ã¯ä½¿ãˆã¾ã›ã‚“ã€‚<br><a href="https://www.yodobashi.com/product/100000001003655227/" target="_blank" rel="noopener">https://www.yodobashi.com/product/100000001003655227/</a><br>ï¼ˆè²·ã£ãŸã®ãŒçµæ§‹å‰ãªã®ã§ã€è²©å£²çµ‚äº†ã—ã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€‚ã™ã¿ã¾ã›ã‚“ã€‚ï¼‰</p><p>æ¬¡ã«æ¸©åº¦è¨ˆã§ã™ãŒã€DS18B20ã¨ã„ã†æ¸©åº¦ã‚»ãƒ³ã‚µã‚’é˜²æ°´åŠ å·¥ã—ãŸã‚‚ã®ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚<br><a href="https://www.aliexpress.com/item/32862371307.html" target="_blank" rel="noopener">https://www.aliexpress.com/item/32862371307.html</a></p><p>ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ã¯ESP32ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚ã‚†ãã‚†ãã¯ã‚¹ãƒãƒ›ã‹ã‚‰æ“ä½œã‚’è¡Œã†ã“ã¨ã‚’è¦‹è¶Šã—ã¦ã®é¸å®šã§ã™ã€‚<br><a href="http://akizukidenshi.com/catalog/g/gM-11819/" target="_blank" rel="noopener">http://akizukidenshi.com/catalog/g/gM-11819/</a> </p><p>ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‹ã‚‰ãƒ’ãƒ¼ã‚¿ã‚’åˆ¶å¾¡ã™ã‚‹ã«ã¯ã€AC100Vã‚’ã‚ªãƒ³/ã‚ªãƒ•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã¯ã‚½ãƒªãƒƒãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒªãƒ¬ãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚<br><a href="http://akizukidenshi.com/catalog/g/gK-00203/" target="_blank" rel="noopener">http://akizukidenshi.com/catalog/g/gK-00203/</a></p><h2 id="åˆ¶ä½œ"><a href="#åˆ¶ä½œ" class="headerlink" title="åˆ¶ä½œ"></a>åˆ¶ä½œ</h2><p>ã“ã‚Œã‚‰ã‚’çµ„ã¿ç«‹ã¦ãŸã®ãŒä»¥ä¸‹ã®å†™çœŸã§ã™ã€‚ã‚±ãƒ¼ã‚¹ã¯ãƒ€ã‚¤ã‚½ãƒ¼ã§è³¼å…¥ã—ãŸå®¹å™¨ã§ã™ã€‚</p><p><img src="/images/20200811/overview.jpg" alt=""></p><p>SSRã¯åŸºæ¿ä»˜ãã®ã‚­ãƒƒãƒˆã‚’è³¼å…¥ã—ã¾ã—ãŸãŒã€ã‹ã•ã°ã‚‹ã®ã§ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«åŸºæ¿ã«å®Ÿè£…ã—ã¦ã—ã¾ã„ã¾ã—ãŸã€‚å®Ÿè£…æ™‚ã®æ³¨æ„ç‚¹ã¨ã—ã¦ã€çµ¶ç¸ã®ãŸã‚ã«AC100Vã®é…ç·šã¯ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«åŸºæ¿ä¸Šã§1ã‚³ãƒãšã¤ç©ºã‘ã¦é…ç·šã—ã€ãƒ©ãƒ³ãƒ‰ã‚’å‰Šã‚Šå–ã£ã¦ãŠãã®ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚</p><p>ã¾ãŸè¨­è¨ˆã®ã¨ã“ã‚ã§ã¯è§£èª¬ã—ã¾ã›ã‚“ã§ã—ãŸãŒã€æ¸©åº¦ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚</p><p>ã–ã£ãã‚Šã¨ã—ãŸæ¥ç¶šå›³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><p><img src="/images/20200811/schematics.png" alt=""></p><p>ã•ã‚‰ã«ãƒãƒ³ãƒ—ã¨ã„ã†æ–°ã‚­ãƒ£ãƒ©ãŒå‡ºã¦ãã¾ã—ãŸãŒã€ã“ã‚Œã¯æ°´ã‚’æ’¹æ‹Œã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚<br><a href="https://www.amazon.co.jp/dp/B07D29YT2C/" target="_blank" rel="noopener">https://www.amazon.co.jp/dp/B07D29YT2C/</a></p><p>æœ€åˆã¯è‡ªç„¶å¯¾æµã®ã¿ã§æ°´æ¸©ãŒå‡ä¸€ã«ãªã‚‹ã‹ã¨æ€ã£ãŸã®ã§ã™ãŒã€æ€ã„ã®å¤–é‹ã®ä¸­ã§æ¸©åº¦å·®ãŒç”Ÿã˜ã¦ã—ã¾ã£ãŸãŸã‚ãƒãƒ³ãƒ—ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚</p><h2 id="ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å®Ÿè£…"><a href="#ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å®Ÿè£…" class="headerlink" title="ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å®Ÿè£…"></a>ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å®Ÿè£…</h2><p>å®Ÿè£…ã—ãŸã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä¸€éƒ¨ã‚’æŠœç²‹ã—ã¾ã™ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">control</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// DS18B20ã‹ã‚‰æ¸©åº¦ã‚’å–å¾—ã™ã‚‹</span></span><br><span class="line">  <span class="keyword">uint32_t</span> convTime = ds18b20.requestTemperature();</span><br><span class="line">  <span class="built_in">delay</span>(convTime);</span><br><span class="line">  <span class="keyword">float</span> temperature;</span><br><span class="line">  <span class="keyword">if</span> (ds18b20.getTemperatureC(&amp;temperature) != OK)</span><br><span class="line">  &#123;</span><br><span class="line">    log_e(<span class="string">"Failed to measure temperature."</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  log_i(<span class="string">"Temp = %.4f deg-C"</span>, temperature, temperature);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã«æ¸©åº¦ã‚’è¡¨ç¤ºã™ã‚‹</span></span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">16</span>];</span><br><span class="line">  <span class="built_in">sprintf</span>(buf, <span class="string">"%2.1f %lcC"</span>, temperature, <span class="number">0xb0</span>);</span><br><span class="line">  displayTask.displayMessage(buf);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ãƒ’ãƒ¼ã‚¿ãƒ¼åˆ¶å¾¡</span></span><br><span class="line">  <span class="keyword">if</span> (temperature &lt; (target_temp - <span class="number">1</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    acSwitch.turnOn();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (temperature &gt; (target_temp + <span class="number">1</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    acSwitch.turnOff();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ãƒ’ãƒ¼ã‚¿ãƒ¼ã®åˆ¶å¾¡ã¯ã€ãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹ã‚’æŒãŸã›ãŸã‚ªãƒ³ã‚ªãƒ•åˆ¶å¾¡ã¨ã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ç›®æ¨™æ¸©åº¦ã‚’60åº¦ã¨ã—ãŸå ´åˆã€æ¸¬å®šã—ãŸæ°´æ¸©ãŒ61åº¦ã‚’ä¸Šå›ã£ãŸã¨ãã«ãƒ’ãƒ¼ã‚¿ãƒ¼ã‚’ã‚ªãƒ•ã«ã€59åº¦ã‚’ä¸‹å›ã£ãŸã¨ãã«ã‚ªãƒ³ã«ã—ã¾ã™ã€‚</p><h2 id="èª¿ç†"><a href="#èª¿ç†" class="headerlink" title="èª¿ç†"></a>èª¿ç†</h2><p><img src="/images/20200811/cooking.jpg" alt=""></p><p>èª¿ç†ä¸­ã®æ§˜å­ã§ã™ã€‚ä¹±é›‘ãªã‚­ãƒƒãƒãƒ³ã§ã™ã¿ã¾ã›ã‚“ã€‚</p><p>ãƒã‚±ãƒ„ã«10Lã»ã©ã®æ°´ã‚’å¼µã‚Šã€ãã“ã«ã‚¸ãƒƒãƒ—ãƒ­ãƒƒã‚¯ã«ã„ã‚ŒãŸé¶ã‚€ã­è‚‰ã¨ã€ãƒ’ãƒ¼ã‚¿ã€æ¸©åº¦è¨ˆã€ãƒãƒ³ãƒ—ã‚’æ”¾ã‚Šè¾¼ã¿ã¾ã™ã€‚</p><p>ä»Šã¯10Lã®ãƒã‚±ãƒ„ã«8Lã»ã©ã®æ°´ã§ä½¿ç”¨ã—ã¦ã„ã¾ã™ãŒã€æ¸©åº¦ã‚’ä¿ã¤åˆ†ã«ã¯200Wã®ãƒ’ãƒ¼ã‚¿ã§ååˆ†ã§ã™ã€‚ã—ã‹ã—ã€20åº¦ã»ã©ã®æ°´ã‚’60åº¦ã¾ã§æ¸©ã‚ã‚‹ã®ã¯ä¸å¯èƒ½ã¨æ€ã£ãŸã»ã†ãŒã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚æˆ‘ãŒå®¶ã¯å¹¸ã„çµ¦æ¹¯å™¨ã‹ã‚‰60åº¦ã®ãŠæ¹¯ãŒå‡ºã›ã‚‹ã®ã§ã€ãã‚Œã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚</p><h2 id="å®Ÿé£Ÿ"><a href="#å®Ÿé£Ÿ" class="headerlink" title="å®Ÿé£Ÿ"></a>å®Ÿé£Ÿ</h2><p>ãŠå¾…ã¡ã‹ã­ã®å®Ÿé£Ÿã§ã™ï¼</p><p><img src="/images/20200811/chicken.jpg" alt=""></p><p>é¶ã‚€ã­è‚‰ã®ä¸‹ã”ã—ã‚‰ãˆã¯ä½•ã‚‚ã—ã¾ã›ã‚“ã§ã—ãŸãŒã€ã¨ã£ã¦ã‚‚ã‚„ã‚ã‚‰ã‹ãƒ¼ãä»•ä¸ŠãŒã£ã¦ã„ã¾ã™ã€‚åŠ ç†±ã¯62åº¦ã§1æ™‚é–“è¡Œã„ã€å¼•ãä¸Šã’å¾Œã«ã‚¸ãƒƒãƒ—ãƒ­ãƒƒã‚¯å†…ã«è»½ãå¡©ã‚’ã—ã¦ã€10åˆ†ã»ã©ä¼‘ã¾ã›ã¾ã—ãŸã€‚</p><p>ã‚½ãƒ¼ã‚¹ã¯ã­ãå¡©ã«ã‚“ã«ãã ã‚Œã§ã™ã€‚é•·ã­ãã¨ã«ã‚“ã«ãã‚’ã¿ã˜ã‚“åˆ‡ã‚Šã«ã—ã¦ã€ã”ã¾æ²¹ã¨å¡©ã§å’ŒãˆãŸã ã‘ã®ç°¡å˜ãŸã‚Œã§ã™ãŒã€ç—…ã¿ã¤ãã«ãªã‚‹ç¾å‘³ã—ã•ã§ã™ã€‚ã«ã‚“ã«ããƒ‘ãƒ¯ãƒ¼ã§å¤ã‚’ä¹—ã‚Šåˆ‡ã‚Šã¾ã—ã‚‡ã†ã€‚</p><p>é¶ã‚€ã­è‚‰ã‚’ä¸¸ã€…1æšï¼ˆç´„300gï¼‰ä½¿ã£ãŸã®ã§ã‹ãªã‚Šã®é£Ÿã¹ã”ãŸãˆã§ã™ã€‚ãã‚Œãªã®ã«ã€ã“ã‚Œå…¨éƒ¨é£Ÿã¹ã¦ã‚‚ãŠã‚ˆã400kcalï¼ãƒ€ã‚¤ã‚¨ãƒƒãƒˆã«ãƒ”ãƒƒã‚¿ãƒªã®é«˜ãŸã‚“ã±ãé£Ÿã§ã™ã€‚<br>ï¼ˆé¶ã‚€ã­è‚‰ã®çš®ã¯å‰¥ãå–ã£ã¦ã„ã¾ã™ã€‚ä½™ã£ãŸçš®ã¯ã¾ã¨ã‚ã¦å†·å‡ã—ã¦ãŠã„ã¦ã€ã‚ã‚‹ç¨‹åº¦æºœã¾ã£ãŸã‚‰é¶æ²¹ã‚’ä½œã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ã€‚ï¼‰</p><p><img src="/images/20200811/pork.jpg" alt=""></p><p>ã“ã¡ã‚‰ã¯åŒæ§˜ã«è±šãƒãƒ©è‚‰ã‚’65åº¦ã§3æ™‚é–“åŠ ç†±ã—ãŸã‚‚ã®ã§ã™ã€‚</p><p>è„‚èº«ãŒã»ã¨ã‚“ã©æº¶ã‘å‡ºã—ã¦ãŠã‚‰ãšã€éå¸¸ã«ç½ªæ·±ã„é£Ÿæ„Ÿã§ã™ã€‚ã“ã¡ã‚‰ã¯å…«è§’ã‚’åŠ¹ã‹ã›ãŸæ±å¡è‚‰é¢¨ã®ã‚½ãƒ¼ã‚¹ã«ã€ç™½é«ªã­ãã¨è¾›å­ã‚’æ·»ãˆã¦é ‚ãã¾ã—ãŸã€‚</p><p>è„‚è³ªãŒå¤šã„ã®ã§ãƒ€ã‚¤ã‚¨ãƒƒãƒˆã«ã¯å‘ã„ã¦ã„ã¾ã›ã‚“ãŒã€ã¨ã¦ã‚‚ç¾å‘³ã—ã‹ã£ãŸã§ã™ã€‚</p><h2 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h2><p>è‡ªä½œã®ä½æ¸©èª¿ç†å™¨ã§ã€é¶ã‚€ã­è‚‰ã‚’ã¨ã¦ã‚‚ç¾å‘³ã—ãé£Ÿã¹ã‚‰ã‚Œã¾ã—ãŸã€‚ãƒ€ã‚¤ã‚¨ãƒƒãƒˆé£Ÿã®ãƒ–ãƒ¬ã‚¤ã‚¯ã‚¹ãƒ«ãƒ¼ã§ã™ã€‚</p><p>èª²é¡Œã¨ã—ã¦ã¯ã€ãƒ’ãƒ¼ã‚¿å‡ºåŠ›ã®200WãŒå°‘ã—åŠ›ä¸è¶³ãªã“ã¨ã€ã‚±ãƒ¼ãƒ–ãƒ«ã®å–ã‚Šå›ã—ãŒç…©é›‘ãªã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚èª¿ç†ã«æ”¯éšœã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ä½¿ã„å‹æ‰‹ãŒã‚ã¾ã‚Šè‰¯ãã‚ã‚Šã¾ã›ã‚“ã€‚</p><p>ä»Šå›ã®è£½ä½œã«ã‹ã‹ã£ãŸè²»ç”¨ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚</p><table><thead><tr><th>å“ç›®</th><th>é‡‘é¡</th></tr></thead><tbody><tr><td>ãƒ’ãƒ¼ã‚¿</td><td>\2,200</td></tr><tr><td>æ¸©åº¦è¨ˆ</td><td>\150</td></tr><tr><td>ãƒãƒ³ãƒ—</td><td>\1,100</td></tr><tr><td>ESP32</td><td>\1,500</td></tr><tr><td>ã‚½ãƒªãƒƒãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒªãƒ¬ãƒ¼</td><td>\250</td></tr><tr><td>ãã®ä»–é…ç·šæã€ã‚±ãƒ¼ã‚¹ãªã©</td><td>\1,000</td></tr></tbody></table><p>åˆè¨ˆã§<strong>6,200å††</strong>ã§ã—ãŸã€‚</p><p>ä¸€æ–¹å¸‚è²©å“ã‚’èª¿ã¹ã¦ã¿ã‚‹ã¨ã€ã‚¢ã‚¤ãƒªã‚¹ã‚ªãƒ¼ãƒ¤ãƒã®ä½æ¸©èª¿ç†å™¨ãŒ1ä¸‡å††ã‚’åˆ‡ã‚‹ä¾¡æ ¼ã§å£²ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚<br><a href="https://www.amazon.co.jp/dp/B07Z5482Y6" target="_blank" rel="noopener">https://www.amazon.co.jp/dp/B07Z5482Y6</a></p><p>è³¢æ˜ãªçš†æ§˜ã¯ã€å¸‚è²©å“ã‚’è²·ã£ãŸã»ã†ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://future-architect.github.io/articles/20200726/&quot;&gt;ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶é€£è¼‰&lt;/a&gt;ã®7å›ç›®ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;ã“ã‚“ã«ã¡ã¯ã€‚ç­’äº•ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;ã€Œã‚³ãƒ­ãƒŠå¤ªã‚Šã€ã¨ã„ã†å˜èªã‚’ã‚ˆãç›®ã«ã™ã‚‹
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="Futureé›»å­å·¥ä½œéƒ¨" scheme="https://future-architect.github.io/tags/Future%E9%9B%BB%E5%AD%90%E5%B7%A5%E4%BD%9C%E9%83%A8/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
      <category term="é›»å­å·¥ä½œ" scheme="https://future-architect.github.io/tags/%E9%9B%BB%E5%AD%90%E5%B7%A5%E4%BD%9C/"/>
    
      <category term="ESP32" scheme="https://future-architect.github.io/tags/ESP32/"/>
    
  </entry>
  
  <entry>
    <title>è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã—ã¦ã¿ã‚ˆã†</title>
    <link href="https://future-architect.github.io/articles/20200810/"/>
    <id>https://future-architect.github.io/articles/20200810/</id>
    <published>2020-08-09T15:00:00.000Z</published>
    <updated>2020-08-11T07:14:43.627Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://future-architect.github.io/articles/20200726/">ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶é€£è¼‰</a>ã®6å›ç›®ã§ã™ã€‚</p><h2 id="è‡ªå·±ç´¹ä»‹"><a href="#è‡ªå·±ç´¹ä»‹" class="headerlink" title="è‡ªå·±ç´¹ä»‹"></a>è‡ªå·±ç´¹ä»‹</h2><ul><li>æ‰€å±ï¼šãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚°ãƒ«ãƒ¼ãƒ—</li><li>ç¤¾ä¼šäººæ­´ï¼š 5å¹´ç›®ã®ITã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆ</li><li>å¥½ããªè¨€èªï¼šPythonã€Go</li><li>è‹¦æ‰‹ãªè¨€èªï¼šæ—¥æœ¬èª</li><li>è¶£å‘³ï¼š<ul><li>ç‰¹å®šãªå•é¡Œã‚’è§£ããŸã‚ã€æŠ€è¡“è¦ç´ ã‚’çµ„ã¿åˆã‚ã›ã¦å¿œç”¨ã™ã‚‹ã“ã¨<ul><li>ä¾‹ãˆã°ã€ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ã‚„ãƒ«ãƒ¼ãƒ“ãƒƒã‚¯ã‚­ãƒ¥ãƒ¼ãƒ–ã®ã‚ˆã†ãªãƒ‘ã‚ºãƒ«ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã§è§£ãã“ã¨</li></ul></li><li>æ™‚é–“ã‹ã‹ã‚‹å®šå½¢ä½œæ¥­ã‚’è‡ªå‹•åŒ–ã™ã‚‹ã“ã¨</li></ul></li></ul><p>å¤è‡ªç”±ã®ç ”ç©¶ã§ã¯ã€<strong>å¤§äººãŸã¡ãŒå¤§å¥½ããªåˆºæ¿€çš„ãªã€ŒãŠã‚«ãƒã€ã®è©±</strong>ã‚’ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã€ITæŠ€è¡“ã€æ•°å­¦ã¨é‡‘èã®çŸ¥è­˜ã‚’èåˆã—ã€FX<a href="https://ja.wikipedia.org/wiki/%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%83%BC%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3" target="_blank" rel="noopener">ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³</a>ã®è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚</p><p><strong>ğŸš§ã©ã‚“ãªã«æŠ€è¡“ã‚’ä½¿ã£ã¦ã‚‚ã€ãƒã‚¤ãƒªã‚¹ã‚¯ã§ã‚ã‚‹ã“ã¨ã¯ç›¸å¤‰ã‚ã‚‰ãšã€æã™ã‚‹å¯èƒ½æ€§ã‚‚ååˆ†ã«ã‚ã‚Šã¾ã™ã€‚æœ¬è¨˜äº‹ã¸ã®åˆ©ç”¨ã«ã¤ã„ã¦ã”æ³¨æ„ãã ã•ã„ğŸš§</strong></p><p>æœ¬æ–‡ã«ã‚‚FXãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒ«ã‚’ç°¡å˜ã«èª¬æ˜ã—ã¾ã™ãŒã€ã©ã†ã—ã¦ã‚‚ã‚„ã£ã¦ã¿ãªã„ã¨ã‚¤ãƒ¡ãƒ¼ã‚¸ã¤ã‹ãªã„æ–¹ã¯ã€<a href="https://fx-navi.tokyo/category/bo" target="_blank" rel="noopener">ã“ã¡ã‚‰ã®è¨˜äº‹</a> ã‚‚å‚è€ƒãã ã•ã„ã€‚è¨¼åˆ¸ä¼šç¤¾ãŒæä¾›ã—ã¦ã„ã‚‹ç„¡æ–™ã®ãƒ‡ãƒ¢å–å¼•ã‚’ã‚„ã£ã¦ã¿ã‚‹ã®ã‚‚ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚</p><h2 id="è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹çµŒç·¯"><a href="#è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹çµŒç·¯" class="headerlink" title="è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹çµŒç·¯"></a>è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹çµŒç·¯</h2><h3 id="è¶£å‘³å„ªå…ˆ"><a href="#è¶£å‘³å„ªå…ˆ" class="headerlink" title="è¶£å‘³å„ªå…ˆ"></a>è¶£å‘³å„ªå…ˆ</h3><p>ç§ã¯ãƒ‡ãƒ¼ã‚¿ã‚’æ“ã‚‹ã“ã¨ãŒå¤§å¥½ãã§ã™ã€‚è‡ªç„¶ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚‚äººé–“æ´»å‹•ã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚‚åé›†&amp;åˆ†æã—ã€çŸ¥ã‚‰ã‚Œã¦ã„ãªã„éš ã‚ŒãŸçŸ¥è­˜ã‚’è§£æ˜ã™ã‚‹ã“ã¨ãŒã€ä½•ã‚ˆã‚Šã‚‚æ¥½ã—ã„ã“ã¨ã ã¨æ€ã„ã¾ã™ã€‚</p><p>å­¦ç”Ÿæ™‚ä»£ã‹ã‚‰å°‘ã—ãšã¤æ ªã‚„æŠ•ä¿¡ã‚„FXã‚’è©¦ã—ã¦ãã¾ã—ãŸãŒã€ã‚ã¾ã‚Šè‰¯ã„è³‡ç”£é‹ç”¨ã®æˆç¸¾ã«ãªã‚‰ãšã€è‡ªåˆ†ã«ã¯æ‰èƒ½ã‚‚é‡‘é‹ã‚‚ç„¡ã„ã“ã¨ã‚’è‡ªè¦šã—ã¾ã—ãŸã€‚æ™‚é–“ã¨ãŠé‡‘ã®ç„¡é§„ã«ãªã‚‰ãªã„ã‚ˆã†ã«è³‡é‡‘ç®¡ç†ã‚„æŠ•è³‡ã‚’è‡ªå‹•åŒ–ã—ã€æ™‚é–“ã®ã‚³ã‚¹ãƒˆã®å‰Šæ¸›ã¨æˆç¸¾å‘ä¸Šã«ç¹‹ã’ãŸã‚‰è‰¯ã„ãªã¨æ€ã„å§‹ã‚ã¾ã—ãŸã€‚</p><h3 id="å¤±æ•—è«‡"><a href="#å¤±æ•—è«‡" class="headerlink" title="å¤±æ•—è«‡"></a>å¤±æ•—è«‡</h3><p>ä»Šå¹´5æœˆé ƒã€ç§ã¯FXãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‰ã—ãŸå®Ÿå±¥æ­´ã§ã™ã€‚å…¥é‡‘ã—ãŸ<strong>15ä¸‡å††</strong>ã¯ã€1é€±é–“ã§ã»ã¼å…¨æã—å¤§å¤±æ•—ã§ã—ãŸã€‚<br><img src="/images/20200810/chart.png" alt=""></p><p>å¾Œã‹ã‚‰æŒ¯ã‚Šè¿”ã‚‹ã¨ã€æ§˜ã€…ãªèª¤ã‚Šã‚„æ„Ÿæƒ…çš„ãªå‹•ãã‚’ç™ºè¦‹ã—ã¾ã—ãŸã€‚</p><p>ä¾‹ãˆã°ã€22æ—¥14:00ã®æ“ä½œã¯ã€ç”»é¢ä¸Šã®ã€Œè²·ã€ã¨ã€Œå£²ã€ãƒœã‚¿ãƒ³ã‚’é–“é•ãˆã¦é€†æ“ä½œã—ã¦ã—ã¾ã„ã¾ã—ãŸã€‚ã“ã®1ãƒãƒã£ãŸãƒŸã‚¹ã ã‘ã§ã€3ä¸‡å††ä»¥ä¸Šã®æå¤±ãŒ1ç§’ä»¥å†…ã«ç™ºç”Ÿã€‚æŠ•è³‡ã¯æœ¬å½“ã«è‰²ã€…ãªæ„å‘³ã®ãƒã‚¤ãƒªã‚¹ã‚¯ã§ã™ã­ã€‚</p><p>ã¡ãªã¿ã«ã€FXãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯åˆ¤å®šæ™‚åˆ»ï¼ˆæ™®é€šã¯æ•°æ™‚é–“ä»¥å†…ï¼‰ã®FXé€šè²¨ãƒšã‚¢ã®å€¤æ®µã¯ã€ã‚ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤æ®µä»¥ä¸Šã«ãªã‚‹ã‹ã€ä»¥ä¸‹ã«ãªã‚‹ã‹ã‚’å½“ã¦ã¦ã¿ã‚‹ã‚²ãƒ¼ãƒ ã§ã™ã€‚ã‚‚ã¡ã‚ã‚“ã€å½“ãŸã‚Šãªã‚‰è³é‡‘ãŒå‡ºã¦ã€ã¯ãšã‚Œãªã‚‰å½“åˆã®å‚åŠ è²»ã‚’æ²¡åã•ã‚Œã¾ã™ã€‚</p><p><strong>FXãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒ«</strong>ã‚’ç°¡å˜ã«èª¬æ˜ã™ã‚‹ã¨ã€</p><ul><li>1æšã®ã€ŒHIGHã€ãƒã‚±ãƒƒãƒˆã‚’è²·ã†ã¨ã€ç‰¹å®šãªæ™‚åˆ»ã«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆFXé€šè²¨ãƒšã‚¢ï¼ˆä¾‹ãˆã°USD/JPYï¼‰ãŒã€ã‚‚ã—ç´„æŸã®å€¤æ®µä»¥ä¸Šãªã‚‰1000å††ã‚‚ã‚‰ãˆã‚‹ã€ã‚‚ã—é€†ãªå ´åˆã¯0å††ã‚’ã‚‚ã‚‰ãˆã€ãƒã‚±ãƒƒãƒˆã®è³¼å…¥æ–™ã‚’å…¨é¡æã™ã‚‹</li><li>åŒã˜ã‚ˆã†ã«ã€1æšã®ã€ŒLOWã€ãƒã‚±ãƒƒãƒˆã‚’è²·ã†ã¨ã€ç‰¹å®šãªæ™‚åˆ»ã«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆFXé€šè²¨ãƒšã‚¢ãŒã€ã‚‚ã—ç‰¹å®šãªå€¤æ®µã‚ˆã‚Šã‚ˆã‚Šä½ã„ãªã‚‰1000å††ã‚‚ã‚‰ãˆã‚‹ã€ã‚‚ã—é€†ãªå ´åˆã¯0å††ã‚’ã‚‚ã‚‰ãˆã€ãƒã‚±ãƒƒãƒˆã®è³¼å…¥æ–™ã‚’å…¨é¡æã™ã‚‹</li><li>åˆ¤å®šæ™‚é–“ã¾ã§ã«ã„ã¤ã§ã‚‚ãƒã‚±ãƒƒãƒˆã‚’è²·ãˆã¾ã™ãŒã€ãã‚Œã«å¿…è¦ãªæ–™é‡‘ï¼ˆæ•°å††ã€œ1000å††ï¼‰ãŒã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé€šè²¨ãƒšã‚¢ã®å€¤å‹•ããªã©ã«å½±éŸ¿ã•ã‚Œã€æ™‚é–“ã¨å…±ã«å¤‰å‹•ã—ã¦ã„ã</li></ul><p>ä¸Šã®è¡¨ã«çµæœæ¬„ã«ã‚ã‚‹ã€ŒSETTLEDã€ã¯ã€äºˆæ¸¬ãŒã‚ã£ã¦ã„ãŸæ„å‘³ã§ã€ãƒã‚±ãƒƒãƒˆæšæ•°ã‹ã‘ã‚‹1000å††ã®ãƒšã‚¤ã‚¢ã‚¦ãƒˆãŒã‚‚ã‚‰ãˆã¾ã™ã€‚ã€ŒOUT_THE_MONEYã€ã¯ã€äºˆæ¸¬ãŒå¤–ã‚Œã€ãƒã‚±ãƒƒãƒˆè³¼å…¥æ–™ã‚’å…¨æã€‚å€¤å‹•ãã®é€”ä¸­ã§ã€æåˆ‡ã‚Šã‚„åˆ©ç¢ºã§ã‚‚è¡Œãˆã¾ã™ã€ŒSELL_BACKã€ã€‚</p><p>å£²è²·ã®é–“ã«FXã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã®ã‚ˆã†ãªå€¤æ®µå·®ã¯æ‰‹æ•°æ–™ã¨ã—ã¦ä»£ä¾¡ã«ãªã‚Šã¾ã™ã€‚</p><p>ä¸Šã®1é€±é–“ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã«å¯¾ã—ã¦ã€åˆæœŸæç›Šã¯ã‚¼ãƒ­ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã¨ã™ã‚‹ã¨ã€æç›Šã®å¤‰åŒ–ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚°ãƒ©ãƒ•ã«ãªã‚Šã¾ã™ã€‚<br><img src="/images/20200810/manual_oper.png" alt=""></p><p>å‰åŠã€5ä¸‡å††å¼±å„²ã‹ã‚‹æ™‚æœŸã‚‚ã‚ã‚Šã¾ã™ãŒã€å¾ŒåŠã¯èª¿å­ã«ä¹—ã£ã¦å¤§é¡ã®å–å¼•ã‚’å§‹ã‚ã€ä¸€æ°—ã«è»¢è½ã€‚2ã€3å›ãã‚‰ã„åç™ºãŒã‚ã‚Šã¾ã—ãŸãŒè£è¿”ã™ã“ã¨ã¯ç„¡ç†ã§ã—ãŸã€‚</p><h3 id="äººé–“æ€§ã®å¼±ç‚¹"><a href="#äººé–“æ€§ã®å¼±ç‚¹" class="headerlink" title="äººé–“æ€§ã®å¼±ç‚¹"></a>äººé–“æ€§ã®å¼±ç‚¹</h3><p>å®¢è¦³çš„ã«åçœã—ãŸã‚‰ã€ã“ã‚Œã¯ã¾ã•ã«äººé–“æ€§ã®å¼±ç‚¹ã‚’æ˜ ã£ã¦ã„ã‚‹é¡ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚</p><ul><li>äººé–“ã¯æ„Ÿæƒ…ã«å·¦å³ã•ã‚Œã‚‹ã€éç†æ€§çš„ãªè¡Œå‹•ã‚’å–ã‚‹ã“ã¨å¤šã€…ã§ã—ã‚‡ã†<ul><li>åˆ©ç›Šã‚’å¾—ã‚‰ã‚Œã‚‹çŠ¶æ³ã§ã¯ã€å®‰å®šã‚’æ±‚ã‚ã¦ãƒªã‚¹ã‚¯ã‚’å›é¿ã™ã‚‹ã€‚å°‘ã—ã ã‘è©•ä¾¡ç›Šã«ãªã£ãŸæ™‚ã€ã™ãã«åˆ©ç¢ºã§é€ƒã’ã¦ã—ã¾ã†</li><li>æå¤±ã‚’è¢«ã‚‹çŠ¶æ³ã§ã¯ã€ãƒªã‚¹ã‚¯ã‚’è² ã£ã¦ã§ã‚‚æå¤±ã‚’å›é¿ã—ã€ãã®çµæœã€é€†ã«æå¤±æ‹¡å¤§ã—ã¦ã—ã¾ã†</li><li>ã‚ˆã£ã¦ã€ã„ã¤ã‚‚ç›ŠãŒå°ã•ãã€æãŒå¤§ãã„ã€ãã‚Œã‚’ç¹°ã‚Šè¿”ã—ã¦ã„ã‚‹</li></ul></li><li>äººé–“ã¯åå¿œãŒé…ãã¦å†·é™ã«è¨ˆç®—ã—ãŸã‚‰æ™‚é–“ãŒã‹ã‹ã‚‹ã€‚å°‘ã—èºŠèº‡ã—ãŸã‚‰ã€åˆ©ç›Šã®ãƒãƒ£ãƒ³ã‚¹ã‚„æåˆ‡ã‚Šã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãªã©ã™ãã«è¦‹é€ƒã—ã¦ã—ã¾ã†</li><li>äººé–“ã¯ã©ã‚“ãªã«æ…é‡ã«æ“ä½œã—ã¦ã‚‚ã€ç–²ã‚Œã‚„ä¸æ³¨æ„ã§ãƒŸã‚¹ã§èª¤æ“ä½œã‚’é¿ã‘ã‚‹ã®ã¯ãŒã©ã†ã—ã¦ã‚‚é›£ã—ã„ã§ã—ã‚‡ã†</li></ul><p><strong>ã“ã‚“ãªå¼±ã„äººé–“ã€æ­¦å™¨ã‚’ä½•ã‚‚æŒã£ã¦ã„ãªã„ã¾ã¾ã§æˆ¦å ´ã«ç«‹ã¤ã®ã¯ã€å‹‡æ°—ã§ã¯ãªã„ã€ãŸã ã®çŠ ç‰²ã§ã™ï¼</strong></p><p>æ­¦å™¨ã¨ãªã‚‹æ©Ÿæ¢°ã§å®Ÿç¾ã—ãŸè‡ªå‹•å£²è²·ã‚’ä½¿ã†ãƒ¡ãƒªãƒƒãƒˆãŒæ˜ã‚‰ã‹ã§ã™ã­ã€‚</p><ul><li>æ©Ÿæ¢°ãŒä¼‘ã¾ãšã«ã€åƒ•ãŒå¯ã¦ã„ã‚‹é–“ã§ã‚‚åƒã„ã¦ãã‚Œã‚‹</li><li>æ©Ÿæ¢°ãŒç†æ€§çš„ã§ã€æˆ‘ã€…äººé–“ã®ã‚ˆã†ã«æ„Ÿæƒ…çš„ã«å·¦å³ã•ã‚Œã‚‹ã“ã¨ãŒãªã„</li><li>åŒæ™‚ã«è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚„ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã€çŸ­æ™‚é–“ã«åå¿œã§ãã‚‹</li></ul><h2 id="ãƒãƒ£ãƒ³ã‚¹ã¯æœ¬å½“ã«ã‚ã‚‹ã®ã‹"><a href="#ãƒãƒ£ãƒ³ã‚¹ã¯æœ¬å½“ã«ã‚ã‚‹ã®ã‹" class="headerlink" title="ãƒãƒ£ãƒ³ã‚¹ã¯æœ¬å½“ã«ã‚ã‚‹ã®ã‹"></a>ãƒãƒ£ãƒ³ã‚¹ã¯æœ¬å½“ã«ã‚ã‚‹ã®ã‹</h2><h3 id="å¤§æ•°ã®æ³•å‰‡"><a href="#å¤§æ•°ã®æ³•å‰‡" class="headerlink" title="å¤§æ•°ã®æ³•å‰‡"></a>å¤§æ•°ã®æ³•å‰‡</h3><p><strong>æ©Ÿæ¢°ã‚’ä½¿ã£ã¦ä»£è¡Œãƒˆãƒ¬ãƒ¼ãƒ‰ã™ã‚Œã°ã€å‹ã¤ã§ã—ã‚‡ã†ã¨æ€ã£ãŸã‚‰ï¼Ÿã¡ã‚‡ã£ã¨å¾…ã£ã¦ã¨ï¼</strong></p><p>æ•µã¯äººé–“æ€§ã ã‘ã§ã¯ãªã„ã®ã§ã™ã€‚å„²ã‘ã‚‹ã‹ã©ã†ã‹ã¯æœŸå¾…å€¤ã‚„ç¢ºç‡ã®å•é¡Œã§ã™ã€‚ã‚«ã‚¸ãƒã§ã‚®ãƒ£ãƒ³ãƒ–ãƒ«ã®ã‚²ãƒ¼ãƒ ãŸã¡ã¯ã€å‹ã¤ç¢ºç‡ãŒæ˜ç¢ºã«è¨ˆç®—ã•ã‚Œã¦ã€ãƒªã‚¿ãƒ¼ãƒ³å¯¾ãƒªã‚¹ã‚¯ã®æœŸå¾…å€¤ãŒãã‚‚ãã‚‚ãƒã‚¤ãƒŠã‚¹ã§ã™ã­ã€‚</p><p>ã€Œãƒãƒ¼ãƒãƒ³ã‚²ãƒ¼ãƒ«ã€ã¨ã„ã†è² ã‘ãŸã‚‰å€ã«è³­ã‘ã‚‹æ–¹æ³•ã€ã€Œãƒ‘ãƒ¼ãƒ¬ãƒ¼æ³•ã€ã¨ã„ã†å‹ã£ãŸã‚‰å€ã«è³­ã‘ã‚‹æ–¹æ³•ãªã©ãªã©ã€ã„ã‚ã„ã‚ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ãŒå­˜åœ¨ã—ã¾ã™ãŒã€ã¿ã‚“ãªã‚«ã‚¸ãƒã«è² ã‘ã¦ã—ã¾ã„ã¾ã™ã€‚</p><p>ãã‚‚ãã‚‚æœŸå¾…å€¤ãŒãƒã‚¤ãƒŠã‚¹ã®ä¸åˆ©ãªå„²ã‘ã¯ã€å€‹åˆ¥ã«å‹ã¤ç¢ºç‡ãŒç¢ºã‹ã«0ã§ã¯ãªã„ãŒã€ãŸã ã—é•·æœŸçš„ã«ç¹°ã‚Šè¿”ã™ã»ã©å‹ã¦ã‚‹å¸Œæœ›ãŒãªããªã‚Šã¾ã™ã€‚æœ€çµ‚çš„ã«å¤§æ•°ã®æ³•å‰‡ã«ã¤ã‹ã¾ã‚‹ã‚ã‘ã§ã™ã€‚</p><p>å£²è²·ã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ãŒå­˜åœ¨ã™ã‚‹æ™‚ç‚¹ã§ã€æœŸå¾…å€¤ãŒä¸åˆ©ãªã‚ã‘ã§ã™ã€‚è¨€ã„æ›ãˆã‚‹ã¨ã€ãƒ©ãƒ³ãƒ€ãƒ ã«ãƒˆãƒ¬ãƒ¼ãƒ‰ã™ã‚‹ãªã‚‰ã€å£²ã‚Šæ‰‹ã¨è²·ã†æ‰‹ãŒãƒãƒ©ãƒ³ã‚¹è‰¯ã„å ´åˆã€è¨¼åˆ¸ä¼šç¤¾ã¯ã‚«ã‚¸ãƒã®è¦ªã®ã‚ˆã†ã«å®‰å®šãªåå…¥ãŒå…¥ã£ã¦ãã‚‹ã‚ã‘ã§ã™ã€‚</p><p>æ•µã¯æ•°å­¦ã§ã™ã®ã§ã€æ­¦å™¨ã‚‚æ•°å­¦ã«ã‚ã‚Šã¾ã™ã€‚</p><p>ãƒã‚±ãƒƒãƒˆã®å€¤æ®µã¯åˆ¤å®šæ™‚åˆ»ã«ãªã‚‹ã¾ã§ãšã£ã¨å¤‰åŒ–ã—ã¦ã„ã‚‹ã®ã§ã€å‹ã¤ç¢ºç‡ã¨ãƒšãƒ¼ã‚¢ã‚¦ãƒˆã®æ¯”ç‡ã‚‚å¸¸ã«å¤‰å‹•ã—ã¦ã„ã‚‹ã‚“ã§ã™ã€‚ä¾‹ãˆã°ã€å‹ç‡ã¯90%ã®æ¨™çš„ã¯ã€ãƒã‚±ãƒƒãƒˆå€¤æ®µãŒ950å††ã€å‹ã¤å¯èƒ½æ€§ãŒé«˜ã„ã‘ã‚Œã©ã€å‹ã£ãŸã‚‰ãŸã ãƒ—ãƒ©ã‚¹50å††ç›Šã€ä¸‡ãŒä¸€è² ã‘ãŸã‚‰ã€ãƒã‚¤ãƒŠã‚¹950å††æã§ã™ã€‚å®Ÿã¯åˆ©ç›Šã®æœŸå¾…å€¤ãŒãƒã‚¤ãƒŠã‚¹ãªã®ã§ã€ä¸åˆ©ãªå–å¼•ã§ã™ã€‚ã¾ãŸã€ä»®ã«å‹ç‡ã¯25%ã€ãƒã‚±ãƒƒãƒˆå€¤æ®µãŒ200å††ã®å ´åˆã€4åˆ†ã®3ã®å¯èƒ½æ€§ã§ãã®200å††ã‚’æã—ã¾ã™ãŒã€å‹ã£ãŸã‚‰800å††ã‚’å¾—ã¾ã™ã€‚ãã‚Œã¯æœ‰åˆ©ãªãƒˆãƒ¬ãƒ¼ãƒ‰ã§ã™ã€‚ãƒãƒ£ãƒ³ã‚¹ãŒã‚ã‚Œã°ç¹°ã‚Šè¿”ã—ç¶šã‘ã‚‹ã¹ãã§ã™ã€‚</p><p>ã„ã¤ã‚‚å„ãƒã‚±ãƒƒãƒˆã®äºˆæƒ³å‹ç‡ã¨ä»Šã®å€¤æ®µãŒæœ‰åˆ©ã‹ä¸åˆ©ã‹ã‚’ãƒªã‚¢ã‚¿ã‚¤ãƒ ã§è¨ˆç®—ã—ã¦ã€æœ‰åˆ©ã®å ´åˆã—ã‹ãƒˆãƒ¬ãƒ¼ãƒ‰ã—ãªã„ã“ã¨ã¯ã€å‹ã¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã­ã€‚</p><p>å•é¡Œã®æ ¹æœ¬ã¯ã€ã‚„ã£ã¦ã„ã‚‹ã‚²ãƒ¼ãƒ ã«ï¼ˆä¾‹ãˆã°ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ã€ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã«å‹ã¦ã‚‹æœ‰åˆ©ãªãƒˆãƒ¬ãƒ¼ãƒ‰ã®ãƒãƒ£ãƒ³ã‚¹ãŒæœ¬å½“ã«ã‚ã‚Šã¾ã™ã‹ã€ãã‚Œã¨ã‚‚ã€ã‚®ãƒ£ãƒ³ãƒ–ãƒ«ã®ã‚ˆã†ã«ã€ã„ã¤ã‚‚ãƒã‚¤ãƒŠã‚¹æœŸå¾…å€¤ã®ç½ ã£ã ã‚‰ã‘ã§ã™ã‹ã€‚</p><p>æ¤œè¨¼ã—ã¦ã¿ãªã„ã¨ã‚ã‹ã‚‰ãªã„ã§ã™ã­ã€‚</p><h3 id="äºˆã‚ç¿’ã£ãŸæœ‰ç”¨ãªæ¦‚å¿µ"><a href="#äºˆã‚ç¿’ã£ãŸæœ‰ç”¨ãªæ¦‚å¿µ" class="headerlink" title="äºˆã‚ç¿’ã£ãŸæœ‰ç”¨ãªæ¦‚å¿µ"></a>äºˆã‚ç¿’ã£ãŸæœ‰ç”¨ãªæ¦‚å¿µ</h3><ul><li>åˆ†æ•£ã®é•·æœŸè¨˜æ†¶æ€§ã«åŸºã¥ã„ãŸäºˆæ¸¬ã®<a href="https://ja.wikipedia.org/wiki/ARCH%E3%83%A2%E3%83%87%E3%83%AB#GARCH(p,q)%E3%83%A2%E3%83%87%E3%83%AB" target="_blank" rel="noopener">GARCH</a><br>ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦åˆ¤å®šæ™‚ã®å€¤æ®µå¸¯ã«è½ã¡ã‚‹ç¢ºç‡ã‚’è¨ˆç®—ã™ã‚‹<ul><li>é‡‘èæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€å€¤å‹•ãã®æ–¹å‘ã‚ˆã‚Šã€å€¤å‹•ãã®åˆ†æ•£ï¼ˆãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼‰ã®äºˆæ¸¬ã®ç²¾åº¦ãŒé«˜ã„ã‚‰ã—ã„</li><li>Pythonã¯ã•ã™ãŒãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã®å¤§å¥½ç‰©ã€GARCHåŠã³æ‹¡å¼µãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¾ã§æä¾›ã—ã¦ã„ã‚‹ â†’ <a href="https://pypi.org/project/arch/" target="_blank" rel="noopener">arch</a></li></ul></li><li><a href="https://en.wikipedia.org/wiki/Kelly_criterion" target="_blank" rel="noopener">ã‚±ãƒªãƒ¼åŸºæº–</a>ã‚’ä½¿ã£ã¦ãƒˆãƒ¬ãƒ¼ãƒ‰ã¯æœ‰åˆ©ãªã®ã‹ä¸åˆ©ãªã®ã‹ã€æœ‰åˆ©ãªã‚‰ãƒˆãƒ¬ãƒ¼ãƒ‰ã®é‡ã‚’ä½•å‰²ã«ã™ã‚‹ã‹ã‚’æ±ºã‚ã‚‹<ul><li><code>kelly = win_rate - (1-win_rate) * premium / (1-premium)</code></li><li><code>kelly</code>å€¤ã¯ã€1å›ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã§æ‰‹å…ƒã«ã‚ã‚‹æŠ•è³‡ç”¨ã®ç·è³‡é‡‘ã®å‰²åˆã®åŸºæº–ã€‚ãã‚Œã¯ã€æå¤±ã®ãƒªã‚¹ã‚¯ã‚’è€ƒãˆãŸä¸Šã§ã€è«–ç†ä¸Šè³‡é‡‘ã‚’ä¸€ç•ªåŠ¹ç‡çš„ã«å¢—ã‚„ã™æŠ•è³‡ã®æ¯”ç‡ã§ã‚ã‚‹</li><li><code>kelly</code>å€¤ã¯<code>win_rate</code>(å‹ã¤ç¢ºç‡)ã¨<code>premium</code>ï¼ˆãƒã‚±ãƒƒãƒˆã®æ–™é‡‘ã¯950å††ã€ãƒšãƒ¼ã‚¢ã‚¦ãƒˆã¯1000å††ã®å ´åˆã¯<code>premium = 950/1000 = 0.95</code>ï¼‰ã«ã‚ˆã£ã¦è¨ˆç®—ã•ã‚ŒãŸ</li><li><code>win_rate</code>&lt;=<code>premium</code>ã®å ´åˆã€<code>kelly</code>&lt;=0ã€ãã‚Œã¯ä¸åˆ©ãªå–å¼•ã‚’æ„å‘³ã—ã¦ã€æ‰‹ã‚’å‡ºã•ãªã„ã»ã†ãŒè‰¯ã„</li><li><code>win_rate</code>ãŒ1ã§ã¯ãªã„æ™‚ã€ã‚ªãƒ¼ãƒ«ã‚¤ãƒ³ã—ã¦ã¯ã„ã‘ãªã„ã€‚ãã‚Œã¯è«–ç†ä¸Šå…¨æã®ãƒªã‚¹ã‚¯ã‚’é¿ã‘ã‚‰ã‚Œã¦ã€ã„ã¤ã¾ã§ã‚‚è£è¿”ã™å¯èƒ½æ€§ã‚’æ”¾æ£„ã—ãªã„</li></ul></li></ul><p>æ”¹ã‚ã¦ã€ãã®æ‚”ã—ã„1é€±é–“ã®æ‰‹å‹•ã®å–å¼•ã‚’æŒ¯ã‚Šè¿”ã£ã¦è¦‹ãŸã‚‰ã©ã†ã‹ã¨æ€ã„ã€å–å¼•ç™ºç”Ÿæ™‚ç‚¹<strong>ä»¥å‰</strong>ã®å€¤å‹•ãæƒ…å ±ã‚’GARCHãƒ¢ãƒ‡ãƒ«ã«æŠ•å…¥ã—ã€åˆ¤å®šæ™‚ã®å‹ã¤ç¢ºç‡(<code>win rate</code>)ã‚’è©•ä¾¡ã—ã€ç†æ€§çš„ãªæŠ•è³‡æ¯”ç‡(<code>kelly</code>)ã‚’å‡ºã—ã¦ã¿ã¾ã—ãŸã€‚</p><img src="/images/20200810/kelly.png" class="img-middle-size"><p>ã©ã†ã‚„ã‚‰æ±—ãŒå‡ºã‚‹ã»ã©ã³ã£ãã‚Šã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§å–å¼•ã—ãŸã®ã¯ã€åŠåˆ†ä»¥ä¸ŠãŒä¸åˆ©ãª(kelly&lt;0)å–å¼•ã ã£ãŸã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚ãã—ã¦ã€æœ‰åˆ©ãªå–å¼•ã«å¯¾ã—ã¦ã‚‚ã€ã‚‚ã£ã¨ã€Œæ­£ç¢ºãªã€æ¯”ç‡ã§è³‡é‡‘ã‚’å‡ºã›ã°ã€ã‚‚ã£ã¨è‰¯ã„çµæœã«ãªã£ãŸã¯ãšã§ã™ã€‚æ‚”ã—ãã¦ãŸã¾ã‚Šã¾ã›ã‚“ã€‚</p><h2 id="è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹æµã‚Œ"><a href="#è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹æµã‚Œ" class="headerlink" title="è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹æµã‚Œ"></a>è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹æµã‚Œ</h2><h3 id="å¸‚è²©ã‚ˆã‚Šè‡ªä½œ"><a href="#å¸‚è²©ã‚ˆã‚Šè‡ªä½œ" class="headerlink" title="å¸‚è²©ã‚ˆã‚Šè‡ªä½œ"></a>å¸‚è²©ã‚ˆã‚Šè‡ªä½œ</h3><p>ã€Œè‡ªå‹•å£²è²·ã€ã‚’ã‚°ãƒ¼ã‚°ãƒ«ã§æ¤œç´¢ã—ãŸã‚‰ã€ã¤ãªã„ã§å‡ºã¦ãã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã€ã€Œæ¯”è¼ƒã€ã€ã€ŒãŠã™ã™ã‚ã€ã¨ã‹ã¯ã‚‚ã¡ã‚ã‚“å‡ºã¦ãã¾ã™ãŒã€ãªã‚“ã¨ã€Œè©æ¬ºã€ã€ã€Œç¨¼ã’ãªã„ã€ã®ã‚‚å‡ºã‚‹ã®ã§ã€å±ãªã„æ„Ÿã‚’æ¥½ã—ã‚ã‚‹ãƒªã‚¹ã‚¯å±‹ã•ã‚“å‘ã‘ã®é›°å›²æ°—ãŒæ¹§ã„ã¦ã„ã¾ã™ã€‚</p><p>ç§ã‚‚å¸‚è²©ã®è‡ªå‹•å£²è²·ã‚’ã‚ã¾ã‚Šä¿¡ç”¨ã—ãªã„æ´¾ã§ã™ã€‚ãªãœãªã‚‰ã€ã¿ã‚“ãªãŒæ˜ã‚Šã«è¡Œãé‡‘é‰±ã«ã¯ã€ã‚‚ã†é‡‘ãŒç„¡ã„ã¨æ€ã†ã‹ã‚‰ã§ã™ã€‚å£²è²·ã‚·ã‚°ãƒŠãƒ«ã‚„ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã¯æœ€åˆã¯ã‚ˆãåŠ¹ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€åºƒãçŸ¥ã‚‰ã‚ŒãŸã‚‰ã€çœŸä¼¼ã‚‰ã‚Œã¦åˆ©ç›Šã‚‚å±±åˆ†ã‘ã«ãªã£ã¦åˆ©ç›ŠãŒå°ã•ããªã‚‹ã®ã§ã™ã€‚</p><p>è‡ªä½œã®è‰¯ã„ç‚¹ã‚’ã‚ã’ã¾ã™ã€‚</p><ul><li>æ‰‹æ•°æ–™ãŒã‹ã‹ã‚‰ãªã„ã®ã§ã€æ‰‹æ•°æ–™ãŒåˆ©ç›Šã«å‹ã¦ãªã„å¿ƒé…ãªã—</li><li>ä¸­èº«ãŒã™ã¹ã¦æŠŠæ¡ã§ãã¦å®‰å¿ƒ</li><li>è‡ªä½œãªã®ã§ã‚«ã‚¹ãƒˆãƒã‚¤ã‚ºã—ã‚„ã™ãã€éšæ™‚ã«é€²åŒ–ã§ãã‚‹</li></ul><h3 id="ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¨­å®š"><a href="#ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¨­å®š" class="headerlink" title="ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¨­å®š"></a>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¨­å®š</h3><p>ä¸»æµã®FXã‚„æ ªã®æˆ¦å ´ã‚’é¿ã‘ã¦ã€ã¡ã‚‡ã£ã¨äºœæµç³»ã®ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å¯¾è±¡ã«ã—ã¦ã„ã¾ã™ã€‚<br>ç†ç”±ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚</p><ul><li>å£²è²·ã‚„å‹è² ã®ãƒ«ãƒ¼ãƒ«ã¯ç°¡å˜</li><li>ãƒ«ãƒ¼ãƒ«ã«ã‚ˆã£ã¦ã€ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ãƒã‚¤ãƒªã‚¹ã‚¯ã ãŒã€åˆ©ç›Šã¨æå¤±ã®é™ç•ŒãŒå–å¼•ã®å‰ã«ã‚‚èª­ã‚ã‚‹</li><li>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯FXãƒ‡ãƒ¼ã‚¿ãªã®ã§ã€å…¬é–‹æ€§ãŒã‚ã‚‹</li><li>æ¯”è¼ƒçš„ã«å€¤å‹•ãã®æ–¹å‘ã‚ˆã‚Šã€å€¤å‹•ãã®åˆ†æ•£ï¼ˆãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼‰ã®äºˆæ¸¬ã®ç²¾åº¦ãŒé«˜ã„ã‚‰ã—ãã€ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€å€¤å‹•ãã®åˆ†æ•£ã®å¤§å°ã®äºˆæ¸¬ã§ãƒˆãƒ¬ãƒ¼ãƒ‰å¯èƒ½ï¼ˆå¾Œè¿°ã®ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æ³•ï¼‰</li><li>ãƒªã‚¹ã‚¯ã¨ãƒªã‚¿ãƒ¼ãƒ³ã®æœ€å¤§å€¤ãŒæ“ä½œã™ã‚‹å‰ã«ã‚‚èª­ã‚ã‚‹ã€‚æ¯”è¼ƒçš„ã«å˜ç´”ãªãƒ«ãƒ¼ãƒ«ãªã®ã§ã€è‡ªå‹•åŒ–ã—ã‚„ã™ã„ã¨ã“ã‚ãŒã‚ã‚‹</li><li>è‡ªå‹•å£²è²·ã«å§”ã­ã‚‹ãŒã€é«˜é »åº¦ã®å£²è²·æ“ä½œãŒä¸è¦ï¼ˆ1ã‚·ãƒªã‚¢ãƒ«ã¯ä¾‹ãˆã°2æ™‚é–“ã§1å›ã®æ“ä½œã®ã¿ï¼‰ã®ãŸã‚ã€ä¸æ­£æ“ä½œã®ç†ç”±ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ•ãƒªãƒ¼ã‚ºã•ã‚Œã‚‹ãƒªã‚¹ã‚¯ãŒæ¸›ã£ãŸï¼ˆãŸã ã—ã‚¼ãƒ­ãƒªã‚¹ã‚¯ã§ã¯ãªã„ï¼‰</li></ul><h3 id="å…·ä½“çš„ã«å®Ÿè·µã—ãŸæµã‚Œã¯ã“ã‚“ãªæ„Ÿã˜"><a href="#å…·ä½“çš„ã«å®Ÿè·µã—ãŸæµã‚Œã¯ã“ã‚“ãªæ„Ÿã˜" class="headerlink" title="å…·ä½“çš„ã«å®Ÿè·µã—ãŸæµã‚Œã¯ã“ã‚“ãªæ„Ÿã˜"></a>å…·ä½“çš„ã«å®Ÿè·µã—ãŸæµã‚Œã¯ã“ã‚“ãªæ„Ÿã˜</h3><ul><li>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–‹ãã€ã‚„ã‚Šæ–¹ã‚„ãƒ«ãƒ¼ãƒ«ã‚’æ…£ã‚Œã¦ã„ãï¼ˆ2ã€3å¹´å‰ã‹ã‚‰ï¼‰<br>â†“</li><li>ãƒ‡ãƒ¼ã‚¿åé›†ã‚’è‡ªå‹•åŒ–ï¼ˆä»Šå¹´4~5æœˆã‹ã‚‰ã€ã‚³ãƒ­ãƒŠã®GWã®æš‡ã¤ã¶ã—ã§ã‚¹ã‚¿ãƒ¼ãƒˆï¼‰<br>â†“</li><li>ç”»é¢ä¸Šã®æ‰‹å‹•æ“ä½œã®ä»£ã‚ã‚Šã«ã€å£²è²·æ“ä½œã®æ©Ÿæ¢°åŒ–ã€è‡ªå‹•åŒ–ï¼ˆ5~6æœˆï¼‰<br>â†“</li><li>äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’å°å…¥ã—ã€ç›´è¿‘ã®æ­´å²ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿæ–½ï¼ˆâ†ç›´è¿‘ã¾ã§ï¼‰<br>â†“</li><li>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã—ã¤ã¤ã€å®Ÿé‹ç”¨ã‚’è©¦ã¿ã‚‹ï¼ˆâ†ä»Šã“ã“ï¼‰<br>â†“</li><li>çµŒæ¸ˆæŒ‡æ¨™ãªã©ã®å¤–éƒ¨è¦ç´ ã®å½±éŸ¿ã‚’åˆ†æã—ã€ã‚‚ã†ä¸€å±¤ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬ç²¾åº¦ã‚’å‘ä¸Šï¼ˆå°†æ¥ãƒ—ãƒ©ãƒ³ï¼‰</li></ul><p>ã“ã®è‡ªå‹•å£²è²·ã‚·ã‚¹ãƒ†ãƒ ãŒæœ¬å½“ã«å„²ã‘ã‚‰ã‚Œã‚‹ã‹ï¼Ÿå®Ÿç¸¾ã¯ã©ã†ã ã£ãŸã®ï¼Ÿã‚’å ±å‘Šã—ãŸã‹ã£ãŸã‚“ã§ã™ãŒã€ã¾ã ãã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²è¡Œã—ã¦ã„ãªãã¦ã€ã¡ã‚‡ã£ã¨æ®‹å¿µã§ã™ã€‚ä»Šå›ã¯ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã ã‘å‡ºã—ã¾ã™ã€‚<br>æœ¬é‹ç”¨é–‹å§‹ã—ã¦ã‹ã‚‰ç¶™ç¶šçš„ã«å ±å‘Šã—ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚</p><h3 id="ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹æˆã¯ã“ã‚“ãªæ„Ÿã˜"><a href="#ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹æˆã¯ã“ã‚“ãªæ„Ÿã˜" class="headerlink" title="ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹æˆã¯ã“ã‚“ãªæ„Ÿã˜"></a>ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹æˆã¯ã“ã‚“ãªæ„Ÿã˜</h3><p><img src="/images/20200810/constructure.png" alt=""></p><h4 id="â‘ ãƒãƒ¼ãƒªãƒ³ã‚°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ"><a href="#â‘ ãƒãƒ¼ãƒªãƒ³ã‚°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ" class="headerlink" title="â‘ ãƒãƒ¼ãƒªãƒ³ã‚°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ"></a>â‘ ãƒãƒ¼ãƒªãƒ³ã‚°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ</h4><p>Pythonã®requestãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®Sessionã‚’ä½¿ã£ã¦ã€ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ã‚¯ãƒƒã‚­ãƒ¼æƒ…å ±ã‚’ä¿æŒã—ãªãŒã‚‰ç¶™ç¶šçš„ã«APIã‚’æœ¬ç‰©ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç™ºä¿¡é »åº¦ã§ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã™ã€‚å°†æ¥çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã«ã™ã‚‹ãŸã‚ã€Elasticsearchã‚’ä½¿ã£ã¦æºœã‚è¾¼ã‚“ã§ã„ã¾ã™ã€‚</p><p>Kibanaã§ã™ãã«å¯è¦–åŒ–ã§ãã‚‹ã®ãŒä¾¿åˆ©ã§ã™ã­ã€‚</p><p><img src="/images/20200810/polling_client.png" alt=""></p><h4 id="â‘¡å–å¼•ã«é–¢ã™ã‚‹APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ"><a href="#â‘¡å–å¼•ã«é–¢ã™ã‚‹APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ" class="headerlink" title="â‘¡å–å¼•ã«é–¢ã™ã‚‹APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ"></a>â‘¡å–å¼•ã«é–¢ã™ã‚‹APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ</h4><p>å–å¼•å‘½ä»¤ã‚’å‡ºã™ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚ãƒãƒ¼ãƒªãƒ³ã‚°ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã»ã¼åŒã˜ä½œã‚Šã§ã™ãŒã€ç®¡ç†ä¸Šã®åˆ©ä¾¿ã•ã¨é–‹ç™ºæ™‚ã®èª¤æ“ä½œã‚’é˜²ããŸã‚ã€åˆ¥ã‚³ãƒ³ãƒãƒãƒ³ãƒˆã«åˆ†ã‘ã¦ã„ã¾ã™ã€‚</p><h4 id="â‘¢äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«"><a href="#â‘¢äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«" class="headerlink" title="â‘¢äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«"></a>â‘¢äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«</h4><p>å‰è¿°ã®GARCHãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã€2ã€œ4æ™‚é–“ã®å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã€è¿‘ã„å°†æ¥ã®ç¢ºç‡ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ã€ã“ã®ã‚ˆã†ãªæƒ…å ±ã‚’å‡ºã™æ„Ÿã˜ã§ã™ã€‚</p><p>ã€Œæ¬¡ã®åˆ¤å®šæ™‚åˆ»20:20ã«ã€USD/JPYã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤æ®µ106.6ã‚ˆã‚Šé«˜ã„ç¢ºç‡ã¯32%ã€106.6ä»¥ä¸‹ã®ç¢ºç‡ã¯68%ã€</p><h4 id="â‘£æ„æ€æ±ºå®š"><a href="#â‘£æ„æ€æ±ºå®š" class="headerlink" title="â‘£æ„æ€æ±ºå®š"></a>â‘£æ„æ€æ±ºå®š</h4><p>1ã‚¿ãƒ¼ãƒ³ã®ä¸­ã«ã€è³‡é‡‘æ•°ã‚„ä¿æœ‰ã§ãã‚‹ãƒã‚±ãƒƒãƒˆæ•°ã®æ•°ã®ä¸Šé™ãŒã‚ã‚Šã¾ã™ã®ã§ã€kellyå€¤ãŒãƒ—ãƒ©ã‚¹ã«ãªã£ãŸã‚‰ã™ãã«å‹•ä½œã™ã‚‹ã®ã§ã¯ãªãã€å…¨ä½“çš„ãªãƒ™ã‚¹ãƒˆã‚’æ±‚ã‚ãŸã„ã®ã§ã™ã€‚</p><p>æ—©ã„æ®µéšã«æ±ºæ–­ã—ãŸã‚‰ã€å¾Œã‹ã‚‰ã‚‚ã£ã¨è‰¯ã„ãƒãƒ£ãƒ³ã‚¹ã‚’å¤±ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ãšã£ã¨èºŠèº‡ã—ã¦æ±ºã‚ãªã„ã¾ã¾ã§ã€éå»ã«æˆ»ã‚Œãªã„ã—ã€æœ€è‰¯ã®åœæ­¢ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’æ¢ã™<a href="https://ja.wikipedia.org/wiki/%E7%A7%98%E6%9B%B8%E5%95%8F%E9%A1%8C" target="_blank" rel="noopener">ç§˜æ›¸å•é¡Œ</a>ãŒå‚è€ƒã«ãªã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚<br>ãã—ã¦ã€ã„ã‚ã‚“ãªã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¦ç¶™ç¶šçš„ã«èª¿æ•´ã™ã‚‹ã®ã§ã™ã€‚</p><h4 id="â‘¤ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"><a href="#â‘¤ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³" class="headerlink" title="â‘¤ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"></a>â‘¤ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4><p>Elasticsearchã«æºœã‚ãŸéå»ãƒ‡ãƒ¼ã‚¿ã¯å­¦ç¿’ã®ææ–™ã«ãªã£ã¦ã€ã©ã†ã„ã†ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é©ç”¨ã—ãŸã‚‰å„²ã‹ã‚‹ã‹ã€ãã—ã¦ã€éå­¦ç¿’ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã€ä»Šå›ä½¿ã£ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã ã‘ã«ãƒ•ã‚£ãƒƒãƒˆã™ã‚‹ã˜ã‚ƒãªãã¦ã€ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãªã‚‹ã¹ãæ¸›ã‚‰ã—ã¾ã™ã€‚</p><p>GARCHãƒ¢ãƒ‡ãƒ«ã®<a href="https://ja.wikipedia.org/wiki/%E3%83%99%E3%82%A4%E3%82%BA%E6%83%85%E5%A0%B1%E9%87%8F%E8%A6%8F%E6%BA%96" target="_blank" rel="noopener">ãƒ™ã‚¤ã‚ºæƒ…å ±é‡è¦æº– BIC</a>ï¼ˆãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ•°ãŒå¤šã„ã»ã©ãƒ¢ãƒ‡ãƒ«ç²¾åº¦ã®è©•ä¾¡ã«ç½°ã‚’ä¸ãˆã‚‹è©•ä¾¡åŸºæº–ï¼‰ã‚’å‚è€ƒã—ãªãŒã‚‰ã€ä¸€å®šã®æ°´æº–ä»¥ä¸‹ã®ã‚‚ã®ã ã‘æ¡ç”¨ã™ã‚‹å½¢ã«ãªã‚Šã¾ã™ã€‚</p><p>ä»¥ä¸‹ã¯ã„ã„åŠ æ¸›ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚åˆæœŸ10000å††ã®è³‡æœ¬é‡‘ã¨ãã®å¾Œã®å¤‰åŒ–ã®çµæœã§ã™ã€‚</p><p>6æœˆ1ãƒ¶æœˆé–“ã®å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚ç§æ‰‹å‹•ã§1é€±é–“å…¨æã‚ˆã‚Šã€1ãƒ¶æœˆé–“ã§ã»ã¼å…¨æã§ã—ãŸã­ã€‚</p><p><img src="/images/20200810/simulation1.png" alt=""></p><p>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é©åº¦ã«èª¿æ•´ã—ã¦ã€å°‘ã—æ”¹å–„ã•ã‚ŒãŸä¾‹ã§ã™ãŒã€ã¾ã å³è‚©ä¸‹ãŒã‚Šã®ãƒˆãƒ¬ãƒ³ãƒ‰ã§ã™ã­ã€‚</p><p><img src="/images/20200810/simulation2.png" alt=""></p><p>ä»¥ä¸‹ã¯ã€<em>ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æˆ¦ç•¥</em>ã¨æ™®é€šã®å£²è²·ã®ãƒŸãƒƒã‚¯ã‚¹ã‚’ä½¿ã£ãŸã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®è³‡æœ¬é‡‘ã®å¤‰åŒ–ã®çµæœã§ã™ã€‚<br>æœˆæœ«ã«æœˆåˆã®2.5å€ã«ãªã‚Šã¾ã—ãŸã€‚</p><p><img src="/images/20200810/simulation3.png" alt=""></p><p><em>ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æˆ¦ç•¥</em>ã¨ã¯ã€å‰è¿°ã®å€¤å‹•ãã®æ–¹å‘ã‚’äºˆæ¸¬ã—ãªãã¦ã€å€¤å‹•ãã®å¤‰å‹•ï¼ˆåˆ†æ•£ã‚„ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼‰ã®é‡ã‚’äºˆæ¸¬ã§ããŸã‚‰å„²ã‹ã‚‹æ–¹æ³•ã§ã™ã€‚</p><h3 id="ã€è£œè¶³ã€‘ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æˆ¦ç•¥"><a href="#ã€è£œè¶³ã€‘ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æˆ¦ç•¥" class="headerlink" title="ã€è£œè¶³ã€‘ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æˆ¦ç•¥"></a>ã€è£œè¶³ã€‘ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æˆ¦ç•¥</h3><p>ã‚ªãƒ—ã‚·ãƒ§ãƒ³å–å¼•ã®æˆ¦ç•¥ã®ä¸€ã¤ã§ã™ã€‚</p><p>ä¾‹ãˆã°ã€<code>USD/JPY 108.7 HIGH</code>ã¨<code>USD/JPY 108.6 LOW</code>ã®åŒæšæ•°ã‚’è³¼å…¥ã—ã€ç›¸å ´ãŒ108.6ã€œ108.7ã®ç¯„å›²ã§å‹•ãã¨æå¤±ã€ç›¸å ´ãŒãã®ç¯„å›²å¤–ã«å¤§ããå‹•ã„ãŸå ´åˆã¯åˆ©ç›Šã§ã™ã€‚</p><p>ã“ã®ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã¯ã€ã‚ã‚‹ç¨‹åº¦ãƒªã‚¹ã‚¯ã®ãƒ˜ãƒƒã‚¸ãŒå¯èƒ½ã§ã™ã€‚ã‚‚ã£ã¨å¤§ãã„æ„å‘³ã¯ã€äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ã€å€¤æ®µã®å‹•ãæ–¹å‘ã®ç²¾åº¦ã¨ã¯é–¢ä¿‚ãªãã€å€¤æ®µã®åˆ†æ•£ï¼ˆãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼‰ã®äºˆæ¸¬ã¯ã€ã‚ã‚‹ç¨‹åº¦ã®ç²¾åº¦ãŒå‡ºã‚‹ãªã‚‰å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚</p><h2 id="æ³¨æ„æ›¸ã"><a href="#æ³¨æ„æ›¸ã" class="headerlink" title="æ³¨æ„æ›¸ã"></a>æ³¨æ„æ›¸ã</h2><p>ãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯1ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¤ãè²·ãˆã‚‹ãƒ­ãƒƒãƒˆæ•°ã¯ä¸Šé™ãŒã‚ã‚‹ï¼ˆã‚®ãƒ£ãƒ³ãƒ–ãƒ«ã¨ã‹ã‚‚ä¸€ç·’ï¼‰ã€è¤‡åˆ©ã¨ã—ã¦å›ã›ã¾ã›ã‚“ã€‚ã¤ã¾ã‚Šã€ä»–ã®é‡‘èæŠ•è³‡ã¿ãŸã„ã«ã€å„²ã‹ã£ãŸãŠé‡‘ã‚’ç”¨ã„ã¦ã€æ¯”ç‡çš„ã«æ‹¡å¤§ã—ã¦ã„ãã“ã¨ã¯ä¸å¯èƒ½ãªã®ã§ã€é•·æœŸçš„ãªé‹ç”¨ã«ã¯å‘ã„ã¦ã„ã¾ã›ã‚“ã€‚ä¸€å®šè¦æ¨¡ã®è³‡é‡‘ã«ãªã£ãŸã‚‰ã€é…å½“ã®ã‚ˆã†ã«å¾ã€…ã«å‡ºé‡‘ã—ã¦ã„ãã®ãŒè³¢æ˜çš„ã§ã™ã­ã€‚</p><p><strong>ã©ã‚“ãªã«æŠ€è¡“ã‚’ä½¿ã£ã¦ã‚‚ã€ãƒã‚¤ãƒªã‚¹ã‚¯ã§ã‚ã‚‹ã“ã¨ã¯ç›¸å¤‰ã‚ã‚‰ãšã€æã™ã‚‹å¯èƒ½æ€§ã‚‚ååˆ†ã«ã‚ã‚Šã¾ã™ã€‚</strong></p><p>ãã®ç†ç”±ã¯ä»¥ä¸‹ã§ã™ã€‚</p><ul><li>äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã®ã‚¤ãƒ³ãƒ—ãƒƒãƒˆãŒã‚ãã¾ã§éå»ã®ãƒ‡ãƒ¼ã‚¿ã ã‘ã€æœªæ¥ã«å¯¾ã™ã‚‹äºˆæ¸¬ã®ç²¾åº¦ãŒæœ‰é™ã§ã‚ã‚‹</li><li>æœ‰åˆ©ãªãƒˆãƒ¬ãƒ¼ãƒ‰ã§ã‚‚ã€å€‹åˆ¥ã«æã™ã‚‹ã“ã¨ãŒååˆ†ã‚ã‚Šã†ã‚‹ã€‚ç¶šã‘ã¦ã‚„ã‚‰ãªã„ã¨ã€å¤§æ•°ã®æ³•å‰‡ã®å¨åŠ›ãŒç™ºæ®ã§ããªã„</li></ul><h2 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h2><ul><li>ä»Šå›è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’è‡ªä½œã™ã‚‹ç†ç”±<ul><li>ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯äººé–“æ€§é•åã§ã€ç§ã‚‚ãã‚Œã«æ‰èƒ½ãŒãªã„</li><li>ä¿¡ç”¨ã—ãªã„å¸‚è²©ç³»ãƒ„ãƒ¼ãƒ«ã«ãŠé‡‘ã‚’ã‹ã‘ãŸããªã„</li><li>ITæŠ€è¡“ãªã‚‰æŒã£ã¦ãŠã‚Šã€æ•°å­¦ãƒ»é‡‘èã®çŸ¥è­˜ãªã‚‰å‹‰å¼·ã§ãã‚‹</li><li>æœ¬å½“ã«è¡Œã‘ã‚‹ã‹ã©ã†ã‹ã‚’æ¢æ±‚ã—ãŸã„å¥½å¥‡å¿ƒé§†ä½¿ã€ä½•ã‚ˆã‚Šã‚‚è¶£å‘³ãŒå¤§äº‹</li></ul></li><li>ä»Šå›è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’å¿…è¦ãªçŸ¥è­˜ã€æŠ€è¡“<ul><li>FXãƒã‚¤ãƒŠãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ¦‚å¿µã¨ãƒ«ãƒ¼ãƒ«</li><li>GARCHãƒ¢ãƒ‡ãƒ«ï¼šåˆ†æ•£ã®é•·æœŸè¨˜æ†¶æ€§ã«åŸºã¥ã„ãŸäºˆæ¸¬ã®GARCHãƒ¢ãƒ‡ãƒ«</li><li>ãƒ™ã‚¤ã‚ºæƒ…å ±é‡è¦æº–ï¼šéå‰°é©åˆã‚’é˜²æ­¢ã®ãŸã‚ã€ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ã‚’ã‚ã’ã‚‹åŒæ™‚ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ç”¨ã®æŒ‡æ¨™</li><li>KellyåŸºæº–ï¼šå‹ç‡ã¨ãƒšãƒ¼ã‚¢ã‚¦ãƒˆãŒåˆ†ã‹ã‚Œã°ã€å–å¼•ãŒæœ‰åˆ©ã‹ä¸åˆ©ã‹ã‚’åˆ¤åˆ¥ã§ãã€æœ‰åˆ©ãªå–å¼•ã«å¯¾ã—ã¦ä½•å‰²ã‚’è³­ã‘ãŸã»ã†ãŒåŠ¹ç‡çš„ãªã®ãŒåˆ†ã‹ã‚‹</li><li>ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æˆ¦ç•¥ï¼šå€¤å‹•ãã®æ–¹å‘ã®äºˆæ¸¬ã‚’è«¦ã‚ã€åˆ†æ•£ã®äºˆæ¸¬ã§å„²ã‹ã‚‹æ‰‹æ³•ï¼ˆçµŒæ¸ˆæŒ‡æ¨™ãªã©ã®é–‹ç¤ºå‰ã«ä½¿ã†ã®ãŒæœ‰åŠ¹ã‹ã‚‚ã—ã‚Œãªã„ã€€â†å°†æ¥ã«ã“ã®è¦ç´ ã‚’è‡ªå‹•å–å¼•ã«å–ã‚Šè¾¼ã‚€ã¨æ€ã„ã¾ã™ï¼‰</li><li>è‡ªå‹•åŒ–ãƒ‡ãƒ¼ã‚¿åé›†ã€å¤‰å½¢ã€åˆ†æã«å¿…è¦ãªITæŠ€è¡“</li><li>ä¸å¯§ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã€é•·ãç¶šãå¿è€</li></ul></li><li>ä»Šå›è‡ªå‹•å£²è²·ãƒ„ãƒ¼ãƒ«ã‚’ä½œã£ãŸçµæœ<ul><li>æ‰‹å‹•ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ãƒ€ãƒ¡ãƒ€ãƒ¡ã§ã—ãŸãŒã€è‡ªå‹•åŒ–ã«ã‚ˆã£ã¦ã€ãƒªã‚¿ãƒ¼ãƒ³ã®æœŸå¾…å€¤ãŒãƒã‚¤ãƒŠã‚¹ã®ä¸åˆ©ãªãƒˆãƒ¬ãƒ¼ãƒ‰ã‚’é¿ã‘ã‚‰ã‚ŒãŸ</li><li>ã‚¹ãƒˆãƒ©ãƒ‰ãƒ«æˆ¦ç•¥ãªã©ãƒªã‚¹ã‚¯ãƒ˜ãƒƒã‚¸ã®æ‰‹æ³•ã‚’ä½µç”¨ã—ã¦ã€ã„ã„çµæœã‚’å¾—ã‚‰ã‚Œã‚‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãŸ</li><li>ã‚·ã‚¹ãƒ†ãƒ ã®æ”¹å–„ã‚’ã—ã¤ã¤ã‚ã‚‹ãŒã€æ‰‹å‹•ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚’ã‚„ã‚ã¦ã€å®Œå…¨ã«è‡ªå‹•åŒ–ã™ã‚‹ã®ã¯ã“ã‚Œã‹ã‚‰ã€‚</li></ul></li></ul><p>å¯ã¦ã„ã‚‹é–“ã‚‚ãƒãƒ£ãƒªãƒ³ãƒãƒ£ãƒªãƒ³ãŒèã“ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ï¼ˆç¬‘ï¼‰</p><p><img src="/images/20200810/image.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://future-architect.github.io/articles/20200726/&quot;&gt;ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶é€£è¼‰&lt;/a&gt;ã®6å›ç›®ã§ã™ã€‚&lt;/p&gt;
&lt;h2 id=&quot;è‡ªå·±ç´¹ä»‹&quot;&gt;&lt;a href=&quot;#è‡ªå·±ç´¹ä»‹&quot; class=&quot;head
      
    
    </summary>
    
    
      <category term="Infrastructure" scheme="https://future-architect.github.io/categories/Infrastructure/"/>
    
    
      <category term="Elastic-Stack" scheme="https://future-architect.github.io/tags/Elastic-Stack/"/>
    
      <category term="Kibana" scheme="https://future-architect.github.io/tags/Kibana/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
      <category term="FinTech" scheme="https://future-architect.github.io/tags/FinTech/"/>
    
      <category term="ElasticSearch" scheme="https://future-architect.github.io/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>API Meetup Online #3ã§é™å®šå…¬é–‹URLï¼ˆCapability URLsï¼‰ã«ã¤ã„ã¦è©±ã‚’ã—ã¦ãã¾ã—ãŸã€‚</title>
    <link href="https://future-architect.github.io/articles/20200809/"/>
    <id>https://future-architect.github.io/articles/20200809/</id>
    <published>2020-08-08T15:00:00.000Z</published>
    <updated>2020-08-11T15:23:23.762Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/20200809/93281_normal.png" class="img-middle-size"><p><a href="https://api-meetup.doorkeeper.jp/events/109648" target="_blank" rel="noopener">API Meetup Online #3</a>ã§ã®ç™»å£‡ã‚’ãŠèª˜ã„ã‚’ã„ãŸã ã„ãŸã®ã§ã€ä»¥å‰ã‹ã‚‰èª¿æŸ»ã—ã¦ã„ãŸã‚‚ã®ã®ã€ç™ºè¡¨ã®æ©Ÿä¼šã®ãªã‹ã£ãŸé™å®šå…¬é–‹URLã«ã¤ã„ã¦èª¿ã¹ã¦ã„ãŸå†…å®¹ã‚’ç™ºè¡¨ã—ã¾ã—ãŸã€‚</p><iframe src="https://docs.google.com/presentation/d/e/2PACX-1vRLdRFqBXd35VgVUCvrXsn3kN4rUu7HDzIoy0Kibs_ThTD3mnWpagkGkpNY1a7J8uWijf0lX8SdRBo3/embed?start=false&loop=false&delayms=3000" frameborder="0"  width="100%" height="569px" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe><p>Real World HTTPã®ç¬¬3ç‰ˆãŒå‡ºã‚‹ã¨ã—ãŸã‚‰ï¼ˆå…·ä½“çš„ãªè¨ˆç”»ã¨ã‹ã¯ãªã„ã§ã™ãŒï¼‰å…¥ã‚Œã‚‹ã‹ã‚‚ã€ãªãƒã‚¿ã§ã—ãŸã€‚ã©ã¡ã‚‰ã‹ã¨ã„ã†ã¨ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼å‘ã‘ãªæ©Ÿèƒ½ãªæ°—ãŒã—ã¾ã™ãŒã€hipchatã¯ä»¥å‰ã€å…±æœ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒã“ã®Capability URLsã ã£ãŸã¨ã„ã†å™‚ã‚‚èãã¾ã™ã—ã€ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚ˆã£ã¦ã¯ã‚¨ãƒ³ãƒ—ãƒ©ã§ã‚‚ä½¿ã£ã¦ã„ã‚‹ã‚‚ã®ã‚‚ã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚è‡ªåˆ†ã§å®Ÿè£…ã™ã‚‹ã«ã—ã¦ã‚‚ã€åˆ©ç”¨ã™ã‚‹å´ã ã£ãŸã‚Šã¨ã„ã‚ã‚“ãªç«‹å ´ã§ã“ã®æ©Ÿèƒ½ã«é–¢ã‚ã‚‹å ´åˆã«ã€ãã®å®‰å…¨æ€§ã‚’è©•ä¾¡ã™ã‚‹ç‰©å·®ã—ã¯æŒã£ã¦ãŠããŸã„ãªã€ã¨ã„ã†ã“ã¨ã§èª¿ã¹ã¾ã—ãŸã€‚</p><p>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çš„ã«ã¯ã€ã€Œç‰¹å®šã®èª°ã‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ã€ã§ã‚‚ã€ã€Œèª°ã§ã‚‚ã„ã„ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¦‹ã¤ã‘ã‚‹ã€ã§ã‚‚ã€ã‹ãªã‚Šè¦‹ã¤ã‘ã‚‹ã®ã¯é›£ã—ã„ã‚“ã˜ã‚ƒãªã„ã‹ã€ã¨ã„ã†ã®ãŒæ‰€æ„Ÿã§ã™ã€‚ãŸã ã€ã€Œèª°ãŒã„ã¤ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã®ã‹ã€ã¨ã„ã†è¨¼è·¡ãŒå¿…è¦ãªå ´åˆã«ã¯åˆã‚ãªã„ã‹ã‚‚ã­ã€ã¨ã„ã†ã®ã‚‚ã‚ã‚Šã¾ã™ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãªã©ã‚’ã‚„ã‚Šã¨ã‚Šã—ãªã„ã§ã€ŒçŸ¥ã£ã¦ã„ã‚‹ã€ã¨ã„ã†æ¡ä»¶ã ã‘ã§ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æºãŒç°¡å˜ã«è¡ŒãˆãŸã‚Šã‚‚ã™ã‚‹ã®ã§ã€ä½¿ãˆã‚‹ã‹ã©ã†ã‹ã¯ã‚·ã‚¹ãƒ†ãƒ ã”ã¨ã®è¦ä»¶æ¬¡ç¬¬ã§ã™ã­ã€‚ãã®è¦ä»¶ã¨ç…§ã‚‰ã—åˆã‚ã›ã¦ä½¿ãˆã‚‹ã‹ã©ã†ã‹åˆ¤æ–­ã™ã‚‹ãŸã‚ã«ã‚‚ã¾ã¨ã¾ã£ãŸè³‡æ–™ã¨ã—ã¦ä¾¡å€¤ãŒã‚ã‚‹ã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚</p><p>å½“æ—¥è³ªå•ã•ã‚ŒãŸã€ã‚­ãƒ¼ã®è¡çªã«é–¢ã—ã¦ã§ã™ãŒã€ç”Ÿæˆã—ãŸã‚­ãƒ¼ã¯DBã«ç™»éŒ²ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯æœ¬ç•ªã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å‚ç…§ã™ã‚‹ã®ã«ã‚‚å¿…è¦ã§ã™ã—ã€èª°ãŒç”Ÿæˆã—ãŸã‚‚ã®ã‹ã€ãƒªã‚½ãƒ¼ã‚¹ã‚ªãƒ¼ãƒŠãƒ¼ã¨ã®ç´ä»˜ã‘ã®ãŸã‚ã«ã‚‚å¿…è¦ã§ã™ã€‚ã‚ã¨ã‹ã‚‰ã‚ªãƒ¼ãƒŠãƒ¼ãŒå…±æœ‰ã‚’è§£é™¤ã—ãŸã‚Šã¨ã‹ã‚‚ã‚ã‚Šã¾ã™ã‹ã‚‰ã­ã€‚ãã®ãŸã‚ã€DBã«ä¿å­˜ã—ã¦ãŠã„ã¦ã€ãã‚Œã¨ã®é‡è¤‡ãƒã‚§ãƒƒã‚¯ã¯å¯èƒ½ã§ã™ã€‚å‚è€ƒã®Goå®Ÿè£…ã‚’è²¼ã£ã¦ãŠãã¾ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"io"</span></span><br><span class="line">   <span class="string">"crypto/rand"</span></span><br><span class="line">   <span class="string">"encoding/base64"</span></span><br><span class="line">   <span class="string">"image"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ¬å½“ã¯DBã¨ã‹ã‚’ä½¿ã†</span></span><br><span class="line"><span class="keyword">var</span> existingImages := <span class="keyword">map</span>[<span class="keyword">string</span>]image.Image</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">genPublicKey</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    baseCode := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">30</span>)</span><br><span class="line">    <span class="comment">// é‡è¤‡ã—ãŸå…¬é–‹URLã‚’ç”Ÿæˆã—ãªã„ã‚ˆã†ã«ã€ãƒ«ãƒ¼ãƒ—ã—ã¦ã¶ã¤ã‹ã‚‰ãªã„ã‚­ãƒ¼ãŒç¢ºå®Ÿã«ç”Ÿæˆã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹</span></span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        io.ReadFull(rand, baseCode)</span><br><span class="line">        publicKey := base64.StdEncoding.EncodeToString(baseCode)</span><br><span class="line">        <span class="keyword">if</span> _, ok := existingImages[publicKey]; !ok &#123;</span><br><span class="line">            <span class="keyword">return</span> publicKey;        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">registerImage</span><span class="params">(img image.Image)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    key := genPublicKey()</span><br><span class="line">    existingImages[key] = img</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"https://example.com/images/"</span> + key</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã¯é›‘ã«base64ã«ã—ã¦ã„ã¾ã™ãŒã€è¨˜å·ãŒå…¥ã‚‰ãªã„ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦base62ãŒã‚ã‚Šã¾ã™ã€‚UUID v4ãªã‚“ã ã‘ã©base64ã§ãªã‚‹ã¹ãæ–‡å­—åˆ—é•·ã‚’çŸ­ãã™ã‚‹Goãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚æ˜”ä½œã£ã¦ã¿ã¾ã—ãŸã€‚ã“ã®ã‚ãŸã‚Šã€ã©ã‚Œã ã‘çŸ­ãã™ã‚‹ã‹ã€åˆ©ä¾¿æ€§ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚„ç©ºé–“ã®åºƒã•ã‚’ã©ã†ã™ã‚‹ã‹ã¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°çš„ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãŒæ¥½ã—ã„åˆ†é‡ã‹ã¨æ€ã„ã¾ã™ã€‚ã©ã†ã„ã£ãŸIDç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ã£ã¦ã¯ã„ã‘ãªã„ã‹ã€ã¨ã‹ã‚‚è³‡æ–™ã§ã¯è§¦ã‚Œã¦ã„ã¾ã™ã€‚</p><p><a href="https://github.com/shibukawa/uuid62" target="_blank" rel="noopener">https://github.com/shibukawa/uuid62</a></p><p>ä»–ã«ã¯ã€Google Cloudã®AIç³»ã®APIã®ç™ºè¡¨ãŒã‚ã‚Šã¾ã—ãŸã€‚ä»•äº‹ã‚„è¶£å‘³ã§ä½¿ã†ãƒãƒ£ãƒ³ã‚¹ã‚‚ã‚ã‚‹ã®ã§çŸ¥ã‚‰ãªã„å†…å®¹ã¯ãªã‹ã£ãŸã®ã§ã™ãŒã€ã€Œã‚¢ãƒ³ãƒ‘ãƒ³ãƒãƒ³ã€ã‚’å«ã‚€éŸ³å£°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«ãƒ†ã‚­ã‚¹ãƒˆåŒ–ã—ã€ã•ã‚‰ã«è‹±èªç¿»è¨³ã™ã‚‹ã¨ã„ã†ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¨ãƒ¼ã‚¹ã®è—æŒã•ã‚“ã®ç™ºè¡¨ã®ãƒ‡ãƒ¢ã¯é¢ç™½ã‹ã£ãŸã§ã™ã€‚ã‚¦ã‚§ã‚¶ãƒ¼ãƒ‹ãƒ¥ãƒ¼ã‚ºï¼ˆã‚ºã¯æ¿ç‚¹ï¼‰ã®äº•åŸã•ã‚“ã®ç™ºè¡¨ã‚‚ã€ãƒ‡ãƒ¼ã‚¿é‡ã¨ã‹ã‚‚ã‚ã‚‚ã‚ã§ãã®åˆ†é‡ã§ã®åœ§å€’çš„ãªæ„Ÿã˜ãŒã‚ã£ã¦è‰¯ã‹ã£ãŸã§ã™ã€‚ãƒãƒ£ãƒ³ã‚¹ãŒã‚ã‚Œã°ä½¿ã£ã¦ã¿ãŸã„ã€‚</p><p>API Meetupã®é‹å–¶ã®ã¿ãªã•ã¾ã€ç™ºè¡¨ã®æ©Ÿä¼šã‚’ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/20200809/93281_normal.png&quot; class=&quot;img-middle-size&quot;&gt;

&lt;p&gt;&lt;a href=&quot;https://api-meetup.doorkeeper.jp/events/109648&quot; target=&quot;_
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="ç™»å£‡è³‡æ–™" scheme="https://future-architect.github.io/tags/%E7%99%BB%E5%A3%87%E8%B3%87%E6%96%99/"/>
    
      <category term="Web" scheme="https://future-architect.github.io/tags/Web/"/>
    
      <category term="HTTP" scheme="https://future-architect.github.io/tags/HTTP/"/>
    
  </entry>
  
  <entry>
    <title>Goã¨SuffixArray</title>
    <link href="https://future-architect.github.io/articles/20200807/"/>
    <id>https://future-architect.github.io/articles/20200807/</id>
    <published>2020-08-06T15:00:00.000Z</published>
    <updated>2020-08-11T02:24:20.940Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/20200807/suffixarray.png" class="img-small-size"><p><a href="https://future-architect.github.io/articles/20200726/">ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶é€£è¼‰</a>ã®5å›ç›®ã§ã™ã€‚</p><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>TIG ã®è¾»ã§ã™ã€‚</p><p>Go ã¯æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå……å®Ÿã—ã¦ã„ã‚‹ã¨ã‚ˆãè¨€ã‚ã‚Œã¾ã™ã€‚æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã ã‘ã§ã€HTTP ã‚µãƒ¼ãƒã‚’ä½œã‚ŒãŸã‚Šã€æš—å·åŒ–å‡¦ç†ã‚„ã€JSON ã‚„ CSV ã¨ã„ã£ãŸãƒ‡ãƒ¼ã‚¿å½¢å¼ã‚’æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚<code>go list std | grep -v vendor | wc -l</code> ã¨ã—ã¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•°ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ç´„ 200 ã‚‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ã€ãã®å¤šãã® Go ã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸­ã§ã‚‚ã€å€‹äººçš„ã«é¢ç™½ã„ãªã¨æ€ã£ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚<a href="https://golang.org/pkg/index/suffixarray/" target="_blank" rel="noopener">suffixarray</a> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ã€‚</p><p><code>suffixarray</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ Suffix Array ã‚’æ‰±ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚<code>suffixarray</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®é­…åŠ›ã‚’æ„Ÿã˜ã‚‹ã«ã¯ã€ã¾ãš Suffix Array ã¨ã¯ä½•ã‹ï¼Ÿã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚‹ã§ã—ã‚‡ã†ã€‚</p><h2 id="Suffix-Arrayã¨ã¯"><a href="#Suffix-Arrayã¨ã¯" class="headerlink" title="Suffix Arrayã¨ã¯"></a>Suffix Arrayã¨ã¯</h2><p>Suffix Array ã¯ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã® 1 ã¤ã§ã™ã€‚1990 å¹´ã« Udi Manber, Gene Myers ã«ã‚ˆã£ã¦è€ƒæ¡ˆã•ã‚Œã¾ã—ãŸã€‚Suffix Array ã‚’ç”¨ã„ã‚‹ã¨ã€æ¤œç´¢ã—ãŸã„ä»»æ„ã®æ–‡å­—åˆ—ã‹ã‚‰ã€æ¼ã‚Œãªãé«˜é€Ÿã«æ–‡å­—åˆ—ã‚’æ¤œç´¢ã§ãã¾ã™ã€‚å…¨æ–‡æ¤œç´¢ã‚„ãƒ‡ãƒ¼ã‚¿åœ§ç¸®ã¨ã„ã£ãŸå¿œç”¨ãŒã‚ã‚Šã¾ã™ã€‚</p><p>Suffix Array ã¯æ–‡å­—åˆ—ã®ã™ã¹ã¦ã® suffix ã‚’è¾æ›¸é †ã§ã‚½ãƒ¼ãƒˆã—ã€ãã‚Œãã‚Œã® suffix ã®å…ƒã®æ–‡å­—åˆ—ã«ãŠã‘ã‚‹é–‹å§‹ä½ç½®ã‚’ä¿æŒã™ã‚‹é…åˆ—ã§ã™ã€‚é•·ã•ãŒ n ã§ã‚ã‚‹æ–‡å­—åˆ— T ã® suffix ã¨ã¯ 1 â‰¦ i â‰¦ n ãªã‚‹ i ã«ã¤ã„ã¦ T ã® i æ–‡å­—ç›®ã‹ã‚‰ n æ–‡å­—ç›®ã¾ã§ã®éƒ¨åˆ†æ–‡å­—åˆ—ã®ã“ã¨ã‚’æŒ‡ã—ã¾ã™ã€‚å…·ä½“çš„ã« <code>banana</code> ã¨ã„ã†æ–‡å­—åˆ—ã§è€ƒãˆã¦ã¿ã¾ã™ã€‚<code>banana</code> ã®ãŠã‘ã‚‹ suffix ã¯ä»¥ä¸‹ã® 6 ã¤ã§ã™ã€‚</p><ul><li>banana</li><li>anana</li><li>nana</li><li>ana</li><li>na</li><li>a</li></ul><p>å„ suffix ã®é–‹å§‹ä½ç½®ã‚’ã‚ã‚ã›ã¦è¨˜è¼‰ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><table><thead><tr><th align="left">é–‹å§‹ä½ç½®</th><th>suffix</th></tr></thead><tbody><tr><td align="left">1</td><td>banana</td></tr><tr><td align="left">2</td><td>anana</td></tr><tr><td align="left">3</td><td>nana</td></tr><tr><td align="left">4</td><td>ana</td></tr><tr><td align="left">5</td><td>na</td></tr><tr><td align="left">6</td><td>a</td></tr></tbody></table><p>ã“ã‚Œã‚‰ã® suffix ã‚’è¾æ›¸é †ã§ã‚½ãƒ¼ãƒˆã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><table><thead><tr><th align="left">é–‹å§‹ä½ç½®</th><th>suffix</th></tr></thead><tbody><tr><td align="left">6</td><td>a</td></tr><tr><td align="left">4</td><td>ana</td></tr><tr><td align="left">2</td><td>anana</td></tr><tr><td align="left">1</td><td>banana</td></tr><tr><td align="left">5</td><td>na</td></tr><tr><td align="left">3</td><td>nana</td></tr></tbody></table><p>ã‚ˆã£ã¦ã€<code>banana</code> ã®æ–‡å­—åˆ—ã«ãŠã‘ã‚‹ Suffix Array ã¨ã¯ [6, 4, 2, 1, 5, 3] ã¨ã„ã†é…åˆ—ã«ãªã‚Šã¾ã™ã€‚suffix ã®é–‹å§‹ä½ç½®ãŒã‚ã‚Œã°å…ƒã® suffix ã‚’æ§‹æˆã™ã‚‹ã“ã¨ãŒã§ãã€é–‹å§‹ä½ç½®ã‹ã‚‰ n æ–‡å­—ç›®ã¾ã§ã®éƒ¨åˆ†æ–‡å­—åˆ—ã«ãªã‚Šã¾ã™ã€‚<code>banana</code> ã«ãŠã‘ã‚‹ suffix ã®é–‹å§‹ä½ç½®ãŒ 3 ã§ã‚ã‚Œã°å…ƒã® suffix ã¯ 3 æ–‡å­—ç›®ã‹ã‚‰ 6 æ–‡å­—ç›®ã¾ã§ã®éƒ¨åˆ†æ–‡å­—åˆ—ã§ã‚ã‚‹ãŸã‚ã€<code>nana</code> ã¨ã„ã† suffix ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p><h3 id="æ–‡å­—åˆ—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°"><a href="#æ–‡å­—åˆ—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°" class="headerlink" title="æ–‡å­—åˆ—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°"></a>æ–‡å­—åˆ—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°</h3><p>Suffix Array ãŒã©ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚ã‚‹ã‹åˆ†ã‹ã‚Šã¾ã—ãŸã€‚æ¬¡ã« Suffix Array ã‚’ç”¨ã„ã¦ã€æ–‡å­—åˆ—ã‚’ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚<code>banana</code> ã¨ã„ã†æ–‡å­—åˆ—ã‹ã‚‰ <code>an</code> ã¨ã„ã†æ–‡å­—åˆ—ã‚’ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚b<font color="Red">an</font><font color="Blue">an</font>a ã§ã™ã‹ã‚‰ã€èµ¤æ–‡å­—ã§ã‚ã‚‹ 2 æ–‡å­—ç›®ã‹ã‚‰ 3 æ–‡å­—ç›®ã® <code>an</code> ã¨ã€é’æ–‡å­—ã§ã‚ã‚‹ 4 æ–‡å­—ç›®ã‹ã‚‰ 5 æ–‡å­—ç›®ã® <code>an</code> ã® 2 ç®‡æ‰€ã§ãƒãƒƒãƒã—ã¾ã™ã€‚æ–‡å­—åˆ— T ã®ä»»æ„ã®éƒ¨åˆ†æ–‡å­—åˆ—ã¯ã€ãã®å‡ºç¾ä½ç½®ã‚’é–‹å§‹ä½ç½®ã¨ã™ã‚‹ T ã® suffix ã® prefix ã§ã™ã€‚ã¤ã¾ã‚Š <code>an</code> ã§ã‚ã‚Œã° suffix <code>ana</code> ã® prefix ã§ã‚ã‚‹ <code>an</code> ã¨ suffix  <code>anana</code> ã® prefix ã§ã‚ã‚‹ <code>an</code> ã§ã™ã€‚ã“ã®ã‚ˆã†ã«æ–‡å­—åˆ— P ã‚’ prefix ã¨ã—ã¦ã‚‚ã¤ã‚ˆã†ãªã€T ã® suffix ã‚’æ¢ç´¢ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€æ–‡å­—åˆ—ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ãŒã§ãã¾ã™ã€‚Suffix Array ã¯æ–‡å­—åˆ—ã® suffix ãŒè¾æ›¸é †ã§ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸ suffix ã®é–‹å§‹ä½ç½®ã‚’ä¿æŒã—ã¦ã„ã‚‹ãŸã‚ã€äºŒåˆ†æ¢ç´¢ã‚’ç”¨ã„ã¦ã€é«˜é€Ÿã«ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã§ãã¾ã™ã€‚</p><p><code>banana</code> ã® Suffix Array ãŒæ±‚ã‚ã‚‰ã‚Œã¦ã„ã‚‹ã¨ã—ã¦ã€Go ã§æ¢ç´¢ã™ã‚‹å®Ÿè£…ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚å®Ÿè£…ä¸Šã® Suffix Array ã¯ 0-indexed ã¨ã—ã¾ã™ã€‚</p><ul><li>Suffix Array ã‚’äºŒåˆ†æ¢ç´¢ã—ã¦ã€ä¸€è‡´ã™ã‚‹ã™ã¹ã¦ã® suffix ã‚’æ¤œç´¢ã™ã‚‹å®Ÿè£…ä¾‹</li></ul><figure class="highlight go"><figcaption><span>main.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"sort"</span></span><br><span class="line"><span class="string">"strings"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">t := <span class="string">"banana"</span></span><br><span class="line">p := <span class="string">"an"</span> <span class="comment">// ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„æ–‡å­—åˆ—</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// banana ã® Suffix Array (0-indexed)</span></span><br><span class="line">sa := []<span class="keyword">int</span>&#123;<span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">2</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// strings.Compare ã®æˆ»ã‚Šå€¤ãŒ 0 ã‚ˆã‚Šã‚‚å¤§ãã„ã†ã¡ã®æœ€å°ã® index ã‚’æ¢ç´¢</span></span><br><span class="line">left := sort.Search(<span class="built_in">len</span>(sa), <span class="function"><span class="keyword">func</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> strings.Compare(t[sa[i]:min(sa[i]+<span class="built_in">len</span>(p), <span class="built_in">len</span>(t))], p) &gt;= <span class="number">0</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// strings.Compare ã®æˆ»ã‚Šå€¤ãŒ 1 ã§ã‚ã‚‹æœ€å°ã® index ã‚’æ¢ç´¢</span></span><br><span class="line">right := sort.Search(<span class="built_in">len</span>(sa), <span class="function"><span class="keyword">func</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> strings.Compare(t[sa[i]:min(sa[i]+<span class="built_in">len</span>(p), <span class="built_in">len</span>(t))], p) == <span class="number">1</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := left; i &lt; right; i++ &#123;</span><br><span class="line">fmt.Printf(<span class="string">"suffix: %s, match: %s\n"</span>, t[sa[i]:], t[sa[i]:sa[i]+<span class="built_in">len</span>(p)])</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> a &lt; b &#123;</span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å‡ºåŠ›çµæœ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">suffix: ana, match: an</span><br><span class="line">suffix: anana, match: an</span><br></pre></td></tr></table></figure><p><a href="https://play.golang.org/p/JFNugaoB26N" target="_blank" rel="noopener">https://play.golang.org/p/JFNugaoB26N</a></p><p>ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã¯å…ƒã®æ–‡å­—åˆ— T ã®é•·ã•ã‚’ $n$ ã¨ã—ã¦ã€ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„æ–‡å­—åˆ— P ã®é•·ã•ã‚’ $m$ ã¨ã™ã‚‹ã¨ $O(m \log n)$ æ™‚é–“ã§ãƒãƒƒãƒãƒ³ã‚°ã§ãã¾ã™ã€‚Go ã® <a href="https://golang.org/pkg/sort/#Search" target="_blank" rel="noopener">sort.Search</a> é–¢æ•°ã¯ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸé…åˆ—ã‚„ã‚¹ãƒ©ã‚¤ã‚¹ã«å¯¾ã—ã¦æ¡ä»¶ã‚’æº€ãŸã™æœ€å°ã® index ã‚’äºŒåˆ†æ¢ç´¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¸Šè¨˜ã®å®Ÿè£…ã§ã¯ã€suffix ã«ãŠã‘ã‚‹ prefix ã®å…ˆé ­ <code>len(p)</code> æ–‡å­—ç›®ã¾ã§ã®éƒ¨åˆ†æ–‡å­—åˆ—ã¨ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„æ–‡å­—åˆ— <code>p</code> ã‚’ <a href="https://golang.org/pkg/strings/#Compare" target="_blank" rel="noopener">strings.Compare</a> ã§æ¯”è¼ƒã—ã€çµæœãŒ 0 ä»¥ä¸Šã¨ 1 ã¨ãªã‚‹æœ€å°ã® index <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>ã‚’æ¢ç´¢ã—ã¦ã„ã¾ã™ã€‚Suffix Array ã«å¯¾ã—ã¦äºŒåˆ†æ¢ç´¢ã‚’è¡Œã†ã“ã¨ã«ã‚ˆã£ã¦ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã™ã‚‹ã¨ãã¯ã€å…ƒã®æ–‡å­—åˆ—ã®é•·ã•ã«å¯¾ã—ã¦ã€å¯¾æ•°æ™‚é–“ã§ãŠã•ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p><h2 id="Suffix-Array-ã®æ§‹ç¯‰"><a href="#Suffix-Array-ã®æ§‹ç¯‰" class="headerlink" title="Suffix Array ã®æ§‹ç¯‰"></a>Suffix Array ã®æ§‹ç¯‰</h2><p>Suffix Array ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚ãƒŠã‚¤ãƒ¼ãƒ–ã«è€ƒãˆã‚‹ã¨ã€é•·ã• $O(n)$ ã®æ–‡å­—åˆ— $n$ ã¤ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã‚¯ã‚¤ãƒƒã‚¯ã‚½ãƒ¼ãƒˆã® 1 å›ã‚ãŸã‚Šã®å¹³å‡è¨ˆç®—é‡ $O(n \log n)$ ã¨ã‚ã‚ã›ã¦ $O(n^2 \log n)$ æ™‚é–“ã«ãªã‚Šã¾ã™ã€‚ã„ã‹ã«ã—ã¦åŠ¹ç‡ã‚ˆã Suffix Array ã‚’æ§‹ç¯‰ã§ãã‚‹ã‹ã©ã†ã‹ãŒã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ãƒã‚¤ãƒ³ãƒˆã«ãªã‚Šã¾ã™ã€‚</p><ul><li>ãƒŠã‚¤ãƒ¼ãƒ–ã«ã‚½ãƒ¼ãƒˆã—ã¦æ§‹ç¯‰ã™ã‚‹å®Ÿè£…ä¾‹</li></ul><figure class="highlight go"><figcaption><span>main.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"sort"</span></span><br><span class="line"><span class="string">"strings"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">text := <span class="string">"banana"</span></span><br><span class="line"></span><br><span class="line">d := <span class="built_in">make</span>([]data, <span class="number">0</span>, <span class="built_in">len</span>(text))</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(text); i++ &#123;</span><br><span class="line">d = <span class="built_in">append</span>(d, data&#123;</span><br><span class="line">Index:  i,</span><br><span class="line">Suffix: text[i:],</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sort.Slice(d, <span class="function"><span class="keyword">func</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">ret := strings.Compare(d[i].Suffix, d[j].Suffix)</span><br><span class="line"><span class="keyword">if</span> ret &lt;= <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, v := <span class="keyword">range</span> d &#123;</span><br><span class="line">fmt.Printf(<span class="string">"index: %d, suffix: %s\n"</span>, v.Index, v.Suffix)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> data <span class="keyword">struct</span> &#123;</span><br><span class="line">Index  <span class="keyword">int</span></span><br><span class="line">Suffix <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å‡ºåŠ›çµæœ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">index: 5, suffix: a</span><br><span class="line">index: 3, suffix: ana</span><br><span class="line">index: 1, suffix: anana</span><br><span class="line">index: 0, suffix: banana</span><br><span class="line">index: 4, suffix: na</span><br><span class="line">index: 2, suffix: nana</span><br></pre></td></tr></table></figure><p><a href="https://play.golang.org/p/J97GtkfWBZp" target="_blank" rel="noopener">https://play.golang.org/p/J97GtkfWBZp</a></p><p>ã—ã‹ã—ã€æ§‹ç¯‰ã« $O(n^2 \log n)$ æ™‚é–“ã‹ã‹ã‚‹ã®ã§ã¯ã€ä¾‹ãˆã° 10 ä¸‡æ–‡å­—ç¨‹åº¦ã®æ–‡å­—åˆ—ã® Suffix Array ã‚’æ§‹ç¯‰ã™ã‚‹ã®ã«ã¨ã¦ã‚‚æ™‚é–“ãŒã‹ã‹ã‚‹ãŸã‚ã€å®Ÿç”¨çš„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p><ul><li>Manberã¨Myersã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </li></ul><p>ãã“ã§æ¬¡ã¯ Manber ã¨ Myers ã«ã‚ˆã£ã¦ç¤ºã•ã‚ŒãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç”¨ã„ã¦æ§‹ç¯‰ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚åŸºæœ¬çš„ãªç€æƒ³ã¯ãƒ€ãƒ–ãƒªãƒ³ã‚°ã«ã‚ˆã‚‹ã‚‚ã®ã§ã™ã€‚ã¤ã¾ã‚Š n æ–‡å­—ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹ã¨ãã«ã€ã¾ãš 1 æ–‡å­—ã®éƒ¨åˆ†æ–‡å­—åˆ—ã®ã¿ã‚’ã‚½ãƒ¼ãƒˆã€ç¶šã„ã¦ 1 æ–‡å­—ã®éƒ¨åˆ†æ–‡å­—åˆ—ã§ã‚½ãƒ¼ãƒˆã—ãŸçµæœã‚’ç”¨ã„ã¦ 2 æ–‡å­—ã®éƒ¨åˆ†æ–‡å­—åˆ—ã‚’ã‚½ãƒ¼ãƒˆã€ã€ã€ã¨ 2k æ–‡å­—ã®éƒ¨åˆ†æ–‡å­—åˆ—ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹ã®ã«ã€k æ–‡å­—ã®éƒ¨åˆ†æ–‡å­—åˆ—ã§ã‚½ãƒ¼ãƒˆã—ãŸçµæœã‚’ç”¨ã„ã¾ã™ã€‚è©³ã—ãã¯èŸ»æœ¬ <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup> ã‚’å‚ç…§ãã ã•ã„ã€‚èŸ»æœ¬ãŒæ‰‹ã‚‚ã¨ã«ãªã„å ´åˆã¯ <a href="https://www.geeksforgeeks.org/suffix-array-set-2-a-nlognlogn-algorithm/" target="_blank" rel="noopener">Suffix Array | Set 2 (nLogn Algorithm)</a> ãªã©ã®ãƒšãƒ¼ã‚¸ã§ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç¢ºèªãã ã•ã„ã€‚æœ¬è¨˜äº‹ã§ã¯ Go ã«ã‚ˆã‚‹å®Ÿè£…ã®ã¿ã‚’ç¤ºã—ã¾ã™ã€‚ãƒ€ãƒ–ãƒªãƒ³ã‚°ã«ã‚ˆã‚Šæ¯”è¼ƒå›æ•°ã¯ $O(\log n)$ å›ã§ 1 å›ã‚ãŸã‚Šã®ã‚½ãƒ¼ãƒˆã®å¹³å‡è¨ˆç®—é‡ãŒ $O(n \log n)$ ã§ã™ã‹ã‚‰ã€å…¨ä½“ã§ã¯ $O(n (\log n)^2)$ æ™‚é–“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚</p><ul><li>èŸ»æœ¬ãƒ™ãƒ¼ã‚¹ã® Go ã«ã‚ˆã‚‹ Suffix Array ã‚’æ§‹ç¯‰ã™ã‚‹å®Ÿè£…</li></ul><figure class="highlight go"><figcaption><span>suffixarray.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> suffixarray</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"sort"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> suffixArray <span class="keyword">struct</span> &#123;</span><br><span class="line"><span class="comment">// length of input string</span></span><br><span class="line">N <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// input text (ASCII only)</span></span><br><span class="line">Text <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Suffix Array</span></span><br><span class="line">Index []<span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">(text <span class="keyword">string</span>)</span> *<span class="title">suffixArray</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> k <span class="keyword">int</span></span><br><span class="line">n := <span class="built_in">len</span>(text)</span><br><span class="line">rank := <span class="built_in">make</span>([]<span class="keyword">int</span>, n+<span class="number">1</span>)</span><br><span class="line">sa := <span class="built_in">make</span>([]<span class="keyword">int</span>, n+<span class="number">1</span>)</span><br><span class="line">tmp := <span class="built_in">make</span>([]<span class="keyword">int</span>, n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= n; i++ &#123;</span><br><span class="line">sa[i] = i</span><br><span class="line"><span class="keyword">if</span> i &lt; n &#123;</span><br><span class="line">rank[i] = <span class="keyword">int</span>(text[i])</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">rank[i] = <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cmp := <span class="function"><span class="keyword">func</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> rank[sa[i]] != rank[sa[j]] &#123;</span><br><span class="line"><span class="keyword">return</span> rank[sa[i]] &lt; rank[sa[j]]</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">ri, rj := <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line"><span class="keyword">if</span> sa[i]+k &lt;= n &#123;</span><br><span class="line">ri = rank[sa[i]+k]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> sa[j]+k &lt;= n &#123;</span><br><span class="line">rj = rank[sa[j]+k]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ri &lt; rj</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// k æ–‡å­—ã«ã¤ã„ã¦ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã¨ã“ã‚ã‹ã‚‰ã€2k æ–‡å­—ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹</span></span><br><span class="line"><span class="keyword">for</span> k = <span class="number">1</span>; k &lt;= n; k *= <span class="number">2</span> &#123;</span><br><span class="line">sort.Slice(sa, cmp)</span><br><span class="line">tmp[sa[<span class="number">0</span>]] = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= n; i++ &#123;</span><br><span class="line">tmp[sa[i]] = tmp[sa[i<span class="number">-1</span>]]</span><br><span class="line"><span class="keyword">if</span> cmp(i<span class="number">-1</span>, i) &#123;</span><br><span class="line">tmp[sa[i]]++</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= n; i++ &#123;</span><br><span class="line">rank[i] = tmp[i]</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &amp;suffixArray&#123;</span><br><span class="line">N:     n,</span><br><span class="line">Text:  text,</span><br><span class="line">Index: sa,</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>banana</code> ã®æ–‡å­—åˆ—ã§è©¦ã—ã«ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p><figure class="highlight go"><figcaption><span>suffixarray_test.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> suffixarray</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"testing"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/google/go-cmp/cmp"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestNew</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">tests := []<span class="keyword">struct</span> &#123;</span><br><span class="line">name <span class="keyword">string</span></span><br><span class="line">text <span class="keyword">string</span></span><br><span class="line">want *suffixArray</span><br><span class="line">&#125;&#123;</span><br><span class="line">&#123;</span><br><span class="line">name: <span class="string">"normal"</span>,</span><br><span class="line">text: <span class="string">"banana"</span>,</span><br><span class="line">want: &amp;suffixArray&#123;</span><br><span class="line">N:     <span class="number">6</span>,</span><br><span class="line">Text:  <span class="string">"banana"</span>,</span><br><span class="line">Index: []<span class="keyword">int</span>&#123;<span class="number">6</span> <span class="comment">/* contain empty string */</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">2</span>&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> _, tt := <span class="keyword">range</span> tests &#123;</span><br><span class="line">t.Run(tt.name, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">got := New(tt.text)</span><br><span class="line"><span class="keyword">if</span> diff := cmp.Diff(got, tt.want); diff != <span class="string">""</span> &#123;</span><br><span class="line">t.Errorf(<span class="string">"New() differs: (-got +want)\n%s"</span>, diff)</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ãƒ†ã‚¹ãƒˆçµæœ</li></ul><p>ãƒ†ã‚¹ãƒˆãŒ Pass ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã—ãŸã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== RUN   TestNew</span><br><span class="line">=== RUN   TestNew/normal</span><br><span class="line">--- PASS: TestNew (0.00s)</span><br><span class="line">    --- PASS: TestNew/normal (0.00s)</span><br><span class="line">PASS</span><br></pre></td></tr></table></figure><p>ã¾ãŸ Go ã§å®Ÿè£…ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€å›½å†…ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¸ãƒ£ãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ ã® 1 ã¤ã§ã‚ã‚‹ <a href="http://judge.u-aizu.ac.jp/onlinejudge/" target="_blank" rel="noopener">Aizu Online Judge</a> ã® <a href="http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=ALDS1_14_D" target="_blank" rel="noopener">Multiple String Matching</a> ã¨ã„ã†å•é¡Œã‚’ç”¨ã„ã¦æ¤œè¨¼ã—ã¾ã—ãŸã€‚<del><a href="https://judgedat.u-aizu.ac.jp/testcases/ALDS1_14_D/17/in" target="_blank" rel="noopener">05_maximum_00.in</a> (1 MBç¨‹åº¦ã‚ã‚‹ã®ã§æ³¨æ„)ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ã‚¿ã‚¤ãƒ ãƒªãƒŸãƒƒãƒˆè¶…é(TLE)ã—ã¦ã„ã¾ã—ãŸãŒâ€¦</del></p><h3 id="suffixarray-ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚ˆã‚‹-Suffix-Array-ã®æ§‹ç¯‰"><a href="#suffixarray-ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚ˆã‚‹-Suffix-Array-ã®æ§‹ç¯‰" class="headerlink" title="suffixarray ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚ˆã‚‹ Suffix Array ã®æ§‹ç¯‰"></a><code>suffixarray</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚ˆã‚‹ Suffix Array ã®æ§‹ç¯‰</h3><p>ã•ã¦ã€ãƒ¡ã‚¤ãƒ³ã§ã‚ã‚‹æœ¬å®¶ã® <code>suffixarray</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚Suffix Array ã®æ§‹ç¯‰ã¯ <a href="https://golang.org/pkg/index/suffixarray/#New" target="_blank" rel="noopener">New</a> é–¢æ•°ã‚’ç”¨ã„ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p><p><code>New</code> é–¢æ•°ã§ Suffix Array ã‚’æ§‹ç¯‰ã—ã€<a href="https://golang.org/pkg/index/suffixarray/#Index.Lookup" target="_blank" rel="noopener">Lookup</a> ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ <a href="https://golang.org/pkg/index/suffixarray/#Index.FindAllIndex" target="_blank" rel="noopener">FindAllIndex</a> ãƒ¡ã‚½ãƒƒãƒ‰ãªã©ã‚’ç”¨ã„ã¦ Suffix Array ã‹ã‚‰æ–‡å­—åˆ—ã®ãƒãƒƒãƒãƒ³ã‚°ãŒã§ãã¾ã™ã€‚<code>banana</code> ã®ä¾‹ã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã«çµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>main_test.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"index/suffixarray"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Example</span><span class="params">()</span></span> &#123;</span><br><span class="line">t := <span class="string">"banana"</span></span><br><span class="line">p := <span class="string">"an"</span> <span class="comment">// ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„æ–‡å­—åˆ—</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Suffix Array ã®æ§‹ç¯‰</span></span><br><span class="line">sa := suffixarray.New([]<span class="keyword">byte</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="comment">// -1 ã§ãƒãƒƒãƒãƒ³ã‚°ã™ã‚‹ã™ã¹ã¦ã®ä½ç½®ã‚’å–å¾—ã€‚å–å¾—ã™ã‚‹ index ã®é †ç•ªã¯ãƒ©ãƒ³ãƒ€ãƒ </span></span><br><span class="line">indexes := sa.Lookup([]<span class="keyword">byte</span>(p), <span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, i := <span class="keyword">range</span> indexes &#123;</span><br><span class="line">fmt.Printf(<span class="string">"suffix: %s, match: %s\n"</span>, t[i:], t[i:i+<span class="built_in">len</span>(p)])</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Unordered Output:</span></span><br><span class="line"><span class="comment">// suffix: ana, match: an</span></span><br><span class="line"><span class="comment">// suffix: anana, match: an</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯"><a href="#ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯" class="headerlink" title="ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯"></a>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</h3><p><code>suffixarray</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½¿ã„æ–¹ãŒåˆ†ã‹ã£ãŸã¨ã“ã‚ã§èŸ»æœ¬ãƒ™ãƒ¼ã‚¹ã®  Manber ã¨ Myers ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç”¨ã„ã¦ Suffix Array ã‚’æ§‹ç¯‰ã™ã‚‹å®Ÿè£…ã¨ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç”¨ã„ã¦æ§‹ç¯‰ã™ã‚‹ 2 ã¤ã®æ–¹æ³•ã§ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’å–å¾—ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚(ãªãŠãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã®çµæœã¯ãƒ­ãƒ¼ã‚«ãƒ«ã®ç’°å¢ƒã«ä¾å­˜ã—ã¾ã™)</p><p>Suffix Array ã‚’æ§‹ç¯‰ã™ã‚‹å¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ã¯ <a href="http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=ALDS1_14_D" target="_blank" rel="noopener">Multiple String Matching</a> ã«ãŠã‘ã‚‹ <a href="https://judgedat.u-aizu.ac.jp/testcases/ALDS1_14_D/17/in" target="_blank" rel="noopener">05_maximum_00.in</a> ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¾ã—ãŸã€‚100ä¸‡æ–‡å­—ã‚ã‚Šã¾ã™ã€‚input ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€æ™‚é–“ã¯ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‹ã‚‰ã¯é™¤ãã¾ã™ã€‚</p><ul><li>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ</li></ul><figure class="highlight go"><figcaption><span>suffixarray_test.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkLookupAll_my</span><span class="params">(b *testing.B)</span></span> &#123;</span><br><span class="line">data, err := ioutil.ReadFile(<span class="string">"testdata/05_maximum_01.in.data"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">b.Fatalf(<span class="string">"read test data: %v"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">b.ResetTimer()</span><br><span class="line"></span><br><span class="line">New(<span class="keyword">string</span>(data))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkLookupAll_std</span><span class="params">(b *testing.B)</span></span> &#123;</span><br><span class="line">data, err := ioutil.ReadFile(<span class="string">"testdata/05_maximum_01.in.data"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">b.Fatalf(<span class="string">"read test data: %v"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">b.ResetTimer()</span><br><span class="line"></span><br><span class="line">suffixarray.New(data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">go <span class="built_in">test</span> -bench . -benchtime=1000000000x</span><br><span class="line">goos: windows</span><br><span class="line">goarch: amd64</span><br><span class="line">pkg: github.com/d-tsuji/go-sandbox</span><br><span class="line">BenchmarkLookupAll_my-8         1000000000               4.54 ns/op</span><br><span class="line">BenchmarkLookupAll_std-8        1000000000               0.0510 ns/op</span><br><span class="line">PASS</span><br><span class="line">ok      github.com/d-tsuji/go-sandbox      9.362s</span><br></pre></td></tr></table></figure><p>ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã®çµæœã«ã‚ˆã‚‹ã¨ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ç§ãŒå®Ÿè£…ã—ãŸ Manber ã¨ Myers ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«æ¯”ã¹ã¦ã€ç´„ 100 å€ç¨‹åº¦é«˜é€Ÿã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p><p>å®Ÿã¯æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã® Suffix Array ã®æ§‹ç¯‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ SAIS<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> ã¨ã„ã† Ge Nongã€Sen Zhangã€Wai Hong Chen ã«ã‚ˆã£ã¦ææ¡ˆã•ã‚ŒãŸé«˜é€Ÿãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç”¨ã„ã¦ã„ã¾ã™ã€‚SAIS ã®è¨ˆç®—é‡ã¯ $O(n)$ ã§ã™ã€‚ã•ã‚‰ã«ã„ãã¤ã‹ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’æ–½ã—ã¦ãŠã‚Šã€è©³ã—ãã¯ <a href="https://golang.org/src/index/suffixarray/sais.go" target="_blank" rel="noopener">index/suffixarray/sais.go</a> ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªãã ã•ã„ã€‚</p><p>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã§ã¯ç´„ 100 å€ç¨‹åº¦ã®å‡¦ç†æ™‚é–“ã®é•ã„ãŒã‚ã‚Šã¾ã—ãŸãŒã€ä¸Šè¨˜ã® Manber ã¨ Myers ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¨ˆç®—é‡ãŒ $O(n (\log n)^2)$ ã§ SAIS ã®è¨ˆç®—é‡ãŒ $O(n)$ ã§ã™ã‹ã‚‰ã€100 å€ç¨‹åº¦ã®å·®ã¯è‡ªç„¶ã§ã™ã€‚SAIS ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ Go ã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå„ªç§€ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p><h2 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h2><p>Go ã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ç§ãŒé¢ç™½ã„ã¨æ€ã£ãŸ <code>suffixarray</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚<code>suffixarray</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ§‹ç¯‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¨ˆç®—é‡ã¯ $O(n)$ ã§éå¸¸ã«é«˜é€Ÿã§ã™ã€‚ãã®ä»–ã« Manber ã¨ Myers ã«ã‚ˆã‚‹è¨ˆç®—é‡ $O(n (\log n)^2)$ ã®æ§‹ç¯‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç”¨ã„ãŸ Go ã«ã‚ˆã‚‹å®Ÿè£…ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>å²¡é‡åŸå¤§è¼” (2012) ã€é«˜é€Ÿæ–‡å­—åˆ—è§£æã®ä¸–ç•Œã€å²©æ³¢æ›¸åº—</li></ul><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;">ç§‹è‘‰æ‹“å“‰ã€å²©ç”°é™½ä¸€ã€åŒ—å·å®œç¨” (2012) ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚³ãƒ³ãƒ†ã‚¹ãƒˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ–ãƒƒã‚¯ [ç¬¬2ç‰ˆ]ã€ ãƒã‚¤ãƒŠãƒ“å‡ºç‰ˆ</span><a href="#fnref:1" rev="footnote"> â†©</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;">Two Efficient Algorithms for Linear Time Suffix Array Construction (https://ieeexplore.ieee.org/document/5582081)</span><a href="#fnref:2" rev="footnote"> â†©</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;">æ–‡å­— a ã¨ b ã‚’ <code>strings.Compare(a, b)</code> ã§è¾æ›¸é †ã§æ¯”è¼ƒã—ãŸã¨ãã« a &lt; b ã§ã‚ã‚Œã° -1ã€a = b ã§ã‚ã‚Œã° 0ã€a &gt; b ã§ã‚ã‚Œã° +1 ã§è¿”ã‚Šå€¤ã¨ã—ã¦å–å¾—ã§ãã¾ã™ã€‚è¿”ã‚Šå€¤ãŒ 0 ä»¥ä¸Šã® index ã‚’æ¢ç´¢ã—ã¦ã„ã‚‹ãŸã‚ a â‰§ b ã§ã‚ã‚‹æœ€å°ã® index ãŒå–å¾—ã§ãã¾ã™ã€‚</span><a href="#fnref:3" rev="footnote"> â†©</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/20200807/suffixarray.png&quot; class=&quot;img-small-size&quot;&gt;

&lt;p&gt;&lt;a href=&quot;https://future-architect.github.io/articles/20200726/&quot;&gt;ãƒ•ãƒ¥ãƒ¼ãƒ
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="Go" scheme="https://future-architect.github.io/tags/Go/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
      <category term="ãƒ‡ãƒ¼ã‚¿æ§‹é€ " scheme="https://future-architect.github.io/tags/%E3%83%87%E3%83%BC%E3%82%BF%E6%A7%8B%E9%80%A0/"/>
    
  </entry>
  
  <entry>
    <title>åˆã‚ã¦ã®OSSã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æ´»å‹•ã€œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¿»è¨³ã‚„ã£ã¦ã¿ãŸã€‚ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚¹ã‚¿ãƒƒãƒ•ã‚‚ã‚„ã£ã¦ã¿ãŸã€‚ã€œ</title>
    <link href="https://future-architect.github.io/articles/20200806/"/>
    <id>https://future-architect.github.io/articles/20200806/</id>
    <published>2020-08-05T15:00:00.000Z</published>
    <updated>2020-08-11T07:12:34.958Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>æœ¬è¨˜äº‹ã¯<a href="https://future-architect.github.io/articles/20200726/">ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶é€£è¼‰</a>ã®4å›ç›®ã§ã™ã€‚</p><p>2017å¹´æ–°å’å…¥ç¤¾ã®æ°¸äº•ã§ã™ã€‚å°å£²æµé€šç³»ã®PJã«æ‰€å±ã—ã¦ãŠã‚Šã€å‰å›ã¯Vue.jsã«é–¢ã™ã‚‹è¨˜äº‹ã‚’æ›¸ãã¾ã—ãŸã€‚</p><ul><li>å‰å›æ›¸ã„ãŸè¨˜äº‹<a href="https://future-architect.github.io/articles/20200428/">ã€ŒVue.jsã®slotã®æ©Ÿèƒ½ã‚’åˆå¿ƒè€…ã«ã‚ã‹ã‚‹ã‚ˆã†ã«è§£èª¬ã—ã¦ã¿ãŸã€</a></li></ul><p>2020å¹´ã¯ã‚³ãƒ­ãƒŠç¦ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚Šã€å¤ä¼‘ã¿ã‚’å–ã£ã¦ã‚‚äºˆå®šãŒãªã„ã¨ã„ã†äººã‚‚å¤šã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚ãã‚“ãªæ™‚é–“ãŒã‚ã‚‹ã¨ãã«ã¯ã€æ™®æ®µä»•äº‹ã‚„è¶£å‘³ã§ãŠä¸–è©±ã«ãªã£ã¦ã„ã‚‹OSSã‚„OSSã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã®è²¢çŒ®ã‚’ã™ã‚‹ã¨ã„ã£ãŸéã”ã—æ–¹ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚</p><p>ã§ã‚‚ã„ã–GitHubã‚’é–‹ã„ã¦ã€ã‚¤ã‚·ãƒ¥ãƒ¼ã‚’è¦—ã„ã¦ã¿ã‚‹ã¨ã€ã©ã†ã‚‚è‡ªåˆ†ã«ã¯å‡ºæ¥ãªã•ãã†ãªé›£ã—ã„ã‚‚ã®ã°ã‹ã‚Šã«è¦‹ãˆã¦ãªã‹ãªã‹ãƒãƒ¼ãƒ‰ãƒ«é«˜ã„ã§ã™ã‚ˆã­ã€‚ä»Šå›ã¯ã€Œåˆã‚ã¦ã®OSSã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æ´»å‹•ã€ã¨ã—ã¦ã€ãƒãƒ¼ãƒ‰ãƒ«ã®ä½ã„OSSè²¢çŒ®ã‚’ä¸‹è¨˜ï¼’ã¤ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚</p><ol><li>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¿»è¨³</li><li>ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ã‚¹ã‚¿ãƒƒãƒ•</li></ol><h1 id="1-ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¿»è¨³"><a href="#1-ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¿»è¨³" class="headerlink" title="1. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¿»è¨³"></a>1. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¿»è¨³</h1><p>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¿»è¨³ã¯ã€<a href="https://www.transifex.com/" target="_blank" rel="noopener">transifex</a>ã¨ã„ã†ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¿»è¨³ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’åˆ©ç”¨ã™ã‚‹ã®ãŒãƒãƒ¼ãƒ‰ãƒ«ã®ä½ã„æ–¹æ³•ã§ã™ã€‚ã“ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ã¯å¤šãã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãŒå‚åŠ ã—ã¦ãŠã‚Šã€è‡ªåˆ†ã®èˆˆå‘³ã®ã‚ã‚‹ã‚‚ã®ã«å‚åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¸‹è¨˜ã®å‚è€ƒãƒšãƒ¼ã‚¸ã‚’ã‚‚ã¨ã«ç™»éŒ²ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p><p>å‚è€ƒï¼štransifexã‚’ç¿»è¨³ã«åˆ©ç”¨ã—ã¦ã„ã‚‹Djangoã®ç¿»è¨³ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èª¬æ˜<br><a href="https://djangoproject.jp/howtojoin-transifex/" target="_blank" rel="noopener">https://djangoproject.jp/howtojoin-transifex/</a></p><h2 id="å®Ÿéš›ã«ã‚„ã£ã¦ã¿ãŸ"><a href="#å®Ÿéš›ã«ã‚„ã£ã¦ã¿ãŸ" class="headerlink" title="å®Ÿéš›ã«ã‚„ã£ã¦ã¿ãŸ"></a>å®Ÿéš›ã«ã‚„ã£ã¦ã¿ãŸ</h2><p>ç§ã¯æ—¥æœ¬ã§ç”Ÿã¾ã‚Œè‚²ã£ãŸæ—¥æœ¬èªãƒã‚¤ãƒ†ã‚£ãƒ–ã§è‹±èªã¯ä¸­å­¦1å¹´ç”Ÿã‹ã‚‰å­¦æ ¡ã§ç¿’ã£ãŸã¨ã„ã†ä¸€èˆ¬çš„ãªæ—¥æœ¬äººã§ã™ã®ã§ã€è‹±èªã‹ã‚‰æ—¥æœ¬èªã¸ã®ç¿»è¨³ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã™ã€‚ï¼ˆå¤§å­¦ã®ç¬¬äºŒå¤–å›½èªã®ãƒ‰ã‚¤ãƒ„èªã¯ã•ã£ã±ã‚Šå¿˜ã‚Œã¾ã—ãŸã€‚ï¼‰</p><p>transifexã§ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«å„è‹±æ–‡ã”ã¨ã«å¯¾å¿œã™ã‚‹æ—¥æœ¬èªã‚’ç¿»è¨³ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚<br>ï¼ˆè‹±å˜èªå¸³ã®ã‚ˆã†ã«å¯¾è¨³ã‚’å½“ã¦ã¦ã„ãã‚ˆã†ãªã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚ï¼‰</p><img src="/images/20200806/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 2020-08-05 20.48.15.png"><p>ãªã®ã§ã€ç„¡ç†ã®ãªã„ç¯„å›²ã§å°‘ã—ãšã¤è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ï¼‘æ–‡ã ã‘ã§ã‚‚OKã§ã™ã€‚ç°¡å˜ã§ã™ã­ã€‚</p><h1 id="2-ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ã‚¹ã‚¿ãƒƒãƒ•æ´»å‹•"><a href="#2-ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ã‚¹ã‚¿ãƒƒãƒ•æ´»å‹•" class="headerlink" title="2.ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ã‚¹ã‚¿ãƒƒãƒ•æ´»å‹•"></a>2.ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ã‚¹ã‚¿ãƒƒãƒ•æ´»å‹•</h1><p>æ˜¨å¹´<a href="https://pycon.jp/2019/" target="_blank" rel="noopener">PyConJP2019</a>ã®å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã¨ã—ã¦æ´»å‹•ã—ã¾ã—ãŸã€‚</p><ul><li>PyConJP2019ã«ç™»å£‡ã•ã‚ŒãŸæ —ç”°ã•ã‚“ã®è¨˜äº‹ã¯<a href="https://future-architect.github.io/articles/20200422/">ã“ã¡ã‚‰</a><br>ï¼ˆä½™è«‡ã«ã€Œä»–ã®ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ã®ç¤¾å“¡ã‚‚å‚åŠ ã—ã¦ãŠã‚Šã€æœ€åˆã®ç”»åƒã¯ã‚¹ã‚¿ãƒƒãƒ•ã‚’ã•ã‚Œã¦ã„ãŸæ–¹ã‹ã‚‰é ‚æˆ´ã—ã¾ã—ãŸã€ã¨ã‚ã‚Šã¾ã™ãŒã€ã€Œã‚¹ã‚¿ãƒƒãƒ•ã‚’ã•ã‚Œã¦ã„ãŸæ–¹ã€ãŒç§ã§ã™ã€‚ï¼‰</li></ul><h2 id="ãã£ã‹ã‘"><a href="#ãã£ã‹ã‘" class="headerlink" title="ãã£ã‹ã‘"></a>ãã£ã‹ã‘</h2><p>æ˜¨å¹´PyConJP2019ã®ã‚³ã‚¢ã‚¹ã‚¿ãƒƒãƒ•ã‚’ã—ã¦ã„ãŸå‹äººã«èª˜ã‚ã‚Œã¦ã€å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã¨ã—ã¦æ´»å‹•ã—ã¾ã—ãŸã€‚Pythonã¯ç‹¬å­¦ã§å‹‰å¼·ã—ãŸãã‚‰ã„ã ã£ãŸã®ã§ã™ãŒã€ã€Œã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ã‚¹ã‚¿ãƒƒãƒ•ã£ã¦ã€ãªã‚“ã ã‹æ¥½ã—ãã†ã ãªãƒ¼ã€ã¨ã„ã†æ°—è»½ãªæ°—æŒã¡ã§å‚åŠ ã—ã¾ã—ãŸã€‚</p><h2 id="å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã®ä»•äº‹å†…å®¹"><a href="#å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã®ä»•äº‹å†…å®¹" class="headerlink" title="å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã®ä»•äº‹å†…å®¹"></a>å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã®ä»•äº‹å†…å®¹</h2><h3 id="æ‹…å½“ã—ãŸä»•äº‹"><a href="#æ‹…å½“ã—ãŸä»•äº‹" class="headerlink" title="æ‹…å½“ã—ãŸä»•äº‹"></a>æ‹…å½“ã—ãŸä»•äº‹</h3><ul><li>å‰æ—¥è¨­å–¶</li><li>å½“æ—¥é‹å–¶ã®ã‚µãƒãƒ¼ãƒˆ<ul><li>å‚åŠ è€…ã®å—ä»˜ãƒ»ãƒãƒ™ãƒ«ãƒ†ã‚£ã‚°ãƒƒã‚ºã‚„Tã‚·ãƒ£ãƒ„ã®é…å¸ƒ</li><li>å‚åŠ è€…ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¼šå ´ã‚’èª˜å°</li><li>é“æ¡ˆå†…ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¼šå ´ã‚„ãŠæ‰‹æ´—ã„ãªã©ï¼‰</li><li>ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¸­ç¶™æ©Ÿæã®æ“ä½œ</li></ul></li><li>Partyã¸ã®å‚åŠ ï¼ˆã“ã‚Œã¯ã‚³ã‚¢ã‚¹ã‚¿ãƒƒãƒ•ã‚‚å«ã‚ã¦å®Ÿè²»ï¼‰</li><li>ç‰‡ä»˜ã‘</li></ul><h3 id="æ‹…å½“ã—ãªã‹ã£ãŸä»•äº‹"><a href="#æ‹…å½“ã—ãªã‹ã£ãŸä»•äº‹" class="headerlink" title="æ‹…å½“ã—ãªã‹ã£ãŸä»•äº‹"></a>æ‹…å½“ã—ãªã‹ã£ãŸä»•äº‹</h3><ul><li>ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å¸ä¼š</li><li>è¨—å…å®¤ã®æ¡ˆå†…</li></ul><h2 id="å¾—ã‚‰ã‚ŒãŸã‚‚ã®"><a href="#å¾—ã‚‰ã‚ŒãŸã‚‚ã®" class="headerlink" title="å¾—ã‚‰ã‚ŒãŸã‚‚ã®"></a>å¾—ã‚‰ã‚ŒãŸã‚‚ã®</h2><p>ã‚¹ã‚¿ãƒƒãƒ•ã®ä»•äº‹ã‚„ä»•äº‹ã®åˆé–“ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€šã˜ã¦Pythonã‚’æ„›ã™ã‚‹å¤šãã®äººã¨çŸ¥ã‚Šåˆã†ã“ã¨ãŒå‡ºæ¥ã¾ã—ãŸã€‚ãã‚Œã‚‚å›½éš›ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ãªã®ã§ã€å¤šæ§˜ãªé¡”ã¶ã‚Œãƒ»ãƒ»ãƒ»ï¼<br>ç‰¹ã«<a href="https://www.amazon.co.jp/dp/4822292274" target="_blank" rel="noopener">ã€ç‹¬å­¦ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã€</a>ã®è‘—è€…ã‚³ãƒ¼ãƒªãƒ¼ãƒ»ã‚¢ãƒ«ã‚½ãƒ•ã•ã‚“ï¼ˆKeyNoteç™»å£‡è€…ï¼‰ã¨ãŠè©±ã§ããŸã“ã¨ã¯å…‰æ „ã§ã—ãŸã€‚</p><p>ç¿»è¨³è€…ã®æ¸…æ°´å·ã•ã‚“ã¨ä¸€ç·’ã«ã‚µã‚¤ãƒ³ã‚‚ã„ãŸã ã„ã¡ã‚ƒã„ã¾ã—ãŸã€‚<br><img src="/images/20200806/IMG_20200805_203949.jpg" alt=""></p><p>ã¡ãªã¿ã«è‡ªå·±ç´¹ä»‹ã™ã‚‹éš›ã«ã€ã€ŒFutureã§åƒã„ã¦ã„ã¾ã™ã€ã¨ã„ã†ã¨ã€å¤šãã®æ–¹ãŒã€Œæ¾å·ã•ã‚“ã®ä¼šç¤¾ã€ã£ã¦åå¿œã•ã‚Œã¦ã„ãŸã®ãŒå°è±¡çš„ã§ã—ãŸã€‚</p><p>*ã»ã‚“ã®ãŸã¾ã«ã€Œtsukammoã•ã‚“ã®ä¼šç¤¾ã€ã¨åå¿œã™ã‚‹ç«¶ãƒ—ãƒ­erã‚‚ã„ã¾ã—ãŸã€‚</p><h2 id="å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã‚„ã‚Šã¾ã—ã‚‡ã†ï¼ãƒ»ãƒ»ãƒ»ã¨è¨€ã„ãŸã„ã¨ã“ã‚ã§ã™ãŒ"><a href="#å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã‚„ã‚Šã¾ã—ã‚‡ã†ï¼ãƒ»ãƒ»ãƒ»ã¨è¨€ã„ãŸã„ã¨ã“ã‚ã§ã™ãŒ" class="headerlink" title="å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã‚„ã‚Šã¾ã—ã‚‡ã†ï¼ãƒ»ãƒ»ãƒ»ã¨è¨€ã„ãŸã„ã¨ã“ã‚ã§ã™ãŒ"></a>å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã‚„ã‚Šã¾ã—ã‚‡ã†ï¼<del>ãƒ»ãƒ»ãƒ»ã¨è¨€ã„ãŸã„ã¨ã“ã‚ã§ã™ãŒ</del></h2><p><del>ä»Šå¹´ã¯ã‚³ãƒ­ãƒŠç¦ã§ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é–‹å‚¬ã¨ãªã‚‹ãŸã‚ã€PyConJP2020ã§ã¯å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã¯å‹Ÿé›†ã—ã¦ãªã•ãã†ã§ã™ã€‚</del></p><p><del>æ¥å¹´ä»¥é™å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•ã€ã‚‚ã—ãã¯ã‚³ã‚¢ã‚¹ã‚¿ãƒƒãƒ•ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¦ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚</del></p><p><strong>(2020/08/08 è¿½è¨˜)</strong> 8/28-30ã«è¡Œã‚ã‚Œã‚‹PyConJP2020å½“æ—¥ã‚¹ã‚¿ãƒƒãƒ•çµ¶è³›å‹Ÿé›†ä¸­ã ãã†ã§ã™ã€‚<br>æ˜¯é<a href="https://pyconjp.blogspot.com/2020/08/support-staff.html" target="_blank" rel="noopener">ã“ã¡ã‚‰</a>ã‹ã‚‰ã”ç™»éŒ²ãã ã•ã„ã€‚<strong>ç§ã‚‚ç”³ã—è¾¼ã¿ã¾ã—ãŸã€‚</strong></p><h1 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h1><p>ä»Šå›OSSã¸ã®è²¢çŒ®ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æ´»å‹•ãªã‚“ã¦ç§ã«ã¯ç„¡ç†ãªã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã£ã¦ã„ã‚‹äººã«ã‚‚ãƒãƒ¼ãƒ‰ãƒ«ä½ã‚ãªï¼’ã¤ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚æ˜¯éçš†ã•ã‚“ã‚‚å–ã‚Šçµ„ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚</p><h1 id="ä½™è«‡ï¼šã‚‚ã£ã¨ãƒãƒ¼ãƒ‰ãƒ«ã®ä½ã„ã‚‚ã®ã¯ãªã„ã®ï¼Ÿ"><a href="#ä½™è«‡ï¼šã‚‚ã£ã¨ãƒãƒ¼ãƒ‰ãƒ«ã®ä½ã„ã‚‚ã®ã¯ãªã„ã®ï¼Ÿ" class="headerlink" title="ä½™è«‡ï¼šã‚‚ã£ã¨ãƒãƒ¼ãƒ‰ãƒ«ã®ä½ã„ã‚‚ã®ã¯ãªã„ã®ï¼Ÿ"></a>ä½™è«‡ï¼šã‚‚ã£ã¨ãƒãƒ¼ãƒ‰ãƒ«ã®ä½ã„ã‚‚ã®ã¯ãªã„ã®ï¼Ÿ</h1><p><a href="https://jp.vuejs.org/support-vuejs/" target="_blank" rel="noopener">Vue.jså…¬å¼ã®æ”¯æ´ã®ãƒšãƒ¼ã‚¸</a>ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªè¨˜è¼‰ãŒã‚ã‚Šã¾ã™ã€‚</p><blockquote><p>ã‚‚ã—ã‚ãªãŸãŒå€‹äººã®é–‹ç™ºè€…ã§ã€Vue ã‚’ä½¿ã£ã¦ç”Ÿç”£æ€§ã‚’æ¥½ã—ã‚“ã§ã„ã‚‹ã®ãªã‚‰ã€å¯„ä»˜ã‚’ã”æ¤œè¨ãã ã•ã„ã€‚ä¾‹ãˆã°ã€æ™‚ã€…ç§ã«ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’ãŠã”ã‚‹ã€ã¨ã‹ã€‚:)</p></blockquote><p>ã¨ã„ã†ã‚ã‘ã§ã€ãŠè¿‘ãã®OSSé–‹ç™ºè€…ãƒ»è²¢çŒ®è€…ãƒ»ã‚³ãƒŸãƒƒã‚¿ãƒ¼ã«ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’å¥¢ã£ã¦ã¿ã¦ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚ã¡ãªã¿ã«Futureã«ã¯Vulsã®ç™ºæ˜è€…ã‚„Vue.jsã®ã‚³ã‚¢ãƒ¡ãƒ³ãƒãƒ¼ä»–ã€OSSã®è²¢çŒ®è€…ãŒãŸãã•ã‚“æ‰€å±ã—ã¦ã„ã¾ã™ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;a href=&quot;#ã¯ã˜ã‚ã«&quot; class=&quot;headerlink&quot; title=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;/a&gt;ã¯ã˜ã‚ã«&lt;/h1&gt;&lt;p&gt;æœ¬è¨˜äº‹ã¯&lt;a href=&quot;https://future-architect.github.io/articles/20200
      
    
    </summary>
    
    
      <category term="Culture" scheme="https://future-architect.github.io/categories/Culture/"/>
    
    
      <category term="Python" scheme="https://future-architect.github.io/tags/Python/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
      <category term="OSS" scheme="https://future-architect.github.io/tags/OSS/"/>
    
  </entry>
  
  <entry>
    <title>Terraformã§æ¥½ã‚’ã—ãŸã„</title>
    <link href="https://future-architect.github.io/articles/20200805/"/>
    <id>https://future-architect.github.io/articles/20200805/</id>
    <published>2020-08-04T15:00:00.000Z</published>
    <updated>2020-08-05T14:17:55.873Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/20200805/%E3%81%B2%E3%81%BE%E3%82%8F%E3%82%8A.jpg" alt=""></p><p>æœ¬è¨˜äº‹ã¯<a href="/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/">å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶è¨˜äº‹</a>ã®ç¬¬3å¼¾ã§ã™ã€‚</p><p>ã“ã‚“ã«ã¡ã¯ã€‚TIG/DXæ‰€å±ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å…¼ã‚«ãƒ¡ãƒ©ãƒãƒ³ã®<a href="https://twitter.com/kaedemalu" target="_blank" rel="noopener">ä¼Šè—¤å¤ªæ–‰</a>ã§ã™ã€‚ä»Šå›ã®ã‚¢ã‚¤ã‚­ãƒ£ãƒƒãƒã¯ç§ãŒæ˜¨å¹´æ’®ã£ãŸã²ã¾ã‚ã‚Šç•‘ã«ã—ã¾ã—ãŸã€‚</p><h2 id="ãƒ„ãƒ¼ãƒ«ã‚’ã¾ã¨ã‚ãŸã„"><a href="#ãƒ„ãƒ¼ãƒ«ã‚’ã¾ã¨ã‚ãŸã„" class="headerlink" title="ãƒ„ãƒ¼ãƒ«ã‚’ã¾ã¨ã‚ãŸã„"></a>ãƒ„ãƒ¼ãƒ«ã‚’ã¾ã¨ã‚ãŸã„</h2><p>Infrastructure as Code(IaC)ã¨ã„ã†è€ƒãˆæ–¹ã«å±ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã¯ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã‚µãƒ¼ãƒãƒ¼ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«Ansibleã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œã£ã¦ãŠããªã‚‰Packerã€ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã‚‰Kubernetesã¨è¨€ã£ãŸæ„Ÿã˜ã§ã€ã©ã‚“ã©ã‚“è¿½ãˆãªã„ãã‚‰ã„ã«å¢—ãˆã¦ã„ã¾ã™ã€‚æˆ‘ã€…ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦ã¯ã€æ–°ã—ã„ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã†ã“ã¨ãŒæ¥½ã—ãã¦ã—ã‚‡ã†ãŒãªã„äººã‚‚å¤šã„ã‹ã¨æ€ã„ã¾ã™ã€‚ã‹ãã„ã†ç§ã‚‚ãã®ä¸€äººã§ã™ã€‚ã—ã‹ã—ã€æ–°ã—ãã‚¤ãƒ³ãƒ•ãƒ©ã‚’å§‹ã‚ã‚‹äººã«ã¨ã£ã¦ã‚‚ãƒ„ãƒ¼ãƒ«ã®å¤šã„æ™‚ä»£ã§ã™ã—ã€å°‘ãªã„å­¦ç¿’ã‚³ã‚¹ãƒˆ(äººã«ã‚ˆã£ã¦ã¯è² æ‹…)ã§ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã‚„ã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒªãƒªãƒ¼ã‚¹ãŒã§ãã‚‹ã“ã¨ã«è¶Šã—ãŸã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p><p>ã“ã®è¨˜äº‹ã§ã¯ã€Terraformã®æ•°å¤šãã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ä»–ã®IaCãƒ„ãƒ¼ãƒ«ã¨å¯èƒ½ãªé™ã‚Šä»£ç”¨ã—ãŸã‚Šã€Terraformã®ä¸–ç•Œã§ãƒªã‚½ãƒ¼ã‚¹ä½œæˆã‚’å®Œçµã•ã›ã‚‹ãŸã‚ã«ä½¿ã„æ–¹ã‚’æ”¹ã‚ã¦çªãè©°ã‚ãŸå†…å®¹ã«ãªã‚Šã¾ã™ã€‚ç§ã®è¨˜äº‹ãªã®ã§ã€ä½¿ã†ã‚¯ãƒ©ã‚¦ãƒ‰ã¯ä¾‹ã«ã‚‚ã‚ŒãšGCPã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p><h2 id="Packerã˜ã‚ƒãªãã¦Terraform"><a href="#Packerã˜ã‚ƒãªãã¦Terraform" class="headerlink" title="Packerã˜ã‚ƒãªãã¦Terraform"></a>Packerã˜ã‚ƒãªãã¦Terraform</h2><p>Packerã¯ã€Linuxãªã©å„ç¨®OSãªã©ã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚ã¨ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹è‡ªä½“ã¯å‰Šé™¤ã•ã‚Œã€ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ®‹ã—ã¾ã™ã€‚ã“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ã€è¨­å®šæ¸ˆã¿ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å±•é–‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®è¨­å®šã¨ã„ã†æ„å‘³ã§ã¯Ansibleã¨ä¼¼ã¦ã„ã¾ã™ãŒã€Ansibleã¯è¨­å®šã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ãã®ã¾ã¾ç”Ÿãã¦ã„ã¾ã™ã€‚</p><h3 id="remote-execã‚’åˆ©ç”¨ã™ã‚‹"><a href="#remote-execã‚’åˆ©ç”¨ã™ã‚‹" class="headerlink" title="remote-execã‚’åˆ©ç”¨ã™ã‚‹"></a><code>remote-exec</code>ã‚’åˆ©ç”¨ã™ã‚‹</h3><p>Terraformã«ã¯Provisionerã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ãŒã€<code>remote-exec</code>ã¯ãã®ã†ã¡ã®ä¸€ã¤ã§ã™ã€‚<code>remote</code>ãªã®ã§ã€å®Ÿè¡Œå ´æ‰€ã¯æ§‹ç¯‰ã—ã¦ã„ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ãªã‚Šã¾ã™ã€‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã‚’è€ƒãˆã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hoge-project</span><br><span class="line"> |- compute_instance.tf</span><br><span class="line"> |- sshkey</span><br><span class="line">     |- id_rsa</span><br><span class="line">     |- id_rsa.pub</span><br></pre></td></tr></table></figure><p>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚³ãƒ¼ãƒ‰ã—ã¦ã„ã‚‹<code>compute_instance.tf</code>ã€ã‚ã¨ã¯åŸ‹ã‚ã‚‹éµã‚’ç½®ã„ã¦ã„ã¾ã™ã€‚<code>compute_instance.tf</code>ã®ä¸­èº«ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚</p><figure class="highlight sh"><figcaption><span>compute_instance.tf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">resource <span class="string">"google_compute_instance"</span> <span class="string">"instance"</span> &#123;</span><br><span class="line">  name         = <span class="string">"sample-instance"</span></span><br><span class="line">  machine_type = <span class="string">"n1-standard-1"</span></span><br><span class="line">  zone         = <span class="string">"asia-northeast1-a"</span></span><br><span class="line">  tags         = []</span><br><span class="line"></span><br><span class="line">  boot_disk &#123;</span><br><span class="line">    initialize_params &#123;</span><br><span class="line">      image = <span class="string">"debian-cloud/debian-9"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  network_interface &#123;</span><br><span class="line">    network = <span class="string">"default"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  provisioner <span class="string">"remote-exec"</span> &#123;</span><br><span class="line">    connection = &#123;</span><br><span class="line">      <span class="built_in">type</span>        = <span class="string">"ssh"</span></span><br><span class="line">      user        = <span class="string">"provisoner"</span></span><br><span class="line">      private_key = file(<span class="string">"./sshkey/id_rsa.pub"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    inline = [</span><br><span class="line">      <span class="string">"sudo apt-get install nginx"</span>,</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã“ã§ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç«‹ã¦ã¦ã€nginxã‚’å…¥ã‚Œã‚‹ã¨ã“ã‚ã¾ã§ã‚’ã‚´ãƒ¼ãƒ«ã¨ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã«ã—ã¾ã—ãŸã€‚é€šå¸¸ã§ã‚ã‚Œã°ã€Terraformã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç«‹ã¦ã¦ã€ãã®å¾Œã€gcloudã‚³ãƒãƒ³ãƒ‰ãªã‚Šã§ä½œæˆã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«sshã—ã¦ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¯ãšã§ã™ãŒã€ãã‚Œã‚’<code>remote-exec</code>ã§ç½®ãæ›ãˆã¦ã„ã¾ã™ã€‚</p><h3 id="ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ"><a href="#ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ" class="headerlink" title="ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ"></a>ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ</h3><ul><li>ãƒ¡ãƒªãƒƒãƒˆ<ul><li>Packerã§buildã—ã¦ã‹ã‚‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’Terraformã§å†åº¦æŒ‡å®šã—ãªãã¦ã‚‚è‰¯ã„</li><li>Terraformã®ã‚³ãƒãƒ³ãƒ‰ã€ä¸–ç•Œã§å®Œçµã™ã‚‹</li></ul></li><li>ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ<ul><li>ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’åˆ©ç”¨ã™ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå¤šã„å ´åˆã¯ã‚³ãƒ¼ãƒ‰ãŒæ±šããªã‚‹</li></ul></li></ul><p>Packerã‚’ä»£ç”¨ã—ã‚ˆã†ã¨ã™ã‚‹å ´åˆã¯ã€è¸ã¿å°ã‚„ã€ç‰¹å®šã®ã‚µãƒ¼ãƒãƒ¼ç¨®ã«å‘ã‘ã¦ã§ã‚ã‚Œã°åŠ¹æœçš„ã‹ã¨æ€ã„ã¾ã™ãŒã€åˆ©ç”¨ã™ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå¤šããªã£ãŸå ´åˆã«ã¯ã‚ãšã‹ãªãŒã‚‰ã‚³ãƒ¼ãƒ‰ãŒèª­ã¿ã«ãããªã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã®ã§ã€ãã®ã¨ãã¯Packerã®å°å…¥ã‚’è€ƒãˆãªã„ã¨ã„ã‘ãªã„ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p><h2 id="Ansibleã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸããªã„"><a href="#Ansibleã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸããªã„" class="headerlink" title="Ansibleã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸããªã„"></a>Ansibleã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸããªã„</h2><p>ã‚¤ãƒ³ãƒ•ãƒ©ã®ç®¡ç†æ–¹æ³•ã¨ã—ã¦ã€Terraform + Ansibleã¯ç‹é“ã™ãã‚‹ãã‚‰ã„ç‹é“ãªã‚„ã‚Šæ–¹ã ã¨æ€ã£ã¦ã„ã¾ã™ã—ã€ã‚³ãƒ¼ãƒ‰ç®¡ç†ã—ã¦ã„ã‚‹æ–¹ã¯ã ã„ãŸã„ãã®2ã¤ã‚’ãƒ¡ã‚¤ãƒ³ã¨ã—ã¦åˆ©ç”¨ã—ã¦ã„ã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿãªã®ã§ã€æ‰‹é †ã¨ã—ã¦ã¯</p><ul><li>Terraformã§ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆ</li><li>Ansibleã§ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®è¨­å®šã‚’è¡Œã†</li></ul><p>ã§è¡Œã†ã¨æ€ã„ã¾ã™ã€‚ãªã®ã§ã€å„ã€…ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ãŒã€å€‹äººçš„ã«ã¯2å›ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸããªã„ã€ã§ãã‚Œã°1ç™ºã§å‡ºæ¥ä¸ŠãŒã£ã¦æ¬²ã—ã„ã¨ã„ã†æ°—æŒã¡ãŒãšã£ã¨ã‚ã‚Šã¾ã—ãŸã€‚ãã®æ°—æŒã¡ã€ã“ã“ã§æ˜‡è¯ã•ã›ã¾ã™ã€‚</p><h3 id="local-execã‚’åˆ©ç”¨ã™ã‚‹"><a href="#local-execã‚’åˆ©ç”¨ã™ã‚‹" class="headerlink" title="local-execã‚’åˆ©ç”¨ã™ã‚‹"></a><code>local-exec</code>ã‚’åˆ©ç”¨ã™ã‚‹</h3><p>å…ˆã»ã©ã¯Provisionerã§<code>remote-exec</code>ã‚’åˆ©ç”¨ã—ã¾ã—ãŸãŒã€ä»Šå›ã¯<code>local-exec</code>ã‚’ä½¿ã„ã¾ã™ã€‚å®Ÿè¡Œå ´æ‰€ãŒ<code>local</code>ã€ã¤ã¾ã‚ŠTerraformã®å®Ÿè¡Œç«¯æœ«ä¸Šã§è¡Œã†ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚Ansibleã¯å®Ÿè¡Œã™ã‚‹ã¨ãã¯å„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸Šã§ã¯ãªãã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚„è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å®Ÿè¡Œã™ã‚‹ã‹ã¨æ€ã„ã¾ã™ã®ã§ã€<code>local-exec</code>ã‚’ä»Šå›ã¯ä½¿ã„ã¾ã™ã€‚ï¼ˆæ§‹ç¯‰ã—ãŸã‚µãƒ¼ãƒãƒ¼ä¸Šã§localhostã§Ansibleã¯å®Ÿè¡Œã§ãã¾ã™ãŒãŠæƒé™¤ã‚‚å¤§å¤‰ã§ã™ã­â€¦ã€‚ï¼‰<br>ä»Šå›ã¯ã‚±ãƒ¼ã‚¹ã¨ã—ã¦ã€ä»¥ä¸‹ã‚’ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã§è€ƒãˆã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hoge-project</span><br><span class="line"> |- compute_instance.tf</span><br><span class="line"> |- ansible</span><br><span class="line">     |- ansible.cfg</span><br><span class="line">     |- inventory</span><br><span class="line">     |- nginx.yaml</span><br><span class="line">     |- sshkey</span><br><span class="line">         |- id_rsa</span><br><span class="line">         |- id_rsa.pub</span><br><span class="line">     |- roles</span><br><span class="line">         |- nginx</span><br><span class="line">             |- tasks</span><br><span class="line">                 |- main.yaml</span><br></pre></td></tr></table></figure><p>ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã‚‚ãŠãã‚‰ãTerraform + Ansibleã®çµ„ã¿åˆã‚ã›ã®æ™‚ã«ã¯ã‚ªãƒ¼ã‚½ãƒ‰ãƒƒã‚¯ã‚¹ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿã“ã“ã§ã€<code>compute_instance.tf</code>ã¯</p><figure class="highlight sh"><figcaption><span>compute_instance.tf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">resource <span class="string">"google_compute_instance"</span> <span class="string">"instance"</span> &#123;</span><br><span class="line">  name         = <span class="string">"sample-instance"</span></span><br><span class="line">  machine_type = <span class="string">"n1-standard-1"</span></span><br><span class="line">  zone         = <span class="string">"asia-northeast1-a"</span></span><br><span class="line">  tags         = []</span><br><span class="line"></span><br><span class="line">  boot_disk &#123;</span><br><span class="line">    initialize_params &#123;</span><br><span class="line">      image = <span class="string">"debian-cloud/debian-9"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  network_interface &#123;</span><br><span class="line">    network = <span class="string">"default"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  metadata = &#123;</span><br><span class="line">    ssh-keys = <span class="string">"ansible:<span class="variable">$&#123;file("./ansible/sshkey/id_rsa.pub")&#125;</span>"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  service_account &#123;</span><br><span class="line">    scopes = [<span class="string">"cloud-platform"</span>]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  provisioner <span class="string">"local-exec"</span> &#123;</span><br><span class="line">    working_dir = <span class="string">"./ansible/"</span></span><br><span class="line">    <span class="built_in">command</span>     = <span class="string">"ansible-playbook -i inventory nginx.yaml"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã¨æ›¸ãã¾ã—ãŸã€‚<code>metadata</code>ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«åŸ‹ã‚è¾¼ã‚€å…¬é–‹éµã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚ãã—ã¦æœ€çµ‚æ®µã«ã‚ã‚‹</p><figure class="highlight sh"><figcaption><span>tf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">provisioner <span class="string">"local-exec"</span> &#123;</span><br><span class="line">  working_dir = <span class="string">"./ansible/"</span></span><br><span class="line">  <span class="built_in">command</span>     = <span class="string">"ansible-playbook -i inventory nginx.yaml"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ãŒä»Šå›ã®ãƒŸã‚½ã®éƒ¨åˆ†ã§ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã‹ã™ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æŒ‡å®šã¨ã€ãã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’æ›¸ã„ã¦ã„ã¾ã™ã€‚ã‚³ãƒãƒ³ãƒ‰è‡ªä½“ã¯äººãŒå®Ÿè¡Œã™ã‚‹ã‚‚ã®ã¨åŸºæœ¬çš„ã«åŒã˜ã«ã™ã‚Œã°ã‚ã¨ã¯Ansibleã®ä¸–ç•Œãªã®ã§ã€taskãŒçµ‚ã‚ã‚‹ã®ã‚’å¾…ã¡ã¾ã—ã‚‡ã†ã€‚</p><h3 id="ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ-1"><a href="#ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ-1" class="headerlink" title="ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ"></a>ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ</h3><p>ä»Šå›ã€Ansibleã®å®Ÿè¡Œã‚’Terraformã«ã‚‚ãŸã›ã¾ã—ãŸãŒã€ã“ã¡ã‚‰ã‚‚ãƒ¡ãƒªãƒƒãƒˆã€ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã©ã¡ã‚‰ã‚‚ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚</p><ul><li>ãƒ¡ãƒªãƒƒãƒˆ<ul><li>ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå›æ•°ãŒæ¸›ã‚‹ï¼ˆæ‰‹é †ãŒæ¸›ã‚‹ï¼‰</li><li>AnsibleãŒç•°å¸¸çµ‚äº†ã—ãŸå ´åˆã¯<code>taint</code>ãƒ•ãƒ©ã‚°ãŒä»˜ãã®ã§ã€ã‚³ãƒ¼ãƒ‰ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã“ã¨ã¯ã—ã£ã‹ã‚Šå®Ÿè¡Œã•ã‚Œã‚‹</li></ul></li><li>ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ<ul><li>Ansibleã®ä¸–ç•Œã¨Terraformã®ä¸–ç•Œã®å¢ƒç•ŒãŒãªããªã‚‹ã®ã§ãã‚Œãã‚Œã®è²¬ä»»ã‚’åˆ†ã‘ã«ãããªã‚‹</li></ul></li></ul><p>ãƒ¡ãƒªãƒƒãƒˆã¯å®Ÿè¡Œå›æ•°ãŒæ¸›ã‚‹ã“ã¨ã¯ã‚‚ã¡ã‚ã‚“ã§ã™ãŒã€<code>taint</code>ãƒ•ãƒ©ã‚°ã‚’ã¤ã‘ã¦ãã‚Œã‚‹ã“ã¨ãŒå¬‰ã—ã„ã¨ã“ã‚ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ<code>taint</code>ãƒ•ãƒ©ã‚°ã¯ã€ã€ŒTerraformã®ãƒªã‚½ãƒ¼ã‚¹ã¨ã—ã¦ã¯ä½œæˆãŒæ¸ˆã‚“ã§ã„ã‚‹ãŒã€ãƒªã‚½ãƒ¼ã‚¹ãŒæŒ‡å®šé€šã‚Šã«ã§ããªã‹ã£ãŸã€æ™‚ã«ã¤ãã®ã§ã€Ansibleã®ä¸–ç•Œã§å¤±æ•—ã—ã¦ã‚‚Terraformã®å¤±æ•—ã«ãªã‚Šã¾ã™ã€‚<br>ä¸€æ–¹ãƒ‡ãƒ¡ãƒªãƒƒãƒˆè‡ªä½“ã¯ã€ç§è‡ªèº«ã¯å¤§ãããªã„ã¨æ€ã„ã¾ã™ãŒã€ãã‚Œãã‚Œã«ã‚‚ãŸã›ã‚‹å½¹å‰²ã€è²¬ä»»ã‚’ã¯ã£ãã‚Šåˆ†ã‘ã¦ãŠããŸã„å ´åˆã«ã¯ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‹ãªã¨æ€ã„ã¾ã™ï¼ˆè¦‹ãŸç›®ã®å•é¡Œã§ã¯ã‚ã‚Šã¾ã™ãŒï¼‰ã€‚</p><h2 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h2><p>æœ¬è¨˜äº‹ã§ã¯å‡ºæ¥ã‚‹ã ã‘Terraformã§ã¾ã‹ãªã£ã¦ã¿ã¾ã—ãŸãŒã€ã¨ã¯ã„ãˆç§è‡ªèº«Ansibleã‚„Packerãªã©ã‚‚ã‚‚ã¡ã‚ã‚“ä½¿ã„ã¾ã™ã€‚ã¾ãŸã€ä½¿ã„æ–¹ã‚‚ãƒãƒ¼ãƒ ãã‚Œãã‚Œãªã®ã§ã“ã®ã‚„ã‚Šæ–¹ãŒ100%ãƒ•ã‚£ãƒƒãƒˆã™ã‚‹ã¨ã“ã¨ã¯ãªã„ã¨æ€ã£ã¦ã„ã¾ã™ã€‚ãŸã ã€Terraformã®ä¸–ç•Œã‚’åºƒã’ã‚‹ã“ã¨ã§ã€ç®¡ç†ã‚³ã‚¹ãƒˆã‚„å®Ÿè£…ã‚³ã‚¹ãƒˆãŒä¸‹ãŒã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚IaCã®èƒŒæ™¯ã¯æ‰‹é †æ›¸ã‚’æ¥µåŠ›æ¸›ã‚‰ã—ãŸã‚Šã€ã‚¤ãƒ³ãƒ•ãƒ©ã«ã‚‚CI/CDã‚’å–ã‚Šå…¥ã‚Œã‚‹ä½™åœ°ã‚’ã‚‚ãŸã›ã‚‹ã“ã¨ã ã¨æ€ã†ã®ã§ã€ã“ã†ã„ã£ãŸå–ã‚Šçµ„ã¿ã¯å¿…è¦ã‹ãªã¨æ€ã„ã¾ã™ã€‚ã“ã“ã§ã„ã†ã€ã€Œæ¥½ã‚’ã—ãŸã„ã€ã¯ã©ã¡ã‚‰ã‹ã¨ã„ã†ã¨äººç‚ºçš„ãªãƒŸã‚¹ã‚’æ¸›ã‚‰ã™ã€ã¨ã„ã†ã¨ã“ã‚ã«è½ã¡ç€ãã¾ã™ã€‚</p><p>ã“ã‚Œã‹ã‚‰ã•ã‚‰ã«å¤ä¼‘ã¿è¨˜äº‹ã¯å‡ºã¦ãã¾ã™ã®ã§ã€ä»Šå¾Œã®è¨˜äº‹ã‚‚ãœã²èª­ã‚“ã§ãã ã•ã„ï¼</p><h2 id="é–¢é€£è¨˜äº‹"><a href="#é–¢é€£è¨˜äº‹" class="headerlink" title="é–¢é€£è¨˜äº‹"></a>é–¢é€£è¨˜äº‹</h2><ul><li><a href="/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/">å¤ä¼‘ã¿é€£è¼‰</a></li><li><a href="/tags/Terraform/">Terraform</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/20200805/%E3%81%B2%E3%81%BE%E3%82%8F%E3%82%8A.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ¬è¨˜äº‹ã¯&lt;a href=&quot;/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%
      
    
    </summary>
    
    
      <category term="Infrastructure" scheme="https://future-architect.github.io/categories/Infrastructure/"/>
    
    
      <category term="GCP" scheme="https://future-architect.github.io/tags/GCP/"/>
    
      <category term="Terraform" scheme="https://future-architect.github.io/tags/Terraform/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
  </entry>
  
  <entry>
    <title>GoPlusè‡ªç”±ç ”ç©¶</title>
    <link href="https://future-architect.github.io/articles/20200804/"/>
    <id>https://future-architect.github.io/articles/20200804/</id>
    <published>2020-08-03T15:00:00.000Z</published>
    <updated>2020-08-05T04:14:16.606Z</updated>
    
    <content type="html"><![CDATA[<p>ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼<a href="https://future-architect.github.io/articles/20200726/">å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶</a>é€£è¼‰ã®2å›ç›®ã§ã™ã€‚</p><p>TIG DXãƒ¦ãƒ‹ãƒƒãƒˆã®ä¼Šè—¤çœŸå½¦ã§ã™ã€‚</p><p>å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶ã¨ã—ã¦ã€GoPlusã®èª¿æŸ»ã‚’è¡Œã„ã¾ã—ãŸã€‚</p><p>ã“ã®è¨˜äº‹ã§ã¯GoPlusã®ç´¹ä»‹ã€ãŠã‚ˆã³ç°¡å˜ãªå†…éƒ¨æ§‹é€ ã®èª¿æŸ»ã‚’è¡Œã„ã¾ã™ã€‚</p><h1 id="ç›®æ¬¡"><a href="#ç›®æ¬¡" class="headerlink" title="ç›®æ¬¡"></a>ç›®æ¬¡</h1><ul><li>ã¯ã˜ã‚ã«</li><li>GoPlusã¨ã¯</li><li>GoPlusã®è¨˜è¿°ä¾‹</li><li>GoPlusã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</li><li>GoPlusã‚’Goã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</li><li>GoPlusã®ãƒãƒƒã‚¯ã‚’ç ”ç©¶</li><li>GoPlusã®ã“ã‚Œã‹ã‚‰</li></ul><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>ç§ã¯ç¾åœ¨Goã‚’æ›¸ã„ã¦ã„ã¾ã™ãŒã€å‰è·ã§ã¯Rubyã§ã®Webé–‹ç™ºãŒãƒ¡ã‚¤ãƒ³ã§ã—ãŸã€‚</p><p>Rubyã¯å‹å®šç¾©ã‚’æ›¸ãå¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€ç«¯çš„ã«è¨€ã†ã¨æ›¸ãã‚„ã™ã•ã«é‡ãã‚’ç½®ã„ã¦ã„ã¾ã™ã€‚</p><p><a href="https://ja.wikipedia.org/wiki/Ruby#%E8%A8%AD%E8%A8%88%E6%80%9D%E6%83%B3" target="_blank" rel="noopener">Wikipedia</a>ã«ã‚‚</p><blockquote><p>é–‹ç™ºè€…ã®ã¾ã¤ã‚‚ã¨ã‚†ãã²ã‚ã¯ã€ã€ŒRubyã®è¨€èªä»•æ§˜ç­–å®šã«ãŠã„ã¦æœ€ã‚‚é‡è¦–ã—ã¦ã„ã‚‹ã®ã¯ã‚¹ãƒˆãƒ¬ã‚¹ãªããƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’æ¥½ã—ã‚€ã“ã¨ã§ã‚ã‚‹ (enjoy programming)ã€ã¨è¿°ã¹ã¦ã„ã‚‹ã€‚</p></blockquote><p>ã¨æ›¸ã„ã¦ã‚ã‚‹ã“ã¨ã‹ã‚‰ã‚‚ã€ãã®è¨­è¨ˆæ€æƒ³ãŒä¼ºãˆã¾ã™ã€‚</p><p>ä¸€æ–¹Goã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«è¨€èªã¨ã—ã¦ã®é«˜é€Ÿå®Ÿè¡Œã¨æ›¸ãã‚„ã™ã•ã®çµ¶å¦™ãªãƒãƒ©ãƒ³ã‚¹ã‚’æ”»ã‚ã¦ã„ã‚‹å°è±¡ã§ã™ã€‚</p><p>C#ã‚’æ›¸ã„ãŸçµŒé¨“ã‚‚ã‚ã‚‹ã®ã§ã€å‹ãŒã‚ã‚‹ã®ãŒè‡ªç„¶ã¨ã„ã†æ„Ÿè¦šã‚‚ç†è§£ã§ãã¾ã™ãŒã€Rubyã«æ…£ã‚Œè¦ªã—ã‚“ã èº«ã‹ã‚‰ã™ã‚‹ã¨å‹å®šç¾©ã‚„é…åˆ—ã®å–ã‚Šæ‰±ã„ãŒå°‘ã€…é¢å€’ã«æ„Ÿã˜ã¾ã™ã€‚<br>ãã‚‚ãã‚‚å¤§æŠµã®è¨€èªã¯Rubyã‚ˆã‚ŠãŠå …ã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚<br>(ã©ã¡ã‚‰ã®è¨€èªãŒå„ªã‚Œã¦ã„ã‚‹ã€ã¨ã„ã†ä¸»å¼µã¯å‹¿è«–ã‚ã‚Šã¾ã›ã‚“ã€‚)</p><p>ãã‚“ãªRubyæ„›ã‚’å¼•ããšã£ã¦ã„ã‚‹ç§ã«ã¨ã£ã¦è¡æ’ƒçš„ãªãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã—ãŸã€‚<br><a href="https://github.com/qiniu/goplus" target="_blank" rel="noopener">GoPlus</a>ã®å­˜åœ¨ã§ã™ã€‚</p><h1 id="GoPlusã¨ã¯"><a href="#GoPlusã¨ã¯" class="headerlink" title="GoPlusã¨ã¯"></a>GoPlusã¨ã¯</h1><p>Goã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒƒãƒˆã«ã‚ãŸã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚</p><blockquote><ul><li>é™çš„å‹ä»˜è¨€èªã§ã‚ã‚‹</li></ul></blockquote><ul><li>Goã¨å®Œå…¨ãªäº’æ›æ€§ã‚’æŒã£ã¦ã‚‹</li><li>ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªã®ã‚ˆã†ãªã‚¹ã‚¿ã‚¤ãƒ«ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã«ãŠã„ã¦Goã‚ˆã‚Šé«˜ã„å¯èª­æ€§ã‚’å®Ÿç¾ã—ã¦ã„ã‚‹</li></ul><p>ã¨ã€<a href="https://github.com/qiniu/goplus/blob/master/README.md" target="_blank" rel="noopener">README</a>ã«æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚<br>Cã«å¯¾ã™ã‚‹C++ã®ã‚ˆã†ãªãƒãƒªã§å‘½åã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã­ã€‚</p><h1 id="GoPlusã®è¨˜è¿°ä¾‹"><a href="#GoPlusã®è¨˜è¿°ä¾‹" class="headerlink" title="GoPlusã®è¨˜è¿°ä¾‹"></a>GoPlusã®è¨˜è¿°ä¾‹</h1><h3 id="HelloWorld"><a href="#HelloWorld" class="headerlink" title="HelloWorld"></a>HelloWorld</h3><figure class="highlight go"><figcaption><span>hello.gop</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">println</span>(<span class="string">"Hello, world!"</span>)</span><br></pre></td></tr></table></figure><p>æ‹¡å¼µå­ã¯<code>.gop</code>ã§ã™ã€‚<br>ã“ã®1è¡Œã ã‘ã§å‹•ãã¾ã™ã€ã¤ã¾ã‚Špackageã®å®šç¾©ã‚„mainé–¢æ•°ã®è¨˜è¿°ãŒä¸è¦ã§ã™ã€‚<br>ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ã€‚</p><h3 id="é…åˆ—ã€ãƒãƒƒãƒ—ã®å–ã‚Šæ‰±ã„"><a href="#é…åˆ—ã€ãƒãƒƒãƒ—ã®å–ã‚Šæ‰±ã„" class="headerlink" title="é…åˆ—ã€ãƒãƒƒãƒ—ã®å–ã‚Šæ‰±ã„"></a>é…åˆ—ã€ãƒãƒƒãƒ—ã®å–ã‚Šæ‰±ã„</h3><figure class="highlight go"><figcaption><span>maplit.gop</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">l := [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">m := &#123;<span class="string">"a"</span>: <span class="number">1</span>, <span class="string">"b"</span>: <span class="number">2</span>&#125;</span><br><span class="line"><span class="built_in">println</span>(l)</span><br><span class="line"><span class="built_in">println</span>(m)</span><br><span class="line"></span><br><span class="line"># [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]ã€<span class="keyword">map</span>[a:<span class="number">1</span> b:<span class="number">2</span>]ãŒå‡ºåŠ›ã•ã‚Œã‚‹</span><br></pre></td></tr></table></figure><p>ç‰¹ã«ã‚¹ãƒ©ã‚¤ã‚¹(å¯å¤‰é•·ã®é…åˆ—å‹)ã®å®£è¨€ã®æ„Ÿã˜ãŒRubyæ™‚ä»£ã‚’æ€ã„å‡ºã—ã¾ã™ã€‚<br>åŒã˜ã“ã¨ã‚’Goã§ã‚„ã‚‹ã¨ã€ã“ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã—ã‚‡ã†ã‹</p><figure class="highlight go"><figcaption><span>maplit.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  l := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">  m := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>&#123;<span class="string">"a"</span>: <span class="number">1</span>, <span class="string">"b"</span>: <span class="number">2</span>&#125;</span><br><span class="line">  fmt.Println(l)</span><br><span class="line">  fmt.Println(m)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½™è«‡ã§ã™ãŒã€ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã®<code>println</code>é–¢æ•°ã‚‚<code>GoPlus</code>ã§æ–°ãŸã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>æœ¬å®¶Goã®Printç³»ã®é–¢æ•°ã‚ˆã‚ŠæŸ”è»Ÿã§ã€å‹ã‚’æ„è­˜ã›ãšã«ä½¿ãˆã‚‹ã‚ˆã†ã«æ‹¡å¼µã•ã‚Œã¦ã„ã¾ã™ã€‚</p><p>ä»–ã«ã‚‚å¤šå€é•·æ•´æ•°å‹ãƒ»å¤šå€é•·æµ®å‹•å°æ•°ç‚¹æ•°å‹ã®ã‚µãƒãƒ¼ãƒˆã€é…åˆ—æ“ä½œã®æ‹¡å¼µã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ç°¡æ˜“çš„ãªè¨˜æ³•ã®å®Ÿè£…ãªã©ä¾¿åˆ©ãªæ©Ÿèƒ½ãŒå¤šæ•°ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><h1 id="GoPlusã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"><a href="#GoPlusã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" class="headerlink" title="GoPlusã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"></a>GoPlusã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h1><p>GoPlusã‚’å®Ÿéš›ã«ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚<br><code>go get</code>ã‚³ãƒãƒ³ãƒ‰ã§<code>GOPATH</code>é…ä¸‹ã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go get github.com/qiniu/goplus</span><br><span class="line">go get github.com/qiniu/goplus@v0.6.50 #ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šã™ã‚‹å ´åˆ</span><br></pre></td></tr></table></figure><p><code>GOPATH</code>é…ä¸‹ã«<code>goplus</code>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç”Ÿæˆã•ã‚Œã‚‹ã®ã§ç§»å‹•ã—ã¾ã™ã€‚<br><code>go install</code>ã‚³ãƒãƒ³ãƒ‰ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $GOPATH/src/github.com/qiniu/goplus</span><br><span class="line">go install -v ./...</span><br></pre></td></tr></table></figure><img src="/images/20200804/gop.jpg" class="img-middle-size"><p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨<code>gop</code>ã‚³ãƒãƒ³ãƒ‰ãŒåˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<br>â€»åŸ·ç­†æ™‚ç‚¹ã§ã¯Î±ç‰ˆã§ã‚ã‚‹ãŸã‚ã€ä»£ã‚ã‚Šã«4ç¨®é¡ã®ã‚³ãƒãƒ³ãƒ‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™ã€‚</p><blockquote><ul><li>qrun: Similar to gop run</li><li>qfmt: Similar to gop fmt</li><li>qexp: Similar to gop export</li><li>qgo: Similar to gop go</li></ul></blockquote><p>è©¦ã—ã«<code>qrun</code>ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚<br><code>qrun</code>ã¯<code>gop run</code>ã€ã¤ã¾ã‚ŠGoã®<code>go run</code>ã«ç›¸å½“ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚<br>æ‹¡å¼µå­ãŒ<code>gop</code>ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚<br>å®Ÿéš›ã«<code>println(&quot;Hello, world!&quot;)</code>1è¡Œã ã‘ãŒæ›¸ã‹ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã§ãã¾ã—ãŸã€‚</p><img src="/images/20200804/run.jpg" class="img-middle-size"><h1 id="GoPlusã‚’Goã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ"><a href="#GoPlusã‚’Goã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ" class="headerlink" title="GoPlusã‚’Goã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ"></a>GoPlusã‚’Goã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h1><p>GoPlusã®æ‹¡å¼µæ©Ÿèƒ½ã‚’Goã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã‚ˆã†ãªä½¿ã„æ–¹ã‚‚å¯èƒ½ã§ã™ã€‚</p><figure class="highlight go"><figcaption><span>main.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/qiniu/goplus/tutorial/14-Using-goplus-in-Go/foo"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">rmap := foo.ReverseMap(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>&#123;<span class="string">"Hi"</span>: <span class="number">1</span>, <span class="string">"Hello"</span>: <span class="number">2</span>&#125;)</span><br><span class="line">fmt.Println(rmap)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="GoPlusã®ãƒãƒƒã‚¯ã‚’ç ”ç©¶"><a href="#GoPlusã®ãƒãƒƒã‚¯ã‚’ç ”ç©¶" class="headerlink" title="GoPlusã®ãƒãƒƒã‚¯ã‚’ç ”ç©¶"></a>GoPlusã®ãƒãƒƒã‚¯ã‚’ç ”ç©¶</h1><p>ä»•äº‹ã§ä½¿ã†ã‹ã¯ã¨ã‚‚ã‹ãGoPlusã¯é¢ç™½ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã ã¨æ„Ÿã˜ã¾ã—ãŸã€‚<br>ä»Šå›ã¯GoPlusãŒã©ã®ã‚ˆã†ãªæ‰‹æ³•ã§Goã‚’æŸ”è»Ÿãªè¨€èªã«æ‹¡å¼µã—ã¦ã„ã‚‹ã®ã‹èª¿æŸ»ã—ã¾ã™ã€‚<br>ã‚ˆã†ã‚„ãè‡ªç”±ç ”ç©¶ã®å§‹ã¾ã‚Šã§ã™ã€‚</p><h3 id="qrunã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒå®Ÿè¡Œã§ãã‚‹ä»•çµ„ã¿"><a href="#qrunã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒå®Ÿè¡Œã§ãã‚‹ä»•çµ„ã¿" class="headerlink" title="qrunã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒå®Ÿè¡Œã§ãã‚‹ä»•çµ„ã¿"></a>qrunã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒå®Ÿè¡Œã§ãã‚‹ä»•çµ„ã¿</h3><p><code>go run</code>ã«ç›¸å½“ã™ã‚‹<code>qrun</code>ã‚³ãƒãƒ³ãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br>ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè£…ã¯<a href="https://github.com/qiniu/goplus/blob/master/cmd/qrun/qrun.go" target="_blank" rel="noopener">ã“ã¡ã‚‰</a>ã§ã™ã€‚</p><p>ã„ãŸã£ã¦æ™®é€šã®Goã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚<br>ã¤ã¾ã‚Šã€<code>go install</code>ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸGoã®å®Ÿè£…ãŒå„ç¨®ã‚³ãƒãƒ³ãƒ‰ã®æ­£ä½“ã§ã™ã€‚</p><p><code>qrun</code>ã®mainé–¢æ•°å†…éƒ¨ã§ã€æ‹¡å¼µå­<code>gop</code>ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£æã€å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€<code>gop</code>ãƒ•ã‚¡ã‚¤ãƒ«æœ¬ä½“ã«ã¯mainé–¢æ•°ã‚„è«¸ã€…ã®ãŠã¾ã˜ãªã„ãŒä¸è¦ã«ãªã£ã¦ã„ãŸã‚“ã§ã™ã­ã€‚</p><p>GoPlusã¯æ—¢ã«5å¹´ã«æ¸¡ã‚Šé–‹ç™ºãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™(initial commitãŒ2015å¹´ã§ã—ãŸ)ã€‚<br>ãã®ãŸã‚è¤‡é›‘ãªå®Ÿè£…ãŒçµ„ã¿ã‚ãŒã£ã¦ã„ã¾ã™ãŒã€é ‘å¼µã£ã¦è¦ç‚¹ã ã‘ã§ã‚‚è§£æã—ã¦ã¿ã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>qrun.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">flag.Parse()</span><br><span class="line"><span class="keyword">if</span> flag.NArg() &lt; <span class="number">1</span> &#123;</span><br><span class="line">fmt.Fprintf(os.Stderr, <span class="string">"Usage: qrun [-asm -quiet -debug -prof] &lt;gopSrcDir|gopSrcFile&gt;\n"</span>)</span><br><span class="line">flag.PrintDefaults()</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã¾ãšã¯æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®<code>flag</code>ã‚’ç”¨ã„ã¦ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã‚’æ ¼ç´ã—ã¦ã„ã¾ã™ã€‚<br>ã¤ã¾ã‚Š<code>flag.Arg(0)</code>ã§å¼•æ•°ã§æ¸¡ã—ãŸ<code>ãƒ•ã‚¡ã‚¤ãƒ«å.gop</code>ãŒå–å¾—ã§ãã¾ã™ã€‚<br>è©¦ã—ã«ä½•ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã›ãš<code>qrun</code>ã‚³ãƒãƒ³ãƒ‰ã®ã¿ã‚’å®Ÿè¡Œã™ã‚‹ã¨<code>flag.NArg() &lt; 1</code>ãŒ<code>true</code>ã«ãªã‚Šã€å®Ÿè£…ã®é€šã‚Šã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚</p><img src="/images/20200804/qrun.jpg" class="img-middle-size"><figure class="highlight go"><figcaption><span>qrun.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">target, _ := filepath.Abs(flag.Arg(<span class="number">0</span>))</span><br><span class="line">isDir, err := IsDir(target)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatalln(<span class="string">"input arg check failed:"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">pkgs, err := parser.ParseGopFiles(fset, target, isDir, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatalln(<span class="string">"ParseGopFiles failed:"</span>, err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ãƒ•ã‚¡ã‚¤ãƒ«åã«ãƒ‘ã‚¹ã‚’çµ„ã¿åˆã‚ã›ãŸ<code>target</code>ãŒ<a href="https://github.com/qiniu/goplus/blob/18dda13248daa0846f7eebc28a5b7268903f9c41/parser/parse.go#L67" target="_blank" rel="noopener">parser.ParseGopFiles()</a>ã«æ¸¡ã•ã‚Œã¾ã™ã€‚<br>ã“ã“ã§<code>gopãƒ•ã‚¡ã‚¤ãƒ«</code>ã¨ã—ã¦ã®è§£æãŒå§‹ã¾ã‚‹ã‚ˆã†ã§ã™ã€‚</p><figure class="highlight go"><figcaption><span>qrun.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">cl.CallBuiltinOp = exec.CallBuiltinOp</span><br><span class="line"></span><br><span class="line">b := exec.NewBuilder(<span class="literal">nil</span>)</span><br><span class="line">_, err = cl.NewPackage(b.Interface(), pkgs[<span class="string">"main"</span>], fset, cl.PkgActClMain)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatalln(<span class="string">"cl.NewPackage failed:"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">code := b.Resolve()</span><br><span class="line"><span class="keyword">if</span> *flagAsm &#123;</span><br><span class="line">code.Dump(os.Stdout)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">ctx := exec.NewContext(code)</span><br><span class="line">ctx.Exec(<span class="number">0</span>, code.Len())</span><br><span class="line"><span class="keyword">if</span> *flagProf &#123;</span><br><span class="line">exec.ProfileReport()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æã—ãŸçµæœã®å®Ÿè¡Œã¯<code>NewBuilder</code>ã€<code>NewPackage</code>ãªã©ã®é–¢æ•°å†…éƒ¨ã§è¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚<br>å…¨ã¦ã‚’è§£æã—ã‚ˆã†ã¨ã™ã‚‹ã¨çµ‚ã‚ã‚ŠãŒè¦‹ãˆã¾ã›ã‚“ã€5å¹´åˆ†ã®é‡ã¿ã‚’æ„Ÿã˜ã¾ã™ã€‚</p><h3 id="æ§‹æ–‡è§£æã®ä»•çµ„ã¿"><a href="#æ§‹æ–‡è§£æã®ä»•çµ„ã¿" class="headerlink" title="æ§‹æ–‡è§£æã®ä»•çµ„ã¿"></a>æ§‹æ–‡è§£æã®ä»•çµ„ã¿</h3><p>GoPlusã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ§‹æ–‡è§£æã¯<a href="https://github.com/qiniu/goplus/blob/18dda13248daa0846f7eebc28a5b7268903f9c41/cl/compile.go#L474" target="_blank" rel="noopener">cl.NewPackage()</a>ã§è¡Œã‚ã‚Œã‚‹ã‚ˆã†ã§ã™ã€‚</p><figure class="highlight go"><figcaption><span>compile.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewPackage</span><span class="params">(out exec.Builder, pkg *ast.Package, fset *token.FileSet, act PkgAct)</span> <span class="params">(p *Package, err error)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> pkg == <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, ErrNotFound</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> CallBuiltinOp == <span class="literal">nil</span> &#123;</span><br><span class="line">log.Panicln(<span class="string">"NewPackage failed: variable CallBuiltinOp is uninitialized"</span>)</span><br><span class="line">&#125;</span><br><span class="line">p = &amp;Package&#123;&#125;</span><br><span class="line">ctxPkg := newPkgCtx(out, pkg, fset)</span><br><span class="line">ctx := newGblBlockCtx(ctxPkg)</span><br><span class="line"><span class="keyword">for</span> _, f := <span class="keyword">range</span> pkg.Files &#123;</span><br><span class="line">loadFile(ctx, f)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span> act &#123;</span><br><span class="line"><span class="keyword">case</span> PkgActClAll:</span><br><span class="line"><span class="keyword">for</span> _, sym := <span class="keyword">range</span> ctx.syms &#123;</span><br><span class="line"><span class="keyword">if</span> f, ok := sym.(*funcDecl); ok &amp;&amp; f.fi != <span class="literal">nil</span> &#123;</span><br><span class="line">ctxPkg.use(f)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> pkg.Name != <span class="string">"main"</span> &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fallthrough</span></span><br><span class="line"><span class="keyword">case</span> PkgActClMain:</span><br><span class="line"><span class="keyword">if</span> pkg.Name != <span class="string">"main"</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, ErrNotAMainPackage</span><br><span class="line">&#125;</span><br><span class="line">entry, err := ctx.findFunc(<span class="string">"main"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">if</span> err == ErrNotFound &#123;</span><br><span class="line">err = ErrMainFuncNotFound</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> p, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> entry.ctx.noExecCtx &#123;</span><br><span class="line">ctx.file = entry.ctx.file</span><br><span class="line">compileBlockStmtWithout(ctx, entry.body)</span><br><span class="line">ctx.checkLabels()</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">out.CallFunc(entry.Get(), <span class="number">0</span>)</span><br><span class="line">ctxPkg.use(entry)</span><br><span class="line">&#125;</span><br><span class="line">out.Return(<span class="number">-1</span>)</span><br><span class="line">&#125;</span><br><span class="line">ctxPkg.resolveFuncs()</span><br><span class="line">p.syms = ctx.syms</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¨˜ã®ã‚ˆã†ã«è¤‡é›‘ãªåˆ†å²ã‚’çµŒç”±ã—ã¾ã™ãŒã€å„çµŒè·¯ã§ã®å‰å‡¦ç†ã‚’çµ‚ãˆãŸã‚‰<a href="https://github.com/qiniu/goplus/blob/18dda13248daa0846f7eebc28a5b7268903f9c41/cl/stmt.go#L47" target="_blank" rel="noopener">compileStmt()</a>ã§å®Ÿéš›ã«æ§‹æ–‡è§£æãŒè¡Œã‚ã‚Œã¾ã™ã€‚<br>ãã®å…ˆé ­ã®<a href="https://github.com/qiniu/goplus/blob/18dda13248daa0846f7eebc28a5b7268903f9c41/cl/stmt.go#L378" target="_blank" rel="noopener">compileExprStmt()</a>å†…éƒ¨ã®<a href="https://github.com/qiniu/goplus/blob/18dda13248daa0846f7eebc28a5b7268903f9c41/cl/expr.go#L54" target="_blank" rel="noopener">compileExpr()</a>ã¾ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è§£æã—ã¦é€ã‚Šè¾¼ã¿ã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>expr.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">compileExpr</span><span class="params">(ctx *blockCtx, expr ast.Expr)</span> <span class="title">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">switch</span> v := expr.(<span class="keyword">type</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> *ast.Ident:</span><br><span class="line"><span class="keyword">return</span> compileIdent(ctx, v.Name)</span><br><span class="line"><span class="keyword">case</span> *ast.BasicLit:</span><br><span class="line"><span class="keyword">return</span> compileBasicLit(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.CallExpr:</span><br><span class="line"><span class="keyword">return</span> compileCallExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.BinaryExpr:</span><br><span class="line"><span class="keyword">return</span> compileBinaryExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.UnaryExpr:</span><br><span class="line"><span class="keyword">return</span> compileUnaryExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.SelectorExpr:</span><br><span class="line"><span class="keyword">return</span> compileSelectorExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.ErrWrapExpr:</span><br><span class="line"><span class="keyword">return</span> compileErrWrapExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.IndexExpr:</span><br><span class="line"><span class="keyword">return</span> compileIndexExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.SliceExpr:</span><br><span class="line"><span class="keyword">return</span> compileSliceExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.CompositeLit:</span><br><span class="line"><span class="keyword">return</span> compileCompositeLit(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.SliceLit:</span><br><span class="line"><span class="keyword">return</span> compileSliceLit(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.FuncLit:</span><br><span class="line"><span class="keyword">return</span> compileFuncLit(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.ParenExpr:</span><br><span class="line"><span class="keyword">return</span> compileExpr(ctx, v.X)</span><br><span class="line"><span class="keyword">case</span> *ast.ListComprehensionExpr:</span><br><span class="line"><span class="keyword">return</span> compileListComprehensionExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.MapComprehensionExpr:</span><br><span class="line"><span class="keyword">return</span> compileMapComprehensionExpr(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.ArrayType:</span><br><span class="line"><span class="keyword">return</span> compileArrayType(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.Ellipsis:</span><br><span class="line"><span class="keyword">return</span> compileEllipsis(ctx, v)</span><br><span class="line"><span class="keyword">case</span> *ast.KeyValueExpr:</span><br><span class="line"><span class="built_in">panic</span>(<span class="string">"compileExpr: ast.KeyValueExpr unexpected"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">log.Panicln(<span class="string">"compileExpr failed: unknown -"</span>, reflect.TypeOf(v))</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã¡ã‚‰ã®switchæ–‡ã¾ã§è¾¿ã‚Šç€ã„ãŸã‚‰ã€è§£æçµæœã«å¿œã˜ãŸã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒèµ°ã‚Šã¾ã™ã€‚<br>èˆˆå‘³ãŒã‚ã‚Œã°qrunã‹ã‚‰æ§‹æ–‡è§£æã¾ã§ã®å‡¦ç†ã®æµã‚Œã‚’è©³ã—ãæ¢ç´¢ã—ã¦ã¿ã¦ãã ã•ã„ã€ç§ã¯ãã‚ãã‚é™ç•Œã§ã™ã€‚</p><p>è©¦ã—ã«è§£æçµæœãŒ<code>*ast.SliceExpr</code>ã ã£ãŸå ´åˆã®å‹•ãã€<a href="https://github.com/qiniu/goplus/blob/18dda13248daa0846f7eebc28a5b7268903f9c41/cl/expr.go#L729" target="_blank" rel="noopener">compileSliceExpr()</a>ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>expr.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">compileSliceExpr</span><span class="params">(ctx *blockCtx, v *ast.SliceExpr)</span> <span class="title">func</span><span class="params">()</span></span> &#123; <span class="comment">// x[i:j:k]</span></span><br><span class="line"><span class="keyword">var</span> kind reflect.Kind</span><br><span class="line">exprX := compileExpr(ctx, v.X)</span><br><span class="line">x := ctx.infer.Get(<span class="number">-1</span>)</span><br><span class="line">typ := x.(iValue).Type()</span><br><span class="line"><span class="keyword">if</span> kind = typ.Kind(); kind == reflect.Ptr &#123;</span><br><span class="line">typ = typ.Elem()</span><br><span class="line"><span class="keyword">if</span> kind = typ.Kind(); kind != reflect.Array &#123;</span><br><span class="line">logPanic(ctx, v, <span class="string">`cannot slice a (type *%v)`</span>, typ)</span><br><span class="line">&#125;</span><br><span class="line">typ = reflect.SliceOf(typ.Elem())</span><br><span class="line">ctx.infer.Ret(<span class="number">1</span>, &amp;goValue&#123;typ&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">exprX()</span><br><span class="line">i, j, k := exec.SliceDefaultIndex, exec.SliceDefaultIndex, exec.SliceDefaultIndex</span><br><span class="line"><span class="keyword">if</span> v.Low != <span class="literal">nil</span> &#123;</span><br><span class="line">i = compileIdx(ctx, v.Low, exec.SliceConstIndexLast, kind)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> v.High != <span class="literal">nil</span> &#123;</span><br><span class="line">j = compileIdx(ctx, v.High, exec.SliceConstIndexLast, kind)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> v.Max != <span class="literal">nil</span> &#123;</span><br><span class="line">k = compileIdx(ctx, v.Max, exec.SliceConstIndexLast, kind)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> v.Slice3 &#123;</span><br><span class="line">ctx.out.Slice3(i, j, k)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">ctx.out.Slice(i, j)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç‹¬è‡ªã®å®Ÿè£…ãŒå±±ç››ã‚Šã§ã™ã­â€¦å†å¸°çš„ã«<a href="https://github.com/qiniu/goplus/blob/18dda13248daa0846f7eebc28a5b7268903f9c41/cl/expr.go#L54" target="_blank" rel="noopener">compileExpr()</a>ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã“ã‚ã‚‚è¿·å®®ãƒã‚¤ãƒ³ãƒˆã‚’é«˜ã‚ã¦ã„ã¾ã™ã€‚<br>ã‚­ãƒªãŒãªã„ã®ã§ä»Šå›ã¯ã“ã®è¾ºã‚Šã§èª¿æŸ»ã‚’çµ‚äº†ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚</p><h1 id="GoPlusã®ã“ã‚Œã‹ã‚‰"><a href="#GoPlusã®ã“ã‚Œã‹ã‚‰" class="headerlink" title="GoPlusã®ã“ã‚Œã‹ã‚‰"></a>GoPlusã®ã“ã‚Œã‹ã‚‰</h1><p>GoPlusã¯åŸ·ç­†æ™‚ç‚¹ã§ã¯æœˆé–“90ä»¶ã«è¿‘ã„ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãƒãƒ¼ã‚¸ã•ã‚Œã€çµ¶è³›é–‹ç™ºä¸­ã®çŠ¶æ…‹ã§ã™ã€‚<br><img src="/images/20200804/project.png" alt=""><br>Î±ç‰ˆã‚’ä¹—ã‚Šè¶Šãˆ<code>gop</code>ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ãå‡ºã™æ—¥ã¯æ¥ã‚‹ã®ã‹ã€ä¹ã†ã”æœŸå¾…ã§ã™ã€‚</p><h1 id="è¿½è¨˜"><a href="#è¿½è¨˜" class="headerlink" title="è¿½è¨˜"></a>è¿½è¨˜</h1><p>è¨˜äº‹ã®å…¬é–‹å‰æ—¥ã«ç¢ºèªã—ãŸã¨ã“ã‚ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³0.7.1ã‚ˆã‚Šgopã‚³ãƒãƒ³ãƒ‰ãŒæ¡ç”¨ã•ã‚Œã¦ã„ã¾ã—ãŸï¼<br>ãŠã‚ã§ã¨ã†GoPlusã€‚<br><img src="/images/20200804/gop.png" alt=""></p><p>ç§ã¯å‰ã„ã®ã§è¨˜äº‹å…¬é–‹ã®1ã‹æœˆå‰ã«æ¦‚ã­æ›¸ãçµ‚ã‚ã£ã¦ã„ãŸã®ã§ã™ãŒã€ãã®é–“ã«ã‚‚GoPlusã¯å¤§ããé€²åŒ–ã—ã¦ã„ã¾ã—ãŸã€‚<br>è¿½è¨˜åŸ·ç­†æ™‚ç‚¹ã§ã®æœ€æ–°ã®å®Ÿè£…(v0.7.4)ã§ã¯REPL(å¯¾è©±å‹ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿)ã®å®Ÿè¡Œæ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚ŒãŸã‚ˆã†ã§ã™ã€‚</p><p><img src="/images/20200804/repl.png" alt=""></p><p>ã•ã‚‰ã«ã¯<a href="https://github.com/goplus/vscode-goplus" target="_blank" rel="noopener">vscodeç”¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³</a>ã®é–‹ç™ºã‚‚ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã—ãŸã€‚<br><img src="/images/20200804/vscode.png" alt=""></p><p>ä»Šå¾Œã®æˆé•·ãŒã¾ã™ã¾ã™æ¥½ã—ã¿ã«ãªã‚Šã¾ã—ãŸã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼&lt;a href=&quot;https://future-architect.github.io/articles/20200726/&quot;&gt;å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶&lt;/a&gt;é€£è¼‰ã®2å›ç›®ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;TIG DXãƒ¦ãƒ‹ãƒƒãƒˆã®ä¼Šè—¤çœŸå½¦ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶ã¨ã—ã¦ã€
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="Go" scheme="https://future-architect.github.io/tags/Go/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
  </entry>
  
  <entry>
    <title>ç”£æ¥­ç”¨æ©Ÿå™¨å‘ã‘ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯Modbusã§æ¸©æ¹¿åº¦ã‚»ãƒ³ã‚·ãƒ³ã‚°</title>
    <link href="https://future-architect.github.io/articles/20200803/"/>
    <id>https://future-architect.github.io/articles/20200803/</id>
    <published>2020-08-02T15:00:00.000Z</published>
    <updated>2020-08-11T01:50:03.215Z</updated>
    
    <content type="html"><![CDATA[<p>ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼<a href="https://future-architect.github.io/articles/20200726/">å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶</a>é€£è¼‰ã®1å›ç›®ã§ã™ã€‚</p><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>TIG DXãƒ¦ãƒ‹ãƒƒãƒˆçœŸé‡ã§ã™ã€‚ä¸‰è±ç³»ã®PLCã¨é€šä¿¡ã™ã‚‹<a href="http://fa-dic.mitsubishielectric.co.jp/faq/show/15797?category_id=865" target="_blank" rel="noopener">MCãƒ—ãƒ­ãƒˆã‚³ãƒ«</a>ã¯ã¡ã‚‡ã£ã¨é£›ã³é“å…·çš„ãª<a href="https://speakerdeck.com/laqiiz/go-plc" target="_blank" rel="noopener">æŒã¡ãƒã‚¿</a>ã®1ã¤ã§ã™ãŒã€åŒæ§˜ã«ãƒ¡ã‚¸ãƒ£ãƒ¼ãªè¦æ ¼ã§ã‚ã‚‹Modbusã«ã¤ã„ã¦è‡ªç”±ç ”ç©¶ã¨ã„ã†åã®èª¿æŸ»ã‚’ã—ã¾ã—ãŸã€‚</p><p>å·¥å ´ã€å€‰åº«ã€ãƒ—ãƒ©ãƒ³ãƒˆãªã©ã®IoTåŒ–ã‚’è¡Œã†ã¨ã€Webå‘¨ã‚Šã«ç„¡ã„æŠ€è¡“ã‚‚è§¦ã‚Œã¦æ¥½ã—ã„ãªã£ã¦æœ€è¿‘æ€ã£ã¦ã¾ã™ã€‚</p><h1 id="Modbusã¨ã¯"><a href="#Modbusã¨ã¯" class="headerlink" title="Modbusã¨ã¯"></a>Modbusã¨ã¯</h1><blockquote><p>Modbusã¯Modiconç¤¾ãŒ1979å¹´ã€åŒç¤¾ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ–ãƒ«ãƒ­ã‚¸ãƒƒã‚¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ© (PLC) å‘ã‘ã«ç­–å®šã—ãŸã‚·ãƒªã‚¢ãƒ«é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚ã‚‹ã€‚ç”£æ¥­ç•Œã«ãŠã‘ã‚‹ãƒ‡ãƒ»ãƒ•ã‚¡ã‚¯ãƒˆæ¨™æº–ã®é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ãªã‚Šã€ç¾åœ¨ã§ã¯ç”£æ¥­ç”¨é›»å­æ©Ÿå™¨ã‚’æ¥ç¶šã™ã‚‹æœ€ã‚‚ä¸€èˆ¬çš„æ‰‹æ®µã¨ãªã£ã¦ã„ã‚‹ã€‚<br><a href="https://ja.wikipedia.org/wiki/Modbus" target="_blank" rel="noopener">https://ja.wikipedia.org/wiki/Modbus</a> - Wikipediaã®Modbusãƒšãƒ¼ã‚¸</p></blockquote><p>Wikipediaã®èª¬æ˜ãŒåˆ†ã‹ã‚Šã‚„ã™ã„ã®ã§å¼•ç”¨ã—ã¾ã—ãŸã€‚</p><p>æ›¸ã„ã¦ã‚ã‚‹ã‚ˆã†ã«Modbusï¼ˆãƒ¢ãƒ‰ãƒã‚¹ï¼‰ã¨ã¯é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚ç”±æ¥ã¯Modiconç¤¾ã‹ã‚‰æ¥ã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ã€‚é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ã‚ã‚‹ã‚ˆã†ã«ã€Webã§ã„ã†HTTPã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚ã‚µãƒ¼ãƒãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¢ãƒ‡ãƒ«ã§ã€Modbusã§ã‚»ãƒ³ã‚µãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ã’ã‚‹ã¨ã€æ¸©åº¦ãƒ»æ¹¿åº¦ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§å–å¾—ã§ãã‚‹ã‚ˆã†ãªã‚‚ã®ã§ã™ï¼ˆå¾Œè¿°ã—ã¾ã™ï¼‰ã€‚</p><p><a href="https://ja.wikipedia.org/wiki/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9E%E3%83%96%E3%83%AB%E3%83%AD%E3%82%B8%E3%83%83%E3%82%AF%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9" target="_blank" rel="noopener">PLC</a>ã¨ã„ã†ã®ã¯å·¥å ´ã®ç”Ÿç”£è¨­å‚™ã§ç”¨ã„ã‚‹æ©Ÿå™¨ã®ã“ã¨ã§ã™ã€‚è£½é€ ç¾å ´ã®FAï¼ˆãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã«ä½¿ã‚ã‚Œã‚‹<a href="https://ja.wikipedia.org/wiki/%E3%82%B7%E3%83%BC%E3%82%B1%E3%83%B3%E3%82%B9%E5%88%B6%E5%BE%A1" target="_blank" rel="noopener">ã‚·ãƒ¼ã‚±ãƒ³ã‚¹åˆ¶å¾¡</a>ã‚’è¡Œã†è£…ç½®ã§ã™ã€‚</p><p>ã‚·ãƒªã‚¢ãƒ«æ¥ç¶šã¯Webç³»ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã¯é¦´æŸ“ã¿ãŒè–„ã„æ°—ãŒã—ã¾ã™ã€‚ç°¡å˜ã«è¨€ã†ï¼‘æœ¬ã ã‘ã®é€šä¿¡ç·šã‚’ä½¿ã„ã€1/0ã®é›»åœ§ãƒ¬ãƒ™ãƒ«ã‚’é€£ç¶šçš„(=ã‚·ãƒªã‚¢ãƒ«)ã«å¤‰åŒ–ã•ã›ã¦ã€æ„å‘³ã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡/å—ä¿¡ã™ã‚‹é€šä¿¡æ–¹å¼ã§ã™ã€‚USBã¨ã‹ã€è‡ªä½œPCã‚’ã™ã‚‹äººã«ã¨ã£ã¦ã¯ã‚·ãƒªã‚¢ãƒ«ATAãŒæœ‰åã§ã—ã‚‡ã†ã‹ã€‚å·¥å ´ç³»ã®äººã«ã¨ã£ã¦ã¯ã€RS-232Cã¨ã‹RS485ãŒæœ‰åãªæ°—ãŒã—ã¾ã™ã€‚</p><h1 id="Modbusã®ä½¿ã„æ‰€"><a href="#Modbusã®ä½¿ã„æ‰€" class="headerlink" title="Modbusã®ä½¿ã„æ‰€"></a>Modbusã®ä½¿ã„æ‰€</h1><p>åˆ©ç”¨ç”¨é€”ãŒPLCæ¥ç¶šã ã‘ã ã¨ã™ã‚‹ã¨ã€Œã‚ªãƒ¬ã«ã¯é–¢ä¿‚ç„¡ã„ãªã€ã£ã¦ãªã‚Šãã†ã§ã™ãŒã€Modbusã¯ã‚‚ã†å°‘ã—åºƒãåˆ©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚æ²é¡Œã®æ¸©æ¹¿åº¦ã‚»ãƒ³ã‚µãƒ¼ã‚„ã€ã‚«ãƒ¡ãƒ©ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ç”£æ¥­ç”¨ãƒ­ãƒœãƒƒãƒˆã®åˆ¶å¾¡ãªã©ã§ã‚‚åˆ©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><p>ã„ã‚„ã„ã‚„ã€ä»Šã©ãã¯ãƒ©ã‚ºãƒ™ãƒªãƒ¼ãƒ‘ã‚¤ãªã©ã®ã‚·ãƒ³ã‚°ãƒ«ãƒœãƒ¼ãƒ‰ã§å®Œçµã•ã›ã‚‹ã“ã¨ãŒå¢—ãˆã¦ã„ã‚‹ã‚ˆã£ã¦IoTç•Œéšˆã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«è¨€ã‚ã‚Œãã†ã§ã™ãŒã€å€‰åº«ã‚„å·¥å ´ãªã©ã§å°å…¥ã™ã‚‹ã¨ã€é«˜ã„å¯ç”¨æ€§ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ï¼ˆ5å¹´10å¹´ã¯æ•…éšœã—ãªã„ã¨ã‹ï¼‰ãŸã‚ã€ã“ã†ã„ã£ãŸç”£æ¥­ç”¨ã®æ©Ÿå™¨ã®é¸å®šã‚’è¡Œã†ã“ã¨ã‚‚ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚ãã†ã™ã‚‹ã¨å¿…ç„¶ã€Modbusã®ã‚ˆã†ãªé€šä¿¡è¦æ ¼ã‚’æŠ‘ãˆã‚‹å¿…è¦ãŒã§ã¦ãã¾ã™ã€‚ãƒ©ã‚ºãƒ‘ã‚¤ã«ã‚»ãƒ³ã‚µãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¥ç¶šã§å®Œçµã§ãã‚‹ãªã‚‰ãã£ã¡ãŒè‰¯ã„ã¨åƒ•ã‚‚ãã†æ€ã„ã¾ã™ã€‚</p><p>MCãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®é•ã„ã§ã™ãŒã€MCãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚‚<a href="https://www.cc-link.org/ja/cclink/slmp/index.html" target="_blank" rel="noopener">SLMP (Seamless Message Protocol)</a>ã¨ã„ã†å½¢ã§æ¨™æº–åŒ–ã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒã€Modbusã¯ãã‚Œã‚ˆã‚Šå¤ãã‹ã‚‰ã‚ã‚Šã€ä»•æ§˜ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªãŸã‚ã€ã‚»ãƒ³ã‚µãƒ¼ã‚„ã‚«ãƒ¡ãƒ©ã‚„ãƒ­ãƒœãƒƒãƒˆãªã©ã®ã‚»ãƒ³ã‚µãƒ¼ãƒ»ã‚¢ã‚¯ãƒãƒ¥ã‚¨ãƒ¼ã‚¿ã«ã‚‚æ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒä¸€ã¤ã®å·®ã‹ãªã¨æ€ã„ã¾ã™ã€‚</p><p>ï¼ˆæœ€è¿‘ã ã¨OPC-UAã§ã™ã‹ã­ã€‚ã¾ã ç§ã¯è§¦ã£ãŸã“ã¨ãŒãªã„ã§ã™ã€‚å€‹äººãƒ¦ãƒ¼ã‚¹ã§1ä¸‡å††ä»¥ä¸‹ã§æ‰‹ã«å…¥ã‚‹OPC-UAæ©Ÿå™¨ãŒã‚ã‚Šã¾ã—ãŸã‚‰ã©ãªãŸã‹æ•™ãˆã¦ä¸‹ã•ã„ï¼‰</p><h1 id="Modbusãƒ—ãƒ­ãƒˆã‚³ãƒ«"><a href="#Modbusãƒ—ãƒ­ãƒˆã‚³ãƒ«" class="headerlink" title="Modbusãƒ—ãƒ­ãƒˆã‚³ãƒ«"></a>Modbusãƒ—ãƒ­ãƒˆã‚³ãƒ«</h1><p>Modbusã¯ã‚µãƒ¼ãƒãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚</p><p>ãã®ãŸã‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ãŒã‚»ãƒ³ã‚µãƒ¼å€¤ã®å–å¾—ã‚„ã‚¢ã‚¯ãƒãƒ¥ã‚¨ãƒ¼ã‚¿ã®æ“ä½œã‚’è¡Œã„ã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå‡¦ç†ã®ç®¡ç†å½¹ãªãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã‚’Modbusã®ãƒã‚¹ã‚¿ãƒ¼ã€ã‚µãƒ¼ãƒå´ã‚’Modbusã®ã‚¹ãƒ¬ãƒ¼ãƒ–ã¨ã‚‚å‘¼ã³ã¾ã™ã€‚Modbusã®è¦ªç‰ã«è¤‡æ•°ã®å­æ©Ÿã‚’ã¶ã‚‰ä¸‹ã’ã¦ä¸€é€£ã®åˆ¶å¾¡ã‚’ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒã‚ˆãå‡ºã¦ãã‚‹æ°—ãŒã—ã¾ã™ã€‚ã“ã®è¨˜äº‹ã§ã¯ãƒã‚¹ã‚¿ãƒ¼ã‚’ãƒãƒãƒ¼ã‚¸ãƒ£ã€ã‚¹ãƒ¬ãƒ¼ãƒ–ã‚’ãƒ¯ãƒ¼ã‚«ã¨å‘¼ã³æ›¿ãˆã¦è¨˜è¼‰ã—ã¾ã™ã€‚</p><img src="/images/20200803/modbus-worker-manager.png" class="img-middle-size"><p>Modbusã«ã¯å¤§ããåˆ†ã‘ã¦3ã¤ã®é€šä¿¡æ–¹å¼ãŒã‚ã‚Šã¾ã™ã€‚å…ˆã»ã©ã‚·ãƒªã‚¢ãƒ«æ¥ç¶šã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã ã‚ˆã£ã¦è¨€ã„ã¾ã—ãŸãŒã€TCP/IPå¯¾å¿œã—ã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚‚ã‚ã‚Šã¾ã™ã€‚</p><ol><li><strong>Modbus RTU</strong>: ã‚·ãƒªã‚¢ãƒ«æ¥ç¶šã§ã€ãƒã‚¤ãƒŠãƒªè¡¨ç¾</li><li><strong>Modbus ASCII</strong>: ã‚·ãƒªã‚¢ãƒ«æ¥ç¶šã§ã€ASCIIãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€‚RTUã«æ¯”ã¹ã¦ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºãŒå¢—ãˆã‚‹ãŒã€äººé–“ã«èª­ã¿ã‚„ã™ã„</li><li><strong>Modbus/TCP</strong>: TCP/IPã‚’ç”¨ã„ã‚‹</li></ol><p>çŠ¶æ³æ¬¡ç¬¬ã‹ã¨æ€ã„ã¾ã™ãŒã€Modbusãƒ¯ãƒ¼ã‚«ãƒ¼ãã®ã‚‚ã®ã‚’é–‹ç™ºã—ã¦ã„ã‚‹æ–¹ã¯ã¨ã‚‚ã‹ãã€å¯¾å¿œæ©Ÿå™¨ã‚’åˆ©ç”¨ã™ã‚‹åˆ†ã«ã¯ã‚·ãƒªã‚¢ãƒ«æ¥ç¶šã®å ´åˆã¯æ€§èƒ½ä¸Šã®ç†ç”±ã‹ã‚‰ ModbusRTUã‚’é¸ã¶ã“ã¨ãŒå¤šã„ã¨æ€ã„ã¾ã™ã€‚</p><h1 id="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ "><a href="#ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ " class="headerlink" title="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ "></a>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ </h1><p>Modbus ASCIIã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆHTTPã§ã„ã†ã¨ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ï¼‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå±æ€§ã‚’æŒã¡ã¾ã™ã€‚Modbus RTUã¯ãƒã‚¤ãƒŠãƒªãƒ•ãƒ¬ãƒ¼ãƒ ã®ãŸã‚è©³ç´°ã¯ã“ã“ã§ã¯å‰²æ„›ã—ã¾ã™ãŒã€ãƒ–ãƒ­ãƒƒã‚¯ã®æ§‹é€ ã¯åŒã˜ã§ã™ã€‚</p><p><img src="/images/20200803/ascc_message_frame.png" alt=""><br>â€»PIâ€“MBUSâ€“300 Rev. Jã‚ˆã‚Š</p><p>STARTç§»è¡Œã®ã€åˆ©ç”¨å¯èƒ½ãªæ–‡å­—ã¯ 0-9, A-Fã‹ã‚‰ã®æ–‡å­—åˆ—ã®ã¿ã§ã™ã€‚æœ€å¾Œã¯CRLFã§çµ‚ã‚ã‚Šã¾ã™ã€‚</p><ul><li><strong>START</strong>: 1æ–‡å­—ã§<code>:ï¼ˆ0x3Aï¼‰</code></li><li><strong>ADDRESS</strong>: 2æ–‡å­—ã€‚ãƒãƒãƒ¼ã‚¸ãƒ£ãŒè¦æ±‚ã™ã‚‹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆ1~247ï¼‰ã€‚0 ã¯ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã€‚</li><li><strong>FUNCTION</strong>: 2æ–‡å­—ã€‚è¦æ±‚ã®ç¨®é¡ã‚’ç¤ºã—ã¾ã™ã€‚ä¸‹è¨˜ã«ç¤ºã—ã¾ã™ã€‚1~255ãŒè¨­å®šå¯èƒ½ã€‚ã©ã®ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ãŒãŒæœ‰åŠ¹åŒ–ã¯ãƒ¯ãƒ¼ã‚«ãƒ‡ãƒã‚¤ã‚¹ã«ä¾å­˜</li><li><strong>DATA</strong>: Næ–‡å­—ã§å¯å¤‰ã€‚ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã”ã¨ã«ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒæ±ºã¾ã‚Šã¾ã™ã€‚</li><li><strong>LRC CHECK</strong>: 2æ–‡å­—ã€‚æ°´å¹³ãƒ‘ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ï¼ˆLongitudinal Redundancy ChecKï¼‰ã®ã“ã¨ã€‚è»¢é€æ™‚ã«ãƒã‚¤ã‚ºã«ã‚ˆã‚‹ãƒ“ãƒƒãƒˆãŒåè»¢ã—ã¦ã„ãªã„ã‹ã‚’å—ä¿¡å´ãŒãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã‚‚ã®</li><li><strong>æ”¹è¡Œ</strong>: CRLF</li></ul><h2 id="ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰"><a href="#ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰" class="headerlink" title="ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰"></a>ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰</h2><p><code>PIâ€“MBUSâ€“300 Rev. J</code>ã«è¨˜è¼‰ã•ã‚Œã¦ã„ãŸã‚³ãƒ¼ãƒ‰ã¯å…¨éƒ¨ã§24ã¤ã‚ã‚Šã¾ã—ãŸã€‚ã‚³ãƒ¼ãƒ‰ã‚’ä¸Šã‹ã‚‰3ã¤æŠœç²‹ã—ã¾ã™ã€‚</p><table><thead><tr><th align="left">CODE</th><th align="left">NAME</th><th align="center">Note</th></tr></thead><tbody><tr><td align="left">01</td><td align="left">Read Coil Status</td><td align="center">ãƒ¯ãƒ¼ã‚«ã®DOï¼ˆDiscrete Outputï¼‰ã®ON/OFFã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹èª­ã¿å–ã‚Š</td></tr><tr><td align="left">02</td><td align="left">Read Input Status</td><td align="center">ãƒ¯ãƒ¼ã‚«ã®DIï¼ˆDiscrete Inputï¼‰ã®ON/OFFã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹èª­ã¿å–ã‚Š</td></tr><tr><td align="left">03</td><td align="left">Read Holding Registers</td><td align="center">ãƒ¯ãƒ¼ã‚«ã®ä¿æŒãƒ¬ã‚¸ã‚¹ã‚¿ã®å†…å®¹ã‚’èª­ã¿å–ã‚Š</td></tr><tr><td align="left">ä»¥ä¸‹çœç•¥ã€‚</td><td align="left"></td><td align="center"></td></tr></tbody></table><p>DATAéƒ¨ã«ã¤ã„ã¦03ã®ä¾‹ã§èª¬æ˜ã—ã¾ã™ã€‚</p><p><code>Read Holding Registers</code> ã®<code>DATA</code> ã¯ä¿æŒãƒ¬ã‚¸ã‚¹ã‚¿ã®é–‹å§‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ä¿æŒãƒ¬ã‚¸ã‚¹ã‚¿ã®æ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚</p><ul><li>START: 1æ–‡å­—</li><li>FUNCTION: 2æ–‡å­—ã€‚<code>Read Holding Registers</code> ã¯ <code>03</code>ã«ãªã‚‹</li><li><strong>DATA</strong>: 03ã®å ´åˆã¯ä»¥ä¸‹4ã¤ã‚’æŒ‡å®š<ul><li><strong>é–‹å§‹ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆHiï¼‰</strong>:  Hi+Loãªã®ã§ã€201ã‚’æŒ‡ã™å ´åˆã¯ Hiã«00ã€Loã«C8ã‚’æŒ‡å®šã€‚é–‹å§‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯1å°‘ãªã„</li><li><strong>é–‹å§‹ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆLoï¼‰</strong>: çœç•¥</li><li><strong>å–å¾—æ•°ï¼ˆHiï¼‰</strong>: Hi+Loãªã®ã§ã€3ç‚¹å–å¾—ã™ã‚‹å ´åˆã¯ã€Hiã‚’00, Loã«03ã‚’æŒ‡å®š</li><li><strong>å–å¾—æ•°ï¼ˆLoï¼‰</strong>: çœç•¥</li></ul></li><li>LRC CHECK: 2æ–‡å­—</li><li>æ”¹è¡Œ</li></ul><p>ã¾ã¨ã‚ã‚‹ã¨ã€Modbusãƒ¯ãƒ¼ã‚«ç•ªå·1ã«Read Holding Registersã§ã€ãƒ¬ã‚¸ã‚¹ã‚¿201ã‹ã‚‰3ç‚¹å–å¾—ã™ã‚‹å ´åˆã¯ã€<br><code>:0300C8003</code>ã¨LRCãƒã‚§ãƒƒã‚¯ã¨CRLFã§1è¦æ±‚ã«ãªã‚Šã¾ã™ã€‚</p><p>å¿œç­”ã‚‚ã»ã¼ä¼¼ãŸã‚ˆã†ãªå½¢å¼ã§ã€ä»¥ä¸‹ã®ç”¨ã«æŒ‡å®šã•ã‚ŒãŸãƒ¬ã‚¸ã‚¹ã‚¿å€¤ãŒå–å¾—ã§ãã¾ã™ã€‚</p><ul><li>START: 1æ–‡å­—</li><li>FUNCTION: 2æ–‡å­—ã€‚<code>Read Holding Registers</code> ã¯ <code>03</code>ã«ãªã‚‹</li><li><strong>Byte Count</strong>: ãƒã‚¤ãƒˆæ•°</li><li><strong>DATA1</strong>: å–å¾—ãƒ‡ãƒ¼ã‚¿1</li><li><strong>DATA2</strong>: å–å¾—ãƒ‡ãƒ¼ã‚¿2</li><li><strong>DATA3</strong>: å–å¾—ãƒ‡ãƒ¼ã‚¿3</li><li>LRC CHECK: 2æ–‡å­—</li><li>æ”¹è¡Œ</li></ul><h1 id="å®Ÿæ©Ÿã‚’è§¦ã£ã¦ã¿ã‚‹"><a href="#å®Ÿæ©Ÿã‚’è§¦ã£ã¦ã¿ã‚‹" class="headerlink" title="å®Ÿæ©Ÿã‚’è§¦ã£ã¦ã¿ã‚‹"></a>å®Ÿæ©Ÿã‚’è§¦ã£ã¦ã¿ã‚‹</h1><p>Amazonã§æ¢ã—ãŸä¸­ã§ä¸€ç•ªå®‰ãè²·ãˆãŸModbus-RTUã‚»ãƒ³ã‚µãƒ¼ <code>KKmoonRS485æ¸©åº¦æ¹¿åº¦ ãƒˆãƒ©ãƒ³ã‚¹ãƒŸãƒƒã‚¿</code> ã§ã™ã€‚å•†å“åãŒModbus-TRUã£ã¦ãªã£ã¦ã„ã¾ã™ãŒtypoãªã®ã§å®‰å¿ƒãã ã•ã„ã€‚å…ˆã»ã©ã¾ã§ã¯Modbus-Asciiã§èª¬æ˜ã—ã¦ã„ã¾ã—ãŸãŒã€ã“ã“ã‹ã‚‰ã¯Modbus-RTUã§ãƒã‚¤ãƒŠãƒªè¡¨ç¾ã«ãªã‚Šã¾ã™ã€‚</p><p><a href="https://www.amazon.co.jp/dp/B07KS3WJRM" target="_blank" rel="noopener">https://www.amazon.co.jp/dp/B07KS3WJRM</a></p><p>ã“ã®çœŸã‚“ä¸­ã§å…‰ã£ã¦ã„ã‚‹ã®ãŒã‚»ãƒ³ã‚µãƒ¼ã§ã™ã€‚</p><p><img src="/images/20200803/IMG_20200803_011731.jpg" alt=""></p><p>ä»Šå›ã¯ã‚·ãƒªã‚¢ãƒ«æ¥ç¶šã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ãŸã‹ã£ãŸã®ã§ã€RS485ã‹ã‚‰USBã«å¤‰æ›ã™ã‚‹<a href="https://www.amazon.co.jp/dp/B00GWEGZOI/" target="_blank" rel="noopener">ã“ã®ã‚ãŸã‚Šã®å¤‰æ›ã‚¢ãƒ€ãƒ—ã‚¿</a>ã‚’è¿½åŠ ã§è³¼å…¥ã—ã¦ã€Winæ©Ÿã‹ã‚‰USBã§ã“ã®ã‚»ãƒ³ã‚µãƒ¼ã«æ¥ç¶šã—ã¦ã„ã¾ã™ã€‚</p><p>ã‚ã¨ã€é›»æºã§ã™ãŒç¯„å›²ãŒDC8Vã€œ48Vã¨ã„ã†ã“ã¨ã§ã€USBã‹ã‚‰ã ã¨çµ¦é›»ã§ããªã„ã®ã§<a href="http://akizukidenshi.com/catalog/g/gM-06642/" target="_blank" rel="noopener">ACã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼</a>ã¨<a href="http://akizukidenshi.com/catalog/g/gK-05148/" target="_blank" rel="noopener">DCã‚¸ãƒ£ãƒƒã‚¯ã®DIPåŒ–ã‚­ãƒƒãƒˆ</a> ã‚’è²·ã£ã¦ã€ã‚­ãƒƒãƒˆã®æ–¹ã‚’ãƒãƒ³ãƒ€ä»˜ã‘ã—ã¦ã€ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã§é€šé›»ã•ã›ã¦ã„ã¾ã™ã€‚ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ä»¥å¤–ã¯ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¼ç·šã¨ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒã‚ã‚Œã°å¾Œã¯ã©ã†ã«ã‹ãªã‚‹ã¨ã‚‚ã„ã¾ã™ã€‚ï¼ˆæŠµæŠ—ã¨ã‹ä¸è¦ï¼‰ã€‚ã“ã®è¾ºã®æ©Ÿæèª¿é”ã¯å¼Šç¤¾ã®é›»å­å·¥ä½œéƒ¨ã®æ–¹ã«è‰²ã€…æ•™ãˆã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚</p><p>KKmoonRS485ã‚»ãƒ³ã‚µãƒ¼ã®æ¥ç¶šæƒ…å ±ã§ã™ãŒä»•æ§˜æ›¸ãªã©ãŒå…¥ã£ã¦ã„ãªãã€<a href="https://www.amazon.co.jp/gp/customer-reviews/R36LHIYIFV23QG" target="_blank" rel="noopener">ã“ã¡ã‚‰ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼</a>ãŒæ­£ç›´ä¸€ç•ªå‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚</p><p>ã¾ãšã¯æ—¢å­˜ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã‚»ãƒ³ã‚µãƒ¼å€¤ã‚’å–å¾—ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p><p>è‰²ã€…ãªç¨®é¡ãŒã‚ã‚‹ã‚ˆã†ã§ã™ãŒã€ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ãŒä¸€ç•ªä½¿ã„å‹æ‰‹ãŒè‰¯ã‹ã£ãŸã§ã™ã€‚<br><a href="https://www.fa.hdl.co.jp/jp/html/app/Modbus_Tool/index.html" target="_blank" rel="noopener">https://www.fa.hdl.co.jp/jp/html/app/Modbus_Tool/index.html</a></p><p>ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆé€šã‚Šã«è¨­å®šã—ã¦ã„ãã¾ã™ã€‚</p><ul><li>ä¼é€ãƒ¢ãƒ¼ãƒ‰: RTU</li><li>é€šä¿¡é€Ÿåº¦ 9600bps</li><li>é€ä¿¡ã‚¯ã‚¨ãƒª: <code>01 03 00 00 00 02</code> ã«ãªã‚Šã¾ã™<ul><li>Mobusãƒ¯ãƒ¼ã‚«ID=1ï¼ˆã‚±ãƒ¼ã‚¹å†…ã®ã‚¹ã‚¤ãƒƒãƒã§åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ã‚‰ã—ã„ï¼‰</li><li><code>Read Holding Registers(0x03)</code></li><li>é–‹å§‹ã‚¢ãƒ‰ãƒ¬ã‚¹: 0x0000</li><li>ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: 0x0002</li></ul></li></ul><p>ã€Œæ¥ç¶šè¨­å®šã€ã§LANã‹USBã‚’é¸æŠã§ãã‚‹ã®ã§ã€ãƒãƒ¼ãƒˆé¸æŠã§USBã®COMãƒãƒ¼ãƒˆå‰²å½“ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚é€šé›»ã§ãã¦ã„ã‚Œã°ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã§é¸æŠè‚¢ã«ã‚»ãƒ³ã‚µãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå‡ºã¦ãã‚‹ã¨ãŠè¦‹ã¾ã™ã€‚ï¼ˆç§ã®ç’°å¢ƒã§ã¯COM3ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¾ã—ãŸï¼‰</p><p>ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®Txï¼ˆè¦æ±‚ï¼‰ã‚’é€ä¿¡ã—ã¦ã€çµæœãŒæˆåŠŸã™ã‚‹ã¨Rxï¼ˆå¿œç­”ï¼‰ã®ç·‘ã®è¡ŒãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p><p><img src="/images/20200803/ModbusToolForDebus.png" alt=""></p><p>Modbusã¯ãƒ¯ãƒ¼ã‚«ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãŒã„ãã¤ã‹ã‚ã‚Šã¾ã™ãŒã€ã‚„ã¯ã‚Šå®Ÿæ©Ÿã‹ã‚‰å€¤ãŒå–å¾—ã§ãã‚‹ã¨æ°—æŒã¡è‰¯ã„ã§ã™ã€‚ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’æœ€åˆã«åˆ©ç”¨ã—ã¦ã‚‚è¨³ãŒåˆ†ã‹ã‚‰ãªã„ã¨æ€ã„ã¾ã™ã®ã§ã€ã“ã®ã‚»ãƒ³ã‚µãƒ¼ã®è³¼å…¥ã¯æœ¬å½“ã«ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚</p><h1 id="å¿œç­”ã«ã¤ã„ã¦"><a href="#å¿œç­”ã«ã¤ã„ã¦" class="headerlink" title="å¿œç­”ã«ã¤ã„ã¦"></a>å¿œç­”ã«ã¤ã„ã¦</h1><p><code>01 03 04 00 FA 03 28 DA EC</code> ãŒå¿œç­”ã§ã—ãŸã€‚</p><p>ãã‚Œãã‚Œã®æ„å‘³ã§ã™ã€‚</p><ul><li><code>01</code>: Modbusãƒ¯ãƒ¼ã‚«IDï¼ˆé€ä¿¡ã—ãŸã®ã¨åŒã˜ï¼‰</li><li><code>03</code>: ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ï¼ˆé€ã£ãŸã®ã¨åŒã˜ï¼‰</li><li><code>04</code>: ãƒ‡ãƒ¼ã‚¿éƒ¨ã®Byteæ•°</li><li><code>00FA</code>: æ¹¿åº¦ã®ãƒ‡ãƒ¼ã‚¿</li><li><code>0328</code>: æ¸©åº¦ã®ãƒ‡ãƒ¼ã‚¿</li><li><code>DAFC</code>: LRCãƒã‚§ãƒƒã‚¯ã®å€¤</li></ul><p><code>00FA</code>ã‚‚<code>0328</code>ã‚‚ã€ã©ã“ã®å›½ã®æ¸©æ¹¿åº¦ã§ã™ã‹ï¼Ÿã£ã¦è¨€ã„ãŸããªã‚Šã¾ã™ãŒã€ç¬¦å·ä»˜ãæ•´æ•°ï¼ˆ16é€²æ•°ï¼‰ã§ã‹ã¤10å€ã—ãŸå€¤ï¼ˆæ¸©åº¦ã‚‚æ¹¿åº¦ã‚‚å°æ•°ç‚¹ä»¥ä¸‹ã¾ã§å–ã‚Œã‚‹ã‚ˆã†ã«ã¨ã„ã†ã“ã¨ã ã¨æ€ã‚ã‚Œã¾ã™ï¼‰ã¨ã„ã†ã“ã¨ã§ã™ã€‚ãŠæ‰‹è»½ã«å€¤ã‚’è¦‹ã‚‹ã«ã¯ã€<a href="https://note.cman.jp/convert/bit/" target="_blank" rel="noopener">ã“ã®ã‚ãŸã‚Š</a>ã®Webãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã—ã¦å¤‰æ›ã™ã‚‹ã¨ã€00FAã¯10é€²æ•°ã§<code>250</code>ã€0328ã¯<code>808</code>ã§ã—ãŸã€‚å‰è€…ã¯æ¹¿åº¦25%ã§ã„ã„ã¨ã—ã¦ã€å¾Œè€…ã¯80.8â„ƒï¼Ÿã“ã®éƒ¨å±‹ã€ã‚µã‚¦ãƒŠã‹ãªï¼Ÿã£ã¦æ€ã„ã¾ã—ãŸãŒã€ã©ã†ã‚‚è¯æ°è¡¨è¨˜ï¼ˆÂ°Fï¼‰ã®ã‚ˆã†ã§ã™ã€‚</p><p><code>è¯æ° æ‘‚æ°</code> ã§ã‚°ã‚°ã‚‹ã¨ã€Googleã§å¤‰æ›ã§ãã‚‹ã‚“ã§ã™ã­ã€‚å®¤æ¸©ãŒ27â„ƒã ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ï¼ˆã‚¨ã‚¢ã‚³ãƒ³ã®è¨­å®šã¯25â„ƒãªã®ã«è§£ã›ã¬ã¨ã„ã†çŸ¥è¦‹ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚ï¼‰</p><p><img src="/images/20200803/image.png" alt=""></p><h1 id="Goã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹"><a href="#Goã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹" class="headerlink" title="Goã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹"></a>Goã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹</h1><p>Modbusã§æ¸©æ¹¿åº¦ã‚»ãƒ³ã‚µãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦å€¤ã‚’å–å¾—ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã—ãŸã€‚ã“ã‚Œã‚’Goè¨€èªã§è¡Œã£ã¦ã¿ã¾ã™ã€‚Modbusã¯æµçŸ³ã«åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹ã ã‘ã‚ã£ã¦ã€Goã§ã‚‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå®Ÿè£…ãŒã‚ã‚Šã¾ã™ã€‚</p><ul><li><a href="https://github.com/goburrow/modbus" target="_blank" rel="noopener">goburrow/modbus</a></li></ul><p>Modbusã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡ºã—ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã‚‹ã¨ã“ã‚ã¾ã§ã€ã»ã¼ã‚µãƒ³ãƒ—ãƒ«é€šã‚Šã§å®Ÿè¡Œã§ãã‚‹ãŸã‚ç‰¹ã«é›£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚</p><p>ã‚³ãƒ¼ãƒ‰ã®å…¨æ–‡ã¯<a href="https://github.com/laqiiz/modbus-learning" target="_blank" rel="noopener">ã“ã¡ã‚‰</a>ã«ã‚ã’ã¦ãŠãã¾ã—ãŸã€‚</p><figure class="highlight go"><figcaption><span>Goã§KKmoonRS485æ¸©åº¦æ¹¿åº¦ã‚»ãƒ³ã‚µã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/binary"</span></span><br><span class="line"><span class="string">"encoding/hex"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/goburrow/modbus"</span></span><br><span class="line"><span class="string">"log"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">h := modbus.NewRTUClientHandler(<span class="string">"COM3"</span>) <span class="comment">// RTU, COM3ãƒãƒ¼ãƒˆ</span></span><br><span class="line">h.BaudRate = <span class="number">9600</span>                       <span class="comment">// Bit/ç§’</span></span><br><span class="line">h.DataBits = <span class="number">8</span>                          <span class="comment">// ãƒ‡ãƒ¼ã‚¿ãƒ“ãƒƒãƒˆ</span></span><br><span class="line">h.Parity = <span class="string">"N"</span>                          <span class="comment">// ãƒ‘ãƒªãƒ†ã‚£</span></span><br><span class="line">h.StopBits = <span class="number">1</span>                          <span class="comment">// ãƒˆãƒƒãƒ—ãƒ“ãƒƒãƒˆ</span></span><br><span class="line">h.SlaveId = <span class="number">1</span>                           <span class="comment">// ã‚¹ãƒ¬ãƒ¼ãƒ–ID</span></span><br><span class="line">h.Timeout = <span class="number">5</span> * time.Second</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err := h.Connect(); err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="comment">// ãƒãƒ¼ãƒˆã®æŒ‡å®šé–“é•ã„ã‚„ã€ä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒãƒãƒ¼ãƒˆã‚’é–‹ã„ã¦ã„ã‚‹å ´åˆ</span></span><br><span class="line">log.Fatal(<span class="string">"connect: "</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> h.Close()</span><br><span class="line"></span><br><span class="line">mc := modbus.NewClient(h)</span><br><span class="line">results, err := mc.ReadHoldingRegisters(<span class="number">0</span>, <span class="number">2</span>) <span class="comment">// ã‚¢ãƒ‰ãƒ¬ã‚¹0x00ã€ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º2</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(<span class="string">"mc.ReadHoldingRegisters"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">humidity := results[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">temperature := results[<span class="number">2</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">fmt.Println(hex.EncodeToString(humidity), hex.EncodeToString(temperature))</span><br><span class="line"></span><br><span class="line">humidityNum := <span class="keyword">float32</span>(<span class="keyword">int16</span>(binary.BigEndian.Uint16(humidity))) * <span class="number">1</span> / <span class="number">10</span></span><br><span class="line">temperatureFNum := <span class="keyword">float32</span>(<span class="keyword">int16</span>(binary.BigEndian.Uint16(temperature))) * <span class="number">1</span> / <span class="number">10</span></span><br><span class="line">temperatureCNum := (temperatureFNum - <span class="number">32</span>) * <span class="number">5</span> / <span class="number">9</span></span><br><span class="line"></span><br><span class="line">fmt.Println(humidityNum, temperatureCNum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã•ãã»ã©ã®ModbusToolã§è¡Œã£ãŸã®ã¨åŒã˜è¦é ˜ã§è¨­å®šã—ã¦ã„ãã¾ã™ã€‚é–¢æ•°ãŒ<code>ReadHoldingRegisters</code>ãªã©ãã®ã¾ã¾ã®åå‰ã§æº–å‚™ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€Modbusã§ä½•ã‚’è¡Œã„ãŸã„ã‹ãŒã‚ã‹ã‚Œã°ã€åˆ©ç”¨ã™ã‚‹ã“ã¨ã¯é›£ã—ããªã„ã¨æ€ã„ã¾ã™ã€‚</p><p>1ç‚¹å®Ÿè¡Œå‰ã®æ³¨æ„ã¨ã—ã¦ã€å…ˆã»ã©ã®ModbusToolã§ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’OPENã«ã—ãŸã¾ã¾ã«ã—ã¦ãŠãã¨ã€ä¸Šè¨˜ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œæ™‚ã« <code>connect: Access is denied.</code> ãŒç™ºç”Ÿã—ã¦ã—ã¾ã„ã¾ã™ã€‚Modbus RTUã§ã¯åŒæ™‚æ¥ç¶šã¯ã§ãã¾ã›ã‚“ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚</p><p>ã¾ãŸã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã‹ã‚‰ã¯å¤šå°‘å„ä»‹ã§ã™ã€‚ <code>binary.BigEndian.Uint16(humidity)</code> ã¨ã‚ã‚‹ã‚ˆã†ã«ã€2byte(16bit)ã‚’BigEndianå½¢å¼ï¼ˆæ•°å€¤ã®ä¸Šä½æ¡ãŒãƒ¡ãƒ¢ãƒªãƒ¼ã®ä¸‹ä½ã«ã‚ã‚‹ï¼‰ã§Unit16ã§èª­ã¿å–ã£ã¦ã€float32ã«å¤‰æ›ã—ã¦ã„ã¾ã™ã€‚</p><p>ã“ã“ã‹ã‚‰ã¯ã‚»ãƒ³ã‚µãƒ¼ã®ä»•æ§˜ã§ã€å€¤ã‚’1/10ã«ã—ã€æ¸©åº¦ã®ã¿è¯æ°â†’æ‘‚æ°å¤‰æ›ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚</p><p>å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ï¼ˆæš‘ã‹ã£ãŸã®ã§ã‚¨ã‚¢ã‚³ãƒ³ã®æ¸©åº¦ã‚’ä¸‹ã’ãŸã‚‰æ€¥ã«å†·ãˆã¾ã—ãŸï¼‰</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;go run main.go</span><br><span class="line">æ¹¿åº¦ æ¸©åº¦</span><br><span class="line">00fb 02e2</span><br><span class="line">25.1 23.222223</span><br></pre></td></tr></table></figure><p>å¾Œã¯ã“ã®æƒ…å ±ã‚’å®šæœŸé–“éš”ã§å®Ÿè¡Œã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ã«ä¸Šã’ã¦ãŠã‘ã°å¯è¦–åŒ–ã‚‚è‡ªç”±è‡ªåœ¨ã ã¨æ€ã„ã¾ã™ã€‚</p><h1 id="ã‚¨ãƒ©ãƒ¼æ™‚ã®æŒ™å‹•"><a href="#ã‚¨ãƒ©ãƒ¼æ™‚ã®æŒ™å‹•" class="headerlink" title="ã‚¨ãƒ©ãƒ¼æ™‚ã®æŒ™å‹•"></a>ã‚¨ãƒ©ãƒ¼æ™‚ã®æŒ™å‹•</h1><p>ã„ãã¤ã‹è¨­å®šã‚’é–“é•ã£ã¦ã¿ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦è¦‹ã¦çµæœã‚’ç¢ºèªã—ã¾ã™ã€‚</p><ul><li>SlaveIDã‚’ç•°ãªã‚‹å€¤ï¼ˆä¾‹ãˆã°2ã«ã—ãŸå ´åˆï¼‰<ul><li>çµæœ: * <code>mc.ReadHoldingRegistersserial: timeout</code></li></ul></li><li>ReadHoldingRegistersserialã®ä»£ã‚ã‚Šã«ReadCoilsã‚’åˆ©ç”¨<ul><li>çµæœ: * <code>mc.ReadHoldingRegistersserial: timeout</code></li></ul></li><li>ReadHoldingRegistersã®Addressã‚’ä»•æ§˜ä¸Šã«ãªã„å€¤ï¼ˆä¾‹ãˆã°1ï¼‰ã«å¤‰æ›´<ul><li>çµæœ: * <code>mc.ReadHoldingRegistersserial: timeout</code></li></ul></li><li>ReadHoldingRegistersã®ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã‚’ä»•æ§˜ä¸Šã«ãªã„å€¤ï¼ˆä¾‹ãˆã°5ï¼‰ã«å¤‰æ›´<ul><li>çµæœ: * <code>mc.ReadHoldingRegistersserial: timeout</code></li></ul></li></ul><p>å…¨ã¦çµæœã¯ <code>timeout</code> ã§ã—ãŸã€‚ã“ã‚Œã§ã‚ã‹ã‚‹ã®ã¯ã€Modbus RTUã®ä»•æ§˜ã«ã¯ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã„ã†ã“ã¨ã¯å­˜åœ¨ã—ãªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚<br>ãã®ãŸã‚ã€æ©Ÿå™¨ãŒæ­£å¸¸ã‹ç•°å¸¸ã‹ã¨ã„ã£ãŸåˆ¤å®šã¯ã€å®šæœŸçš„ã«å€¤ã‚’ç¢ºèªã—æƒ³å®šé€šã‚Šå†…ã®å¿œç­”ãŒè¿”ã£ã¦ãã‚‹ã‹ã©ã†ã‹ã¨ã„ã£ãŸã“ã¨ã§ã®ãƒã‚§ãƒƒã‚¯ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚</p><h1 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h1><p>ã€ŒModbusã§ã‚·ãƒªã‚¢ãƒ«æ¥ç¶šã€ã‚’æœ€åˆè¦‹ãŸæ™‚ã¯é¦´æŸ“ã¿ãŒãªã„ã ã‘ã«ã€å‡„ãé›£ã—ã„ã“ã¨ã§ã¯ãªã„ã‹ï¼Ÿã¨æ€ã„ã¾ã—ãŸãŒã€Webç³»ã®æŠ€è¡“ã«æ¯”ã¹æƒ…å ±ãŒå°‘ãªã„ã®ã¯ã‚ã‚Šãã†ã§ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ã ã‘ã§ã ã¨ãã“ã¾ã§é›£ã—ãã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚</p><p>å®Ÿéš›ã®å·¥å ´ã§ã€ãƒ©ã‚¤ãƒ³åˆ¶å¾¡ã‚’ç›´æ¥Goãªã©ã‹ã‚‰è¡Œã†ã“ã¨ã¯ã»ã¼ãªã„ã¨æ€ã„ã¾ã™ã€‚ã—ã‹ã—ã‚»ãƒ³ã‚µãƒ¼é¡ã‹ã‚‰æƒ…å ±ã‚’ã‚‚ã‚‰ã„ã€ä½•ã‹ã—ã‚‰ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚„æ©Ÿæ¢°å­¦ç¿’ã®æ¨è«–çµæœã‚’ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆ¶å¾¡å´ã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã™ã‚‹ã“ã¨ã¯ä»Šå¾Œã®FA/IoTåŒ–ã®æµã‚Œã‹ã‚‰å¢—ãˆã¦ãã‚‹ã¨æ€ã„ã¾ã™ã€‚</p><p>ãã®å ´åˆã®é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒModbusã§ã‚ã‚Œã°ä¸Šè¨˜ã®çŸ¥è­˜ã¨ã€<code>goburrow/modbus</code>ã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ´»ç”¨ã™ã‚Œã°ã€ãƒ‡ãƒ¼ã‚¿é€£æºã‚’è¡Œã†ã“ã¨è‡ªä½“ã¯ãã“ã¾ã§å¤§ããªéšœå£ã§ã¯ãªã„ã¨æ€ã„ã¾ã™ã€‚</p><p>ã¾ãŸã€Modbusã‚’å­¦ã¶ä¸Šã§ç‰¹ã«ãƒ¯ãƒ¼ã‚«ãƒ¼ã®æ‰±ã„ã«é–¢ã—ã¦ã¯ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã ã‘ã§è¡Œã†ã®ã§ã¯ãªãå®Ÿæ©Ÿã‚’ç”¨ã„ã‚‹ã¨ã¨ã¦ã‚‚ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ¹§ãã¾ã™ã€‚ã‚‚ã—ã€ãªã‚‹ã¹ããŠå®‰ãæ¸ˆã¾ã›ãŸã„å ´åˆã¯ã€AliExpressã§ã®è³¼å…¥ã‚‚ãŠã™ã™ã‚ã§ã™ã€‚ãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ ãŒ30æ—¥ã»ã©ã‹ã‹ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ãŒã€æ ¼å®‰ã§æ‰‹ã«å…¥ã‚‹ã“ã¨é–“é•ã„ãªã„ã§ã™ã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="http://web.eecs.umich.edu/~modbus/documents/PI_MBUS_300.pdf" target="_blank" rel="noopener">Modicon Modbus ProtocolReference Guide PIâ€“MBUSâ€“300 Rev. J</a><ul><li>ãƒ—ãƒ­ãƒˆã‚³ãƒ«ä»•æ§˜æ›¸</li></ul></li><li><a href="https://www.m-system.co.jp/mssjapanese/kaisetsu/nmmodbus.pdf" target="_blank" rel="noopener">Modbus ãƒ—ãƒ­ãƒˆã‚³ãƒ«æ¦‚èª¬æ›¸ - M-System</a></li></ul><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;">Technology Innovation Groupã®ç•¥ã§ã€ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ã®ä¸­ã§ã‚‚ç‰¹ã«ITæŠ€è¡“ã«ç‰¹åŒ–ã—ãŸéƒ¨éšŠã§ã™ã€‚ãã®ä¸­ã§ã‚‚DXãƒãƒ¼ãƒ ã¯ç‰¹ã«ãƒ‡ã‚¸ã‚¿ãƒ«ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«é–¢ã‚ã‚‹ä»•äº‹ã‚’æ¨é€²ã—ã¦ã„ããƒãƒ¼ãƒ ã§ã™ã€‚</span><a href="#fnref:1" rev="footnote"> â†©</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼&lt;a href=&quot;https://future-architect.github.io/articles/20200726/&quot;&gt;å¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶&lt;/a&gt;é€£è¼‰ã®1å›ç›®ã§ã™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;a href=&quot;#ã¯ã˜ã‚ã«&quot; class=&quot;head
      
    
    </summary>
    
    
      <category term="IoT" scheme="https://future-architect.github.io/categories/IoT/"/>
    
    
      <category term="Go" scheme="https://future-architect.github.io/tags/Go/"/>
    
      <category term="PLC" scheme="https://future-architect.github.io/tags/PLC/"/>
    
      <category term="Futureé›»å­å·¥ä½œéƒ¨" scheme="https://future-architect.github.io/tags/Future%E9%9B%BB%E5%AD%90%E5%B7%A5%E4%BD%9C%E9%83%A8/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
      <category term="Modbus" scheme="https://future-architect.github.io/tags/Modbus/"/>
    
      <category term="é›»å­å·¥ä½œ" scheme="https://future-architect.github.io/tags/%E9%9B%BB%E5%AD%90%E5%B7%A5%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>Kaggleã«ãƒ¯ã‚¯ãƒãƒ³é–‹ç™ºç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¬é–‹ã—ã¾ã—ãŸ &amp; ã‚³ãƒ¼ãƒ‰è§£èª¬</title>
    <link href="https://future-architect.github.io/articles/20200801/"/>
    <id>https://future-architect.github.io/articles/20200801/</id>
    <published>2020-07-31T15:00:00.000Z</published>
    <updated>2020-07-31T03:56:09.552Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>ã“ã‚“ã«ã¡ã¯ã€‚SAIGæ‰€å±ã®è¾²è¦‹ã¨ç”³ã—ã¾ã™ã€‚<br>ã“ã®åº¦ã€ç ”ç©¶ã§ç”¨ã„ãŸ<a href="https://www.kaggle.com/futurecorporation/epitope-prediction" target="_blank" rel="noopener">Bç´°èƒã‚¨ãƒ”ãƒˆãƒ¼ãƒ—äºˆæ¸¬ç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</a>ã¨<a href="https://www.kaggle.com/futurecorporation/covid-19-sars-b-cells-basic-predictions-and-eda" target="_blank" rel="noopener">ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰</a>ã‚’å…¬é–‹ã—ãŸã®ã§ã€ãã®è§£èª¬ã‚’ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚(ã“ã‚Œã®<a href="https://prtimes.jp/main/html/rd/p/000000406.000004374.html" target="_blank" rel="noopener">ãƒ—ãƒ¬ã‚¹ãƒªãƒªãƒ¼ã‚¹</a>)</p><h1 id="ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦"><a href="#ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦" class="headerlink" title="ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦"></a>ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦</h1><p>ç°¡å˜ã«è¨€ã†ã¨ã€Bç´°èƒã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ãŒåˆ†ã‹ã‚Œã°ãƒ¯ã‚¯ãƒãƒ³ä½œæˆã®å¤§ããªåŠ©ã‘ã«ãªã‚‹ã€ã ã‹ã‚‰COVID-19ã®åŸå› ã‚¦ã‚¤ãƒ«ã‚¹ã§ã‚ã‚‹SARS-CoV-2ãŒæŒã¤ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®Bç´°èƒã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ã‚’äºˆæ¸¬ã—ã¦ã€ãƒ¯ã‚¯ãƒãƒ³é–‹ç™ºã®å½¹ã«ç«‹ã¦ã‚ˆã†ãœã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚</p><p>Bç´°èƒã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ã«ã¤ã„ã¦ã‚‚ã†å°‘ã—è©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹ã¯<a href="https://www.biorxiv.org/content/10.1101/2020.07.27.224121v1" target="_blank" rel="noopener">æˆ‘ã€…ã®è«–æ–‡</a>ã‚’èª­ã‚€ã‹å…ç–«å­¦ã®æœ¬ã‚’èª­ã‚“ã§ã¿ã‚‹ã¨ã„ã„ã¨æ€ã„ã¾ã™ã€‚</p><h1 id="ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦"><a href="#ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦" class="headerlink" title="ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦"></a>ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦</h1><p>ã§ã¯æœ¬é¡Œã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã®è§£èª¬ã‚’ã—ã¦ã„ãã¾ã™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INPUT_DIR = <span class="string">'../input/epitope-prediction'</span></span><br><span class="line">bcell = pd.read_csv(<span class="string">f'<span class="subst">&#123;INPUT_DIR&#125;</span>/input_bcell.csv'</span>)</span><br><span class="line">sars = pd.read_csv(<span class="string">f'<span class="subst">&#123;INPUT_DIR&#125;</span>/input_sars.csv'</span>)</span><br><span class="line">covid = pd.read_csv(<span class="string">f'<span class="subst">&#123;INPUT_DIR&#125;</span>/input_covid.csv'</span>)</span><br><span class="line">bcell_sars = pd.concat([bcell, sars], axis=<span class="number">0</span>, ignore_index=<span class="literal">True</span>)</span><br><span class="line">bcell_sars.head()</span><br></pre></td></tr></table></figure><img src="/images/20200801/Screenshot from 2020-07-31 05-55-30.png"><p>æœ€åˆã®éƒ¨åˆ†ã§ãƒ‡ãƒ¼ã‚¿ãŒã©ã‚“ãªã‚‚ã®ãªã®ã‹ã¨ã„ã†ã“ã¨ã‚’è¦‹ã¦ã„ã¾ã™ã€‚åŸºæœ¬ä¸­ã®åŸºæœ¬ã§ã™ã­ã€ãƒ‡ãƒ¼ã‚¿ãŒã©ã‚“ãªã‚‚ã®ãªã®ã‹ã¨ã„ã†ã“ã¨ãŒåˆ†ã‹ã‚‰ãªã„ã¨æ–¹é‡ã®ç«‹ã¦ã‚ˆã†ãŒãªã„ã§ã™ã€‚</p><p>å„ã‚«ãƒ©ãƒ ã¯</p><ul><li><code>parent_protein_id</code> : ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®<a href="https://www.uniprot.org/" target="_blank" rel="noopener">UniProt ID</a></li><li><code>protein_seq</code> : ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®é…åˆ—</li><li><code>start_position</code> : ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ã®é–‹å§‹ä½ç½®</li><li><code>end_position</code> : ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ã®çµ‚äº†ä½ç½®</li><li><code>peptide_seq</code> : ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—é…åˆ— </li><li><code>chou_fasman</code> : ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ç‰¹å¾´é‡, $\beta$ ã‚¿ãƒ¼ãƒ³</li><li><code>emini</code> : ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ç‰¹å¾´é‡, relative surface accessibility</li><li><code>kolaskar_tongaonkar</code> : ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ç‰¹å¾´é‡, æŠ—åŸæ€§</li><li><code>parker</code> : ã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ç‰¹å¾´é‡, ç–æ°´æ€§</li><li><code>isoelectric_point</code> : ã‚¿ãƒ³ãƒ‘ã‚¯è³ªç‰¹å¾´é‡,ç­‰é›»ç‚¹</li><li><code>aromacity</code>: ã‚¿ãƒ³ãƒ‘ã‚¯è³ªç‰¹å¾´é‡,èŠ³é¦™æ—ã‚¢ãƒŸãƒé…¸ã®å‰²åˆ</li><li><code>hydrophobicity</code> : ã‚¿ãƒ³ãƒ‘ã‚¯è³ªç‰¹å¾´é‡,ç–æ°´æ€§</li><li><code>stability</code> : ã‚¿ãƒ³ãƒ‘ã‚¯è³ªç‰¹å¾´é‡,å®‰å®šæ€§</li><li><code>target</code> : æŠ—ä½“ä¾¡</li></ul><p>ã¨ãªã£ã¦ã„ã¾ã™ã€‚äºˆæ¸¬ã—ãŸã„ã‚‚ã®ã¯target(æŠ—ä½“ä¾¡)ã§ã“ã‚Œã¯0ã¨1ã®binaryã®å€¤ã‚’å–ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.sum(bcell_sars.isnull())</span><br></pre></td></tr></table></figure><p>ã¾ãŸã€æ¬ æå€¤ãŒã‚ã‚‹ã‹ã©ã†ã‹ã®ãƒã‚§ãƒƒã‚¯ã‚‚ã—ã¾ã—ãŸã€‚å¹¸ã„ã“ã®ãƒ‡ãƒ¼ã‚¿ã«ã¯æ¬ æå€¤ã¯ãªã„ã®ã§ã€ãã®ã¾ã¾ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚ã¨ã„ã†ã“ã¨ã§æ—©é€ŸB-cellã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ©ç”¨ã—ã¦COVID-19ã«è¿‘ã„ã¨ã•ã‚Œã‚‹SARSã®Bcellã‚¨ãƒ”ãƒˆãƒ¼ãƒ—äºˆæ¸¬ã‚’è¡Œã„ã¾ã—ãŸã€‚</p><h3 id="Task1-SARSäºˆæ¸¬"><a href="#Task1-SARSäºˆæ¸¬" class="headerlink" title="Task1 : SARSäºˆæ¸¬"></a>Task1 : SARSäºˆæ¸¬</h3><p>Bcellãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ã¿ã‚’ä½¿ç”¨ã—ã¦SARSãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æŠ—ä½“ä¾¡ã‚’äºˆæ¸¬ã™ã‚‹ã‚¿ã‚¹ã‚¯ã€‚<br>SARS-CoVã¨SARS-CoV-2ã¯é…åˆ—ã«é¡ä¼¼æ€§ãŒã‚ã‚‹ãŸã‚Task1ã§ã¯SARSã®äºˆæ¸¬ã‚’è¡Œã£ã¦ã„ã‚‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># create length columns</span></span><br><span class="line"><span class="keyword">for</span> df <span class="keyword">in</span> [bcell, sars, covid, bcell_sars]:</span><br><span class="line">    df[<span class="string">"length"</span>] = df[<span class="string">"end_position"</span>] - df[<span class="string">"start_position"</span>] + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">kf = GroupKFold(n_splits = <span class="number">5</span>)</span><br><span class="line">oof = np.zeros(len(bcell))</span><br><span class="line">preds = np.zeros(len(sars))</span><br><span class="line">feature_importance = pd.DataFrame()</span><br><span class="line">feature_columns = [<span class="string">"chou_fasman"</span>,<span class="string">"emini"</span>,<span class="string">"kolaskar_tongaonkar"</span>,<span class="string">"parker"</span>,<span class="string">"length"</span>,<span class="string">"isoelectric_point"</span>,<span class="string">"aromaticity"</span>,<span class="string">"hydrophobicity"</span>,<span class="string">"stability"</span>]</span><br><span class="line">target = <span class="string">"target"</span></span><br><span class="line"><span class="keyword">for</span> i,(train_index,valid_index) <span class="keyword">in</span> enumerate(kf.split(bcell[feature_columns],bcell[<span class="string">"target"</span>],bcell[<span class="string">"parent_protein_id"</span>])):</span><br><span class="line">    train_x = bcell.loc[train_index][feature_columns].values</span><br><span class="line">    train_y = bcell.loc[train_index][target].values</span><br><span class="line">    valid_x = bcell.loc[valid_index][feature_columns].values</span><br><span class="line">    valid_y = bcell.loc[valid_index][target].values</span><br><span class="line">    train_data = lgb.Dataset(train_x, label = train_y)</span><br><span class="line">    valid_data = lgb.Dataset(valid_x, label = valid_y)</span><br><span class="line">    model = lgb.train(params, train_data, valid_sets = [valid_data], verbose_eval=<span class="number">20</span>,num_boost_round=<span class="number">500</span>,early_stopping_rounds=<span class="number">50</span>) </span><br><span class="line">    oof[valid_index] = model.predict(valid_x)</span><br><span class="line">    preds += model.predict(sars[feature_columns].values)/kf.n_splits</span><br><span class="line">    feature_importance[<span class="string">"feature"</span>] = feature_columns</span><br><span class="line">    feature_importance[<span class="string">"importance"</span>+str(i)] = model.feature_importance()</span><br><span class="line">roc_auc_score(bcell[<span class="string">"target"</span>],oof)</span><br></pre></td></tr></table></figure><p>lengthã¨ã„ã†ç‰¹å¾´é‡ã‚’ä½œæˆã—ã¦ã€æ™®é€šã«5-fold cross validationã—ã¦ã„ã‚‹ã ã‘ã§ã™ãŒã€æ³¨ç›®ã™ã¹ãéƒ¨åˆ†ã¯<strong>GroupKFold</strong>ã‚’ä½¿ã£ã¦ã„ã‚‹ç‚¹ã§ã™ã€‚ãŸã ã€GroupKFoldã‚’çŸ¥ã‚‰ãªã„äººã‚‚ã„ã‚‹ã¨æ€ã†ã®ã§å…ˆã«GroupKFoldã®èª¬æ˜ã‚’ã—ã¾ã™ã€‚</p><p><a href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_cv_indices.html#sphx-glr-auto-examples-model-selection-plot-cv-indices-py" target="_blank" rel="noopener">https://scikit-learn.org/stable/auto_examples/model_selection/plot_cv_indices.html#sphx-glr-auto-examples-model-selection-plot-cv-indices-py</a>ã‹ã‚‰å¼•ç”¨ã€‚</p><img src="/images/20200801/Screenshot from 2020-07-31 06-20-49.png"><p>ã“ã‚Œã‚’è¦‹ã¦ã¿ã‚‹ã¨GroupKFoldã¯KFoldã¨ç•°ãªã‚ŠGroupã‚’ã¾ãŸãã“ã¨ã®ãªã„åˆ†ã‘æ–¹ã‚’ã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚<br>ã§ã€ä»Šå›ä½•æ•…parent_protein_idã‚’groupã¨ã—ã¦GroupKFoldã‚’ã—ã¦ã„ã‚‹ã‹ã¨ã„ã†ã¨ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã”ã¨ã«åˆ†ã‘ãªã„ã¨ä¸å½“ã«ç²¾åº¦ãŒé«˜ããªã‚‹æã‚ŒãŒã‚ã‚‹ãŸã‚ã§ã™ã€‚ã“ã‚Œã¯å˜ç´”ãªç†ç”±ã§targetã«1ã—ã‹ãªã„ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã‚„0ã—ã‹ãªã„ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã¨ã„ã†ã‚‚ã®ãŒå­˜åœ¨ã—ã¾ã™ã€‚ã“ã‚Œã‚’trainã¨validationã«æ··åœ¨ã•ã›ã¦ã—ã¾ã†ã¨ã‚ˆã‚Šç²¾åº¦ãŒé«˜ããªã‚‹ã¨ã„ã†ã®ã¯æƒ³åƒã«é›£ããªã„ã¨æ€ã„ã¾ã™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select = [i != <span class="string">"feature"</span> <span class="keyword">for</span> i <span class="keyword">in</span> feature_importance.columns]</span><br><span class="line">select = feature_importance.columns[select]</span><br><span class="line">feature_importance[select] = feature_importance[select]/feature_importance[select].sum()</span><br><span class="line">feature_importance[<span class="string">"importance"</span>] = feature_importance.select_dtypes(include=[np.number]).mean(axis=<span class="number">1</span>)</span><br><span class="line">sns.barplot(x=<span class="string">"importance"</span>, y=<span class="string">"feature"</span>, data=feature_importance.sort_values(by=<span class="string">"importance"</span>, ascending=<span class="literal">False</span>));</span><br><span class="line">plt.title(<span class="string">'GBDT Features (avg over folds)'</span>);</span><br></pre></td></tr></table></figure><img src="/images/20200801/Screenshot from 2020-07-31 06-56-08.png"><p>LightGBMã§ã¯Feature importanceã¨ã„ã†æŒ‡æ¨™ã§ã€ã©ã®ç‰¹å¾´é‡ãŒã‚ˆã‚Šäºˆæ¸¬ã«å¯„ä¸ã—ãŸã®ã‹ã‚’è¦‹ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚<br>ä»Šå›ã®ä¾‹ã§è¦‹ã‚‹ã¨äºˆæ¸¬ã«ä¸€ç•ªé‡è¦ã ã£ãŸã®ã¯hydrophobicity(ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®ç–æ°´æ€§)ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p><p>ã¾ãŸSARSã¯æ­£è§£ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã®ã§äºˆæ¸¬ãŒã©ã‚Œã ã‘ã‚ãŸã£ã¦ã„ãŸã‹ã‚‚è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, classification_report</span><br><span class="line">print(<span class="string">"Accuracy:"</span>, accuracy_score(sars[<span class="string">"target"</span>].values, np.int32(preds &gt;= <span class="number">0.5</span>)))</span><br><span class="line">print(classification_report(sars[<span class="string">"target"</span>].values, np.int32(preds &gt;= <span class="number">0.5</span>)))</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Accuracy: 0.7403846153846154</span><br><span class="line">              precision    recall  f1-score   support</span><br><span class="line"></span><br><span class="line">           0       0.74      0.99      0.85       380</span><br><span class="line">           1       0.78      0.05      0.09       140</span><br><span class="line"></span><br><span class="line">    accuracy                           0.74       520</span><br><span class="line">   macro avg       0.76      0.52      0.47       520</span><br><span class="line">weighted avg       0.75      0.74      0.65       520</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã‚’è¦‹ã‚‹ã¨1ã«å¯¾ã™ã‚‹recallãŒã¨ã¦ã‚‚ä½ãæ”¹å–„ã®ä½™åœ°ãŒã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p><h3 id="Task2-SARS-CoV-2-COVID-19-äºˆæ¸¬"><a href="#Task2-SARS-CoV-2-COVID-19-äºˆæ¸¬" class="headerlink" title="Task2 : SARS-CoV-2 (COVID-19) äºˆæ¸¬"></a>Task2 : SARS-CoV-2 (COVID-19) äºˆæ¸¬</h3><p>Bcellã¨SARSã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åˆ©ç”¨ã—ã¦ã€SARS-CoV-2ã®æŠ—ä½“ä¾¡ã‚’äºˆæ¸¬ã™ã‚‹ã‚¿ã‚¹ã‚¯ã€‚<br>SARS-CoV-2ã«ã¯æŠ—ä½“ä¾¡ãƒ‡ãƒ¼ã‚¿ãŒãªã„ã¨ã“ã‚ãŒé›£ã—ã„ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">kf = GroupKFold(n_splits = <span class="number">5</span>)</span><br><span class="line">oof = np.zeros(len(bcell_sars))</span><br><span class="line">preds = np.zeros(len(covid))</span><br><span class="line">feature_importance = pd.DataFrame()</span><br><span class="line">feature_columns = [<span class="string">"chou_fasman"</span>,<span class="string">"emini"</span>,<span class="string">"kolaskar_tongaonkar"</span>,<span class="string">"parker"</span>,<span class="string">"length"</span>,<span class="string">"isoelectric_point"</span>,<span class="string">"aromaticity"</span>,<span class="string">"hydrophobicity"</span>,<span class="string">"stability"</span>]</span><br><span class="line">target = <span class="string">"target"</span></span><br><span class="line"><span class="keyword">for</span> i,(train_index,valid_index) <span class="keyword">in</span> enumerate(kf.split(bcell_sars[feature_columns],bcell_sars[<span class="string">"target"</span>],bcell_sars[<span class="string">"parent_protein_id"</span>])):</span><br><span class="line">    train_x = bcell_sars.loc[train_index][feature_columns].values</span><br><span class="line">    train_y = bcell_sars.loc[train_index][target].values</span><br><span class="line">    valid_x = bcell_sars.loc[valid_index][feature_columns].values</span><br><span class="line">    valid_y = bcell_sars.loc[valid_index][target].values</span><br><span class="line">    train_data = lgb.Dataset(train_x, label = train_y)</span><br><span class="line">    valid_data = lgb.Dataset(valid_x, label = valid_y)</span><br><span class="line">    model = lgb.train(params, train_data, valid_sets = [valid_data], verbose_eval=<span class="number">20</span>,num_boost_round=<span class="number">500</span>,early_stopping_rounds=<span class="number">50</span>) </span><br><span class="line">    oof[valid_index] = model.predict(valid_x)</span><br><span class="line">    preds += model.predict(covid[feature_columns].values)/kf.n_splits</span><br><span class="line">    feature_importance[<span class="string">"feature"</span>] = feature_columns</span><br><span class="line">    feature_importance[<span class="string">"importance"</span>+str(i)] = model.feature_importance()</span><br><span class="line">roc_auc_score(bcell_sars[<span class="string">"target"</span>],oof)</span><br><span class="line"></span><br><span class="line">covid[<span class="string">"target"</span>] = preds</span><br><span class="line">covid.to_csv(<span class="string">"sub.csv"</span>,index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>SARS-CoV-2ã¸ã®äºˆæ¸¬ã‚‚åŒæ§˜ã«ã—ã¦äºˆæ¸¬çµæœã‚’å‡ºåŠ›ã—ã¾ã™ãŒã€æ­£è§£ãƒ‡ãƒ¼ã‚¿ãŒãªã„ã®ã§è‰¯ã—æ‚ªã—ã®åˆ¤æ–­ã¯é›£ã—ã„ã§ã™ã€‚ã“ã®éƒ¨åˆ†ã¯ä»Šå¾Œã®ç”Ÿä½“å†…ã§ã®å®Ÿé¨“ã§å¾—ã‚‰ã‚Œã‚‹Bç´°èƒã‚¨ãƒ”ãƒˆãƒ¼ãƒ—ã®æƒ…å ±ã‚’è¸ã¾ãˆãŸä¸Šã§åˆ¤æ–­ã™ã‚‹ã“ã¨ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚</p><h1 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h1><p>ä»Šå›ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã€è«–æ–‡ã®å…¬é–‹ã«ã‚ˆã‚Šã€åŒ»å­¦ã®çŸ¥è¦‹ã‚’æŒãŸãªã„AIç ”ç©¶è€…ã§ã‚‚å®¹æ˜“ã«ãƒ¯ã‚¯ãƒãƒ³é–‹ç™ºç”¨ãƒ‡ãƒ¼ã‚¿ã§å®Ÿé¨“ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦å¾—ã‚‰ã‚ŒãŸçŸ¥è¦‹ã‚’Kaggle notebookç­‰ã§å…¬é–‹ã—ã¦ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;a href=&quot;#ã¯ã˜ã‚ã«&quot; class=&quot;headerlink&quot; title=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;/a&gt;ã¯ã˜ã‚ã«&lt;/h1&gt;&lt;p&gt;ã“ã‚“ã«ã¡ã¯ã€‚SAIGæ‰€å±ã®è¾²è¦‹ã¨ç”³ã—ã¾ã™ã€‚&lt;br&gt;ã“ã®åº¦ã€ç ”ç©¶ã§ç”¨ã„ãŸ&lt;a href=&quot;https://www.kaggle
      
    
    </summary>
    
    
      <category term="DataScience" scheme="https://future-architect.github.io/categories/DataScience/"/>
    
    
      <category term="Python" scheme="https://future-architect.github.io/tags/Python/"/>
    
      <category term="Kaggle" scheme="https://future-architect.github.io/tags/Kaggle/"/>
    
  </entry>
  
  <entry>
    <title>ã‚³ãƒ¼ãƒ‰é¸è€ƒã®å•é¡Œé¸å®šã‚’ç¾å ´ç¤¾å“¡ãŒã‚„ã‚‹ã‚ã‘</title>
    <link href="https://future-architect.github.io/articles/20200731/"/>
    <id>https://future-architect.github.io/articles/20200731/</id>
    <published>2020-07-30T15:00:00.000Z</published>
    <updated>2020-08-11T07:15:39.544Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/20200731/laptop-2298286_1280.png"><p><a href="https://pixabay.com/ja/users/Sara_Torda-888816/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2298286" target="_blank" rel="noopener">Sara Torda</a>ã«ã‚ˆã‚‹<a href="https://pixabay.com/ja/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2298286" target="_blank" rel="noopener">Pixabay</a>ã‹ã‚‰ã®ç”»åƒ</p><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>SAIG(Strategic AI Group)ã®å¡šæœ¬ã§ã™ã€‚AIã¨è¨€ãˆã° Deep Learning ç­‰ã®æ©Ÿæ¢°å­¦ç¿’åˆ†é‡ãŒä¸­å¿ƒã§ã™ãŒã€ãã‚Œã‚‰ãŒé©ã•ãªã„ã¨åˆ¤æ–­ã•ã‚ŒãŸå•é¡Œå…¨èˆ¬(æ•°ç†æœ€é©ã‚„è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†)ã‚’æ‹…å½“ã—ã¦ã„ã¾ã™ã€‚</p><p>ã¾ãŸã€ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä¸­å¿ƒã¨ã—ãŸå…¨ç¤¾çš„ãªæ´»å‹•ã«é–¢ã‚ã£ã¦ãŠã‚Šã€ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ãŒ2018å¹´ã‚ˆã‚Šå®Ÿæ–½ã—ã¦ã„ã‚‹ã€æ–°å’æ¡ç”¨ã®<strong>ã‚³ãƒ¼ãƒ‰é¸è€ƒ</strong>ã«ã¤ã„ã¦ã”ç´¹ä»‹ã—ã¾ã™ã€‚</p><h1 id="ã‚³ãƒ¼ãƒ‰é¸è€ƒã‚’ã¯ã˜ã‚ãŸçµŒç·¯"><a href="#ã‚³ãƒ¼ãƒ‰é¸è€ƒã‚’ã¯ã˜ã‚ãŸçµŒç·¯" class="headerlink" title="ã‚³ãƒ¼ãƒ‰é¸è€ƒã‚’ã¯ã˜ã‚ãŸçµŒç·¯"></a>ã‚³ãƒ¼ãƒ‰é¸è€ƒã‚’ã¯ã˜ã‚ãŸçµŒç·¯</h1><p>å…¨ç¤¾å“¡ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚­ãƒ«ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ã«ã¨ã£ã¦ã€æ¡ç”¨æ™‚ã«ãŠã‘ã‚‹ãã®èƒ½åŠ›ã®å®šé‡è©•ä¾¡ã¯é•·å¹´ã®èª²é¡Œã§ã‚ã‚Šã€æ˜¨ä»Šã®æ¡ç”¨ã‚µãƒ¼ãƒ“ã‚¹ã®å……å®Ÿã‚’æ©Ÿã«å–ã‚Šçµ„ã¿ã‚’ã¯ã˜ã‚ã¾ã—ãŸã€‚</p><p>ã‚ˆã‚Šè©³ç´°ãªçµŒç·¯ã¯ä¸‹è¨˜è¨˜äº‹ã‚’ã”å‚ç…§ãã ã•ã„ã€‚</p><p><a href="https://tracks.run/interview/future-architect/" target="_blank" rel="noopener">é«˜ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚­ãƒ«ã‚’æŒã¤äººæã‚’å¼•ãã¤ã‘ã‚‹ã€Œã‚³ãƒ¼ãƒ‰é¸è€ƒã€ å…¨ç¤¾å“¡ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ç†ŸçŸ¥ã—ãŸãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ä¼æ¥­ã®æ¡ç”¨ãƒ•ãƒ­ãƒ¼ã‚’å…¬é–‹ï¼</a></p><p>ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ãŒæ±ºã¾ã£ãŸã‚‚ã®ã®ã€æ¡ç”¨ãƒ•ãƒ­ãƒ¼ã®æ„å›³ã«æ²¿ã£ãŸãƒ‡ã‚¶ã‚¤ãƒ³ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã€æ¡ç”¨ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ã ã‘ã§ã¯å¯¾å¿œãŒé›£ã—ã„éƒ¨åˆ†ãŒã‚ã‚Šã¾ã—ãŸã€‚ãã“ã§ã€ç¤¾å†…ã®éƒ¨æ´»å‹•ã¨ã—ã¦ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°éƒ¨ã‚’ç«‹ã¡ä¸Šã’ãƒ»é‹å–¶ã—ã¦ã„ãŸç§ã«ç›¸è«‡ãŒæ¥ã¾ã—ãŸã€‚</p><h1 id="ã‚³ãƒ¼ãƒ‰é¸è€ƒã®ä½ç½®ä»˜ã‘ã¨ãƒ‡ã‚¶ã‚¤ãƒ³"><a href="#ã‚³ãƒ¼ãƒ‰é¸è€ƒã®ä½ç½®ä»˜ã‘ã¨ãƒ‡ã‚¶ã‚¤ãƒ³" class="headerlink" title="ã‚³ãƒ¼ãƒ‰é¸è€ƒã®ä½ç½®ä»˜ã‘ã¨ãƒ‡ã‚¶ã‚¤ãƒ³"></a>ã‚³ãƒ¼ãƒ‰é¸è€ƒã®ä½ç½®ä»˜ã‘ã¨ãƒ‡ã‚¶ã‚¤ãƒ³</h1><p>ã¾ãšã€ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ç¤¾å“¡ã®å¤šãã¯ITã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆã¨ã„ã†1è·ç¨®ã«å±ã—ã¦ãŠã‚Šã€æœŸå¾…ã•ã‚Œã‚‹å½¹å‰²ã¯ã“ã‚Œã¾ã§ã®å®Ÿç¸¾ã‚„æœ¬äººå¸Œæœ›ã«å¿œã˜ã¦æµå‹•çš„ã«å®šã‚ã‚‰ã‚Œã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰é¸è€ƒã§ã‚‚ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ç‰¹åŒ–ã—ãŸäººæã®ã¿ã‚’é¸å‡ºã™ã‚‹ã®ã§ã¯ãªãã€ITã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆã¨ã—ã¦åŸºç¤çš„ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ç´ é¤Šã‚’æŒã£ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¾ã—ãŸã€‚<br>ä¸€æ–¹ã€é«˜ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚­ãƒ«ã‚’æœ‰ã—ãŸäººæã‚’è©•ä¾¡ã™ã¹ãã€ã‚¹ã‚­ãƒ«ã«å¿œã˜ã¦ç‚¹æ•°ã®å·®ãŒé–‹ãã‚ˆã†å•é¡Œé¸æŠã‚’è¡Œã†ã“ã¨ã‚‚æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚ã•ã‚‰ã«ã€åˆæ ¼è€…ãŒæ¬¡ã®é¸è€ƒã«é€²ã‚€éš›ã‚„å†…å®šæ‰¿è«¾æ™‚ã®åˆ¤æ–­åŸºæº–ã¨ã—ã¦ã€å„é¸è€ƒå†…å®¹ã¯ã‚·ãƒ“ã‚¢ã«è¦‹ã‚‰ã‚Œã¾ã™ã€‚</p><p>ã“ã‚Œã‚‰ã®è¦³ç‚¹ã‹ã‚‰ã€ã‚³ãƒ¼ãƒ‰é¸è€ƒã«æ±‚ã‚ã‚‰ã‚Œã‚‹è¦ç´ ã‚’ä¸‹è¨˜ã®ã‚ˆã†ã«å®šã‚ã¾ã—ãŸã€‚</p><ul><li>åŸºç¤çš„ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ç´ é¤Šã‚’æœ‰ã—ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã“ã¨<sup id="fnref:0"><a href="#fn:0" rel="footnote">0</a></sup></li><li>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚­ãƒ«ã®é«˜ã•ã«å¿œã˜ã¦ç‚¹æ•°å·®ãŒç”Ÿã¾ã‚Œã‚‹ã“ã¨<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></li><li>ç‰¹å®šã®çŸ¥è­˜ã‚„ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ãŒä¸è¦ãªã“ã¨</li><li>å•é¡Œæ–‡ã®ç†è§£ãŒå®¹æ˜“ãªã“ã¨</li><li>è§£æ³•ã‚’è€ƒãˆã‚‹ã®ãŒæ¥½ã—ã„ã“ã¨</li></ul><p>ã“ã‚Œã‚‰ã‚’åŠ å‘³ã—ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰é¸è€ƒã®å®Ÿç¾ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚<br>ã€Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã«ä¾ã‚‰ãšè§£ã‘ã€æ®µéšçš„ã«é›£æ˜“åº¦ãŒä¸ŠãŒã‚‹ãƒ‘ã‚ºãƒ«ãƒãƒƒã‚¯ãªå•é¡Œã‚’è¤‡æ•°<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>å‡ºé¡Œã™ã‚‹ã€‚ã€</p><h1 id="å•é¡Œé¸å®š"><a href="#å•é¡Œé¸å®š" class="headerlink" title="å•é¡Œé¸å®š"></a>å•é¡Œé¸å®š</h1><p>æ´»ç”¨ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ã€äºˆã‚ç”¨æ„ã•ã‚ŒãŸæ•°ç™¾å•ã®å•é¡Œã‹ã‚‰è‡ªç”±ã«çµ„ã¿åˆã‚ã›ã¦è©¦é¨“ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚<br>å„å•é¡Œã«ã¯ã€é›£æ˜“åº¦ã‚„æ‰€è¦æ™‚é–“ã®ç›®å®‰ãŒä½µè¨˜ã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒã€ã‚ã¾ã‚Šç´å¾—ã®ã§ããªã„å€¤ã§ã‚ã£ãŸã‚Šã€å½“ç¤¾ã®ç‹™ã„ã«ããã‚ãªã„å•é¡Œã‚‚å¤šãè¦‹å—ã‘ã‚‰ã‚Œã¾ã—ãŸã€‚ãã“ã§ã€ç›®æŒ‡ã™ã‚³ãƒ¼ãƒ‰é¸è€ƒã®å®Ÿç¾ã®ãŸã‚ã€å…¨ã¦ã®å•é¡Œã‚’ç¾å ´ç¤¾å“¡ã§è¦‹ç›´ã™ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p><ol><li>ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã¨ã—ã¦ã€ç§ãŒå…¨å•é¡Œæ–‡ã‚’ç¢ºèªã€å€™è£œã¨ã—ã¦20å•ä»¥å†…ã«çµã‚Šè¾¼ã¿ã¾ã™ã€‚</li><li>ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°éƒ¨ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’ä¸­å¿ƒã«ã€å”åŠ›ã—ã¦ãã‚Œã‚‹ç¤¾å“¡ã«å•é¡Œå€™è£œã‚’å…±æœ‰ã—ã¾ã™ã€‚</li><li>å®Ÿéš›ã«å•é¡Œã‚’è§£ã„ã¦ã‚‚ã‚‰ã£ã¦ã€é›£æ˜“åº¦ã®ç›®å®‰ã‚„æ„Ÿæƒ³ã‚’ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã—ã¦ã‚‚ã‚‰ã„ã¾ã™ã€‚</li><li>é›£æ˜“åº¦ãŒç¶ºéº—ãªéšæ®µçŠ¶ã«ãªã‚‹ã‚ˆã†çµ„ã¿åˆã‚ã›ã‚’è€ƒãˆã€å‡ºé¡Œã™ã‚‹å•é¡Œã‚’é¸å®šã—ã¾ã™ã€‚</li></ol><p>å•é¡Œé¸å®šã®å®Ÿæ–½ã«ã‚ãŸã‚Šã€è§£ãå•é¡Œã«ãƒãƒ«ãƒã‚„æ‹…å½“ç­‰ã‚’å®šã‚ãšã€éƒ¨æ´»å‹•ã®å»¶é•·ã¨ã—ã¦èˆˆå‘³ã®å‘ãã¾ã¾ã«å–ã‚Šçµ„ã‚“ã§ã‚‚ã‚‰ãˆã‚‹ã“ã¨ã‚’å¤§äº‹ã«ã—ã¦ã„ã¾ã™ã€‚è§£ãçµ‚ã‚ã£ãŸå•é¡Œã«å¯¾ã—æ‹…å½“ã—ãŸãƒ¡ãƒ³ãƒãƒ¼é–“ã§è­°è«–ãŒç››ã‚Šä¸ŠãŒã‚‹ã“ã¨ã‚‚å¤šãã€ä¸€ç¨®ã®ãŠç¥­ã‚Šã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã€‚</p><h1 id="çµæœã®æ´»ç”¨"><a href="#çµæœã®æ´»ç”¨" class="headerlink" title="çµæœã®æ´»ç”¨"></a>çµæœã®æ´»ç”¨</h1><p>ã‚³ãƒ¼ãƒ‰é¸è€ƒã®çµæœã®æ´»ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ç‰¹ã«é¢æ¥ãªã©ã€ä»–ã®é¸è€ƒãƒ•ãƒ­ãƒ¼ã¨çµ¡ã‚ã¦è©¦è¡ŒéŒ¯èª¤ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚å¹´ã€…å¤‰åŒ–ã™ã‚‹ãŸã‚ç¢ºå®šçš„ãªã“ã¨ã¯è¨€ã„é›£ã„ã®ã§ã™ãŒã€è‡ªç¤¾ã®ç‹™ã„ã«æ²¿ã£ãŸè¦³ç‚¹ã§å®šé‡åŒ–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å½¢éª¸åŒ–ã›ãšã€é¸è€ƒåŸºæº–ã¨ã—ã¦æ´»ç”¨ã§ãã‚‹ã“ã¨ã«ãƒ¡ãƒªãƒƒãƒˆã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã€‚</p><h1 id="åŠ¹æœ"><a href="#åŠ¹æœ" class="headerlink" title="åŠ¹æœ"></a>åŠ¹æœ</h1><p>ã‚³ãƒ¼ãƒ‰é¸è€ƒã¯å½“åˆæƒ³å®šã‚’è¶…ãˆã‚‹æˆæœã«ç¹‹ãŒã£ã¦ã„ã¾ã™ã€‚</p><p>ã¾ãšã€ã‚³ãƒ¼ãƒ‰é¸è€ƒã‚’å®Ÿæ–½ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ITã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°æ¥­ç•Œã‚’å°±æ´»å€™è£œã¨ã—ã¦ã„ãªã„å­¦ç”Ÿã‹ã‚‰ã‚‚å¿œå‹ŸãŒæ¥ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã¾ãŸã€é¢æ¥å®˜ã®è©•ä¾¡ä»¥å¤–ã«ã€å®¢è¦³çš„ãªæ•°å€¤åŸºæº–ãŒåŠ ã‚ã£ãŸã“ã¨ã«ã‚ˆã‚Šã€æŸ”è»Ÿãªé¸è€ƒãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚ãã—ã¦ã€é¢æ¥æ™‚ã®ãƒã‚¿ã‚„å†…å®šæ‰¿è«¾æ™‚ã®ç†ç”±ã¨ã—ã¦ã€ã‚³ãƒ¼ãƒ‰é¸è€ƒå†…å®¹ã«å¯¾ã™ã‚‹å¥½å°è±¡ã‚’ä¸Šã’ã‚‹å¿œå‹Ÿè€…ãŒå°‘ãªããªã„äººæ•°ç”Ÿã¾ã‚Œã¾ã—ãŸã€‚</p><p>ä¸Šè¨˜ã®çµæœã€æ–°å’æ¡ç”¨è€…ã®å†…ã€ã™ã§ã«ã‚³ãƒ¼ãƒ‰é¸è€ƒçµŒç”±ã®äººæ•°ã¯ååˆ†ãªå‰²åˆã‚’å ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p><h1 id="ãŠã‚ã‚Šã«"><a href="#ãŠã‚ã‚Šã«" class="headerlink" title="ãŠã‚ã‚Šã«"></a>ãŠã‚ã‚Šã«</h1><p>ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ã®ã‚³ãƒ¼ãƒ‰é¸è€ƒã®å–ã‚Šçµ„ã¿ã«ã¤ã„ã¦ã”ç´¹ä»‹ã—ã¾ã—ãŸã€‚<br>ITäººæã®æ¯æ¸‡ãŒå«ã°ã‚Œã‚‹ä¸­ã€å„ç¤¾ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚­ãƒ«ã‚’æ¸¬ã‚‹æ–½ç­–ã‚’æ¤œè¨ãƒ»æ¡ç”¨ã™ã‚‹ä¼æ¥­ã‚‚å¤šã„ã¨æ€ã„ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰é¸è€ƒã¨ã„ã£ã¦ã‚‚ã€ä¼æ¥­æ¯ã«æ±‚ã‚ã‚‹ç‹™ã„ã‚„è©•ä¾¡åŸºæº–ã¯æ§˜ã€…ã§ã‚ã‚Šã€ãã‚Œã«åˆã‚ã›ã¦å¿…è¦ãªé¸è€ƒã‚’ã©ã†å®Ÿç¾ã™ã‚Œã°ã‚ˆã„ã®ã‹ã€æœ¬å–ã‚Šçµ„ã¿ãŒä½•ã‹ã®å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</p><p>(å€‹äººçš„ã«ã¯ã€ã‚³ãƒ¼ãƒ‰é¸è€ƒã‚’é€šã˜ã¦å¤šãã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒãƒ¼ã«å…¥ç¤¾é ‚ã„ãŸã®ã§ã€ã‚ˆã‚Šè‰¯ã„å•é¡Œã‚’æƒãˆã‚‹ãŸã‚ã€ãã‚ãã‚ç¤¾å†…ã§ã®è‡ªä½œã‚’å®Ÿç¾ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚)</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:0"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">0.</span><span style="display: inline-block; vertical-align: top;">AtCoderç·‘ã‚³ãƒ¼ãƒ€ãƒ¼ã®æ–¹ã®å¤šããŒé€šéã™ã‚‹ãƒ¬ãƒ™ãƒ«ã‚’æƒ³å®šã—ã¾ã—ãŸã€‚</span><a href="#fnref:0" rev="footnote"> â†©</a></li><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;">AtCoderé»„ã‚³ãƒ¼ãƒ€ãƒ¼ã®æ–¹ã§ã‚ã‚Œã°æº€ç‚¹ãŒå–ã‚Œã‚‹ãƒ¬ãƒ™ãƒ«ã‚’æƒ³å®šã—ã¾ã—ãŸã€‚</span><a href="#fnref:1" rev="footnote"> â†©</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;">æ‰€è¦æ™‚é–“ã®å…¼ã­åˆã„ã‹ã‚‰5å•ç¨‹åº¦ã‚’ç›®å®‰ã«ã—ã¦ã„ã¾ã™ã€‚</span><a href="#fnref:2" rev="footnote"> â†©</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/20200731/laptop-2298286_1280.png&quot;&gt;

&lt;p&gt;&lt;a href=&quot;https://pixabay.com/ja/users/Sara_Torda-888816/?utm_source=link-attributio
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°" scheme="https://future-architect.github.io/tags/%E7%AB%B6%E6%8A%80%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0/"/>
    
      <category term="æ¡ç”¨" scheme="https://future-architect.github.io/tags/%E6%8E%A1%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Redux-Toolkitã«å­¦ã¶ã€TypeScriptã®å‹æ¨è«–ã¨ã“ã‚Œã‹ã‚‰ã®APIãƒ‡ã‚¶ã‚¤ãƒ³</title>
    <link href="https://future-architect.github.io/articles/20200730/"/>
    <id>https://future-architect.github.io/articles/20200730/</id>
    <published>2020-07-29T15:00:00.000Z</published>
    <updated>2020-08-05T14:18:41.658Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/20200730/top.png"><p>TypeScriptã¯ã€JavaScriptã®ã•ã¾ã–ã¾ãªãƒ•ãƒªãƒ¼ãƒ€ãƒ ãªæ›¸ãæ–¹ã‚’å—ã‘å…¥ã‚Œã€æ¼¸é€²çš„ãªå‹ä»˜ã‘ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨ã„ã†<del>ç‹‚ã£ãŸ</del>é«˜é›£æ˜“åº¦ãªç›®çš„ã®ãŸã‚ã«ä½œæˆã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒã€ãã‚ãã‚ã€TypeScriptãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã§ã€åˆ©ç”¨è€…ã«ã¨ã£ã¦ä½¿ã„ã‚„ã™ã„APIã¿ãŸã„ãªæ–¹å‘æ€§ã§ä½¿ã‚ã‚Œã‚‹ã“ã¨ã‚‚å¢—ãˆã‚‹ã®ã§ã¯ã€ã¨ã„ã†æ€ã„ã‚’å¼·ãæŒã¡ã¾ã—ãŸã€‚ã€Œæ—¢å­˜ã®JSãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’TypeScriptåŒ–ã—ã¦ã€œã€ã¿ãŸã„ãªç´¹ä»‹ã®ã•ã‚Œæ–¹ã¯ã‚‚ã¯ã‚„éå»ã®ã‚‚ã®ã«ãªã£ãŸã®ã§ã¯ãªã„ã‹ã¨ã€‚</p><p>ã™ã§ã«<a href="https://2019.stateofjs.com/javascript-flavors/typescript/" target="_blank" rel="noopener">State of JavaScript 2019</a>ã§ã¯2/3ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã™ã§ã«TypeScriptã‚’åˆ©ç”¨ã—ãŸã“ã¨ãŒã‚ã‚‹ï¼ˆä½¿ã£ã¦ã„ã‚‹ï¼‰ã¨ç­”ãˆã€æ®‹ã‚Šã®1/3ã‚‚å­¦ã³ãŸã„ã€ã¨ç­”ãˆã¦ã„ã‚‹çŠ¶æ³ã§ã™ã€‚ã“ã®å‹¢ã„ã ã¨ã€2å¹´å¾Œã«ã¯80%ã‚’è¶…ãˆãã†ã§ã™ã€‚åƒ•è‡ªèº«ã‚‚ã€TypeScriptãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãªä¸–ç•ŒãŒãã‚‹ã“ã¨ã‚’æƒ³åƒã—ã¦<a href="https://github.com/future-architect/typescript-guide/" target="_blank" rel="noopener">èª¬æ˜ã«ä½¿ãˆã‚‹æ•™ç§‘æ›¸</a>ã‚’æ›¸ãå§‹ã‚ãŸã‚ã‘ã§ã™ãŒã€æ€ã£ãŸã‚ˆã‚Šã‚‚ãã®ä¸–ç•ŒãŒæ¥ã‚‹ã®ã¯æ—©ãã†ã§ã™ã€‚</p><p>ã“ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã§ã¯ã€TypeScriptãƒ¦ãƒ¼ã‚¶ãƒ¼ã®TypeScriptãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹TypeScriptãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãŸã‚ã®APIè¨­è¨ˆã«ã¤ã„ã¦è€ƒãˆã‚’ã¾ã¨ã‚ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚æƒ³å®šèª­è€…ã¯ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½œã‚‹ã‚ˆã†ãªäººã§ã™ã®ã§ã€æ—¢å­˜ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’çµ„ã¿åˆã‚ã›ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã‚‹äººã¯æƒ³å®šå¤–ã§ã™ã€‚</p><p>ã¡ãªã¿ã«ã€ç›¸äº’é‹ç”¨ã®è©±ãªã©ã¯ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ã‹ã‚‰å‡ºç‰ˆã•ã‚Œã¦ã„ã‚‹<a href="https://www.oreilly.co.jp/books/9784873119045/" target="_blank" rel="noopener">ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°TypeScript</a>ã®11ç« ãªã©ã§è©³ã—ãèª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã¡ã‚‰ã‚’ã¿ã‚‹ã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚JSã‹ã‚‰ç§»è¡Œã«ã¤ã„ã¦ã¯è©±ã¯ã—ã¾ã›ã‚“ã€‚</p><h1 id="3è¡Œã¾ã¨ã‚"><a href="#3è¡Œã¾ã¨ã‚" class="headerlink" title="3è¡Œã¾ã¨ã‚"></a>3è¡Œã¾ã¨ã‚</h1><ul><li>TypeScriptã®å‹æ¨è«–ã¯åˆ¶ç´„ãŒã‚ã£ã¦ã€ä»–ã®é–¢æ•°å‹è¨€èªã§æä¾›ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‚ˆã‚Šã¯å¼±ã„</li><li>ã†ã¾ãæ¨è«–ã‚’æ´»ç”¨ã—ã¦ã€ã‚³ãƒ¼ãƒ‰è£œå®Œã¨ã‹å‹ãƒã‚§ãƒƒã‚¯ãŒåˆ©ãã‚„ã™ã„APIã‚’ä½œã‚ã†</li><li>JavaScriptæ™‚ä»£ã¨ã¯APIã®å½¢ãŒå¤‰ã‚ã‚‹ã‹ã‚‚ã‚ˆ/å¤‰ãˆã¦è¡Œã“ã†</li></ul><h1 id="å‰å›ã®ãŠã•ã‚‰ã„"><a href="#å‰å›ã®ãŠã•ã‚‰ã„" class="headerlink" title="å‰å›ã®ãŠã•ã‚‰ã„"></a>å‰å›ã®ãŠã•ã‚‰ã„</h1><p>TechBlogã§ä»¥å‰ã€Redux Toolkitã®ç´¹ä»‹ã‚’æ›¸ãã¾ã—ãŸã€‚ä»Šå›ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã¯ãã®ç¶šãã§ã™ã€‚</p><ul><li><a href="https://future-architect.github.io/articles/20200501/">TypeScriptã§Reactã‚’ã‚„ã‚‹ã¨ãã¯ã€å°ã•ã„ã‚¢ãƒ—ãƒªã§ã‚‚Reduxã‚’æœ€åˆã‹ã‚‰ä½¿ã£ã¦ã‚‚ã„ã„ã‹ã‚‚ã­ã¨ã„ã†ãŠè©±</a></li></ul><blockquote><p>æœ€è¿‘ã€åƒ•ãŒæ„è­˜ã—ã¦ã„ã‚‹ã®ã¯ãƒªãƒ¼ãƒ€ãƒ–ãƒ«ãªã‚³ãƒ¼ãƒ‰ã§ã™ã€‚ã“ã‚Œã¯ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã®æœ¬ã®Readableã§ã¯ãªãã¦ã€ã‚³ãƒ¼ãƒ‰ãŒäººã‚’å°ã„ã¦ãã‚Œã‚‹ï¼ˆLeadableï¼‰ã¨ã„ã†æ„å‘³ã§ã™ã€‚ä¸€æ–¹ã§ã€Reduxã¨TypeScriptã§æ„Ÿã˜ã¦ã„ãŸã®ã¯ã€å‡¦ç†ç³»ã‚’é€šã™ãŸã‚ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã‹ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†æ„Ÿè¦šã§ã™ã­ã€‚ã‚ªãƒ¼ãƒ€ãƒ–ãƒ«(Orderable)ã¨å‘¼ã‚“ã§ã„ã‚‹ã‘ã©ã€ã‚‚ã£ã¨ã„ã„åå‰ãŒã‚ã£ãŸã‚‰æ•™ãˆã¦ãã ã•ã„ã€‚Redux Toolkitã¯ã ã„ã¶ä½™è¨ˆãªã“ã¨ã«é ­ã‚’ä½¿ã‚ãªãã¦æ¸ˆã‚€ã®ã§ã€ã¨ã¦ã‚‚è‰¯ã„ã§ã™ã€‚<br>(ç•¥)<br>Redux toolkitã¨ç”Ÿã®Reduxã‚’ä½¿ã£ã¦è¦‹ã¦æ€ã†ã®ã¯ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è¨­è¨ˆã®é›£æ˜“åº¦ãŒ3å€ãã‚‰ã„ã«ãªã£ãŸãªãã€ã¨ã„ã†æ„Ÿã˜ã§ã™ã­ã€‚TypeScriptã§å‹æ¨è«–ãŒå…¥ã£ãŸã®ã¯ã‚ã‚‹ã®ã§ã™ãŒã€ãã®å‹æ¨è«–ãŒåŠ¹ãã‚„ã™ã„ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®Ÿè£…ã—ãªãã‚ƒã„ã‘ãªã„å‹æƒ…å ±ã‚’æ¸›ã‚‰ã™ãŸã‚ã®è¨­è¨ˆã¨ã„ã†ã®ãŒã€ã“ã®å¾Œã®ä¸»æˆ¦å ´ã«ãªã‚Šãã†ã ãªãã€ã¨ã„ã†ã“ã¨ã§ã™ã€‚ä»Šã¾ã§ã¯ãƒ‡ãƒ¼ã‚¿ã‚’åŠ å·¥ã™ã‚‹ã€ã¨ã„ã†ãƒ­ã‚¸ãƒƒã‚¯ã ã‘ã‚’è¨­è¨ˆã™ã‚Œã°è‰¯ã‹ã£ãŸã®ã§ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ã®ä¼æ¬ã ã‘ã˜ã‚ƒãªãã¦ã€å‹æƒ…å ±ã®ä¼æ¬ã¨ã„ã†ã®ã‚‚è€ƒæ…®ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã€‚ã‚ã‚‹æ„å‘³ã€C++ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆçµŒé¨“ãŒç”Ÿãã‚‹ã®ã‹ã‚‚ã€ãªãã€ã¨ã„ã†ã€‚ã¾ã ã‚ã¾ã‚Šè¨€èªåŒ–ã§ããªã„ã®ã§ã™ãŒã€‚Haskellãªäººã¨ã‹å¾—æ„ã ã£ãŸã‚Šã™ã‚‹ã‚“ã§ã™ã‹ã­ï¼Ÿ</p></blockquote><h1 id="å‹ã®ä¼æ¬"><a href="#å‹ã®ä¼æ¬" class="headerlink" title="å‹ã®ä¼æ¬"></a>å‹ã®ä¼æ¬</h1><p>ä½¿ã„ã‚„ã™ã„APIã¨ã„ã†ã®ã¯ã€ãã®ä»Šå…¥åŠ›ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ç®‡æ‰€ã®æƒ…å ±ãŒååˆ†ã«å¾—ã‚‰ã‚Œã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚ãã‚Œã¯å‹ã§ã™ã€‚ã—ã‹ã—ã€å‹ã‚’å…¨éƒ¨è¦šãˆã¦ã„ã¦é–“é•ã„ãªãå®£è¨€ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã™ã‚‹ã¨ã€å…¥åŠ›ã®è£œåŠ©ã«ã¯ãªã‚Šã¾ã›ã‚“ã—ã€ã‚¿ã‚¤ãƒ—æ•°ã‚‚å¢—ãˆã¾ã™ã€‚ã‚ã–ã‚ã–å…¥åŠ›ã—ãªãã¦ã‚‚ãã¡ã‚“ã¨æƒ…å ±ãŒå¾—ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã®ãŒå‹æ¨è«–ã§ã™ã€‚å‹æ¨è«–ã¯ãã®å ´ã®ç’°å¢ƒã‹ã‚‰å‹ã‚’æ±ºå®šã—ã¦ã„ãã¾ã™ã€‚</p><p>å‰å›ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã®æœ€å¾Œã«æ›¸ã„ãŸã®ãŒå‹ã®ä¼æ¬ã§ã™ã€‚å‹æ¨è«–(type inference)ã§ã¯ã‚ã‚‹ã®ã§ã™ãŒã€TypeScriptã®å ´åˆã¯ã‚ˆã‚Šå¼·åŠ›ãªå‹æ¨è«–ã‚’æŒã¤è¨€èªã¨æ¯”ã¹ã‚‹ã¨ã€æ¨è«–ã™ã‚‹æ–¹å‘ãŒé™å®šã•ã‚Œã¦ã„ã‚‹ã®ã§ã‚ãˆã¦ä¼æ¬ã¨å‘¼ã³ã¾ã—ãŸãŒã€å‹æ¨è«–ã§ã™ã€‚</p><p>æ–¹å‘ãŒæ±ºã¾ã£ã¦ã„ã¦æ©Ÿèƒ½ãŒå¼±ã„ã®ã¯æ¬ ç‚¹ã§ã‚‚ã‚ã‚Šã¾ã™ãŒã€é•·æ‰€ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚å‡¦ç†ç³»ã®æŒ™å‹•ã¯ã‚ã‹ã‚Šã‚„ã™ãã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã—ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚‚æ—©ã„ã§ã™ã€‚</p><h2 id="ä»£å…¥"><a href="#ä»£å…¥" class="headerlink" title="ä»£å…¥"></a>ä»£å…¥</h2><p>ä¸€ç•ªåŸºæœ¬çš„ãªæ¨è«–ã¯ã€ä»£å…¥ã§ã™ã­ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> greeting = <span class="string">"hello world"</span>;</span><br></pre></td></tr></table></figure><p>ä¸å¯§ã«æ›¸ããªã‚‰æ¬¡ã®ã‚ˆã†ã«å‹æƒ…å ±ã‚’å…¥ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ãŒã€å³è¾ºã‹ã‚‰æ˜ã‚‰ã‹ãªã®ã§ã€å·¦å´ã®ä»£å…¥éƒ¨åˆ†ã§ã¯å‹ã‚’çœç•¥ã§ãã¾ã™ã­ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> i: <span class="built_in">string</span> = <span class="string">"hello world"</span>;</span><br></pre></td></tr></table></figure><p>é€†æ–¹å‘ã«ã¯æ¨è«–ã¯ã§ãã¾ã›ã‚“ã€‚å½“ãŸã‚Šå‰ã«æ€ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒãã†ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚é€†æ–¹å‘ã«æ¨è«–ãŒã§ãã‚‹ã¨ã—ãŸã‚‰ã€å·¦è¾ºã‹ã‚‰å³è¾ºã®é–¢æ•°ã®è¿”ã‚Šå€¤ã®å‹ã‚’æ¨å®šã—ã¦ã€ãã“ã‹ã‚‰ã€å¼•æ•°<code>i</code>ã®å‹ã‚‚æ±ºã¾ã£ã¦ã€Œtestã®å‘¼ã³å‡ºã—æ™‚ã®å¼•æ•°ã®å‹ãŒé•ã†ã€ã¨ãªã‚Šã¾ã™ãŒã€TypeScriptã®å ´åˆã¯ä¸€æ–¹é€šè¡Œãªã®ã§ã€å³è¾ºã®å‹ãŒå…¨éƒ¨è§£æ±ºã—ã¦ã‹ã‚‰å·¦è¾ºã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã€ã€Œæ•°å­—ã¯æ–‡å­—åˆ—ã®å¤‰æ•°ã«ä»£å…¥ã§ããªã„ã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s: <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">const</span> i: <span class="built_in">number</span> = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>&lt;<span class="title">T</span>&gt;(<span class="params">i: T</span>): <span class="title">T</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Type 'number' is not assignable to type 'string'.</span></span><br><span class="line">s = test(i);</span><br></pre></td></tr></table></figure><p>å‹å¤‰æ•°ã‚’æŒã¤ã‚¯ãƒ©ã‚¹ã‚’å‹ã‚’æŒ‡å®šã—ãªã„ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆã—ãŸå ´åˆã¯ã€<code>unknown</code>ãŒæŒ‡å®šã•ã‚ŒãŸã‚‚ã®ã¨ã—ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆã•ã‚Œã¾ã™ã€‚æœ€åˆã®<code>append()</code>ã®å¼•æ•°ã‚’ã¿ã¦ã€T=numberã¨æ¨è«–ã—ã¦ãã‚Œã‚‹ã“ã¨ã¯TypeScriptã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€æ¬¡ã®æ–‡å­—åˆ—ã®<code>append()</code>ã‚‚æˆåŠŸã—ã¦ã—ã¾ã„ã¾ã™ã€‚ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ãã‚Œã¾ã›ã‚“ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> list = <span class="keyword">new</span> <span class="built_in">Array</span>&lt;T&gt;();</span><br><span class="line">    append(i: T) &#123;</span><br><span class="line">        <span class="keyword">this</span>.list.push(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> l = <span class="keyword">new</span> List();</span><br><span class="line">l.append(<span class="number">10</span>);</span><br><span class="line">l.append(<span class="string">"string"</span>);</span><br></pre></td></tr></table></figure><p><code>unknown</code>ã®ã¾ã¾å‹•ã„ã¡ã‚ƒã†ã¨ã€TypeScriptã‹ã‚‰JavaScriptã®ä¸–ç•Œã«é€†æˆ»ã‚Šã‚’ã—ã¾ã™ãŒã€ã¾ã‚ãã‚Œã§ã‚‚å‹•ã„ã¦ãã‚Œã‚‹ã®ã¯TypeScriptã‚‰ã—ã„ã¨ã“ã‚ã§ã¯ã‚ã‚Šã¾ã™ã€‚<a href="https://go2goplay.golang.org/" target="_blank" rel="noopener">Goã®ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹</a>ã®ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆæ™‚ã«æ˜ç¤ºçš„ãªå‹å¤‰æ•°æŒ‡å®šãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚</p><h2 id="é–¢æ•°ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°"><a href="#é–¢æ•°ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°" class="headerlink" title="é–¢æ•°ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°"></a>é–¢æ•°ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°</h2><p>å¼•æ•°ã‹ã‚‰ã€ãã‚ŒãŒå±ã™ã‚‹é–¢æ•°ã®å‹å¤‰æ•°ã¸ã®ä¼æ¬ã¯å¯èƒ½ã§ã™ã€‚ã¨ã„ã†ã‚ˆã‚Šã‚‚ã€é–¢æ•°ã®å‹å¤‰æ•°ã«æ¨è«–ã§å‹ã‚’è‡ªå‹•è¨­å®šã™ã‚‹æ–¹æ³•ã¯å¼•æ•°çµŒç”±ãŒå”¯ä¸€ã®æ–¹æ³•ã§ã™ã€‚</p><p>å˜ãªã‚‹<code>T</code>ã§ãªãã¦ã‚‚ã€<code>T[]</code>ã®ã‚ˆã†ãªé…åˆ—ã§ã‚‚ã€<code>(input: T) =&gt; void</code>ã¿ãŸã„ãªå¼•æ•°ã§ã‚ã£ã¦ã‚‚ã€ãã¡ã‚“ã¨è§£æ±ºã—ã¦ãã‚Œã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>&lt;<span class="title">T</span>&gt;(<span class="params">a: T</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼•æ•°åŒå£«ã®ä¼æ¬ã‚‚è¦‹é€ƒã›ãªã„è¦ç´ ã§ã™ã€‚Redux-Toolkitã®<code>createSlice()</code>ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«æ›¸ãã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createSlice</span>&lt;<span class="title">S</span>&gt;(<span class="params">state: S, reducers: &#123;[key: <span class="built_in">string</span>]: (s: S) =&gt; S&#125;</span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã®è‰¯ã„ç‚¹ã¯ã€æœ€åˆã®å¼•æ•°ã®initialStateã‹ã‚‰å‹æƒ…å ±ãŒä¼æ¬ã—ã€2ã¤ç›®ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹ã®å®šç¾©ãŒå®Œæˆã™ã‚‹ç‚¹ã«ã‚ã‚Šã¾ã™ã€‚ã“ã®reducersã®é–¢æ•°ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã™ã‚‹å ´åˆã¯ã€sã¯Stateå‹ã¨åˆ†ã‹ã£ã¦ã„ã‚‹ã®ã§ã‚³ãƒ¼ãƒ‰è£œå®ŒãŒèãã¾ã™ã—ã€returnã®æ–¹ãŒé–“é•ãˆã°å³åº§ã«èµ¤ç·šãŒå¼•ã‹ã‚Œã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> State = &#123;</span><br><span class="line">    name: <span class="built_in">string</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState: State = &#123;</span><br><span class="line">    name: <span class="string">"shibukawa"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">createSlice(initialState, &#123;</span><br><span class="line">    greeting: <span class="function">(<span class="params">s</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`hello <span class="subst">$&#123;s.name&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="é–¢æ•°ã®è¿”ã‚Šå€¤"><a href="#é–¢æ•°ã®è¿”ã‚Šå€¤" class="headerlink" title="é–¢æ•°ã®è¿”ã‚Šå€¤"></a>é–¢æ•°ã®è¿”ã‚Šå€¤</h2><p>é–¢æ•°ã®è¿”ã‚Šå€¤ã®æ¨è«–ãŒè³¢ã„ã®ã¯TypeScriptã®ã†ã‚Œã—ã„ã¨ã“ã‚ã§ã™ã€‚å¼•æ•°ã¨é•ã£ã¦è¿”ã‚Šå€¤ã¯å†…éƒ¨ã®ãƒ­ã‚¸ãƒƒã‚¯ã§æ±ºã¾ã‚‹ã®ã§çœç•¥å¯èƒ½ã§ã™ãŒã€ESLintã®æ¨å¥¨è¨­å®šã§<code>explicit-function-return-type</code>ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ONã«ãªã£ã¦ãŠã‚Šã€æ˜ç¤ºçš„ã«æ›¸ã‹ãªã„ã¨ã„ã‘ã¾ã›ã‚“ã€‚åƒ•ã¯ã“ã®è¨­å®šã¯ã‚ªãƒ•ã«ã—ã¦ã—ã¾ã„ã¾ã™ã—ã€ä»®ã«å®£è¨€ã‚’çœç•¥ã—ã¦ã‚‚.d.tsã«ã¯å‹æƒ…å ±ã¨ã—ã¦ã¯ç¾ã‚Œã‚‹ã—ã€ã‚³ãƒ¼ãƒ‰è£œå®Œã¯èãã—ã€å‹å®£è¨€ã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’grepã—ã¦ç›®ã§è¦‹ã‚Œãªã„ä»¥å¤–ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¯ãªã„ã§ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Math</span>.random() &gt; <span class="number">0.5</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span> <span class="keyword">as</span> <span class="built_in">number</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test"</span> <span class="keyword">as</span> <span class="built_in">string</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã¯æ¬¡ã®ã‚ˆã†ã«æ¨è«–ã•ã‚Œã¾ã™ã€‚ãªãŠã€as numberã€as stringã‚’å¤–ã™ã¨ã€ <code>10 | &quot;test&quot;</code>ã«ãªã‚Šã¾ã™ã€‚</p><figure class="highlight ts"><figcaption><span>.d.ts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>): <span class="title">string</span> | <span class="title">number</span></span>;</span><br></pre></td></tr></table></figure><p>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™å ´åˆã¯æŒ™å‹•ãŒã¡ã‚‡ã£ã¨é•ã„ã¾ã™ã€‚Reduxã®action creatorã§ã‚ˆãè¦‹ã‚‹ã‚ˆã†ãªæ¬¡ã‚ˆã†ãªé–¢æ•°ã§ã™ã­ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ADD_TODO = <span class="string">"ADD_TODO"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="keyword">type</span>: ADD_TODO,</span><br><span class="line">    text</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã¯ã“ã†ãªã‚Šã¾ã™ã€‚</p><figure class="highlight ts"><figcaption><span>.d.ts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text: <span class="built_in">string</span></span>): </span>&#123;</span><br><span class="line">    <span class="keyword">type</span>: <span class="built_in">string</span>;</span><br><span class="line">    text: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’æ–‡å­—åˆ—å‹ã§ã¯ãªãã¦ã€ç‰¹å®šã®æ–‡å­—åˆ—<code>ADD_TODO</code>å›ºå®šã¨ã—ãŸã„å ´åˆã¯ã€<code>as const</code>ã‚’ã¤ã‘ã¾ã™ã€‚â†‘ã®ä¾‹ã®constã®å¤‰æ•°ã‚’å‚ç…§ã—ãŸã¾ã¾as constã‚’ã¤ã‘ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã™ã®ã§ã€æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã«ã—ã¦ã„ã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="keyword">type</span>: <span class="string">"ADD_TODO"</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">    text</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><figcaption><span>.d.ts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">text: <span class="built_in">string</span></span>): </span>&#123;</span><br><span class="line">    <span class="keyword">type</span>: <span class="string">"ADD_TODO"</span>;</span><br><span class="line">    text: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>é–¢æ•°ã®è¿”ã‚Šå€¤ã‹ã‚‰ã€å‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®<code>ReturnType</code>ã‚’ä½¿ã†ã¨ã€å‹ã‚’å–ã‚Šå‡ºã™ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚â†‘ã®<code>as const</code>ã¯ã“ã®å‹ã‚’ä½¿ã†å ´åˆã«å¤§åˆ‡ã«ãªã‚Šã¾ã™ã€‚Reduxã®reducerã®actionã®å‹æŒ‡å®šã§ã€ã™ã¹ã¦ã®Action Creatorã®è¿”ã‚Šå€¤ã®å‹ã®åˆä½µå‹ã‚’ä½œã‚‹ã¨ãã«ã€â€ADD_TODOâ€ã®éƒ¨åˆ†ãŒæ®‹ã£ã¦ã„ã‚‹ã¨å¬‰ã—ã„ã‹ã‚‰ã§ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> AddTodoAction = ReturnType&lt;<span class="keyword">typeof</span> addTodo&gt;;</span><br><span class="line"><span class="keyword">type</span> DoneTodoAction = ReturnType&lt;<span class="keyword">typeof</span> doneTodo&gt;;</span><br><span class="line"><span class="keyword">type</span> Actions = AddTodoAction | DoneTodoAction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  todos: [] <span class="keyword">as</span> Todo[]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">todoApp</span>(<span class="params">&#123;todos&#125; = initialState, action: Actions</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"ADD_TODO"</span>: <span class="comment">// ã“ã“ã§å„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®é–¢æ•°ãŒreturnã—ã¦ãªã„æ–‡å­—åˆ—ã‚’æ›¸ãã¨ã‚¨ãƒ©ãƒ¼ãŒæ¤œçŸ¥ã•ã‚Œã‚‹</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;todos&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åˆã®ä¾‹ã¯ADD_TODOã‚’constå¤‰æ•°ã«ã—ã¦ã„ã¾ã—ãŸã€‚å¤‰æ•°ã®æœ‰ç„¡ã§ã‚ã‚Œã°TypeScriptã§ãªãã¦ã‚‚JSã§ã‚‚ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ãŒåˆ©ããŸã‚ã«Reduxã§ã€Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®è­˜åˆ¥å­ã¯constå¤‰æ•°ã«ã™ã‚‹ã€ãŒãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«ãªã£ãŸã¨æ€ã„ã¾ã™ãŒã€ãã‚‚ãã‚‚TypeScriptã§ã¯æ–‡å­—åˆ—ã®ã¾ã¾ã§ã‚‚ãƒã‚§ãƒƒã‚¯ãŒåˆ©ãã®ã§ã€å¤‰æ•°å®£è¨€ãŒçœç•¥ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p><p>ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™å ´åˆã®å‹å®šç¾©ã¯ã€ã»ã¨ã‚“ã©ãŒnullableã§ãªã„å ´åˆã¯ã“ã®ã‚ˆã†ã«é–¢æ•°ã«ç›´æ¥æ›¸ã„ã¦ã‚‚ã„ã„ã§ã™ãŒã€nullableã ã£ãŸã‚Šå‹æŒ‡å®šã®ã‚ã‚‹é…åˆ—ã ã£ãŸã‚Šã™ã‚‹å ´åˆã¯å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãŸãã•ã‚“ã¤ã‘ãªã‘ã‚Œã°ãªã‚‰ãšã€ã‚¿ã‚¤ãƒ—æ•°ãŒå¤šããªã£ã¦ãã¦ã—ã¾ã„ã¾ã™ã—ã€è¦‹é€šã—ã‚‚æ‚ªããªã‚Šã¾ã™ã€‚ã¾ãŸè¤‡æ•°ç®‡æ‰€ã§åˆ©ç”¨ã™ã‚‹å ´åˆãªã©ã¯å¤–éƒ¨ã«å‹å®šç¾©ã‚’æ›¸ãæ–¹ãŒè‰¯ã„ã§ã™ã­ã€‚</p><p>ãªãŠã€TypeScriptã§ã¯è¿”ã‚Šå€¤ã‚’å—ã‘å–ã‚‹å¤‰æ•°ã®å‹ã‹ã‚‰ã€è¿”ã‚Šå€¤ã®æ–¹ã‚’æ¨è«–ã—ã¦æ±ºã‚ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã¾ã‚è¿”ã‚Šå€¤ã‚’å—ã‘ã‚‹=ä»£å…¥ãªã®ã§ã€ä»£å…¥ã®å³è¾ºã¸ã®æ¨è«–ãŒåŠ¹ã‹ãªã„ä»¥ä¸Šã€å½“ç„¶ã§ã™ã­ã€‚</p><h2 id="ã‚¯ãƒ©ã‚¹ã¨ãƒ¡ãƒ³ãƒãƒ¼"><a href="#ã‚¯ãƒ©ã‚¹ã¨ãƒ¡ãƒ³ãƒãƒ¼" class="headerlink" title="ã‚¯ãƒ©ã‚¹ã¨ãƒ¡ãƒ³ãƒãƒ¼"></a>ã‚¯ãƒ©ã‚¹ã¨ãƒ¡ãƒ³ãƒãƒ¼</h2><p>ã‚¯ãƒ©ã‚¹å´ã«å‹å¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã¨ã€ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚‚ä½¿ãˆã¾ã™ã€‚ã¾ã‚å½“ç„¶ã§ã™ã­ã€‚ãƒ¡ãƒ³ãƒãƒ¼å¤‰æ•°ã¨ã€ãƒ¡ãƒ³ãƒãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã‚„è¿”ã‚Šå€¤ã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> list = <span class="keyword">new</span> <span class="built_in">Array</span>&lt;T&gt;();</span><br><span class="line">    append(i: T) &#123;</span><br><span class="line">        <span class="keyword">this</span>.list.push(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€†ã«ã€ãƒ¡ãƒ³ãƒãƒ¼ã§å®šç¾©ã•ã‚ŒãŸå‹å¤‰æ•°ã¯ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã‚¯ãƒ©ã‚¹å´ã§ä½¿ãˆã¾ã›ã‚“ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> list = <span class="keyword">new</span> <span class="built_in">Array</span>&lt;T&gt;();</span><br><span class="line">    append&lt;U&gt;(i: T, e: U) &#123;</span><br><span class="line">        <span class="keyword">this</span>.list.push(i);</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ãŸã ã—ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’é™¤ãã¾ã™ã€‚ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ã‚’å…ƒã«ã€å‹å¤‰æ•°ã‚’æ±ºå®šã™ã‚‹ã“ã¨ã¯ã§ãã¾ã™ã€‚ã“ã®ç‰¹æ€§ã¯å¤§åˆ‡ã§ã€ã‚¯ãƒ©ã‚¹ã®å‹å¤‰æ•°ã«å‹ã‚’ä¼æ¬ã•ã›ã‚‹ã«ã¯ã€ã‚¯ãƒ©ã‚¹ã®å‹å¤‰æ•°ã«ã¯ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ä½¿ã†æ–¹æ³•ä»¥å¤–ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãã†ã§ãªã‘ã‚Œã°æ˜ç¤ºçš„ã«å‹ã‚’æ¸¡ã—ã¦åˆæœŸåŒ–ï¼ˆ<code>new List&lt;number&gt;()</code>ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> list = <span class="keyword">new</span> <span class="built_in">Array</span>&lt;T&gt;();</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">a: T</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.list.push(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æ±ºã§ããªã„ã®ãŒ<code>Promise</code>ã®å¼•æ•°ã®ã‚ˆã†ãª<code>(asyncTask: (resolve: (i: T)=&gt;void) =&gt; void</code>ã¨ã„ã£ãŸã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ãŒé–¢æ•°ã§ã€ãã®é–¢æ•°ã®å…¥åŠ›å€¤ã§å‹ã‚’æ±ºã‚ã‚‹ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã§ã™ã€‚ã“ã®ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã§ã¯å‹ãŒæ±ºå®šã§ããšã€<code>Promiseã®å‹å¤‰æ•°</code>ã¯<code>unknown</code>ã®ã¾ã¾ã§ã™ã€‚ã“ã®å ´åˆã ã‘ã¯<code>new Promise&lt;number&gt;</code>ã¨æ˜ç¤ºçš„ã«æ›¸ã„ã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promiseTest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(<span class="number">10</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¾‹å¤–"><a href="#ä¾‹å¤–" class="headerlink" title="ä¾‹å¤–"></a>ä¾‹å¤–</h2><p>ã“ã“ãŒTypeScriptã®å‹æ¨è«–ã®ç§˜å­”ã‹ãªã€ã¨æ€ã„ã¾ã™ã€‚ã¾ãšã€Javaã®throwså®£è¨€ãŒãªã„ï¼ˆä½•ãŒé£›ã‚“ã§ãã‚‹ã‹äº‹å‰ã«ã‚ã‹ã‚‰ãªã„ï¼‰ã€<code>Promise</code>ã§<code>reject</code>ã«æ¸¡ã•ã‚Œã‚‹ä¾‹å¤–ã®å‹å®šç¾©ãŒãªã„ã‹ã‚‰ã§ã™ã€‚å—ã‘å–ã‚Šå´ã«å‹ã¨ã—ã¦ä¼ã‚ã‚‹ç‰©ãŒä½•ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚</p><p>ãã‚‚ãã‚‚ã€TypeScriptã¯ä¾‹å¤–ã‚’æ‰±ã†ã®ãŒå…ƒã®JavaScriptã®ç‰¹æ€§ã‚‚ã‚ã£ã¦è‹¦æ‰‹ã§ã™ã€‚</p><ul><li><a href="https://qiita.com/shibukawa/items/ffe7264ecff78f55b296" target="_blank" rel="noopener">JavaScript/TypeScriptã®ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥ã‚’è€ƒãˆã‚‹</a></li></ul><p>å‹ã®è£œå®Œã‚‚åŠ¹ã„ã¦ã€ã‚¿ã‚¤ãƒ—æ•°ã‚‚å°‘ãªãã¦æ¸ˆã¿ã€é–¢æ•°ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã®å¤–ã§åˆ¥ã®è¦ç´ ã‚’å®šç¾©ã—ãªãã¦ã‚‚è‰¯ã„æ–¹æ³•ã¯ã€Goã‚¹ã‚¿ã‚¤ãƒ«ã§è¿”ã‚Šå€¤ã®ä¸€éƒ¨ã¨ã—ã¦è¿”ã™æ–¹æ³•ãªã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã£ã¦ã„ã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calcAge</span>(<span class="params">birthDay: <span class="built_in">Date</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> age = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">let</span> error = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">const</span> today = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">const</span> tNum = today.getFullYear() * <span class="number">10000</span> + (today.getMonth() + <span class="number">1</span>) * <span class="number">100</span> + today.getDate();</span><br><span class="line">    <span class="keyword">const</span> bNum = birthDay.getFullYear() * <span class="number">10000</span> + (birthDay.getMonth() + <span class="number">1</span> ) * <span class="number">100</span> + birthDay.getDate();</span><br><span class="line">    <span class="keyword">if</span> (bNum &gt; tNum) &#123;</span><br><span class="line">        error = <span class="string">"birthday is future"</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        age = <span class="built_in">Math</span>.floor((tNum - bNum) / <span class="number">10000</span>);</span><br><span class="line">        <span class="keyword">if</span> (age &gt; <span class="number">120</span>) &#123;</span><br><span class="line">            error = <span class="string">"too old"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        age,</span><br><span class="line">        error,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã§ã‚ã‚Œã°è£œå®Œã‚‚åˆ©ãã—ã€<code>if (res.error)</code>ã¿ãŸã„ã«æ¡ä»¶åˆ†å²ã‚‚ç°¡å˜ã§ã™ã€‚</p><p>ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã®TypeScriptæœ¬ã§ã¯ã€æ­£å¸¸ç³»ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã€Errorã®åˆä½µå‹ã‚’è¿”ã—ã€å—ã‘å–ã‚Šå´ã§instanceofã‚’ä½¿ã£ã¦æ¡ä»¶ã‚ã‘ã‚’ã—ã¦ã„ã¾ã—ãŸã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã»ã†ãŒåˆ©ç”¨ã‚³ãƒ¼ãƒ‰å´ã®ã‚¿ã‚¤ãƒ—æ•°ã¯å°‘ãªã„ã®ã§å€‹äººçš„ã«ã¯å¥½ãã‹ãªã€ã¨æ€ã„ã¾ã—ãŸã€‚æ€ã„ã£ãã‚ŠGoé¢¨ã«å¯„ã›ã‚‹ãŸã‚ã«ã‚¿ãƒ—ãƒ«ã‚’ä½¿ã†ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€ãã‚Œã‚ˆã‚Šã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ–¹ãŒã‚‚ã‚ã‚‚ã‚è‰¯ã„æ°—ãŒã—ã¾ã™ï¼ˆå—ã‘æ‰‹ãŒåˆ†å‰²ä»£å…¥ã§å¤‰æ•°åã‚’è‡ªåˆ†ã§ã¤ã‘ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™æ™‚ã«undefinedã‚’å…¥ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹etcï¼‰ã€‚</p><h1 id="å‹æ¨è«–ã®é€”ä¸­ã§ã®å‹æ¼”ç®—"><a href="#å‹æ¨è«–ã®é€”ä¸­ã§ã®å‹æ¼”ç®—" class="headerlink" title="å‹æ¨è«–ã®é€”ä¸­ã§ã®å‹æ¼”ç®—"></a>å‹æ¨è«–ã®é€”ä¸­ã§ã®å‹æ¼”ç®—</h1><p>æ¨è«–ä¸­ã«å‹ã®æ¼”ç®—ã‚’è¡Œã„ãŸã„ã€ä¾‹ãˆã°ã€å…¥åŠ›ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨åŒä¸€ã®ã‚­ãƒ¼ã‚’æŒã¤ãŒã€ã‚·ã‚°ãƒãƒãƒ£ãŒå…¨ãåˆ¥ã®é–¢æ•°ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®šç¾©ã—ã¦ã€ãã‚Œã‚’è¿”ã‚Šå€¤ã«ä½¿ã„ãŸã„ã¨ã—ã¾ã™ã€‚ã¡ã‚‡ã†ã©ã€Redux <code>createSlice</code> ãŒã€<code>reducers</code>ã§æ¸¡ã•ã‚ŒãŸreducerãŒæ ¼ç´ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¼•æ•°ã«ã¨ã£ã¦ã€åŒã˜ã‚­ãƒ¼ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå…¥ã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã£ã¦ã€è¿”ã‚Šå€¤ã®<code>actions</code>ã«å…¥ã‚Œã¦è¿”ã—ã¦ã„ã¾ã™ã€‚</p><p>å‹æ¨è«–ã®æµã‚Œã¨ã—ã¦ã¯ã€å¼•æ•°â†’è¿”ã‚Šå€¤ã®ã‚ˆãã‚ã‚‹æ¨è«–ãªã®ã§ã™ãŒã€åŒã˜å‹<code>T</code>ã‚’ä½¿ã†ã®ã§ã¯ãªãã¦ã€ã¡ã‚‡ã£ã¨ã—ãŸæ¼”ç®—ãŒå¿…è¦ã§ã™ã€‚ã“ã®å ´åˆã¯ã€å¼•æ•°â†’é–¢æ•°ã®å‹å¤‰æ•°â†’è¿”ã‚Šå€¤ã¨ã€é–¢æ•°ã®å‹å¤‰æ•°ã‚’ãƒ¯ãƒ³ã‚¯ãƒƒã‚·ãƒ§ãƒ³ç½®ã‘ã°è‰¯ã„ã‚ˆã†ã§ã™ã€‚</p><p>ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ãªå‹å®šç¾©ã‚’ã€å‹ã‚’å¼•æ•°ã«æŒã¤é–¢æ•°ã¨è¦‹ç«‹ã¦ã¦ä½œæˆã—ã¾ã™ã€‚ã¾ãšã¯Reducersã¨ã€Actionsã‚’ä½œã‚Šã¾ã™ã€‚æ¨¡æ“¬ã‚³ãƒ¼ãƒ‰ãªã®ã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å¼•æ•°ã¯ãªã—ã€ã¨ã—ã¾ã™ã€‚</p><p>Reducersã¯é–¢æ•°ã®å¼•æ•°ã§æ¸¡ã•ã‚Œã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã€Actionsã¯è¿”ã‚Šå€¤ã§ä½¿ã†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚å¼•æ•°å´ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚ã‚¹ãƒ†ãƒ¼ãƒˆã®å‹ã‚’å¼•æ•°ã«ã¨ã£ãŸã‚‰ã€ãã‚Œã‚’å¼•æ•°ã«ã¨ã£ã¦ã€è¿”ã‚Šå€¤ã¨ã—ã¦è¿”ã™é–¢æ•°ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚Actionsã®æ–¹ã¯ã€å¼•æ•°ã®R(reducer)ã‚’å¼•æ•°ãƒ‹ãƒˆãƒªã€ãã‚Œã¨åŒã˜å±æ€§ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å€¤ã®å‹ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™é–¢æ•°ã§ã™ã€‚<code>{[P in keyof R]: å€¤ã®å‹}</code>ã§ã€åŒã˜ã‚­ãƒ¼ã‚’æŒã¤å€¤ã®å‹é•ã„ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚Šå‡ºã—ã¦ã„ã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Reducers&lt;S&gt; =  &#123;[key: <span class="built_in">string</span>]: <span class="function">(<span class="params">s: S</span>) =&gt;</span> S&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Actions&lt;R&gt; = &#123;[P <span class="keyword">in</span> keyof R]: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;&#125;;</span><br></pre></td></tr></table></figure><p>æ¬¡ã«createStateã‚’å®šç¾©ã—ã¾ã™ã€‚Sã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚å…ˆã»ã©å®šç¾©ã—ãŸActionsã¨Reducersã‚’ä½¿ã£ã¦é–¢æ•°å®šç¾©ã‚’çµ„ã¿ç«‹ã¦ã¦ã¿ã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createState</span>&lt;<span class="title">S</span> <span class="title">extends</span> </span>&#123;&#125;&gt;(state: S, reducers: Reducers&lt;S&gt;): &#123; actions: Actions&lt;Reducers&lt;S&gt;&gt; &#125; &#123;</span><br><span class="line">    <span class="keyword">const</span> actions = &#123;&#125; <span class="keyword">as</span> &#123;[key: <span class="built_in">string</span>]: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key of <span class="built_in">Object</span>.keys(reducers)) &#123;</span><br><span class="line">        actions[key] = <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="keyword">return</span> &#123;&#125; &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        actions: actions <span class="keyword">as</span> Actions&lt;Reducers&lt;S&gt;&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã§å®Œæˆã§ã—ã‚‡ã†ã‹ï¼Ÿå®Ÿã¯é•ã„ã¾ã™ã€‚<code>Reducers</code>ã¯ã€Œä»»æ„ã®ã‚­ãƒ¼ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã§ã™ã€‚reducersã¨ã€actionsã§ã€ãã‚Œãã‚Œ<code>Reducers</code>ã‚’ä½¿ã£ã¦ã„ã¾ã™ãŒã€ãã‚Œãã‚ŒãŒã€Œä»»æ„ã®ã‚­ãƒ¼ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã§ã‚ã‚Šã€ã“ã®2ã¤ãŒåŒã˜ã‚­ãƒ¼ã‚’æŒã¤ã¨ã„ã†ä¿è¨¼ã¯ã“ã®å‹å®šç¾©ã§ã¯è¡Œã‚ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€actionsã®ã©ã®ã‚­ãƒ¼ã‚’ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¦ã‚‚ã€ã‚¨ãƒ©ãƒ¼ã¯æ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã€‚</p><p>2ã¤ã®<code>Reducers&lt;S&gt;</code>ã‚’1ã¤ã«ã—ã¾ã™ã€‚ã“ã“ã§ã€é–¢æ•°ã®å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«1ã¤å‹å¤‰æ•°ã‚’è¿½åŠ ã—ã¾ã™ã€‚<code>extends</code>ã¯å‹ã«ãŠã‘ã‚‹ã€Œ=ã€ã¿ãŸã„ãªã‚‚ã®ã§ã™ã€‚é–¢æ•°ã®å‹å¤‰æ•°ã‚’ä¸€æ™‚çš„ãªå‹ç½®ãå ´ã«ä½¿ã£ã¦ã„ã¾ã™ã€‚ãã‚Œã‚’å…¥åŠ›å´ã¨ã€è¿”ã‚Šå€¤ã¨åŒã˜å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã“ã¨ã§ã€ã€Œã“ã®2ã¤ãŒåŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã§ã‚ã‚‹ã“ã¨ãŒè¡¨ç¾ã§ãã¾ã™ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createState</span>&lt;<span class="title">S</span> <span class="title">extends</span> </span>&#123;&#125;, ReducersType <span class="keyword">extends</span> Reducers&lt;S&gt;&gt;(state: S, reducers: ReducersType): &#123; actions: Actions&lt;ReducersType&gt; &#125; &#123;</span><br><span class="line">    <span class="keyword">const</span> actions = &#123;&#125; <span class="keyword">as</span> &#123;[key: <span class="built_in">string</span>]: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key of <span class="built_in">Object</span>.keys(reducers)) &#123;</span><br><span class="line">        actions[key] = <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="keyword">return</span> &#123;&#125; &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        actions: actions <span class="keyword">as</span> Actions&lt;ReducersType&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã§ã€æœŸå¾…é€šã‚Šã®ã€ã€ŒåŒã˜ã‚­ãƒ¼ã‚’æŒã¤åˆ¥ã®å‹ã€ã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‹ã«è¨­å®šã§ãã¾ã—ãŸã€‚</p><h1 id="ã“ã‚Œã‹ã‚‰ã®APIè¨­è¨ˆ"><a href="#ã“ã‚Œã‹ã‚‰ã®APIè¨­è¨ˆ" class="headerlink" title="ã“ã‚Œã‹ã‚‰ã®APIè¨­è¨ˆ"></a>ã“ã‚Œã‹ã‚‰ã®APIè¨­è¨ˆ</h1><p>Redux-Toolkitã®APIè¨­è¨ˆã‚’è¦‹ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã€ãã®ã‚³ãƒ¼ãƒ‰ã®ç’°å¢ƒï¼ˆå‹æ¨è«–ç”¨èªã§ã™ï¼‰ãŒã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®æ‰‹ä¼ã„ã‚’ã—ã¦ãã‚Œã‚‹ã‚ˆã†ãªAPIãƒ‡ã‚¶ã‚¤ãƒ³ã«ãªã£ã¦ã„ã¾ã™ã€‚</p><ul><li>ã‚³ãƒ¼ãƒ‰è£œå®ŒãŒã±ã¡ã£ã¨æ±ºã¾ã‚‹</li><li>æ¨è«–ãŒæ±ºã¾ã‚‹(å‹å¤‰æ•°ã‚’æ˜ç¤ºçš„ã«è¨­å®šã—ãªãã¦ã‚‚ã„ã„)</li><li>ã‚¨ãƒ©ãƒ¼ãŒå³åº§ã«åˆ†ã‹ã‚‹</li><li>ä½™è¨ˆãªå‹å®šç¾©ã‚„å®šæ•°å®šç¾©ãªã©ã‚’ã—ãªãã¦ã‚‚æ¸ˆã‚€ã€å¿…è¦ã§ã‚ã£ã¦ã‚‚ã€ä½¿ã†å ´æ‰€ã¨å®šç¾©ä½ç½®ãŒã¨ã¦ã‚‚è¿‘ã„ã€‚</li></ul><p>ä¸€è¨€ã§è¨€ãˆã°ã€ã€Œè¨˜æ†¶åŠ›ã‚’ã‚ã¾ã‚Šå¿…è¦ã¨ã—ãªã„ã€ã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒã§ãã¾ã™ã€‚ãŠãã‚‰ãã€åŒã˜ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’ç”£ã¿å‡ºã™ãŸã‚ã®è„³ã®é…¸ç´ ä½¿ç”¨é‡ãŒå°‘ãªã„ã€ã¿ãŸã„ãªæ„Ÿã˜ã§ã€Œã‚ã‹ã‚Šã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã€ã¯å®šé‡çš„ã«è¨ˆæ¸¬ã¯å¯èƒ½ãªæ°—ãŒã—ã¾ã™ã€‚ã¾ã‚è©¦ã—ãŸã“ã¨ã¯ãªã„ã§ã™ãŒã€‚</p><p>ã‚³ãƒ¼ãƒ‰è£œå®ŒãŒã°ã¡ã£ã¨æ±ºã¾ã£ã¦æ¨è«–ãŒæ±ºã¾ã‚‹ã®ã¯ã€anyã‚„unknownã«ãªã‚Šã«ãã„è¨­è¨ˆã§ã™ã­ã€‚ã„ã‚ã„ã‚ãªå‹æ¨è«–ã‚’ç´¹ä»‹ã—ã¦ãã¾ã—ãŸãŒã€å¤§ããªæµã‚Œã¨ã—ã¦ã¯å¤§ãã2ã¤ã§ã™ã­ã€‚æ¨è«–ã®èµ·ç‚¹ã¨ãªã‚‹ã®ã¯ã€é–¢æ•°ã®å¼•æ•°ã¨ã‚¯ãƒ©ã‚¹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ã®2ç®‡æ‰€ã§ã™ã€‚åŸºæœ¬çš„ã«ã¯ã“ã®æµã‚Œã«ã†ã¾ãä¹—ã‚‹ã€ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚</p><ul><li>å¼•æ•°â†’é–¢æ•°ã®å‹å¤‰æ•°ã€è¿”ã‚Šå€¤</li><li>ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°â†’ã‚¯ãƒ©ã‚¹ã®å‹å¤‰æ•°â†’ãƒ¡ãƒ³ãƒãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã‚„è¿”ã‚Šå€¤</li></ul><p>Reduxã‚„Redux Toolkitã‚’ä½¿ã†ã«ã‚ãŸã£ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯Stateã¯å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¾ã‚ã“ã‚Œã¯Reduxã‚’ä½¿ã†ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é–¢å¿ƒã”ã¨ãã®ã‚‚ã®ãªã®ã§ã€ã“ã‚Œã¯è‰¯ã„ã§ã—ã‚‡ã†ã€‚ã“ã‚Œã‚’ä¸€åº¦è¨­è¨ˆã—ãŸã‚‰ã“ã‚Œã‚’æœ€å¤§é™ã«æ´»ç”¨ã§ãã‚‹ã€ã¨ã„ã†ã®ãŒç›®æŒ‡ã™ä¸–ç•Œã§ã™ã€‚ã‚·ãƒ³ãƒ—ãƒ«ãªå…¥å‡ºåŠ›ã ã‘ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚Œã°å¼•æ•°ã‹ã‚‰æ¨è«–ã‚’ãã¡ã‚“ã¨ã—ã¾ã—ã‚‡ã†ã€ã§å®Œçµã§ã™ãŒã€Redux-Toolkitã¨ã‹ã®ã‚ˆã†ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæŒ‡å®šã—ãŸãƒ‡ãƒ¼ã‚¿å‹ã‚’å…¥åŠ›ã‹å‡ºåŠ›ã«ä½¿ã†reducerã®ã‚ˆã†ãªï¼ˆåˆ¥ã®ä¾‹ã ã¨ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ç”¨èªã§ã„ã†ã¨ã“ã‚ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆã€ã‚ã‚‹ã„ã¯GUIã®ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒãƒ³ãƒ‰ãƒ©ï¼‰ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„å ´é¢ãŒã€ãã“ãã“è¤‡é›‘ãªã‚±ãƒ¼ã‚¹ã§ã™ã€‚</p><p>Redux-Toolkitã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚‹é–¢æ•°ã¨ã„ã†å½¢æ…‹ã§ã—ãŸã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> State = &#123;</span><br><span class="line">    name: <span class="built_in">string</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState: State = &#123;</span><br><span class="line">    name: <span class="string">"shibukawa"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">createSlice(initialState, &#123;</span><br><span class="line">    greeting: <span class="function">(<span class="params">s</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`hello <span class="subst">$&#123;s.name&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>äººã«ã‚ˆã£ã¦ã¯ã€Œã‚¯ãƒ©ã‚¹ã‚’ä½¿ã£ã¦ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚‚å®šç¾©ã—ãŸã„ã€ã¨æ€ã†æ–¹ã‚‚ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ã‚ˆãã‚ˆãè€ƒãˆã‚‹ã¨ã€Redux-Toolkitã‚¹ã‚¿ã‚¤ãƒ«ä»¥å¤–ã¯é›£ã—ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p><p>ã€Œé–¢æ•°ã®å…¥ã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã¨ã„ã†ã®ã¯ã€ã‚¯ãƒ©ã‚¹ãŒãªã‹ã£ãŸæ™‚ä»£ã«ã¿ã‚“ãªãŒã‚ªãƒ¬ã‚ªãƒ¬ã‚¯ãƒ©ã‚¹ä½œã£ã¦ã„ãŸã¨ãã«ã‚ˆãè¦‹ã‹ã‘ãŸæ‚ªã„æ…£ç¿’ã§ã™ãŒã€TypeScriptçš„ã«ã¯æ‰±ã„ã‚„ã™ã„ã®ã§ã™ã€‚é–¢æ•°ã®ã‚·ã‚°ãƒãƒãƒ£ã‚’åŒä¸€ã«ãã‚ãˆã‚‹ã“ã¨ãŒç°¡å˜ã§ã™ã€‚å‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ä½¿ãˆã°ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚­ãƒ¼ä¸€è¦§ãŒå–å¾—ã§ãã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®šç¾©ã—ãŸreducerã®ãƒªã‚¹ãƒˆã‚’ä½¿ã£ã¦ã€å‹è£œå®Œã‚’åˆ©ç”¨ã—ãªãŒã‚‰actionsã‚’ä½œã‚Šå‡ºã™ã“ã¨ã‚‚ã§ãã¾ã—ãŸã€‚</p><p>ã‚¯ãƒ©ã‚¹ã‚‚ä¸€å¿œã€ã‚­ãƒ¼ã®ä¸€è¦§ã®å–å¾—ã¾ã§ã¯å¯èƒ½ã§ã™ã€‚ãŸã ã€å–å¾—ã¯ã§ãã¦ã‚‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»»æ„ã®åå‰ã§å®šç¾©ã™ã‚‹æ–°ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦ã€ç‰¹å®šã®ã‚·ã‚°ãƒãƒãƒ£ã‚’è¦æ±‚ã—ã¦ã€ãã‚Œä»¥å¤–ãŒä½œæˆã•ã‚ŒãŸã‚‰ç·¨é›†ä¸­ã«ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã™ã€ã¨ã„ã†ã®ã¯ã§ããªã„ã‚“ã˜ã‚ƒãªã„ã§ã™ã‹ã­ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> A &#123;</span><br><span class="line">    methodA(a :State) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    methodB(a :State) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> keys = keyof A; <span class="comment">// "methodA" | "methodB"</span></span><br></pre></td></tr></table></figure><p>ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—GUIæ™‚ä»£ã«ã‚ˆãç”¨ã„ã‚‰ã‚Œã¦ã„ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚ˆã†ã«ã€å›ºå®šã®åå‰ã ã‘ã‚’è¨±ã™å ´åˆã«ã¯ã‚¯ãƒ©ã‚¹ã§ã‚‚å¯èƒ½ã§ã™ã€‚Reactã‚„Vue.jsã®ã‚¯ãƒ©ã‚¹æ–¹å¼ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãã‚Œã§ã™ã­ã€‚ã—ã‹ã—ã€å„ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚·ã‚°ãƒ‹ãƒãƒ£ã‚’å¼·åˆ¶ã™ã‚‹ã“ã¨ã¾ã§ã¯ã§ãã¾ã›ã‚“ã€‚reducersã®ã‚ˆã†ã«ã€ä»»æ„ã®ã‚­ãƒ¼ã§å®šç¾©ã‚’å¢—ã‚„ã›ã‚‹ã‚ˆã†ãªã‚‚ã®ã¯ã€Œé–¢æ•°ã‚’å€¤ã«æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã«ã›ã–ã‚‹ã‚’ãˆãªã„ã‹ãªã€ã¨æ€ã„ã¾ã™ã€‚</p><p>ãªãŠã€JavaScriptãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å®Œå…¨ã«ç„¡è¦–ã™ã‚‹ãªã‚‰ã€åˆ¥ã®æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚AngularãŒDIã‚’å®Ÿç¾ã™ã‚‹ã®ã«ã¤ã‹ã£ã¦ã„ã‚‹ï¼ˆã¨æ€ã†ï¼‰ã®ãŒã€tsconfigã®<code>emitDecoratorMetadata</code>ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®è£ã§ã¯<a href="https://www.npmjs.com/package/reflect-metadata" target="_blank" rel="noopener">reflect-metadata</a>ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä½¿ã‚ã‚Œã¦ã„ã¦ã€å‹æƒ…å ±ã‚’å‹•çš„ã«å–å¾—ã—ã¦ã•ã¾ã–ã¾ãªã“ã¨ã‚’å®Ÿç¾ã—ã¾ã™ã€‚ãŸã ã—ã€ã“ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸå‹•çš„ãªãƒ­ã‚¸ãƒƒã‚¯ã¯ã‚¨ãƒ‡ã‚£ã‚¿ã®è£œå®Œã‚„ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ™‚ã®ãƒã‚§ãƒƒã‚¯ã¯ã—ã¦ãã‚Œãªã„ã®ã§ã€å‹æƒ…å ±ã¨æ¨è«–ã‚’ä½¿ã£ãŸæ–¹ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ“ãƒªãƒ†ã‚£ã¯é«˜ã„æ°—ãŒã—ã¾ã™ã€‚</p><h1 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h1><p>TypeScriptã®å‹ã¨ã„ã†ã¨ã€ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã€ãƒŸã‚¹ã®å‰Šæ¸›ã€ã¿ãŸã„ãªè«–èª¿ã§èªã‚‰ã‚Œã‚‹ã“ã¨ãŒ99%ã§ã™ãŒã€ä½¿ã†äººã«ã¨ã£ã¦ä½¿ã„ã‚„ã™ã„APIã¨ã„ã†ã®ã‚’æ–°ã—ãä½œã‚Šå‡ºã›ã‚‹ã®ã§ã¯ãªã„ã‹ã€ã¨ã„ã†ã“ã¨ã§æ€è€ƒå®Ÿé¨“ã—ã¦ã¿ã¾ã—ãŸã€‚</p><p>JavaScriptæ™‚ä»£ã¯å‹ãŒãªã‹ã£ãŸã®ã§ã€æ¬¡ã®ã‚ˆã†ãªè¨­è¨ˆã‚‚ã‚ˆãä½œã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚ã‚ã¨ã¯jQueryã¨ã‹ã§ã™ã­ã€‚ãã®æ‰‹ã®è¨­è¨ˆã¯JavaScriptæ™‚ä»£ã«ã¯ã‚ˆã‹ã£ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€TypeScriptæ™‚ä»£ã«ã¯ã¾ãŸåˆ¥ã®è¨­è¨ˆãŒå¿…è¦ã¨æ€ã£ã¦ã„ã¾ã™ã€‚ã‚‚ã¡ã‚ã‚“ã€â†“ã®ã‚ˆã†ãªå‹å®šç¾©ã‚‚ã§ãã¦ã€æ–‡å­—åˆ—ã®åå‰ã«ã‚ˆã£ã¦ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã®å¼•æ•°ã®Eventã®å‹ãŒå¤‰ã‚ã£ãŸã‚Šã€è¿”ã‚Šå€¤ã®å‹ãŒå¤‰ã‚ã£ãŸã‚Šï¼ˆ<code>createElement</code>ã®ã‚ˆã†ã«ï¼‰ã¨ã‹ã€ãã®æ‰‹ã®å³ã—ã„è¦ä»¶ã«ã‚‚é©åˆã™ã‚‹ã‚ˆã†ã«TypeScriptã§ã¯æ©Ÿèƒ½ã‚’æŒã£ã¦ã„ãŸã‚Šã‚‚ã—ã¾ã™ãŒï¼ˆã‚ªãƒ©ã‚¤ãƒªãƒ¼ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°TypeScriptã®P65ã‚ãŸã‚Šï¼‰ã€ãã‚Œã¯ã‚ãã¾ã§ã‚‚éå»ã¨ç¾åœ¨ã‚’ã¤ãªã’ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã‚ã£ã¦ã€æœªæ¥ã«ä½¿ã†æ–‡æ³•ã§ã¯ãªã„ã¨æ€ã†ã®ã§ã™ã‚ˆã­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.on(<span class="string">"ã‚¤ãƒ™ãƒ³ãƒˆå"</span>, ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©)</span><br></pre></td></tr></table></figure><p>Vue.js 3ã‚‚ã€ä»Šã¾ã§ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒ³ãƒˆã¨ã—ã¦ã„ãŸæ–¹å‘ã‹ã‚‰ã€defineComponenté–¢æ•°ã®å¼•æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§å®šç¾©ã¨ãªã‚Šã¾ã—ãŸã€‚ãƒ™ãƒ¼ã‚¿ç‰ˆã®vue-cliã ã¨ã€ã‚‚ã¨ã‚‚ã¨TSã¨ã®ç›¸æ€§ãŒæ‚ªããªã‹ã£ãŸã‚¯ãƒ©ã‚¹ã®æ–¹ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãªã£ã¦ãŠã‚Šï¼ˆé¸æŠè‚¢ãŒã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ä½¿ã†ã‹(Y/n)ã¨ãªã£ã¦ãŠã‚Šã€ã‚¨ãƒ³ã‚¿ãƒ¼é€£æ‰“ã ã¨ã“ã¡ã‚‰ã§ã¯ãªãã€ã‚¯ãƒ©ã‚¹ã®æ–¹ã«ãªã‚‹)ã€ã“ã¡ã‚‰ãŒã©ã‚Œã ã‘æ™®åŠã™ã‚‹ã‹ã¯åˆ†ã‹ã‚‰ãªã„ã§ã™ãŒã€ã“ã‚Œã‚‚TypeScriptã«ã‚ˆã‚Šãã£ãŸè¨­è¨ˆå¤‰æ›´ãªã‚“ã˜ã‚ƒãªã„ã§ã™ã‹ã­ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">defineComponent(&#123;</span><br><span class="line">   <span class="comment">// ã“ã“ãªã‚‰è£œå®Œã‚„ãƒã‚§ãƒƒã‚¯ãŒããï¼</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>JavaScript===TypeScriptãŒåãå‡ºã™ç‰©ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºè€…ã¯TypeScriptã—ã‹æ›¸ã‹ãªã„ã¨ã„ã†æ™‚ä»£ã«ã‚ã‚ã›ãŸAPIãƒ‡ã‚¶ã‚¤ãƒ³ã«ã¤ã„ã¦ã€ä¸€ç·’ã«è€ƒãˆã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/20200730/top.png&quot;&gt;


&lt;p&gt;TypeScriptã¯ã€JavaScriptã®ã•ã¾ã–ã¾ãªãƒ•ãƒªãƒ¼ãƒ€ãƒ ãªæ›¸ãæ–¹ã‚’å—ã‘å…¥ã‚Œã€æ¼¸é€²çš„ãªå‹ä»˜ã‘ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨ã„ã†&lt;del&gt;ç‹‚ã£ãŸ&lt;/del&gt;é«˜é›£æ˜“åº¦ãªç›®çš„ã®ãŸã‚ã«ä½œæˆã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒ
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="TypeScript" scheme="https://future-architect.github.io/tags/TypeScript/"/>
    
  </entry>
  
  <entry>
    <title>AWSèªå®š Machine learning specialty åˆæ ¼è¨˜</title>
    <link href="https://future-architect.github.io/articles/20200729/"/>
    <id>https://future-architect.github.io/articles/20200729/</id>
    <published>2020-07-28T15:00:00.000Z</published>
    <updated>2020-07-31T04:56:13.051Z</updated>
    
    <content type="html"><![CDATA[<p>TIGã®ä¼Šè—¤çœŸå½¦ã§ã™ã€‚</p><p>å…ˆæ—¥ã‚‚ã†ä¸€äººã®ä¼Šè—¤ã•ã‚“ãŒ<a href="https://future-architect.github.io/articles/20200629/">Terraform Associateåˆæ ¼è¨˜</a>ã‚’æ›¸ã„ã¦ãã‚Œã¾ã—ãŸã€‚ã“ã®è¨˜äº‹ã«ç¶šã„ã¦è³‡æ ¼ã®è¨˜äº‹ã‚’æ›¸ã„ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚ä½™è«‡ã§ã™ãŒã“ã¡ã‚‰ã®ä¼Šè—¤ã•ã‚“ã¨ã®åŒºåˆ¥ãŒã¤ãã‚ˆã†ã«è‡ªå·±ç´¹ä»‹ã¯ãƒ•ãƒ«ãƒãƒ¼ãƒ ã§æ›¸ã„ã¦ã„ã¾ã™ã€‚</p><p>ç§ã¯AWSã®è³‡æ ¼ã‚’4ã¤ã»ã©æŒã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€ä»Šå›ã¯<a href="https://aws.amazon.com/jp/certification/certified-machine-learning-specialty/" target="_blank" rel="noopener">AWSèªå®š æ©Ÿæ¢°å­¦ç¿’ - å°‚é–€çŸ¥è­˜</a>ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚ã¡ãªã¿ã«æ©Ÿæ¢°å­¦ç¿’ã®è³‡æ ¼ã¯å®Ÿå‹™çµŒé¨“0ã‹ã‚‰2ã‚«æœˆã»ã©å­¦ç¿’ã—ã¦åˆæ ¼ã—ã¾ã—ãŸã€‚</p><p>å‰æçŸ¥è­˜0ã®äººã‚‚å¯¾è±¡ã«ãªã‚‹ã‚ˆã†ãªè¨˜äº‹ã‚’ç›®æŒ‡ã—ã¦è¨˜è¼‰ã—ã¾ã™ã€‚</p><img src="/images/20200729/badge.png" class="img-small-size"><h1 id="ã“ã®è¨˜äº‹ã®ç›®çš„"><a href="#ã“ã®è¨˜äº‹ã®ç›®çš„" class="headerlink" title="ã“ã®è¨˜äº‹ã®ç›®çš„"></a>ã“ã®è¨˜äº‹ã®ç›®çš„</h1><p>AWSèªå®šè©¦é¨“ã§è¦æ±‚ã•ã‚Œã‚‹çŸ¥è­˜ã€å­¦ç¿’æ³•ã«ã¤ã„ã¦ã¾ã¨ã‚ã¾ã™ã€‚<br>å¤§ã¾ã‹ãªæ¦‚è¦ã€å„åˆ†é‡ã®å…·ä½“çš„ãªå†…å®¹ã‚’è¨˜è¼‰ã—ã¦ã„ãã¾ã™ã€‚</p><h2 id="ç›®æ¬¡"><a href="#ç›®æ¬¡" class="headerlink" title="ç›®æ¬¡"></a>ç›®æ¬¡</h2><ol><li>AWS èªå®š æ©Ÿæ¢°å­¦ç¿’ â€“ å°‚é–€çŸ¥è­˜ã¨ã¯</li><li>è¦æ±‚ã•ã‚Œã‚‹çŸ¥è­˜</li><li>å­¦ç¿’æ–¹æ³•ã«ã¤ã„ã¦</li><li>ã¾ã¨ã‚</li></ol><p><a id="anchor1"></a></p><h1 id="AWS-èªå®š-æ©Ÿæ¢°å­¦ç¿’-â€“-å°‚é–€çŸ¥è­˜ã¨ã¯"><a href="#AWS-èªå®š-æ©Ÿæ¢°å­¦ç¿’-â€“-å°‚é–€çŸ¥è­˜ã¨ã¯" class="headerlink" title="AWS èªå®š æ©Ÿæ¢°å­¦ç¿’ â€“ å°‚é–€çŸ¥è­˜ã¨ã¯"></a>AWS èªå®š æ©Ÿæ¢°å­¦ç¿’ â€“ å°‚é–€çŸ¥è­˜ã¨ã¯</h1><p>ãã®åã®é€šã‚Šã€AIé–‹ç™ºã€ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã‚’æ¥­å‹™ã§è¡Œã†äººå‘ã‘ã®è³‡æ ¼è©¦é¨“ã§ã™ã€‚<br>AWSã®èªå®šè©¦é¨“ã®ä¸­ã§ã¯çã—ãã€AWSã®ã‚µãƒ¼ãƒ“ã‚¹ã«ç‰¹åŒ–ã—ãŸè©¦é¨“ã§ã¯ãªãæ©Ÿæ¢°å­¦ç¿’ã®åŸºç¤çŸ¥è­˜ã‚‚è¦æ±‚ã•ã‚Œã‚‹ç‚¹ãŒç‰¹å¾´ã§ã™ã€‚<br><a id="anchor2"></a></p><h1 id="è¦æ±‚ã•ã‚Œã‚‹çŸ¥è­˜"><a href="#è¦æ±‚ã•ã‚Œã‚‹çŸ¥è­˜" class="headerlink" title="è¦æ±‚ã•ã‚Œã‚‹çŸ¥è­˜"></a>è¦æ±‚ã•ã‚Œã‚‹çŸ¥è­˜</h1><p><a href="https://aws.amazon.com/jp/certification/certified-machine-learning-specialty/" target="_blank" rel="noopener">AWSèªå®šã®å…¬å¼ã‚µã‚¤ãƒˆ</a>ã«ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚</p><blockquote><p>èªå®šã«ã‚ˆã£ã¦æ¤œè¨¼ã•ã‚Œã‚‹èƒ½åŠ›</p><ul><li>ä¸ãˆã‚‰ã‚ŒãŸãƒ“ã‚¸ãƒã‚¹ã®å•é¡Œã«å¯¾ã—ã€é©åˆ‡ãª ML ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’é¸ã³ã€ãã®ç†ç”±ã‚’èª¬æ˜ã§ãã‚‹</li></ul></blockquote><ul><li>ML ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ã«é©ã—ãŸ AWS ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’é¸æŠã™ã‚‹</li><li>ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã€ã‚³ã‚¹ãƒˆåŠ¹ç‡ã€ä¿¡é ¼æ€§ã€å®‰å…¨æ€§ã«å„ªã‚ŒãŸ ML ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­è¨ˆã—ã€å®Ÿè£…ã™ã‚‹</li></ul><blockquote><p>æ¨å¥¨ã•ã‚Œã‚‹çŸ¥è­˜ã¨çµŒé¨“</p><ul><li>AWS ã‚¯ãƒ©ã‚¦ãƒ‰ã§ã® ML/æ·±å±¤å­¦ç¿’ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã®é–‹ç™ºã€è¨­è¨ˆã€å®Ÿè¡Œã«ãŠã‘ã‚‹ã€1ï½2 å¹´ã®çµŒé¨“</li></ul></blockquote><ul><li>åŸºæœ¬çš„ãª ML ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®åŸºã¨ãªã‚‹è€ƒãˆã‚’è¡¨ç¾ã™ã‚‹èƒ½åŠ›</li><li>åŸºæœ¬çš„ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®å®Ÿè·µçµŒé¨“</li><li>ML ãŠã‚ˆã³æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ä½¿ç”¨çµŒé¨“</li><li>ãƒ¢ãƒ‡ãƒ«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹èƒ½åŠ›</li><li>ãƒ‡ãƒ—ãƒ­ã‚¤ã¨é‹ç”¨ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹èƒ½åŠ›</li></ul><p>è‡ªåˆ†ã®å—é¨“çµŒé¨“ã‹ã‚‰è¦æ±‚ã•ã‚Œã‚‹çŸ¥è­˜ã‚’ä¸‹è¨˜ã®ã‚«ãƒ†ã‚´ãƒªã«åˆ†é¡ã—ã¾ã—ãŸã€‚</p><ul><li>ç›®çš„ã«å¯¾ã—æœ€é©ãªæ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜</li><li>ä½œæˆã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜</li><li>ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã«é–¢ã™ã‚‹çŸ¥è­˜</li><li>åˆ†æ•£å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ãªã©ã‚¤ãƒ³ãƒ•ãƒ©å¯„ã‚Šã®çŸ¥è­˜</li><li>æ©Ÿæ¢°å­¦ç¿’ã®AWSãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹çŸ¥è­˜</li><li>ã‚µãƒ¼ãƒ“ã‚¹ã®æ§‹ç¯‰ã€é‹ç”¨ã«é–¢ã™ã‚‹çŸ¥è­˜</li></ul><h2 id="ç›®çš„ã«å¯¾ã—æœ€é©ãªæ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜"><a href="#ç›®çš„ã«å¯¾ã—æœ€é©ãªæ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜" class="headerlink" title="ç›®çš„ã«å¯¾ã—æœ€é©ãªæ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜"></a>ç›®çš„ã«å¯¾ã—æœ€é©ãªæ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜</h2><p>æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã«ã¯ã•ã¾ã–ã¾ãªå­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒå­˜åœ¨ã—ã¾ã™ã€‚<br>æ©Ÿæ¢°å­¦ç¿’ã‚’ç”¨ã„ã¦èª²é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€ç›®çš„ã«å¯¾ã—æœ€é©ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®é¸æŠã‚’è¡Œã†çŸ¥è­˜ãŒè¦æ±‚ã•ã‚Œã¾ã™ã€‚</p><p>ä¾‹ãˆã°ç”»åƒåˆ†é¡ã«ã¯CNN(ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯)ãŒã€æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šæ‰±ã„ã«ã¯RNN(å†å¸°å‹ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯)ã‚’é¸å®šã§ãã‚‹ã‚ˆã†ãªçŸ¥è­˜ã§ã™ã€‚</p><p>è¨€èªå‡¦ç†ã«ç‰¹åŒ–ã—ãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€éŸ³å£°å‡¦ç†ã«ãŠã‘ã‚‹æœ€é©è§£ãªã©ã€ç›®çš„ã‹ã‚‰æ‰‹æ®µã‚’å°ãå‡ºã™ãŸã‚ã«ã¯ã“ã‚Œã‚‰ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒã©ã®ã‚ˆã†ãªåˆ†é‡ã‚’å¾—æ„ã¨ã™ã‚‹ã‹ã‚’å­¦ã¶å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ç·šå½¢å­¦ç¿’ã‚„ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ãªã©åŸºç¤çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚„ã€CNNã€RNNã®ç‰¹å¾´ã€tf-idfãªã©ã®ä¸€èˆ¬çš„ãªçŸ¥è­˜ã‚’ç†è§£ã§ãã¦ã„ã‚‹äº‹ãŒè¦æ±‚ã•ã‚Œã¾ã™ã€‚ç‰¹ã«ã€<a href="https://aws.amazon.com/jp/sagemaker/" target="_blank" rel="noopener">Amazon SageMaker</a>ã§æä¾›ã•ã‚Œã‚‹çµ„ã¿è¾¼ã¿ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¦‚è¦ã‚’ç†è§£ã—ã¦ã€å„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç‰¹å¾´ã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç¨®é¡ã€æ¦‚è¦ã¯<a href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/algos.html" target="_blank" rel="noopener">Amazon SageMakerã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><p>ä¾‹ãˆã°ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®è¨˜äº‹ã¨è¦ç´„ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å­¦ç¿’ã•ã›ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ã‹ã‚‰è¦ç´„ã‚’è‡ªå‹•ç”Ÿæˆã—ãŸã„ã€ã¨ã„ã†ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒå‡ºé¡Œã•ã‚Œã€4æŠç¨‹åº¦ã®SageMakerçµ„ã¿è¾¼ã¿ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒé¸æŠè‚¢ã¨ã—ã¦ç”¨æ„ã•ã‚Œã¾ã™ã€‚<br>ãã®ä¸­ã‹ã‚‰Sequence to Sequenceãªã©ã‚’é¸ã¹ã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ãŒç›®çš„ã§ã™ã€‚<br>ä¾‹é¡Œ</p><blockquote><p>ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆã®ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚<br>ãŠå•ã„åˆã‚ã›ã®å†…å®¹ã®é¡ä¼¼æ€§ã«åŸºã¥ã„ã¦ã€é‡è¤‡ã™ã‚‹è³ªå•ã‚’ç‰¹å®šã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚<br>ã“ã®å•é¡Œã®è§£æ±ºã«ã©ã®SageMakerã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒåˆ©ç”¨ã§ãã¾ã™ã‹ã€‚<br>A: BlazingText<br>B: Object2Vec<br>C: K-means<br>D: DeepAR</p></blockquote><blockquote><p>æ­£è§£: B</p></blockquote><h2 id="ä½œæˆã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜"><a href="#ä½œæˆã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜" class="headerlink" title="ä½œæˆã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜"></a>ä½œæˆã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã®çŸ¥è­˜</h2><p>æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’ç¤ºã™æŒ‡æ¨™ã¨ã—ã¦ã€æ­£ç¢ºåº¦ï¼ˆaccuracyï¼‰ã€ç²¾åº¦ï¼ˆprecisionï¼‰ã€å†ç¾ç‡ï¼ˆrecallï¼‰ã¨ã„ã£ãŸæ¦‚å¿µãŒå­˜åœ¨ã—ã¾ã™ã€‚å°‘ã—é«˜åº¦ãªã‚‚ã®ã§ã¯AUCã€ROCãªã©ã®æŒ‡æ¨™ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ã“ã‚Œã‚‰ã®æŒ‡æ¨™ã‚„ã€æŒ‡æ¨™ã®æ¸¬å®šã§ç”¨ã„ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹TPã€FPã€TNã€FN(çœŸé™½æ€§ã€å½é™½æ€§ã€çœŸé™°æ€§ã€å½é™°æ€§)ã«ã¤ã„ã¦ç†è§£ã™ã‚‹ã“ã¨ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚TPã€FPã€TNã€FNãŒãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§ã¾ã¨ã‚ã‚‰ã‚ŒãŸè¡¨ã‹ã‚‰ç²¾åº¦ã‚’è¨ˆç®—ã™ã‚‹ã‚ˆã†ãªå•é¡Œã‚‚å‡ºé¡Œã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆæ•°å­—ã¨ã—ã¦ã¯ãã®å ´ã§é›»å“ã‚’ä½¿ã‚ãšã«è¨ˆç®—ã§ãã‚‹ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚ï¼‰</p><p>ã¾ãŸã€æ§‹ç¯‰ã—ãŸã„ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã©ã®æŒ‡æ¨™ãŒé‡è¦è¦–ã•ã‚Œã‚‹ã®ã‹ã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã‚¹ãƒ‘ãƒ ãƒ¡ãƒ¼ãƒ«ã‚’æ¤œçŸ¥ã™ã‚‹æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦æœ€ã‚‚é‡è¦è¦–ã•ã‚Œã‚‹æŒ‡æ¨™ã¯æ­£ç¢ºåº¦ã€ç²¾åº¦ã€å†ç¾ç‡ã®ã†ã¡ã©ã‚Œã‹ã‚’ç­”ãˆã‚‹ã‚ˆã†ãªå•é¡ŒãŒå‡ºé¡Œã•ã‚Œã¾ã™ã€‚</p><p>ä¾‹é¡Œ</p><blockquote><p>ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹Aç¤¾ã§ã¯ã€é¡§å®¢ã®è§£ç´„ã‚’é˜²ããŸã‚ã€é¡§å®¢ãŒè§£ç´„ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’äºˆæ¸¬ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’2ã¤æ§‹ç¯‰ã—ã¾ã—ãŸã€‚<br>ãƒ¢ãƒ‡ãƒ«Aã¯ã€100ã®å½é™°æ€§ï¼ˆFNï¼‰ã¨40ã®å½é™½æ€§ï¼ˆFPï¼‰ã§92ï¼…ã®ç²¾åº¦ã§ã™ã€‚<br>ãƒ¢ãƒ‡ãƒ«Bã¯ã€40ã®FNã¨100ã®FPã§92ï¼…ã®ç²¾åº¦ã§ã—ãŸã€‚<br>2ã¤ã®ãƒ¢ãƒ‡ãƒ«ã®ã©ã¡ã‚‰ãŒAç¤¾ã«ã¨ã£ã¦ã‚³ã‚¹ãƒˆåŠ¹æœãŒé«˜ã„ã§ã—ã‚‡ã†ã‹ã€‚</p><p>æ­£è§£: ãƒ¢ãƒ‡ãƒ«B</p></blockquote><h2 id="æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½å‘ä¸Šã«é–¢ã™ã‚‹çŸ¥è­˜"><a href="#æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½å‘ä¸Šã«é–¢ã™ã‚‹çŸ¥è­˜" class="headerlink" title="æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½å‘ä¸Šã«é–¢ã™ã‚‹çŸ¥è­˜"></a>æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½å‘ä¸Šã«é–¢ã™ã‚‹çŸ¥è­˜</h2><p>æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã§ã¯ã€æœŸå¾…ã—ãŸæ€§èƒ½ã®ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã§ããªã„å ´åˆã«ãã®åŸå› ã‚’æ¨æ¸¬ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><ul><li>æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ãŒéå­¦ç¿’ã®çŠ¶æ…‹ã«é™¥ã£ãŸéš›ã«ãƒ‡ãƒ¼ã‚¿ã«ã©ã®ã‚ˆã†ãªå‰å‡¦ç†ã‚’æ–½ã™ã‹ã€‚</li><li>å……åˆ†ãªæ•°ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãŒé›†ã¾ã£ã¦ã„ãªã„å ´åˆã«ã©ã®ã‚ˆã†ãªæ‰‹æ®µã§æ€§èƒ½ã®é«˜ã„æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã‹</li></ul><p>ã¨ã„ã£ãŸãƒˆãƒ”ãƒƒã‚¯ã«å¯¾ã™ã‚‹å•é¡ŒãŒå‡ºé¡Œã•ã‚Œã¾ã™ã€‚</p><p>æ­£è¦åŒ–ã€æ­£å‰‡åŒ–ã€ãƒ‡ãƒ¼ã‚¿ã®æ°´å¢—ã—ã€ç®±ã²ã’å›³ã®èª­ã¿å–ã‚Šæ–¹ã€å­¦ç¿’ç‡ãªã©ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¿æ•´ã¨ã„ã£ãŸæ©Ÿæ¢°å­¦ç¿’ã®çŸ¥è­˜ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚</p><p>ä¾‹é¡Œ</p><blockquote><p>ä½œæˆã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ãŒã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã§ã¯é«˜ç²¾åº¦ã§ã‚ã‚‹ãŒã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ä½ç²¾åº¦ã§ã‚ã‚‹ã“ã¨ã«æ°—ä»˜ãã¾ã—ãŸã€‚<br>ã“ã®å•é¡Œã®è§£æ±ºãŒè¦‹è¾¼ã‚ã‚‹æ‰‹æ³•ã¯ã©ã‚Œã§ã—ã‚‡ã†ã‹ã€‚<br>A: ãƒ‡ãƒ¼ã‚¿ã®æ­£å‰‡åŒ–å‡¦ç†ã‚’å‰Šé™¤ã™ã‚‹<br>B: ä½¿ç”¨ã™ã‚‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’å°‘ãªãã™ã‚‹<br>C: ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰åˆ©ç”¨ã™ã‚‹ç‰¹å¾´é‡ã‚’æ¸›ã‚‰ã™</p></blockquote><blockquote><p>æ­£è§£: C</p></blockquote><h2 id="åˆ†æ•£å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ãªã©ã‚¤ãƒ³ãƒ•ãƒ©å¯„ã‚Šã®çŸ¥è­˜"><a href="#åˆ†æ•£å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ãªã©ã‚¤ãƒ³ãƒ•ãƒ©å¯„ã‚Šã®çŸ¥è­˜" class="headerlink" title="åˆ†æ•£å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ãªã©ã‚¤ãƒ³ãƒ•ãƒ©å¯„ã‚Šã®çŸ¥è­˜"></a>åˆ†æ•£å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ãªã©ã‚¤ãƒ³ãƒ•ãƒ©å¯„ã‚Šã®çŸ¥è­˜</h2><p>æ©Ÿæ¢°å­¦ç¿’ã§ã®åˆ†æ•£å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã«é–¢ã™ã‚‹çŸ¥è­˜ã¨ã¯ã€<code>Apache</code>ã®<code>Hadoop</code>,<code>Hive</code>, <code>Spark</code>ã¨ã„ã£ãŸåˆ†æ•£å‡¦ç†ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«å¯¾ã™ã‚‹ç†è§£ã¨æ›è¨€ã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚</p><p>AWSã®ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ã¯<code>Amazon EMR</code>ã€<code>AWS Glue</code>ã«ã¤ã„ã¦ç†è§£ã—ã¦ã„ã‚‹ã“ã¨ãŒè¦æ±‚ã•ã‚Œã¾ã™ã€‚ã¾ãŸãã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã¨é€£æºã™ã‚‹<code>Amazon Athena</code>ã€<code>Amazon Kinesis</code>ã«ã¤ã„ã¦ã®çŸ¥è­˜ã‚„ã€ãƒ‡ãƒ¼ã‚¿ã‚¦ã‚§ã‚¢ãƒã‚¦ã‚¹ã¨ã—ã¦<code>Amazon Redshift</code>ã€æ©Ÿæ¢°å­¦ç¿’ã«ãŠã‘ã‚‹<code>Amazon S3</code>ã®ä½¿ç”¨ä¾‹ãŒå‡ºé¡Œç¯„å›²ã«å«ã¾ã‚Œã¾ã™ã€‚</p><p>ã“ã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯å®Ÿä½“é¨“ç„¡ã—ã§å„ã‚µãƒ¼ãƒ“ã‚¹ã®é•ã„ã‚„æŒ™å‹•ã‚’ç†è§£ã™ã‚‹ã®ãŒã¨ã¦ã‚‚é›£ã—ã„åˆ†é‡ã§ã™ãŒã€å‡ºé¡Œã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¯¾ã—ã€ã©ã®ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã®çµ„ã¿åˆã‚ã›ãŒæœ€é©ã‹è€ƒãˆã‚‹ã‚ˆã†ãªå•é¡ŒãŒå‡ºé¡Œã•ã‚Œã¾ã™ã€‚</p><p>ä¾‹é¡Œ:</p><blockquote><p>ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚²ãƒ¼ãƒ ã®é‹ç”¨ã§ã€JSONå½¢å¼ã®åˆ©ç”¨åˆ†æãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã‚€ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã‚’è¡Œã„ã¾ã™ã€‚åŸºç›¤ã¨ãªã‚‹ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã‚’æœ›ã‚“ã§ãŠã‚‰ãšã€ãƒ‡ãƒ¼ã‚¿ã‚’ã™ãã«åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚³ã‚¹ãƒˆåŠ¹ç‡ãŒé«˜ãã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ã©ã®ã‚ˆã†ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã‹ã€‚</p></blockquote><blockquote><p>A:<br>Kinesis Data Streamsã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã¿ã€Lambdaé–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’S3ã«ä¿å­˜ã—ã¾ã™ã€‚<br>15åˆ†ã”ã¨ã«Glue ETLã‚¸ãƒ§ãƒ–ã‚’èµ·å‹•ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’JSONã‹ã‚‰Parquetå½¢å¼ã«å¤‰æ›ã—ã¾ã™ã€‚<br>AWS Glueã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’Athenaãƒ†ãƒ¼ãƒ–ãƒ«ã«èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p></blockquote><blockquote><p>B:<br>S3ã¸ã®æ›¸ãè¾¼ã¿ä¸­ã«ãƒ‡ãƒ¼ã‚¿ã‚’Parquetå½¢å¼ã«å¤‰æ›ã™ã‚‹è¨­å®šã§Kinesis Firehoseã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã¿ã¾ã™ã€‚<br>AWS Glueã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’Athenaãƒ†ãƒ¼ãƒ–ãƒ«ã«èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p></blockquote><blockquote><p>æ­£è§£: B</p></blockquote><h2 id="æ©Ÿæ¢°å­¦ç¿’ã®AWSãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹çŸ¥è­˜"><a href="#æ©Ÿæ¢°å­¦ç¿’ã®AWSãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹çŸ¥è­˜" class="headerlink" title="æ©Ÿæ¢°å­¦ç¿’ã®AWSãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹çŸ¥è­˜"></a>æ©Ÿæ¢°å­¦ç¿’ã®AWSãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã™ã‚‹çŸ¥è­˜</h2><p><code>Amazon Sage Maker</code>ã€<code>Amazon EMR</code>ãªã©ã®ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®è©³ç´°ãªåˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦å‡ºé¡Œã•ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€æ©Ÿæ¢°å­¦ç¿’ã®ãƒã‚¦ãƒã‚¦ãŒã»ã¨ã‚“ã©ç„¡ã„çŠ¶æ…‹ã‹ã‚‰ã§ã‚‚æ©Ÿæ¢°å­¦ç¿’ã‚µãƒ¼ãƒ“ã‚¹ãŒæä¾›å¯èƒ½ã«ãªã‚‹ã‚ˆã†ãªã€ãƒãƒãƒ¼ã‚¸ãƒ‰ãªå´é¢ãŒæ¥µã‚ã¦é«˜ã„ã‚µãƒ¼ãƒ“ã‚¹ã«é–¢ã™ã‚‹å•é¡Œã‚‚å‡ºé¡Œã•ã‚Œã¾ã™ã€‚</p><p>ãƒ†ã‚­ã‚¹ãƒˆåˆ†æã«ç”¨ã„ã‚‹<code>AMAZON COMPREHEND</code>ã€éŸ³å£°ã‚’æ–‡å­—èµ·ã“ã—ã§ãã‚‹<code>AMAZON TRANSCRIBE</code>ã€æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®äºˆæ¸¬ã‚’è¡Œã†<code>AMAZON FORECAST</code>â€¦ã¨ã„ã£ãŸé¡ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚<a href="https://aws.amazon.com/jp/machine-learning/" target="_blank" rel="noopener">awså…¬å¼ã‚µã‚¤ãƒˆã€ŒAWS ã§ã®æ©Ÿæ¢°å­¦ç¿’ã€</a>ã®AI ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>å„ã‚µãƒ¼ãƒ“ã‚¹ã®æ¦‚è¦ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’æŠŠæ¡ã—ã€é©åˆ‡ã«é¸æŠã§ãã‚‹ã‚ˆã†ã«ã€ã¾ãŸå­˜åœ¨ã—ãªã„ã‚µãƒ¼ãƒ“ã‚¹ãŒãƒ–ãƒ©ãƒ•ã¨ã—ã¦é¸æŠè‚¢ã«å‡ºç¾ã—ã¦ã‚‚é¨™ã•ã‚Œãªã„ã‚ˆã†ã—ã£ã‹ã‚Šã¨ç†è§£ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><p>æ¦‚è¦ãƒ¬ãƒ™ãƒ«ã§ã¯ãªãã€ä¾‹ãˆã°<code>Amazon Transcribe</code>ãŒå¯¾å¿œã—ã¦ã„ã‚‹è¨€èªã‚’æŠŠæ¡ã—ã¦ãŠãã€éå¯¾å¿œã®è¨€èªã®å ´åˆ<code>Amazon Translate</code>ã§ç¿»è¨³ã—ã¦ã‹ã‚‰<code>Amazon Transcribe</code>ã«ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘æ¸¡ã™ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹æ§‹ç¯‰ãŒæ­£è§£ã¨ãªã‚‹ã‚ˆã†ãªæ·±ã„ç†è§£ãŒè¦æ±‚ã•ã‚Œã‚‹å•é¡Œã‚‚å‡ºé¡Œã•ã‚Œã¾ã™ã€‚<br>ã“ã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯æ—¥ã€…æ–°ã—ã„ã‚‚ã®ãŒå¢—ãˆã€æ—¢å­˜ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚‚æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€å…¥å¿µãªã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ãŒå¿…è¦ãªã‚¸ãƒ£ãƒ³ãƒ«ã§ã™ã€‚</p><p>ä¾‹é¡Œ:</p><blockquote><p>é¡”å†™çœŸã‹ã‚‰æœ‰åäººã‚’æ¤œå‡ºã§ãã‚‹ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚<br>æœ€å°é™ã®åŠ´åŠ›ã§ã“ã‚Œã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã®ã«å½¹ç«‹ã¤AWSã‚µãƒ¼ãƒ“ã‚¹ã¯ã©ã‚Œã§ã™ã‹ã€‚<br>A: Amazon Predict<br>B: Amazon Rekognition<br>C: Amazon Polly<br>D: Amazon Comprehend</p></blockquote><blockquote><p>æ­£è§£: B</p></blockquote><h2 id="ã‚µãƒ¼ãƒ“ã‚¹ã®æ§‹ç¯‰ã€é‹ç”¨ã«é–¢ã™ã‚‹çŸ¥è­˜"><a href="#ã‚µãƒ¼ãƒ“ã‚¹ã®æ§‹ç¯‰ã€é‹ç”¨ã«é–¢ã™ã‚‹çŸ¥è­˜" class="headerlink" title="ã‚µãƒ¼ãƒ“ã‚¹ã®æ§‹ç¯‰ã€é‹ç”¨ã«é–¢ã™ã‚‹çŸ¥è­˜"></a>ã‚µãƒ¼ãƒ“ã‚¹ã®æ§‹ç¯‰ã€é‹ç”¨ã«é–¢ã™ã‚‹çŸ¥è­˜</h2><p>æ©Ÿæ¢°å­¦ç¿’ã«ç›´çµã™ã‚‹çŸ¥è­˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ãƒ“ã‚¸ãƒã‚¹ãƒ¬ãƒ™ãƒ«ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ§‹ç¯‰ã‚’è¡Œã†ä¸Šã§ã®AWSã‚µãƒ¼ãƒ“ã‚¹ã®çŸ¥è­˜ã‚‚å•ã‚ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</p><p>å…·ä½“çš„ã«ã¯IAMã®è¨­å®šãªã©ã€é‹ç”¨é¢ã§è¨­å®šã™ã‚‹å¿…è¦ã®ã‚ã‚‹é …ç›®ã«ã¤ã„ã¦å‡ºé¡Œã•ã‚Œã¾ã™ã€‚</p><p>ä¾‹é¡Œ</p><blockquote><p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®IAMãƒ­ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã—ãŸã€‚S3ã®ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ã©ã®ã‚ˆã†ã«ç®¡ç†ã•ã‚Œã¾ã™ã‹ï¼Ÿ<br>A: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä½¿ç”¨å¯èƒ½ãªãƒã‚±ãƒƒãƒˆã¯ã‚ã‚Šã¾ã›ã‚“<br>B: åå‰ã«ã€Œsagemakerã€ãŒå«ã¾ã‚Œã‚‹ãƒã‚±ãƒƒãƒˆã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å½¹å‰²ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™<br>C: ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãŒæœ‰åŠ¹ãªãƒã‚±ãƒƒãƒˆã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å½¹å‰²ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™</p></blockquote><blockquote><p>æ­£è§£: B</p></blockquote><p><a id="anchor3"></a></p><h1 id="å­¦ç¿’æ–¹æ³•ã«ã¤ã„ã¦"><a href="#å­¦ç¿’æ–¹æ³•ã«ã¤ã„ã¦" class="headerlink" title="å­¦ç¿’æ–¹æ³•ã«ã¤ã„ã¦"></a>å­¦ç¿’æ–¹æ³•ã«ã¤ã„ã¦</h1><p>ã–ã£ãã‚Šã¨å†…å®¹ã‚’èª¬æ˜ã—ã¾ã—ãŸãŒã€åˆæ ¼ã¸ã®ç­‹é“ã¯è¦‹ãˆã¦ãã¾ã—ãŸã§ã—ã‚‡ã†ã‹ã€‚<br><code>ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ-ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆ</code>ã‚„<code>ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚·ãƒ§ãƒŠãƒ¼</code>ãªã©ã€AWSã®è³‡æ ¼ã‚’æŒã£ã¦ã„ãªã„æ–¹ãŒæœ€åˆã«å—ã‘ã‚‹å‚¾å‘ãŒé«˜ã„è©¦é¨“ã¯1å†Šèª­ã‚“ã§ãŠã‘ã°åˆæ ¼ã§ãã‚‹ã‚ˆã†ãªè³ªã®é«˜ã„æ›¸ç±ãŒå­˜åœ¨ã—ã¾ã™ã€‚</p><p>ã—ã‹ã—æ©Ÿæ¢°å­¦ç¿’-å°‚é–€çŸ¥è­˜ã¯çŸ¥è­˜ãŒåºƒç¯„ã‹ã¤AWSã«ç‰¹åŒ–ã—ãŸå†…å®¹ã§ã¯ãªã„éƒ¨åˆ†ã‚‚å¤šãã€ã¾ã å¿…è¦ãªçŸ¥è­˜ã‚’ä½“ç³»çš„ã«ã¾ã¨ã‚ãŸæ›¸ç±ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚<br>ãã†ã„ã£ãŸæ„å‘³ã§ã‚‚å³ã—ã„è©¦é¨“ã§ã™ãŒã€å‚è€ƒã¾ã§ã«è‡ªåˆ†ãŒå­¦ç¿’ã«åˆ©ç”¨ã—ãŸæ›¸ç±ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚</p><h2 id="ãã‚‚ãã‚‚AIã«å¯¾ã™ã‚‹çŸ¥è­˜ãŒç„¡ã„äººå‘ã‘"><a href="#ãã‚‚ãã‚‚AIã«å¯¾ã™ã‚‹çŸ¥è­˜ãŒç„¡ã„äººå‘ã‘" class="headerlink" title="ãã‚‚ãã‚‚AIã«å¯¾ã™ã‚‹çŸ¥è­˜ãŒç„¡ã„äººå‘ã‘"></a>ãã‚‚ãã‚‚AIã«å¯¾ã™ã‚‹çŸ¥è­˜ãŒç„¡ã„äººå‘ã‘</h2><p>AIã«èˆˆå‘³ã¯ã‚ã‚‹ã‚‚ã®ã®å®Ÿéš›ã«AIã«è§¦ã‚ŒãŸã“ã¨ãŒãªã„ã€ã¨ã„ã†æ–¹ã‚‚ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚ãã®çŠ¶æ…‹ã‹ã‚‰è©¦é¨“å•é¡Œã«ç‰¹åŒ–ã—ãŸçŸ¥è­˜ã‚’è©°ã‚è¾¼ã¿æ•™è‚²çš„æ‰‹æ³•ã§å­¦ã¶ã®ã¯é™ç•ŒãŒã‚ã‚Šã¾ã™ã€‚æ€¥ãŒã°å›ã‚Œã€ã¨ã„ã†ã“ã¨ã§ã¾ãšã¯æ©Ÿæ¢°å­¦ç¿’ã®æ¦‚è¦ã‹ã‚‰å­¦ã‚“ã§ã„ãã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚</p><p>AWSã®è©¦é¨“ã«åˆæ ¼ã™ã‚‹ã«ã¯ã€Pythonã®å„ç¨®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ç”¨ã„ãŸã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ¬ãƒ™ãƒ«ã®çŸ¥è­˜ã‚„ã€å…·ä½“çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ•°å¼ã«ã¤ã„ã¦ã®çŸ¥è­˜ã¯å¿…è¦ãªãã€æ¦‚å¿µçš„ãªéƒ¨åˆ†ã‚’æŠ¼ã•ãˆã¦ãŠã‘ã°OKã§ã™ã€‚å›å¸°ã€åˆ†é¡ã€ç·šå½¢åˆ†é›¢ã¨ã„ã£ãŸæ¦‚å¿µã‹ã‚‰å„ç¨®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æ¦‚å¿µçš„ã«å¤§ã¾ã‹ã«æŠŠæ¡ã—ã¦ãŠãç¨‹åº¦ã®å­¦ç¿’ã§ã€è©¦é¨“ã«å¿…è¦ãªçŸ¥è­˜ã‚’å­¦ã¶ä¸Šã§å½¹ã«ç«‹ã¤ã¨æ€ã„ã¾ã™ã€‚</p><p>å‰æçŸ¥è­˜ã‚’å­¦ã¶ãŸã‚ã«æ©Ÿæ¢°å­¦ç¿’åˆå¿ƒè€…å‘ã‘ã®æœ¬ã‚’ï¼‘å†Šèª­ã‚“ã§ãŠãäº‹ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚<br>ç§ã¯å¥½å¥‡å¿ƒã‹ã‚‰<a href="https://www.amazon.co.jp/Python-%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0-%E9%81%94%E4%BA%BA%E3%83%87%E3%83%BC%E3%82%BF%E3%82%B5%E3%82%A4%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%82%B9%E3%83%88%E3%81%AB%E3%82%88%E3%82%8B%E7%90%86%E8%AB%96%E3%81%A8%E5%AE%9F%E8%B7%B5-impress-gear/dp/4295003379/ref=asc_df_4295003379/?tag=jpgo-22&linkCode=df0&hvadid=295678107984&hvpos=&hvnetw=g&hvrand=17590793615228539759&hvpone=&hvptwo=&hvqmt=&hvdev=c&hvdvcmdl=&hvlocint=&hvlocphy=1009243&hvtargid=pla-524387980046&psc=1&language=ja_JP&th=1&psc=1" target="_blank" rel="noopener">Python æ©Ÿæ¢°å­¦ç¿’ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° é”äººãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã«ã‚ˆã‚‹ç†è«–ã¨å®Ÿè·µ</a>ã¨ã„ã†æ›¸ç±ã‚’è³¼å…¥ã—ã¾ã—ãŸã€‚</p><p>è©¦é¨“ã«å¯¾ã—ã¦ã¯éå‰°ãªã»ã©è©³ç´°ã«æ©Ÿæ¢°å­¦ç¿’ã®æ¦‚è¦ãŒæ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€æ­£ç›´èª­ã‚€ã ã‘ã§ä¸€è‹¦åŠ´ã§ã—ãŸã€‚</p><h2 id="AWSã«é–¢ã™ã‚‹çŸ¥è­˜ã‚’å­¦ã¶æ–¹æ³•"><a href="#AWSã«é–¢ã™ã‚‹çŸ¥è­˜ã‚’å­¦ã¶æ–¹æ³•" class="headerlink" title="AWSã«é–¢ã™ã‚‹çŸ¥è­˜ã‚’å­¦ã¶æ–¹æ³•"></a>AWSã«é–¢ã™ã‚‹çŸ¥è­˜ã‚’å­¦ã¶æ–¹æ³•</h2><p>ç¾çŠ¶æ©Ÿæ¢°å­¦ç¿’é–¢é€£ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒæ›¸ç±ã®å½¢å¼ã§ã¾ã¨ã¾ã£ã¦ã„ã‚‹ã‚‚ã®ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ­£æ”»æ³•ã®æ‰‹æ®µã¨ã—ã¦ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªæµã‚Œã§å­¦ç¿’ã‚’é€²ã‚ã¦ã„ãã¾ã™ã€‚</p><ul><li><a href="https://docs.aws.amazon.com/index.html" target="_blank" rel="noopener">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã®æ©Ÿæ¢°å­¦ç¿’ã®ã‚¸ãƒ£ãƒ³ãƒ«ã‚’èª­ç ´ã™ã‚‹</li><li><a href="https://aws.amazon.com/jp/training/learning-paths/machine-learning/exam-preparation/" target="_blank" rel="noopener">æ©Ÿæ¢°å­¦ç¿’: è©¦é¨“æº–å‚™</a>ã®ãƒšãƒ¼ã‚¸ã«å¾“ã£ã¦å­¦ç¿’ã‚’é€²ã‚ã¦ã„ã</li></ul><p>æ„šç›´ã«å­¦ç¿’ã™ã‚‹æ™‚é–“ã®æ»å‡ºãŒé›£ã—ã„å ´åˆã€åˆæ ¼ã™ã‚‹è‡ªä¿¡ãŒæŒã¦ãšå‰¯æ•™æãŒå¿…è¦ãªå ´åˆã¯udemyãªã©ã®å­¦ç¿’ã‚µã‚¤ãƒˆã§ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ ã‚„è©¦é¨“å•é¡Œã‚’è³¼å…¥ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚</p><p><a id="anchor4"></a></p><h1 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h1><p>ã“ã®è¨˜äº‹ãŒè©¦é¨“å‹‰å¼·ã®è£œåŠ©ã¨ãªã‚Œã°ã€ã¾ãŸè©¦é¨“ã‚’å—ã‘ã¦ã¿ã‚ˆã†ã¨æ€ã£ã¦ã„ãŸã ã‘ã‚‹ãã£ã‹ã‘ã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚<br>å­¦ç¿’ã®ãƒãƒ¼ãƒ‰ãƒ«ã¯é«˜ã‚ãªã®ã§ã€ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆã®ã‚ˆã†ã«ï¼‘å†Šã®æœ¬ã«ã¾ã¨ã¾ã‚‹æ—¥ãŒæ¥ã¦ã»ã—ã„ã§ã™ã­ã€‚<br>é–¢é€£è¨˜äº‹ã¨ã—ã¦ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼æŠ€è¡“ãƒ–ãƒ­ã‚°ã®<a href="https://future-architect.github.io/tags/%E5%90%88%E6%A0%BC%E8%A8%98/">åˆæ ¼è¨˜</a>ã€<a href="https://future-architect.github.io/tags/MachineLearning/">Machine Learning</a>ã‚¿ã‚°ã®è¨˜äº‹ã‚‚æ˜¯éã”è¦§ãã ã•ã„ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;TIGã®ä¼Šè—¤çœŸå½¦ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæ—¥ã‚‚ã†ä¸€äººã®ä¼Šè—¤ã•ã‚“ãŒ&lt;a href=&quot;https://future-architect.github.io/articles/20200629/&quot;&gt;Terraform Associateåˆæ ¼è¨˜&lt;/a&gt;ã‚’æ›¸ã„ã¦ãã‚Œã¾ã—ãŸã€‚ã“ã®è¨˜äº‹ã«ç¶š
      
    
    </summary>
    
    
      <category term="DataScience" scheme="https://future-architect.github.io/categories/DataScience/"/>
    
    
      <category term="AWS" scheme="https://future-architect.github.io/tags/AWS/"/>
    
      <category term="MachineLearning" scheme="https://future-architect.github.io/tags/MachineLearning/"/>
    
  </entry>
  
  <entry>
    <title>DBã‚¹ã‚­ãƒ¼ãƒã‚’é§†å‹•ã«ã—ãŸé–‹ç™ºã®ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª¿æŸ»</title>
    <link href="https://future-architect.github.io/articles/20200728/"/>
    <id>https://future-architect.github.io/articles/20200728/</id>
    <published>2020-07-27T15:00:00.000Z</published>
    <updated>2020-07-27T14:48:28.191Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h2><p>Goã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ‰±ã†å ´åˆã€<a href="https://github.com/go-gorm/gorm" target="_blank" rel="noopener">Gorm</a>, <a href="https://github.com/go-gorp/gorp" target="_blank" rel="noopener">Gorp</a>, <a href="https://github.com/jmoiron/sqlx" target="_blank" rel="noopener">sqlx</a> ã¨ã„ã£ãŸ ORM ãŒã‚ˆãä½¿ã‚ã‚Œã¾ã™ã€‚å¤šãã®å ´åˆã¯æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚«ãƒ©ãƒ åã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ã™ã‚‹ã‚¿ã‚°ä»˜ãã®æ§‹é€ ä½“ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ä¾‹ãˆã° <code>Gorm</code> ã‚’ç”¨ã„ã¦ <code>users</code> ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹é€ ä½“ãŒä¸€ä¾‹ã¨ã—ã¦è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>model_user.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">UserID    <span class="keyword">string</span>       <span class="string">`gorm:"column:user_id;primary_key"`</span></span><br><span class="line">UserName  <span class="keyword">string</span>       <span class="string">`gorm:"column:user_name"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *User)</span> <span class="title">TableName</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"users"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Gorm</code> ã‚„ <code>Xorm</code> ã¨ã„ã£ãŸ ORM ã‚’ç”¨ã„ã‚‹å ´åˆã€ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰æ§‹é€ ä½“ã‚’ç”Ÿæˆã§ããšã€æ§‹é€ ä½“ã®ç”ŸæˆãŒé¢å€’ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚è¤‡æ•°äººã§é–‹ç™ºã—ã¦ã„ãŸã‚Šã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ æ•°ãŒå¤šã‹ã£ãŸã‚Šã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ•°ãŒå¤šã„å ´åˆã€ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰æ§‹é€ ä½“ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã¨ã‚ˆã„ãªã€ã¨è€ƒãˆã‚‹ã“ã¨ã§ã—ã‚‡ã†ã€‚ <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p><p>ã¾ãŸã€å½“ç¤¾ã®ãƒ¡ãƒ³ãƒã¨é–‹ç™ºã™ã‚‹ã¨ã SQL ãŒæ›¸ã‘é©åˆ‡ã« index ã‚’è²¼ã£ãŸã‚Šã€å®Ÿè¡Œè¨ˆç”»ã‹ã‚‰ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã§ãã‚‹ãƒ¡ãƒ³ãƒãŒå¤šã„ã§ã™ã€‚ç´ ã® SQL ã‚’æ›¸ã or æ›¸ããŸã„ã‚±ãƒ¼ã‚¹ãŒå¤šãã€ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã§ã‚¯ã‚¨ãƒªã‚’ç”Ÿæˆã™ã‚‹ <code>Gorm</code> ãªã©ã® ORM ã¨ç›¸æ€§ãŒæ‚ªã„ã¨æ„Ÿã˜ã¦ã„ã¾ã—ãŸã€‚</p><ul><li><strong>ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ ã¨ãƒãƒƒãƒ”ãƒ³ã‚°ã§ãã‚‹æ§‹é€ ä½“ã‚’è‡ªå‹•ç”Ÿæˆã—ãŸã„</strong></li><li><strong>ä»»æ„ã®ã‚¯ã‚¨ãƒªã‹ã‚‰çµæœã‚»ãƒƒãƒˆã®ã‚«ãƒ©ãƒ ã¨ãƒãƒƒãƒ”ãƒ³ã‚°ã§ãã‚‹æ§‹é€ ä½“ã‚’è‡ªå‹•ç”Ÿæˆã—ãŸã„</strong></li></ul><p>ä¸Šè¨˜ã‚’æº€ãŸã™ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¢ã—ã¤ã¤ã€ä»Šå›ã¯æ—¢ã«å­˜åœ¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚­ãƒ¼ãƒã‚„ã‚¯ã‚¨ãƒªã‹ã‚‰æ§‹é€ ä½“ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ <code>xo</code> ã¨ <code>gen</code> ã‚’èª¿æŸ»ã—ã¦ã¿ã¾ã—ãŸã€‚</p><ul><li><a href="https://github.com/xo/xo" target="_blank" rel="noopener">xo/xo</a></li><li><a href="https://github.com/smallnest/gen" target="_blank" rel="noopener">gen</a></li></ul><p><a href="https://github.com/volatiletech/sqlboiler" target="_blank" rel="noopener">SQLBoiler</a> ã‚„ <a href="https://github.com/go-xorm/xorm" target="_blank" rel="noopener">Xorm</a> ã¯ ORM ã¨ã—ã¦ä½¿ã‚ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã®ã§å¯¾è±¡ã‹ã‚‰å¤–ã—ã¾ã—ãŸã€‚<code>SQLBoiler</code> ã‚„ <code>Xorm</code> ã®æ‰€æ„Ÿã¯ <a href="https://future-architect.github.io/articles/20190926/">Goè¨€èªã®DBãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è©•ä¾¡</a> ã®è¨˜äº‹ã«è¨˜è¼‰ã—ã¦ãŠã‚Šã¾ã™ã®ã§ã€ã‚ã‚ã›ã¦ã”ç¢ºèªãã ã•ã„ã€‚</p><h2 id="æ¦‚è¦ã‚µãƒãƒª"><a href="#æ¦‚è¦ã‚µãƒãƒª" class="headerlink" title="æ¦‚è¦ã‚µãƒãƒª"></a>æ¦‚è¦ã‚µãƒãƒª</h2><p>ä»Šå›èª¿æŸ»ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®2020/07/12æ™‚ç‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã¨ã«ã—ãŸæ¦‚è¦ã‚µãƒãƒªã§ã™ã€‚ã©ã¡ã‚‰ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚ç¶™ç¶šçš„ã«ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><table><thead><tr><th>Project Name</th><th>Stars</th><th>Forks</th><th>Open Issues</th><th>Description</th><th>Last Update</th></tr></thead><tbody><tr><td><a href="https://github.com/xo/xo" target="_blank" rel="noopener">xo</a></td><td>2503</td><td>224</td><td>91</td><td>Command line tool to generate idiomatic Go code for SQL databases supporting PostgreSQL, MySQL, SQLite, Oracle, and Microsoft SQL Server</td><td>2020-07-10 11:12:42</td></tr><tr><td><a href="https://github.com/smallnest/gen" target="_blank" rel="noopener">gen</a></td><td>565</td><td>105</td><td>3</td><td>Converts a database into gorm structs and RESTful api</td><td>2020-07-10 14:19:19</td></tr></tbody></table><ul><li>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</li></ul><p>ä»Šå›èª¿æŸ»ã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚<code>xo</code> ã¯ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã•ã‚Œã¦ã„ãªã‹ã£ãŸãŸã‚ã€ã‚³ãƒŸãƒƒãƒˆ ID ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚</p><table><thead><tr><th>ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</th><th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th></tr></thead><tbody><tr><td><code>xo</code></td><td><code>7818603ff52bc0b96122715f9c7df7559aeef82d</code></td></tr><tr><td><code>gen</code></td><td><code>v0.9.24</code></td></tr></tbody></table><h2 id="ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ"><a href="#ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ" class="headerlink" title="ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ"></a>ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</h2><p>æœ¬è¨˜äº‹ã§ã¯ <code>xo</code> ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ <code>booktest</code> ã‚’ã‚µãƒ³ãƒ—ãƒ«ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦è€ƒãˆã¦ã¿ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ PostgreSQL ã‚’æ¡ç”¨ã™ã‚‹ã“ã¨ã¨ã—ã€Docker ã‚’ç”¨ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ­ãƒ¼ã‚«ãƒ«ã«èµ·å‹•ã•ã›ã¦ãŠãã¾ã™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm --name my-postgres -e POSTGRES_USER&#x3D;booktest -e POSTGRES_PASSWORD&#x3D;pass -e POSTGRES_DB&#x3D;testdb -d -p 15432:5432 postgres</span><br></pre></td></tr></table></figure><p>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã® ER å›³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><p><img src="/images/20200728/erd.png" alt=""></p><p>ã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆã™ã‚‹ SQL ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- The MIT License (MIT)</span></span><br><span class="line"><span class="comment">-- </span></span><br><span class="line"><span class="comment">-- Copyright (c) 2015-2016 Kenneth Shaw</span></span><br><span class="line"><span class="comment">-- </span></span><br><span class="line"><span class="comment">-- https://github.com/xo/xo/blob/master/LICENSE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SCHEMA</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> booktest <span class="keyword">CASCADE</span>;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> books <span class="keyword">CASCADE</span>;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TYPE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> book_type <span class="keyword">CASCADE</span>;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="keyword">authors</span> <span class="keyword">CASCADE</span>;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> say_hello(<span class="built_in">text</span>) <span class="keyword">CASCADE</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SCHEMA</span> booktest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">authors</span> (</span><br><span class="line">  author_id <span class="built_in">SERIAL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">text</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> authors_name_idx <span class="keyword">ON</span> <span class="keyword">authors</span>(<span class="keyword">name</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TYPE</span> book_type <span class="keyword">AS</span> ENUM (</span><br><span class="line">  <span class="string">'FICTION'</span>,</span><br><span class="line">  <span class="string">'NONFICTION'</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> books (</span><br><span class="line">  book_id <span class="built_in">SERIAL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">  author_id <span class="built_in">integer</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">REFERENCES</span> <span class="keyword">authors</span>(author_id),</span><br><span class="line">  isbn <span class="built_in">text</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">  booktype book_type <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'FICTION'</span>,</span><br><span class="line">  title <span class="built_in">text</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">  <span class="keyword">year</span> <span class="built_in">integer</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">2000</span>,</span><br><span class="line">  available <span class="built_in">timestamp</span> <span class="keyword">with</span> <span class="built_in">time</span> zone <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'NOW()'</span>,</span><br><span class="line">  tags <span class="built_in">varchar</span>[] <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'&#123;&#125;'</span>,</span><br><span class="line">  memo <span class="built_in">text</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> books_title_idx <span class="keyword">ON</span> books(title, <span class="keyword">year</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> say_hello(<span class="built_in">text</span>) <span class="keyword">RETURNS</span> <span class="built_in">text</span> <span class="keyword">AS</span> $$</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">RETURN</span> <span class="keyword">CONCAT</span>(<span class="string">'hello '</span>, $<span class="number">1</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">$$ LANGUAGE plpgsql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> books_title_lower_idx <span class="keyword">ON</span> books(title);</span><br></pre></td></tr></table></figure><h2 id="xo"><a href="#xo" class="headerlink" title="xo"></a>xo</h2><p><code>xo</code> ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚­ãƒ¼ãƒã‚„ä»»æ„ã® SQL ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ Go ã®ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ç”Ÿæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã£ã¦æŸ”è»Ÿã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚ORM ã‚’ç›®æŒ‡ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ãªãã€é™çš„ã«å‹ä»˜ã‘ã•ã‚ŒãŸ Go ã‚‰ã—ã„ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚’ç›®çš„ã® 1 ã¤ã¨ã—ã¦ã„ã¾ã™ã€‚</p><p>ã¾ãšã¯ <code>xo</code> ã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã§ã™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ go.mod</span><br><span class="line">â”œâ”€â”€ main.go</span><br><span class="line">â””â”€â”€ generated</span><br></pre></td></tr></table></figure><p>ã•ã£ãã <code>xo</code> ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚2020/07/13ç¾åœ¨ã€ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã¯ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€master ãƒ–ãƒ©ãƒ³ãƒã®æœ€æ–°ã®ã‚³ãƒŸãƒƒãƒˆ(<code>7818603ff52bc0b96122715f9c7df7559aeef82d</code>) ã‚’ç”¨ã„ã¾ã™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get -u github.com&#x2F;xo&#x2F;xo</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆå…ˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã¯ <code>generated</code> ã¨ã—ã¾ã™ã€‚<code>xo</code> ã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã¦ã€æ§‹é€ ä½“ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xo pgsql:&#x2F;&#x2F;booktest:pass@localhost:15432&#x2F;testdb?sslmode&#x3D;disable --schema booktest --out generated</span><br></pre></td></tr></table></figure><p><code>generated</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«ã„ãã¤ã‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ generated</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ author.xo.go</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ book.xo.go</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ booktype.xo.go</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ sp_sayhello.xo.go</span><br><span class="line">â”‚Â Â  â””â”€â”€ xo_db.xo.go</span><br><span class="line">â”œâ”€â”€ go.mod</span><br><span class="line">â””â”€â”€ main.go</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ« <code>author.xo.go</code> ã‚’ç¢ºèªã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æˆã¯ã€å¤§ãã SELECT ã‚’æ‰±ã†ã‚¯ã‚¨ãƒªç”¨ã®é–¢æ•°ã¨ã€ãã‚Œä»¥å¤–ã® INSERT, UPDATE, DELETE ã¨ã„ã£ãŸã‚¯ã‚¨ãƒªã‚’æ‰±ã†ãƒ¡ã‚½ãƒƒãƒ‰ã¨ 2 ç¨®é¡ã«å¤§åˆ¥ã§ãã¾ã™ã€‚</p><h3 id="SELECTç³»"><a href="#SELECTç³»" class="headerlink" title="SELECTç³»"></a>SELECTç³»</h3><p>SELECT ã‚’æ‰±ã†ã‚¯ã‚¨ãƒªã§ã¯ä»¥ä¸‹ã® 2 ã¤ã®é–¢æ•°ãŒç”Ÿæˆã•ã‚Œã¦ã„ã¾ã™ã€‚</p><ul><li><code>AuthorsByName(db XODB, name string) ([]*Author, error)</code> </li><li><code>AuthorByAuthorID(db XODB, authorID int) (*Author, error)</code></li></ul><p>ãã‚Œãã‚Œé–¢æ•°ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«è²¼ã‚‰ã‚ŒãŸ index ã‚’ã‚‚ã¨ã«ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AuthorsByName retrieves a row from 'booktest.authors' as a Author.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Generated from index 'authors_name_idx'.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AuthorsByName</span><span class="params">(db XODB, name <span class="keyword">string</span>)</span> <span class="params">([]*Author, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AuthorByAuthorID retrieves a row from 'booktest.authors' as a Author.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Generated from index 'authors_pkey'.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AuthorByAuthorID</span><span class="params">(db XODB, authorID <span class="keyword">int</span>)</span> <span class="params">(*Author, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é–¢æ•°å†…ã« SQL ãŒæ˜ç¤ºçš„ã«è¨˜è¿°ã•ã‚Œã¦ã„ã¦å®‰å¿ƒæ„ŸãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸ index ã‹ã‚‰ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã®ã§ã€æ¦‚ã­ã‚¯ã‚¨ãƒªã¯é«˜é€Ÿã«å‹•ä½œã™ã‚‹ã§ã—ã‚‡ã†ã€‚ãŸã ã—é–¢æ•°ã®ã‚·ã‚°ãƒãƒãƒ£ã‚„ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚·ã‚°ãƒãƒãƒ£ã‹ã‚‰åˆ†ã‹ã‚‹ã‚ˆã†ã« <code>Context</code> ã‚’å¼•æ•°ã«å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚å¤šãã®ã‚±ãƒ¼ã‚¹ã§ã¯ <code>Context</code> ã‚’å¼•ãå›ã™ã‚±ãƒ¼ã‚¹ãŒä¸€èˆ¬çš„ã§ã™ã®ã§ã€Context å¯¾å¿œã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãªã©ã‚’ç”¨ã„ã¦æ‹¡å¼µã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AuthorByAuthorID retrieves a row from 'booktest.authors' as a Author.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Generated from index 'authors_pkey'.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AuthorByAuthorID</span><span class="params">(db XODB, authorID <span class="keyword">int</span>)</span> <span class="params">(*Author, error)</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> err error</span><br><span class="line"></span><br><span class="line"><span class="comment">// sql query</span></span><br><span class="line"><span class="keyword">const</span> sqlstr = <span class="string">`SELECT `</span> +</span><br><span class="line"><span class="string">`author_id, name `</span> +</span><br><span class="line"><span class="string">`FROM booktest.authors `</span> +</span><br><span class="line"><span class="string">`WHERE author_id = $1`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// run query</span></span><br><span class="line">XOLog(sqlstr, authorID)</span><br><span class="line">a := Author&#123;</span><br><span class="line">_exists: <span class="literal">true</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">err = db.QueryRow(sqlstr, authorID).Scan(&amp;a.AuthorID, &amp;a.Name)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &amp;a, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="INSERT-UPDATE-DELETEç³»"><a href="#INSERT-UPDATE-DELETEç³»" class="headerlink" title="INSERT/UPDATE/DELETEç³»"></a>INSERT/UPDATE/DELETEç³»</h3><p>INSERT ã®ã‚¯ã‚¨ãƒªã‚‚ SELECT ã¨åŒæ§˜ã«ã€INSERT ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Author represents a row from 'booktest.authors'.</span></span><br><span class="line"><span class="keyword">type</span> Author <span class="keyword">struct</span> &#123;</span><br><span class="line">AuthorID <span class="keyword">int</span>    <span class="string">`json:"author_id"`</span> <span class="comment">// author_id</span></span><br><span class="line">Name     <span class="keyword">string</span> <span class="string">`json:"name"`</span>      <span class="comment">// name</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// xo fields</span></span><br><span class="line">_exists, _deleted <span class="keyword">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Insert inserts the Author to the database.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *Author)</span> <span class="title">Insert</span><span class="params">(db XODB)</span> <span class="title">error</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> err error</span><br><span class="line"></span><br><span class="line"><span class="comment">// if already exist, bail</span></span><br><span class="line"><span class="keyword">if</span> a._exists &#123;</span><br><span class="line"><span class="keyword">return</span> errors.New(<span class="string">"insert failed: already exists"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// sql insert query, primary key provided by sequence</span></span><br><span class="line"><span class="keyword">const</span> sqlstr = <span class="string">`INSERT INTO booktest.authors (`</span> +</span><br><span class="line"><span class="string">`name`</span> +</span><br><span class="line"><span class="string">`) VALUES (`</span> +</span><br><span class="line"><span class="string">`$1`</span> +</span><br><span class="line"><span class="string">`) RETURNING author_id`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// run query</span></span><br><span class="line">XOLog(sqlstr, a.Name)</span><br><span class="line">err = db.QueryRow(sqlstr, a.Name).Scan(&amp;a.AuthorID)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// set existence</span></span><br><span class="line">a._exists = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UPDATE, UPSERT, DELETE ç”¨ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚ç”Ÿæˆã•ã‚Œã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯å‰²æ„›ã—ã¾ã™ã€‚</p><h3 id="ãã®ä»–ç‰¹å¾´"><a href="#ãã®ä»–ç‰¹å¾´" class="headerlink" title="ãã®ä»–ç‰¹å¾´"></a>ãã®ä»–ç‰¹å¾´</h3><p><code>xo</code> ã§ç‰¹å¾´çš„ãªæ©Ÿèƒ½ã¯ã€ä»»æ„ã®ã‚¯ã‚¨ãƒªã‚’ã‚‚ã¨ã«æ§‹é€ ä½“ã‚’ç”Ÿæˆã§ãã‚‹ç‚¹ã§ã™ã€‚<code>books</code> ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ <code>authors</code> ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ JOIN ã—ã¦ <code>books</code> ã® <code>title</code> ã§æ–‡å­—åˆ—æ¤œç´¢ã™ã‚‹ã‚¯ã‚¨ãƒªã®ä¾‹ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚ä»¥ä¸‹ã¯ <code>xo</code> ã®ã‚³ãƒãƒ³ãƒ‰ä¾‹ã§ã™ã€‚SQL ã‚’è¨˜è¿°ã—ã¦æ§‹é€ ä½“ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®è©³ç´°ã¯ <a href="https://github.com/xo/xo/blob/master/README.md#command-line-options" target="_blank" rel="noopener">README.md</a> ã‚’å‚ç…§ãã ã•ã„ã€‚ </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">xo pgsql://booktest:pass@localhost:15432/testdb?sslmode=<span class="built_in">disable</span> -N -M -B -T AuthorBookResult --query-type-comment=<span class="string">'AuthorBookResult is the result of a search.'</span> -o generated &lt;&lt; ENDSQL</span><br><span class="line">SELECT</span><br><span class="line">  a.author_id AS author_id,</span><br><span class="line">  a.name AS author_name,</span><br><span class="line">  b.book_id AS book_id,</span><br><span class="line">  b.isbn AS book_isbn,</span><br><span class="line">  b.title AS book_title,</span><br><span class="line">  b.tags AS book_tags,</span><br><span class="line">  b.memo AS book_memo</span><br><span class="line">FROM books b</span><br><span class="line">JOIN authors a ON a.author_id = b.author_id</span><br><span class="line">WHERE b.title LIKE %%title string%%</span><br><span class="line">ENDSQL</span><br></pre></td></tr></table></figure><p>ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã¨ <code>authorbookresult.xo.go</code> ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒãƒ³ãƒ‰ã«è¨˜è¿°ã—ãŸã‚¯ã‚¨ãƒªã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã™ã‚‹ã‚«ãƒ©ãƒ ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¿æŒã™ã‚‹æ§‹é€ ä½“ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚SQL ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã™å¤‰æ•°ã®å‹ã¯ã€<code>xo</code> ã®ã‚³ãƒãƒ³ãƒ‰ã«è¨˜è¿°ã™ã‚‹ SQL ã®å†…ã« <code>int</code>, <code>string</code> ãªã©ã¨ã—ã¦æ˜ç¤ºçš„ã«è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Package generated contains the types for schema 'public'.</span></span><br><span class="line"><span class="keyword">package</span> generated</span><br><span class="line"></span><br><span class="line"><span class="comment">// Code generated by xo. DO NOT EDIT.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// AuthorBookResult is the result of a search.</span></span><br><span class="line"><span class="keyword">type</span> AuthorBookResult <span class="keyword">struct</span> &#123;</span><br><span class="line">AuthorID   <span class="keyword">int</span>         <span class="comment">// author_id</span></span><br><span class="line">AuthorName <span class="keyword">string</span>      <span class="comment">// author_name</span></span><br><span class="line">BookID     <span class="keyword">int</span>         <span class="comment">// book_id</span></span><br><span class="line">BookIsbn   <span class="keyword">string</span>      <span class="comment">// book_isbn</span></span><br><span class="line">BookTitle  <span class="keyword">string</span>      <span class="comment">// book_title</span></span><br><span class="line">BookTags   StringSlice <span class="comment">// book_tags</span></span><br><span class="line">BookMemo   <span class="keyword">string</span>      <span class="comment">// book_memo</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AuthorBookResultsByTitle runs a custom query, returning results as AuthorBookResult.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AuthorBookResultsByTitle</span><span class="params">(db XODB, title <span class="keyword">string</span>)</span> <span class="params">([]*AuthorBookResult, error)</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> err error</span><br><span class="line"></span><br><span class="line"><span class="comment">// sql query</span></span><br><span class="line"><span class="keyword">const</span> sqlstr = <span class="string">`SELECT `</span> +</span><br><span class="line"><span class="string">`a.author_id AS author_id, `</span> +</span><br><span class="line"><span class="string">`a.name AS author_name, `</span> +</span><br><span class="line"><span class="string">`b.book_id AS book_id, `</span> +</span><br><span class="line"><span class="string">`b.isbn AS book_isbn, `</span> +</span><br><span class="line"><span class="string">`b.title AS book_title, `</span> +</span><br><span class="line"><span class="string">`b.tags AS book_tags, `</span> +</span><br><span class="line"><span class="string">`b.memo AS book_memo `</span> +</span><br><span class="line"><span class="string">`FROM books b `</span> +</span><br><span class="line"><span class="string">`JOIN authors a ON a.author_id = b.author_id `</span> +</span><br><span class="line"><span class="string">`WHERE b.title LIKE $1`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// run query</span></span><br><span class="line">XOLog(sqlstr, title)</span><br><span class="line">q, err := db.Query(sqlstr, title)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> q.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// load results</span></span><br><span class="line">res := []*AuthorBookResult&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> q.Next() &#123;</span><br><span class="line">abr := AuthorBookResult&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// scan</span></span><br><span class="line">err = q.Scan(&amp;abr.AuthorID, &amp;abr.AuthorName, &amp;abr.BookID, &amp;abr.BookIsbn, &amp;abr.BookTitle, &amp;abr.BookTags, &amp;abr.BookMemo)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = <span class="built_in">append</span>(res, &amp;abr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> res, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½™è«‡ã§ã™ãŒã€ã‚«ã‚¹ã‚¿ãƒ  SQL ã‹ã‚‰æ§‹é€ ä½“ã‚’ç”Ÿæˆã™ã‚‹å ´åˆã€<code>-- hogehoge</code> ã¨ã„ã†ã‚³ãƒ¡ãƒ³ãƒˆã®è¨˜è¿°ã¯ã§ãã¾ã›ã‚“ã€‚ç”Ÿæˆã•ã‚Œã‚‹ SQL ãŒå£Šã‚Œã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã€å®Ÿè¡Œæ™‚ã®ãƒ­ã‚°ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦å‡ºåŠ›ã™ã‚‹ã¨æ˜ã‚‰ã‹ã§ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">generated.XOLog = log.Printf</span><br></pre></td></tr></table></figure><ul><li>å®Ÿè¡Œçµæœä¾‹</li></ul><p>æ–‡å­—åˆ—çµåˆã—ãŸ SQL ã§ã™ãŒã€<code>--</code> ã«ã‚ˆã£ã¦æ„å›³ã—ãªã„ç¯„å›²ã®è¨˜è¿°ã¾ã§ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚<code>/* hogehoge */</code> ã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¨˜è¿°ã™ã‚Œã° OK ã§ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2020/07/14 21:59:00 SELECT a.author_id AS author_id, a.name AS author_name, b.book_id AS book_id, b.isbn AS book_isbn, b.title AS book_title, b.tags AS book_tags, -- memo is memo b.memo AS book_memo FROM books b JOIN authors a ON a.author_id = b.author_id WHERE</span><br><span class="line"> b.title LIKE <span class="variable">$1</span>%!(EXTRA string=hoge)</span><br></pre></td></tr></table></figure><h3 id="æ‰€æ„Ÿ"><a href="#æ‰€æ„Ÿ" class="headerlink" title="æ‰€æ„Ÿ"></a>æ‰€æ„Ÿ</h3><ul><li>Good<ul><li>SQL ãŒæ–‡å­—åˆ—ã¨ã—ã¦æ˜ç¤ºã•ã‚Œã¦ã„ã¦ã€ã©ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªãŒç™ºè¡Œã•ã‚Œã‚‹ã‹åˆ†ã‹ã‚‹</li><li>ã‚¯ã‚¨ãƒªã‚’æ‰±ã†é–¢æ•°ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ãŒæ‰±ã†å‹ã‚’æ˜ç¤ºã—ã¦ã„ã¦æ‰±ã„ã‚„ã™ã„</li></ul></li><li>Bad<ul><li>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç”Ÿæˆã•ã‚ŒãŸã‚¯ã‚¨ãƒªã¯ Context ã‚’æ‰±ã†ã“ã¨ãŒã§ããšã€<code>Context</code> ã‚’ä½¿ã†å ´åˆã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å®Ÿè£…ãŒå¿…è¦</li><li>ç”Ÿæˆã•ã‚ŒãŸã‚¯ã‚¨ãƒªã‚’ <code>psql</code> ãªã©ã§æ¥ç¶šã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ç›´æ¥å®Ÿè¡Œã—ãŸã„å ´åˆã€æ–‡å­—åˆ—çµåˆã•ã‚ŒãŸã‚¯ã‚¨ãƒªã‚’é€£çµã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šæ‰‹é–“</li><li>ã‚«ã‚¹ã‚¿ãƒ ã‚¯ã‚¨ãƒªã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ã†å ´åˆã€ç‹¬è‡ªã®è¨˜è¿°æ–¹æ³•ãŒå¿…è¦ã€‚ã¾ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å†…ã« Go ã®å‹ã‚’åŸ‹ã‚è¾¼ã‚€å¿…è¦ãŒã‚ã‚Šã€ç…©é›‘</li><li>ã‚«ã‚¹ã‚¿ãƒ ã‚¯ã‚¨ãƒªã‚’ä½¿ã†å ´åˆã€SQL ã«ã‚³ãƒ¡ãƒ³ãƒˆ <code>-- hogehoge</code> ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã¨ã€ç”Ÿæˆã•ã‚Œã‚‹ã‚¯ã‚¨ãƒªãŒå£Šã‚Œã‚‹</li></ul></li></ul><h2 id="gen"><a href="#gen" class="headerlink" title="gen"></a>gen</h2><p>ç¶šã„ã¦ <code>gen</code> ã§ã™ã€‚<code>gen</code> ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚­ãƒ¼ãƒãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã¨ã«ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹(ç‰¹ã« <code>Gorm</code>)ã¨ãƒãƒƒãƒ”ãƒ³ã‚°å¯èƒ½ãªæ§‹é€ ä½“ã®ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚</p><p><code>gen</code> ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get -u github.com/smallnest/gen@v0.9.24</span><br></pre></td></tr></table></figure><p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã¯ <code>xo</code> ã‚’è©¦ã—ãŸã¨ãã¨åŒæ§˜ã«ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ãŠãã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ go.mod</span><br><span class="line">â”œâ”€â”€ main.go</span><br><span class="line">â””â”€â”€ generated</span><br></pre></td></tr></table></figure><p><code>gen</code> ã‚³ãƒãƒ³ãƒ‰ã§æ§‹é€ ä½“ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gen --connstr=<span class="string">"host=localhost port=15432 user=booktest password=pass dbname=testdb sslmode=disable"</span> --out generated --sqltype postgres --database testdb --no-json --overwrite</span><br><span class="line">table: books unable to generate struct field: tags <span class="built_in">type</span>: _VARCHAR error: unknown sql <span class="built_in">type</span>: _varchar</span><br><span class="line">Generating code <span class="keyword">for</span> the following tables (2)</span><br><span class="line">[0] authors</span><br><span class="line">[1] books</span><br></pre></td></tr></table></figure><p><code>generated</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã« <code>model</code> ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç”Ÿæˆã•ã‚Œã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸­ã« <code>authors.go</code>ã€<code>books.go</code> ã¨ <code>model_base.go</code> ã¨ã„ã† 3 ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚<code>books</code> ãƒ†ãƒ¼ãƒ–ãƒ«ã® <code>tags</code> ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿å‹ã¯ <code>varchar[]</code> å‹ã§ã—ãŸãŒã€<code>gen</code> ã§ç”Ÿæˆã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã€ç”Ÿæˆã•ã‚ŒãŸæ§‹é€ ä½“ã«ã¯ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ generated</span><br><span class="line">â”‚Â Â  â””â”€â”€ model</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ authors.go</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ books.go</span><br><span class="line">â”‚Â Â      â””â”€â”€ model_base.go</span><br><span class="line">â”œâ”€â”€ go.mod</span><br><span class="line">â””â”€â”€ go.sum</span><br></pre></td></tr></table></figure><p><code>gen</code> ã§ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿å‹ã¨æ§‹é€ ä½“ã®å‹ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ json ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ <code>--mapping=</code> ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ä»»æ„ã®å‹ã®ãƒãƒƒãƒ”ãƒ³ã‚°ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ãŠæ‰‹è»½ã‹ã¤æŸ”è»Ÿã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹ç‚¹ã¯éå¸¸ã«è‰¯ã„ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚ã‚«ãƒ©ãƒ ãŒ NULL ã‚’è¨±å®¹ã™ã‚‹ã‹ã©ã†ã‹ã§ NULL ã‚’æ‰±ãˆã‚‹å‹ãŒç”Ÿæˆã§ãã‚‹ç‚¹ã‚‚å¬‰ã—ã„ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚ãŸã ã— <a href="https://github.com/smallnest/gen/blob/v0.9.24/template/mapping.json" target="_blank" rel="noopener">mapping.json</a> ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ä»¥ä¸‹ã®ãƒãƒƒãƒ”ãƒ³ã‚°æƒ…å ±ã‚’è¿½åŠ ã—ã¦ <code>gen</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œæ™‚ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦ã‚‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"sql_type"</span>: <span class="string">"varchar[]"</span>,</span><br><span class="line">  <span class="attr">"go_type"</span>: <span class="string">"[]string"</span>,</span><br><span class="line">  <span class="attr">"json_type"</span>: <span class="string">"Text"</span>,</span><br><span class="line">  <span class="attr">"protobuf_type"</span>: <span class="string">"[]string"</span>,</span><br><span class="line">  <span class="attr">"guregu_type"</span>: <span class="string">"null.String"</span>,</span><br><span class="line">  <span class="attr">"go_nullable_type"</span>: <span class="string">"[]sql.NullString"</span>,</span><br><span class="line">  <span class="attr">"swagger_type"</span>: <span class="string">"string"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p><code>table: books unable to generate struct field: tags type: _VARCHAR error: unknown sql type: _varchar</code> ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã¯å‡ºåŠ›ã•ã‚Œã¦ã—ã¾ã„ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ç”Ÿæˆã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚è¬ã®ãƒãƒƒã‚¯ã§ã™ãŒã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã€ä»¥ä¸‹ã®ã‚ˆã†ã« <code>_varchar</code> å‹ã¨ã™ã‚‹ã¨ã†ã¾ãç”Ÿæˆã§ãã¾ã™ã€‚</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    &#123;</span><br><span class="line"><span class="deletion">-     "sql_type": "varchar[]",</span></span><br><span class="line"><span class="addition">+     "sql_type": "_varchar",</span></span><br><span class="line">      "go_type": "[]string",</span><br><span class="line">      "json_type": "Text",</span><br><span class="line">      "protobuf_type": "[]string",</span><br><span class="line">      "guregu_type": "null.String",</span><br><span class="line">      "go_nullable_type": "[]sql.NullString",</span><br><span class="line">      "swagger_type": "string"</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p>ã•ã¦ <code>books.go</code> ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨ <code>guregu/null</code> ã‚„ <code>satori/go.uuid</code> ã¨ã„ã£ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¦æ±‚ã•ã‚Œã¾ã™ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§æ‹¡å¼µã®ä½™åœ°ãŒã‚ã‚Šãã†ã§ã™ã€‚</p><figure class="highlight go"><figcaption><span>books.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"database/sql"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/guregu/null"</span></span><br><span class="line"><span class="string">"github.com/satori/go.uuid"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">_ = time.Second</span><br><span class="line">_ = sql.LevelDefault</span><br><span class="line">_ = null.Bool&#123;&#125;</span><br><span class="line">_ = uuid.UUID&#123;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">DB Table Details</span></span><br><span class="line"><span class="comment">-------------------------------------</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Table: books</span></span><br><span class="line"><span class="comment">[ 0] book_id                                        INT4                 null: false  primary: true   isArray: false  auto: false  col: INT4            len: -1      default: []</span></span><br><span class="line"><span class="comment">[ 1] author_id                                      INT4                 null: false  primary: false  isArray: false  auto: false  col: INT4            len: -1      default: []</span></span><br><span class="line"><span class="comment">[ 2] isbn                                           TEXT                 null: false  primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: ['']</span></span><br><span class="line"><span class="comment">[ 3] booktype                                       USER_DEFINED         null: false  primary: false  isArray: false  auto: false  col: USER_DEFINED    len: -1      default: ['FICTION']</span></span><br><span class="line"><span class="comment">[ 4] title                                          TEXT                 null: false  primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: ['']</span></span><br><span class="line"><span class="comment">[ 5] year                                           INT4                 null: false  primary: false  isArray: false  auto: false  col: INT4            len: -1      default: [2000]</span></span><br><span class="line"><span class="comment">[ 6] available                                      TIMESTAMPTZ          null: false  primary: false  isArray: false  auto: false  col: TIMESTAMPTZ     len: -1      default: ['2020-07-14 00:11:49.494152+00']</span></span><br><span class="line"><span class="comment">[ 7] tags                                           _VARCHAR             null: false  primary: false  isArray: false  auto: false  col: _VARCHAR        len: -1      default: ['&#123;&#125;']</span></span><br><span class="line"><span class="comment">[ 8] memo                                           TEXT                 null: true   primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: []</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">JSON Sample</span></span><br><span class="line"><span class="comment">-------------------------------------</span></span><br><span class="line"><span class="comment">&#123;    "booktype": 46,    "title": "EBVYCwqfRlayFOFOmrVgcynTE",    "year": 11,    "available": "2272-12-29T02:27:30.083660182+09:00",    "tags": "VHTlEZoMqhtKpSMUrcdhBiUxj",    "book_id": 14,    "author_id": 44,    "isbn": "gxvRbsFhNSFstWgOZBWVeGWvX"&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Books struct is a row record of the books table in the testdb database</span></span><br><span class="line"><span class="keyword">type</span> Books <span class="keyword">struct</span> &#123;</span><br><span class="line"><span class="comment">//[ 0] book_id                                        INT4                 null: false  primary: true   isArray: false  auto: false  col: INT4            len: -1      default: []</span></span><br><span class="line">BookID <span class="keyword">int32</span></span><br><span class="line"><span class="comment">//[ 1] author_id                                      INT4                 null: false  primary: false  isArray: false  auto: false  col: INT4            len: -1      default: []</span></span><br><span class="line">AuthorID <span class="keyword">int32</span></span><br><span class="line"><span class="comment">//[ 2] isbn                                           TEXT                 null: false  primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: ['']</span></span><br><span class="line">Isbn <span class="keyword">string</span></span><br><span class="line"><span class="comment">//[ 3] booktype                                       USER_DEFINED         null: false  primary: false  isArray: false  auto: false  col: USER_DEFINED    len: -1      default: ['FICTION']</span></span><br><span class="line">Booktype <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"><span class="comment">//[ 4] title                                          TEXT                 null: false  primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: ['']</span></span><br><span class="line">Title <span class="keyword">string</span></span><br><span class="line"><span class="comment">//[ 5] year                                           INT4                 null: false  primary: false  isArray: false  auto: false  col: INT4            len: -1      default: [2000]</span></span><br><span class="line">Year <span class="keyword">int32</span></span><br><span class="line"><span class="comment">//[ 6] available                                      TIMESTAMPTZ          null: false  primary: false  isArray: false  auto: false  col: TIMESTAMPTZ     len: -1      default: ['2020-07-14 00:11:49.494152+00']</span></span><br><span class="line">Available time.Time</span><br><span class="line"><span class="comment">//[ 8] memo                                           TEXT                 null: true   primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: []</span></span><br><span class="line">Memo sql.NullString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> booksTableInfo = &amp;TableInfo&#123;</span><br><span class="line">Name: <span class="string">"books"</span>,</span><br><span class="line">Columns: []*ColumnInfo&#123;</span><br><span class="line"></span><br><span class="line">&amp;ColumnInfo&#123;</span><br><span class="line">Index:              <span class="number">0</span>,</span><br><span class="line">Name:               <span class="string">"book_id"</span>,</span><br><span class="line">Comment:            <span class="string">``</span>,</span><br><span class="line">Notes:              <span class="string">``</span>,</span><br><span class="line">Nullable:           <span class="literal">false</span>,</span><br><span class="line">DatabaseTypeName:   <span class="string">"INT4"</span>,</span><br><span class="line">DatabaseTypePretty: <span class="string">"INT4"</span>,</span><br><span class="line">IsPrimaryKey:       <span class="literal">true</span>,</span><br><span class="line">IsAutoIncrement:    <span class="literal">false</span>,</span><br><span class="line">IsArray:            <span class="literal">false</span>,</span><br><span class="line">ColumnType:         <span class="string">"INT4"</span>,</span><br><span class="line">ColumnLength:       <span class="number">-1</span>,</span><br><span class="line">GoFieldName:        <span class="string">"BookID"</span>,</span><br><span class="line">GoFieldType:        <span class="string">"int32"</span>,</span><br><span class="line">JSONFieldName:      <span class="string">"book_id"</span>,</span><br><span class="line">ProtobufFieldName:  <span class="string">"book_id"</span>,</span><br><span class="line">ProtobufType:       <span class="string">"int32"</span>,</span><br><span class="line">ProtobufPos:        <span class="number">1</span>,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... çœç•¥</span></span><br><span class="line"></span><br><span class="line">&amp;ColumnInfo&#123;</span><br><span class="line">Index:              <span class="number">8</span>,</span><br><span class="line">Name:               <span class="string">"memo"</span>,</span><br><span class="line">Comment:            <span class="string">``</span>,</span><br><span class="line">Notes:              <span class="string">``</span>,</span><br><span class="line">Nullable:           <span class="literal">true</span>,</span><br><span class="line">DatabaseTypeName:   <span class="string">"TEXT"</span>,</span><br><span class="line">DatabaseTypePretty: <span class="string">"TEXT"</span>,</span><br><span class="line">IsPrimaryKey:       <span class="literal">false</span>,</span><br><span class="line">IsAutoIncrement:    <span class="literal">false</span>,</span><br><span class="line">IsArray:            <span class="literal">false</span>,</span><br><span class="line">ColumnType:         <span class="string">"TEXT"</span>,</span><br><span class="line">ColumnLength:       <span class="number">-1</span>,</span><br><span class="line">GoFieldName:        <span class="string">"Memo"</span>,</span><br><span class="line">GoFieldType:        <span class="string">"sql.NullString"</span>,</span><br><span class="line">JSONFieldName:      <span class="string">"memo"</span>,</span><br><span class="line">ProtobufFieldName:  <span class="string">"memo"</span>,</span><br><span class="line">ProtobufType:       <span class="string">"string"</span>,</span><br><span class="line">ProtobufPos:        <span class="number">9</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TableName sets the insert table name for this struct type</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *Books)</span> <span class="title">TableName</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"books"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BeforeSave invoked before saving, return an error if field is not populated.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *Books)</span> <span class="title">BeforeSave</span><span class="params">()</span> <span class="title">error</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Prepare invoked before saving, can be used to populate fields etc.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *Books)</span> <span class="title">Prepare</span><span class="params">()</span></span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Validate invoked before performing action, return an error if field is not populated.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *Books)</span> <span class="title">Validate</span><span class="params">(action Action)</span> <span class="title">error</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TableInfo return table meta data</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *Books)</span> <span class="title">TableInfo</span><span class="params">()</span> *<span class="title">TableInfo</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> booksTableInfo</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Gorm</code> ã‚’æ„è­˜ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãªã£ã¦ãŠã‚Šã€<code>gen</code> ã‚³ãƒãƒ³ãƒ‰ã« <code>--gorm</code> ã¨ã„ã†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä»˜ä¸ã™ã‚‹ã¨ç”Ÿæˆã™ã‚‹æ§‹é€ ä½“ã« <code>Gorm</code> ã®ã‚¿ã‚°ãŒä»˜ä¸ã•ã‚Œã¾ã™ã€‚<code>authors.go</code> ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»˜ä¸ã•ã‚ŒãŸã‚¿ã‚°ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Authors struct is a row record of the authors table in the testdb database</span></span><br><span class="line"><span class="keyword">type</span> Authors <span class="keyword">struct</span> &#123;</span><br><span class="line"><span class="comment">//[ 0] author_id                                      INT4                 null: false  primary: true   isArray: false  auto: false  col: INT4            len: -1      default: []</span></span><br><span class="line">AuthorID <span class="keyword">int32</span> <span class="string">`gorm:"primary_key;column:author_id;type:INT4;"`</span></span><br><span class="line"><span class="comment">//[ 1] name                                           TEXT                 null: false  primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: ['']</span></span><br><span class="line">Name <span class="keyword">string</span> <span class="string">`gorm:"column:name;type:TEXT;default:'';"`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>gorm:&quot;primary_key;column:author_id;type:INT4;&quot;</code> ã¨ã„ã£ãŸã‚¿ã‚°ãŒä»˜ä¸ã•ã‚Œã¦ã„ã¾ã™ã€‚æ§‹é€ ä½“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦ä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ <code>TableName()</code> ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚ãŠãã‚‰ã <code>Gorm</code> ã‚’æ„è­˜ã—ãŸã‚‚ã®ã§ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãª <code>TableName()</code> ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã¨ <code>Gorm</code> ã®ãƒ†ãƒ¼ãƒ–ãƒ«åã¨ã—ã¦ <code>string</code> ã®æ–‡å­—åˆ—ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã®å ´åˆãƒ†ãƒ¼ãƒ–ãƒ«åã¯ <code>authors</code> ã§ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TableName sets the insert table name for this struct type</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *Authors)</span> <span class="title">TableName</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"authors"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã¡ãªã¿ã« <code>Gorm</code> ã®æ§‹é€ ä½“ã¨ã—ã¦ç”Ÿæˆã•ã‚Œã‚‹ã‚¿ã‚°ã§ã™ãŒã€å¤–éƒ¨ã‚­ãƒ¼ã¯ä»˜ä¸ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚<code>books</code> ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãŠã‘ã‚‹ <code>author_id</code> ã¯ <code>authors</code> ã®å¤–éƒ¨ã‚­ãƒ¼ã§ã™ãŒã€<code>Gorm</code> ã®æ§‹é€ ä½“ã‚’è¦‹ã‚‹ã¨ã€å¤–éƒ¨ã‚­ãƒ¼ã§ã‚ã‚‹ã‚¿ã‚°ã¯ä»˜ä¸ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Books struct is a row record of the books table in the testdb database</span></span><br><span class="line"><span class="keyword">type</span> Books <span class="keyword">struct</span> &#123;</span><br><span class="line"><span class="comment">//[ 0] book_id                                        INT4                 null: false  primary: true   isArray: false  auto: false  col: INT4            len: -1      default: []</span></span><br><span class="line">BookID <span class="keyword">int32</span> <span class="string">`gorm:"primary_key;column:book_id;type:INT4;"`</span></span><br><span class="line"><span class="comment">//[ 1] author_id                                      INT4                 null: false  primary: false  isArray: false  auto: false  col: INT4            len: -1      default: []</span></span><br><span class="line">AuthorID <span class="keyword">int32</span> <span class="string">`gorm:"column:author_id;type:INT4;"`</span></span><br><span class="line"><span class="comment">//[ 2] isbn                                           TEXT                 null: false  primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: ['']</span></span><br><span class="line">Isbn <span class="keyword">string</span> <span class="string">`gorm:"column:isbn;type:TEXT;default:'';"`</span></span><br><span class="line"><span class="comment">//[ 3] booktype                                       USER_DEFINED         null: false  primary: false  isArray: false  auto: false  col: USER_DEFINED    len: -1      default: ['FICTION']</span></span><br><span class="line">Booktype <span class="keyword">interface</span>&#123;&#125; <span class="string">`gorm:"column:booktype;"`</span></span><br><span class="line"><span class="comment">//[ 4] title                                          TEXT                 null: false  primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: ['']</span></span><br><span class="line">Title <span class="keyword">string</span> <span class="string">`gorm:"column:title;type:TEXT;default:'';"`</span></span><br><span class="line"><span class="comment">//[ 5] year                                           INT4                 null: false  primary: false  isArray: false  auto: false  col: INT4            len: -1      default: [2000]</span></span><br><span class="line">Year <span class="keyword">int32</span> <span class="string">`gorm:"column:year;type:INT4;default:2000;"`</span></span><br><span class="line"><span class="comment">//[ 6] available                                      TIMESTAMPTZ          null: false  primary: false  isArray: false  auto: false  col: TIMESTAMPTZ     len: -1      default: ['2020-07-14 00:11:49.494152+00']</span></span><br><span class="line">Available time.Time <span class="string">`gorm:"column:available;type:TIMESTAMPTZ;default:'2020-07-14 00:11:49.494152+00';"`</span></span><br><span class="line"><span class="comment">//[ 8] memo                                           TEXT                 null: true   primary: false  isArray: false  auto: false  col: TEXT            len: -1      default: []</span></span><br><span class="line">Memo sql.NullString <span class="string">`gorm:"column:memo;type:TEXT;"`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ‰€æ„Ÿ-1"><a href="#æ‰€æ„Ÿ-1" class="headerlink" title="æ‰€æ„Ÿ"></a>æ‰€æ„Ÿ</h3><ul><li>Good<ul><li><code>Gorm</code> ã‚„ <code>db</code> ã¨ã„ã£ãŸ ORM ã¨é€£æºã§ãã‚‹ã‚¿ã‚°ãŒä»˜ä¸ã•ã‚ŒãŸæ§‹é€ ä½“ã‚’ç”Ÿæˆã§ãã‚‹</li><li>æ‹¡å¼µã§ãã‚‹ç‚¹ãŒå¤šãã€æŸ”è»Ÿã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹</li></ul></li><li>Bad<ul><li>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨ç”Ÿæˆã•ã‚Œã‚‹æ§‹é€ ä½“ãŒã‚„ã‚„é‡åš</li><li><code>varchar[]</code> å‹ãŒã‚ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰æ§‹é€ ä½“ã‚’ç”Ÿæˆã—ãŸå ´åˆã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ãªã©ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯æ‰±ãˆãªã„ãƒ‡ãƒ¼ã‚¿å‹ãŒã‚ã‚‹</li></ul></li></ul><h2 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h2><p>ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰ã‚¯ã‚¨ãƒªã‚’æ‰±ã†é–¢æ•°ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã€æ§‹é€ ä½“ã‚’ç”Ÿæˆã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª¿æŸ»ã—ã¾ã—ãŸ</p><p><code>xo</code> ã¯ <code>SQLBoiler</code> ã¨åŒã˜ã‚ˆã†ãªç³»çµ±ã§ã€ã‚¹ã‚­ãƒ¼ãƒã‚„ SQL ã‚’ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªé–¢æ•°ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”Ÿæˆã—ã¾ã™ã€‚<code>gen</code> ã¯ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰æ§‹é€ ä½“ã‚’ç”Ÿæˆã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚<code>Gorm</code> ã‚„ <code>sqlx</code> ã¨ã„ã£ãŸ ORM ãªã©ã¨ä¸€ç·’ã«ä½¿ã†å¿…è¦ãŒã‚ã‚‹ã§ã—ã‚‡ã†ã€‚</p><p>ã„ãšã‚Œã«ã—ã¦ã‚‚ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰æ§‹é€ ä½“ã‚’ç”Ÿæˆã§ãã‚‹ç‚¹ã¯é–‹ç™ºä½“é¨“ã¨ã—ã¦è‰¯ã„ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚<code>xo</code> ã‚‚ <code>gen</code> ã‚‚ç‰¹å¾´çš„ã§ã€èˆˆå‘³æ·±ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ãŸã ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é–‹ç™ºã«çµ„ã¿è¾¼ã‚“ã§ã„ãã«ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æ‹¡å¼µãªã©ã„ãã¤ã‹å·¥å¤«ã¯å¿…è¦ã ã¨æ„Ÿã˜ã¾ã—ãŸã€‚</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;">ã‚¹ã‚­ãƒ¼ãƒã‚’å¤‰æ›´ã—ãŸå ´åˆã€æ§‹é€ ä½“ã®ç”Ÿæˆã ã‘ã§ãªããƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†ãŒå¿…è¦ã§ã™ãŒã€æœ¬è¨˜äº‹ã§ã¯ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®è©±ã¯å‰²æ„›ã—ã¾ã™ã€‚</span><a href="#fnref:1" rev="footnote"> â†©</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;a href=&quot;#ã¯ã˜ã‚ã«&quot; class=&quot;headerlink&quot; title=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;/a&gt;ã¯ã˜ã‚ã«&lt;/h2&gt;&lt;p&gt;Goã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ‰±ã†å ´åˆã€&lt;a href=&quot;https://github.com/go-gorm/gorm&quot; targe
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="DB" scheme="https://future-architect.github.io/tags/DB/"/>
    
      <category term="Go" scheme="https://future-architect.github.io/tags/Go/"/>
    
      <category term="ORM" scheme="https://future-architect.github.io/tags/ORM/"/>
    
  </entry>
  
  <entry>
    <title>Goã‹ã‚‰AWS Kinesisã®AggregationFormatã‚’åˆ©ç”¨ã™ã‚‹</title>
    <link href="https://future-architect.github.io/articles/20200727/"/>
    <id>https://future-architect.github.io/articles/20200727/</id>
    <published>2020-07-26T15:00:00.000Z</published>
    <updated>2020-07-27T00:25:08.109Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://future-architect.github.io/tags/Serverless%E9%80%A3%E8%BC%89/">ã‚µãƒ¼ãƒãƒ¬ã‚¹é€£è¼‰ä¼ç”»</a>ã®8å›ç›®ã§ã™ã€‚</p><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>TIG DXãƒ¦ãƒ‹ãƒƒãƒˆã®çœŸé‡ã§ã™ã€‚ã“ã“æ•°å¹´ã¯ç”£æ¥­å‘ã‘ã®IoTï¼ˆä¾‹ãˆã°å·¥å ´IoTã‚„ãƒ¢ãƒ“ãƒªãƒ†ã‚£IoTï¼‰ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚<a href="https://future-architect.github.io/articles/20191023/">å·¥å ´ã‚’ãƒãƒƒã‚¯ã™ã‚‹ãŸã‚ã®åŸºæœ¬çŸ¥è­˜</a>ã‚„<a href="https://future-architect.github.io/articles/20200422/">PyConJP 2019ã«ç™»å£‡ã—ã¾ã—ãŸ</a> ã®è¨˜äº‹ã‚’æ›¸ã„ãŸæ —ç”°ã•ã‚“ã‚„ã€<a href="https://future-architect.github.io/articles/20191201/">SORACOM USBãƒ‰ãƒ³ã‚°ãƒ«ã®è‡ªå‹•æ¥ç¶š</a> ã®è¨˜äº‹ã‚’æ›¸ã„ãŸæ£šäº•ã•ã‚“ã¨åŒã˜ãƒãƒ¼ãƒ ã«æ‰€å±ã—ã¦ã„ã¾ã™ã€‚</p><p><a href="https://future-architect.github.io/tags/Serverless%E9%80%A3%E8%BC%89/">ã‚µãƒ¼ãƒãƒ¬ã‚¹é€£è¼‰ä¼ç”»</a> ã®ç¬¬8å¼¾ç›®ã¨ã—ã¦ã€Serverlessã®ä»£è¡¨æ ¼ã§ã‚ã‚‹AWS Lambdaã§Goã‚’ç”¨ã„ã¦Kinesisã«å¯¾ã™ã‚‹KPL/KCLç›¸å½“ã®å‡¦ç†ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã„ãã¾ã™ã€‚</p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æŸIoTã‚’ãƒ†ãƒ¼ãƒã¨ã—ãŸæ¡ˆä»¶ã§ã€Kinesisã‚’ç”¨ã„ãŸã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ETLãªãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹ã«ã‚ãŸã£ã¦ã€ä¸‹å›³ã®ã‚ˆã†ã«Kinesisã®å¾Œæ®µã¯Goã¨Lambdaã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚KinesisãŒå¤šæ®µã«ãªã£ã¦ã„ã‚‹ã®ã¯ã€Rawãƒ‡ãƒ¼ã‚¿ã¨åŠ å·¥æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’åˆ¥ã‚·ã‚¹ãƒ†ãƒ ã§åˆ©ç”¨ã—ãŸã‹ã£ãŸãŸã‚ã§ã™ã€‚</p><p><img src="/images/20200727/abstract.png" alt=""></p><p>æœ€åˆã«Kinesisã«Publishã™ã‚‹ECSã¯Javaã®KPLï¼ˆKinesis Producer Libraryï¼‰ã‚’ç”¨ã„ã¦ãŠã‚Šã€å½“ç„¶Aggregation Format(å¾Œè¿°ã—ã¾ã™)ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ãŒã€å¾Œç¶šã®Goã‚¢ãƒ—ãƒªã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ <strong>DeAggregation</strong> ã™ã‚‹å‡¦ç†ã¨ã€å¾Œç¶šã®Kinesisã¸ã®å†åº¦ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ <strong>Aggregation</strong> ã™ã‚‹æ–¹æ³•ãŒã‚ã¾ã‚Šè¦‹å½“ãŸã‚‰ãªã‹ã£ãŸã®ã§ã€å®Ÿè£…ä¾‹ã‚’æ®‹ã—ã¾ã™ã€‚</p><p>ã“ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã§è¨˜è¼‰ã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã«è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚</p><p><a href="https://github.com/laqiiz/go-kinesis-aggr-example" target="_blank" rel="noopener">https://github.com/laqiiz/go-kinesis-aggr-example</a></p><h1 id="Kineis-Data-Streamã¨ã¯"><a href="#Kineis-Data-Streamã¨ã¯" class="headerlink" title="Kineis Data Streamã¨ã¯"></a>Kineis Data Streamã¨ã¯</h1><blockquote><p>Amazon Kinesis Data Streams (KDS) ã¯ã€å¤§è¦æ¨¡ã«ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ã§æŒç¶šçš„ãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚(ä¸­ç•¥) åé›†ãƒ‡ãƒ¼ã‚¿ã¯ãƒŸãƒªç§’ã§å…¥æ‰‹ã§ãã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚„ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç•°å¸¸æ¤œçŸ¥ã€ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ãªä¾¡æ ¼è¨­å®šãªã©ã®äº‹ä¾‹ã«åˆ©ç”¨å¯èƒ½ã§ã™ã€‚<br><a href="https://aws.amazon.com/jp/kinesis/data-streams/" target="_blank" rel="noopener">https://aws.amazon.com/jp/kinesis/data-streams/</a></p></blockquote><p>ç°¡å˜ã«è¨€ã†ã¨AWSä¸Šã§Pub-Subãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚’è¡Œãˆã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚Kinesisã®æ–‡è„ˆã§ã¯ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹Publishå´ã‚’Producerã€ãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡ã™ã‚‹Subscribeå´ã‚’Consumerã¨å‘¼ã³ã¾ã™ã€‚SQSã¨ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éåŒæœŸã«é€£æºã™ã‚‹éƒ¨åˆ†ã¯åŒã˜ã§ã™ãŒã€Consumerå´ã‚’Nå€‹é…ç½®ã§ãã‚‹ã¨ã“ã‚ãªã©ãŒç•°ãªã‚Šã¾ã™ã€‚</p><h1 id="Kinesis-Record-Aggregation-amp-Deaggregation"><a href="#Kinesis-Record-Aggregation-amp-Deaggregation" class="headerlink" title="Kinesis Record Aggregation &amp; Deaggregation"></a>Kinesis Record Aggregation &amp; Deaggregation</h1><p>Kinesisã«ã¯Record Aggregationï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰ã®é›†ç´„ï¼‰ã¨ã„ã£ãŸè€ƒãˆæ–¹ãŒã‚ã‚Šã¾ã™ã€‚</p><p>èƒŒæ™¯ã¨ã—ã¦KDSã¸ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’Produceã™ã‚‹ã¨ãã®èª²é‡‘å˜ä½ã¯ã€<a href="https://aws.amazon.com/jp/kinesis/data-streams/faqs/" target="_blank" rel="noopener">25KBã‚’ã—ãã„å€¤ã¨ã—ãŸæ›¸ãè¾¼ã¿æ•°ã§èª²é‡‘</a>ã•ã‚Œã¾ã™ã€‚25KBã‚ˆã‚Šå°ã•ãã¦ã‚‚åŒã˜æ–™é‡‘ãŒèª²é‡‘ã•ã‚Œã‚‹ãŸã‚ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã‚µã‚¤ã‚ºãŒå°ã•ã„å ´åˆã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é›†ç´„ã™ã‚‹ã“ã¨ãŒæœ‰åŠ¹ã§ã™ã€‚åŒæ™‚ã«ã€å°ã•ãã¦ç´°ã‹ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’1ã¤ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«é›†ç´„ã™ã‚‹ã“ã¨ã§ã€HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ†ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒç„¡ãã›ã‚‹ã®ã§ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚’ä¸Šã’ã‚‹åŠ¹æœã‚‚æœŸå¾…ã§ãã¾ã™ã€‚</p><figure class="highlight plain"><figcaption><span>é›†ç´„ã‚¤ãƒ¡ãƒ¼ã‚¸</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">record 0 --|</span><br><span class="line">record 1   |        [ Aggregation ]</span><br><span class="line">    ...    |--&gt; Amazon Kinesis record --&gt;  PutRecords Request</span><br><span class="line">    ...    |                              </span><br><span class="line">record A --|</span><br></pre></td></tr></table></figure><p>AWSã§ã“ã®25KBä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é›†ç´„ã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯ã€<strong>KPL Aggregated Record Format</strong>ã¨å‘¼ã¶ãã†ã§ã™ã€‚ä»•æ§˜ã¯ä»¥ä¸‹ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚</p><p><a href="https://github.com/awslabs/amazon-kinesis-producer/blob/master/aggregation-format.md" target="_blank" rel="noopener">https://github.com/awslabs/amazon-kinesis-producer/blob/master/aggregation-format.md</a></p><p>æ¦‚è¦ã ã‘ã¾ã¨ã‚ã‚‹ã¨ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚</p><ul><li>å…ˆé ­ã«4ãƒã‚¤ãƒˆã®ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã¯<code>0xF3 0x89 0x9A 0xC2</code> ãŒã¤ã</li><li>ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒãƒƒãƒ•ã‚¡ï¼ˆproto2ï¼‰ã‚’åˆ©ç”¨ã—ãŸãƒã‚¤ãƒŠãƒªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</li><li>æœ€å¾Œã«16ãƒã‚¤ãƒˆã®MD5ãƒã‚§ãƒƒã‚¯ã‚µãƒ </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0               4                  N          N+15</span><br><span class="line">+---+---+---+---+&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;+---+...+---+</span><br><span class="line">|  MAGIC NUMBER | PROTOBUF MESSAGE |    MD5    |</span><br><span class="line">+---+---+---+---+&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;+---+...+---+</span><br></pre></td></tr></table></figure><p><code>PROTOBUF MESSAGE</code> éƒ¨åˆ†ã¯ä»¥ä¸‹ã®å®šç¾©ã§ã™ã€‚Proto ã‚’çŸ¥ã‚‰ãªã„äººã«è£œè¶³ã™ã‚‹ã¨ <code>repeated</code> ã¯JSONã§ã„ã†é…åˆ—ã‚’ç¤ºã™å®£è¨€ã§ã™ã€‚<code>AggregatedRecord</code> ã§Kinesisã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã‚’è¤‡æ•°å®£è¨€ã™ã‚‹ã®ãŒç‰¹å¾´çš„ã§ã™ã­ã€‚ã‚‚ã—ã€è¤‡æ•°ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒåŒã˜ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã‚’æŒ‡å®šã™ã‚‹ã¨ã™ã‚‹ã¨ã€åŠ¹ç‡ã‚ˆãã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºãŒã§ããã†ã§ã™ã€‚</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">AggregatedRecord</span> </span>&#123;</span><br><span class="line">  <span class="keyword">repeated</span> <span class="built_in">string</span> partition_key_table     = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">repeated</span> <span class="built_in">string</span> explicit_hash_key_table = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">repeated</span> Record records                 = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SubMessage</span></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Tag</span> </span>&#123;</span><br><span class="line">  <span class="keyword">required</span> <span class="built_in">string</span> key   = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">optional</span> <span class="built_in">string</span> value = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Record</span> </span>&#123;</span><br><span class="line">  <span class="keyword">required</span> <span class="built_in">uint64</span> partition_key_index     = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">optional</span> <span class="built_in">uint64</span> explicit_hash_key_index = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">required</span> <span class="built_in">bytes</span>  data                    = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">repeated</span> Tag    tags                    = <span class="number">4</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç´°ã‹ãèª¬æ˜ã—ã¾ã—ãŸãŒã€KPL Aggregated Record Formatã®æ§‹é€ ã‚’çŸ¥ã‚‰ãªãã¦ã‚‚æ—¢å­˜ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ´»ç”¨ã™ã‚Œã°åˆ©ç”¨å¯èƒ½ã§ã™ã®ã§ã”å®‰å¿ƒãã ã•ã„ã€‚</p><h2 id="Record-Aggregation-ã¨-PutRecordsã®åŒºåˆ¥"><a href="#Record-Aggregation-ã¨-PutRecordsã®åŒºåˆ¥" class="headerlink" title="Record Aggregation ã¨ PutRecordsã®åŒºåˆ¥"></a>Record Aggregation ã¨ PutRecordsã®åŒºåˆ¥</h2><p>ã¡ã‚‡ã£ã¨ã‚„ã‚„ã“ã—ã„ã®ãŒã€ Kinesisã«ã¯è¤‡æ•°RECORDã‚’ä¸€åº¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ç™»éŒ²ã™ã‚‹<a href="https://aws.amazon.com/jp/blogs/aws/kinesis-update-putrecords-api/" target="_blank" rel="noopener">PutRecords</a>ã¨ã„ã†APIãŒã‚ã‚Šã¾ã™ãŒã€ Record Aggregationã¯ãã‚Œã¨ã¯ç•°ãªã‚Šã¾ã™ï¼ˆåˆ¥ã®æ¦‚å¿µãªã®ã§å…±å­˜ã§ãã¾ã™ï¼‰ã€‚PutRecordsã¯ã‚ãã¾ã§è¤‡æ•°ã®RECORDã‚’1åº¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«æŸã­ã‚‹ã‚‚ã®ã§ã‚ã£ã¦ã€Aggregated Formatã¯è¤‡æ•°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’1ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«é›†ç´„ã™ã‚‹ç‚¹ãŒé•ã„ã§ã™ã€‚PutRecordsã¯HTTP Requestã®ç™ºè¡Œã‚’æŠ‘ãˆã‚‰ã‚Œã‚‹åˆ†ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã®å‘ä¸ŠãŒæœŸå¾…ã§ãã‚‹ç‚¹ã¯ã€Aggregated Formatã¨åŒã˜ã§ã™ãŒã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°ã¯å¤‰åŒ–ãªã„ã®ã§æ–™é‡‘ã¯åŒã˜ã§ã™ã€‚å½“ç„¶åˆ¥ç‰©ãªã®ã§Aggregated Formatã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’PutRecordsã‚‚ã§ãã¾ã™ã€‚</p><h1 id="å®Ÿæ–½æ–¹æ³•"><a href="#å®Ÿæ–½æ–¹æ³•" class="headerlink" title="å®Ÿæ–½æ–¹æ³•"></a>å®Ÿæ–½æ–¹æ³•</h1><p><a href="https://aws.amazon.com/jp/sdk-for-go/" target="_blank" rel="noopener">AWS SDK for Go</a> ã§Kinesisã«å¯¾ã™ã‚‹Produce/Consumeã¯ã§ãã¾ã™ãŒã€æ¨™æº–ã§ã¯Aggregation/DeAggregationã¯ã§ãã¾ã›ã‚“ã€‚ãã®ãŸã‚ä»¥ä¸‹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p><ul><li><strong>Aggregation</strong>:  <a href="https://github.com/a8m/kinesis-producer" target="_blank" rel="noopener">a8m/kinesis-producer</a> </li><li><strong>DeAggregation</strong>: <a href="https://github.com/awslabs/kinesis-aggregation" target="_blank" rel="noopener">awslabs/kinesis-aggregation</a></li></ul><p>DeAggregationã«é–¢ã—ã¦ã¯AWSLabã®ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆ©ç”¨ã§ãã‚‹ã®ã§ã¡ã‚‡ã£ã¨å®‰å¿ƒã§ãã¾ã™ã­ã€‚åˆ©ç”¨æ–¹æ³•ã¯ç°¡å˜ã‹ã¨è¨€ã‚ã‚Œã‚‹ã¨ï¼Ÿã§ã—ãŸã®ã§ã“ã“ã«åˆ©ç”¨æ–¹æ³•ã‚’æ®‹ã—ã¦ã„ãã¾ã™ã€‚</p><h1 id="åˆ©ç”¨æ–¹æ³•"><a href="#åˆ©ç”¨æ–¹æ³•" class="headerlink" title="åˆ©ç”¨æ–¹æ³•"></a>åˆ©ç”¨æ–¹æ³•</h1><p>ãã‚Œãã‚Œã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åˆ©ç”¨æ‰‹é †ã‚’èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚ã“ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã§è¨˜è¼‰ã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã«è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚</p><p><a href="https://github.com/laqiiz/go-kinesis-aggr-example" target="_blank" rel="noopener">https://github.com/laqiiz/go-kinesis-aggr-example</a></p><h2 id="Aggregateï¼ˆa8m-kinesis-producerï¼‰"><a href="#Aggregateï¼ˆa8m-kinesis-producerï¼‰" class="headerlink" title="Aggregateï¼ˆa8m/kinesis-producerï¼‰"></a>Aggregateï¼ˆa8m/kinesis-producerï¼‰</h2><p>æœ€åˆã«ã‚³ãƒ¼ãƒ‰ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’è¼‰ã›ã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>é›†ç´„å´ã®å®Ÿè£…ä¾‹</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"os"</span></span><br><span class="line"><span class="string">"github.com/a8m/kinesis-producer"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/events"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/lambda"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-sdk-go/aws"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-sdk-go/aws/session"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-sdk-go/service/kinesis"</span></span><br><span class="line"><span class="string">"golang.org/x/sync/errgroup"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> kc = kinesis.New(session.Must(session.NewSession()))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(e events.KinesisEvent)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"ã€Start Aggregation Lambdaã€‘"</span>, <span class="built_in">len</span>(e.Records))</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pr = producer.New(&amp;producer.Config&#123;</span><br><span class="line">StreamName: os.Getenv(<span class="string">"KINESIS_STREAM"</span>),</span><br><span class="line">Client:     kc,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">eg := errgroup.Group&#123;&#125;</span><br><span class="line"></span><br><span class="line">pr.Start() <span class="comment">// Producerç”¨ã®goroutineèµ·å‹•</span></span><br><span class="line">eg.Go(<span class="function"><span class="keyword">func</span><span class="params">()</span> <span class="title">error</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> r := <span class="keyword">range</span> pr.NotifyFailures() &#123;</span><br><span class="line"><span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, r := <span class="keyword">range</span> e.Records &#123;</span><br><span class="line"><span class="comment">// TODO å–å¾—ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã«å¯¾ã™ã‚‹ä½•ã‹ã—ã‚‰ã®å‡¦ç†ã€‚ã“ã“ã§ã¯å˜ç´”ã«é›†ç´„ã—ã¦çµ‚ã‚ã‚Š</span></span><br><span class="line"><span class="keyword">if</span> err := pr.Put(r.Kinesis.Data, r.Kinesis.PartitionKey); err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">pr.Stop() <span class="comment">// é€ä¿¡ä¸­ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã®flushã¨ã€Producer goroutineã®åœæ­¢</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> eg.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§åˆæœŸåŒ–ã—ã¦ã„ã‚‹ã®ãŒã€Kinesis Producerã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã™ã€‚<code>handle</code>é–¢æ•°å†…éƒ¨ãŒã‚„ã‚„ã“ã—ã„ã§ã™ãŒã€æœ€åˆã«Record Aggregationç”¨ã®Producerã‚’ç”Ÿæˆã—ã€<code>pr.Start()</code> ã§å†…éƒ¨ã§ç”¨ã„ã‚‹goroutineã‚’èµ·å‹•ã€ãã®å¾Œã«ProducerãŒå‡ºã™ã‹ã‚‚çŸ¥ã‚Œãªã„errorã‚’æ¤œçŸ¥ã™ã‚‹ãŸã‚ã® <code>goroutine</code> ã‚’ <code>errgroup</code> ã‚’åˆ©ç”¨ã—ã¦èµ·å‹•ã•ã›ã¾ã™ã€‚ã¡ã‚‡ã£ã¨ã‚„ã‚„ã“ã—ã„ã§ã™ãŒã€ã“ã‚Œã‚’æœ€åˆã«è¡Œã‚ãªã„ã¨ã€ã‚¨ãƒ©ãƒ¼ã‚’å–ã‚Šã“ã¼ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚Producerã¯Stopã—ãŸã‚ã¨ã«Startã—ã¦ã‚‚channelã‚’å†…éƒ¨ã§closeã—ã¦ã„ãŸã‚Šã™ã‚‹ã®ã§ä¸Šæ‰‹ãå‹•ãã¾ã›ã‚“ã§ã—ãŸã€‚</p><p><code>Producer</code> ã«å¯¾ã™ã‚‹Putå‡¦ç†ã§ã™ãŒã€ä»Šå›ã¯Lambdaã ã¨ã„ã†ã“ã¨ã¨ã€ä»–ã®ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã¸ã®æ›¸ãè¾¼ã¿ã‚‚ã—ãªã„ã“ã¨ã‚‚ã‚ã‚ŠåŒæœŸçš„ã«è¡Œã£ã¦ã„ã¾ã™ã€‚</p><p>æœ€å¾Œã« <code>pr.Stop()</code> ã‚’å‘¼ã³goroutineã‚’åœæ­¢ã•ã›ã¦ã€åŒæ™‚ã«å‡¦ç†ä¸­ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’flushã•ã›ã¾ã™ã€‚ã“ã‚Œã‚’å‘¼ã³å¿˜ã‚Œã‚‹ã¨Flushã•ã‚Œã‚‹é–“éš”ã‚ˆã‚Šå‰ã«Lambdaé–¢æ•°ãŒåœæ­¢ã—ã¦ã—ã¾ã„ã€ã‚¨ãƒ©ãƒ¼ã¯ç™ºç”Ÿã—ãªã„ã‘ã©Kinesisã«é€ä¿¡ã•ã‚Œã¦ã„ãªã„ã“ã¨ãŒç™ºç”Ÿã™ã‚‹æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚<code>pr.Stop</code> ã¯ <strong>errgroupã®å¾…å—ã‚ˆã‚Šå‰ã«</strong> å‘¼ã³å‡ºã—ãŸã„ã®ã§ã€<code>defer</code> ã¯åˆ©ç”¨ã—ã¦ã„ã¾ã›ã‚“ã€‚</p><p>ã“ã‚Œã‚’Goã§Lambdaã‚’åˆ©ç”¨ã™ã‚‹ã¨ãã®ãŠä½œæ³•é€šã‚Šã«mainé–¢æ•°ã‹ã‚‰å‘¼ã³å‡ºã›ã°å®Œäº†ã§ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">lambda.Start(handle)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã§Goã§Lambdaã§ã‚‚Kinesisã¸Record AggregationãŒè¡Œãˆã¾ã™ã€‚</p><h2 id="DeAggregate-awslabs-kinesis-aggregation"><a href="#DeAggregate-awslabs-kinesis-aggregation" class="headerlink" title="DeAggregate(awslabs/kinesis-aggregation])"></a>DeAggregate(awslabs/kinesis-aggregation])</h2><p>awslabs/kinesis-aggregationã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ã“ã®æ™‚ã€Lambdaã®å¼•æ•°ã¨ã—ã¦æ¸¡ã•ã‚Œã‚‹ <code>events.KinesisEvent</code> ã®å‹ã¨ã€deaggregatorãŒæ±‚ã‚ã‚‹æ–¹ãŒç•°ãªã‚‹ãŸã‚ã€è‡ªåˆ†ã§å‹ã®è©°ã‚æ›¿ãˆä½œæ¥­ãŒå¿…è¦ã§ã™ï¼ˆæœ€åˆã®ãƒ«ãƒ¼ãƒ—åˆ†ã®éƒ¨åˆ†ï¼‰ã€‚ãã“ãŒæœ€å¤§ã®å±±å ´ã§ã€ãã‚Œã•ãˆã§ãã¦ã—ã¾ãˆã°<code>deagg.DeaggregateRecords</code>ã‚’å‘¼ã³å‡ºã—ã¦ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®é›†ç´„è§£é™¤ãŒè¡Œã‚ã‚Œã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>é›†ç´„è§£é™¤å´ã®å®Ÿè£…ä¾‹</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/events"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/lambda"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-sdk-go/aws"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-sdk-go/service/kinesis"</span></span><br><span class="line">deagg <span class="string">"github.com/awslabs/kinesis-aggregation/go/deaggregator"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(e events.KinesisEvent)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"ã€Start DeAggregation Lambdaã€‘"</span>, <span class="built_in">len</span>(e.Records))</span><br><span class="line"></span><br><span class="line">krs := <span class="built_in">make</span>([]*kinesis.Record, <span class="number">0</span>, <span class="built_in">len</span>(e.Records))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, r := <span class="keyword">range</span> e.Records &#123;</span><br><span class="line">krs = <span class="built_in">append</span>(krs, &amp;kinesis.Record&#123;</span><br><span class="line">ApproximateArrivalTimestamp: aws.Time(r.Kinesis.ApproximateArrivalTimestamp.UTC()),</span><br><span class="line">Data:                        r.Kinesis.Data,</span><br><span class="line">EncryptionType:              &amp;r.Kinesis.EncryptionType,</span><br><span class="line">PartitionKey:                &amp;r.Kinesis.EncryptionType,</span><br><span class="line">SequenceNumber:              &amp;r.Kinesis.SequenceNumber,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dars, err := deagg.DeaggregateRecords(krs)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, r := <span class="keyword">range</span> dars &#123;</span><br><span class="line"><span class="comment">// TODO de-aggregationå¾Œãƒ¬ã‚³ãƒ¼ãƒ‰ã«å¯¾ã™ã‚‹å‡¦ç†</span></span><br><span class="line">fmt.Println(<span class="string">"input"</span>, <span class="keyword">string</span>(r.Data))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã‚’Goã§Lambdaã‚’åˆ©ç”¨ã™ã‚‹ã¨ãã®ãŠä½œæ³•é€šã‚Šã«mainé–¢æ•°ã‹ã‚‰å‘¼ã³å‡ºã›ã°å®Œäº†ã§ã™ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">lambda.Start(handle)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ãƒ¬ã‚³ãƒ¼ãƒ‰é›†ç´„ã®è§£é™¤å‡¦ç†ã¯ã€ã“ã¨Kinesisãƒˆãƒªã‚¬ãƒ¼ã®Lambdaã«å¯¾ã—ã¦ã¯å¸¸ã«å®Ÿè£…ã—ã¦ãŠã„ã¦ã‚‚è‰¯ã„æ°—ãŒã—ã¾ã™ã€‚<br>ç†ç”±ã§ã™ãŒã€<code>deagg.DeaggregateRecords</code> ãŒé›†ç´„æ¸ˆã¿<strong>ã§ã¯ãªã„</strong> ãƒ¬ã‚³ãƒ¼ãƒ‰ã«å¯¾ã—ã¦å®Ÿè¡Œã—ã¦ã‚‚errorãŒç™ºç”Ÿã—ãªã„ãŸã‚ã¨ã€æœ€åˆã¯é›†ç´„ãƒ¬ã‚³ãƒ¼ãƒ‰ã˜ã‚ƒãªã„å…¥åŠ›ã ã£ãŸã¨ã—ã¦ã‚‚ã€é€”ä¸­ã§é›†ç´„ãƒ¬ã‚³ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã£ãŸã¨ãã«æ€¥ã«å‹•ã‹ãªããªã‚‹ã“ã¨ã‚’é˜²ãã“ã¨ã‚‚å‡ºæ¥ã‚‹ã‹ã‚‰ã§ã™ã€‚ï¼ˆç–é€šã®1ä»¶ã¯é€šã£ãŸã‘ã©ã€çµåˆãƒ†ã‚¹ãƒˆã§è¤‡æ•°ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’é€£æºã—ã ã™ã¨æ€¥ã«è½ã¡ãŸã€ã¿ãŸã„ãªã“ã¨ã‚‚å›é¿ã§ãã¾ã™ï¼‰ã€‚ç‰¹ã«Javaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒKPLã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€é›†ç´„ã‚ã‚Š/é›†ç´„ç„¡ã—ã¯ã‚ã¾ã‚Šæ„è­˜ã—ãªã„ã“ã¨ãŒå¤šãã€äº‹å‰ã®ã™ã‚Šåˆã‚ã›ã§ã¯é›†ç´„ã—ãªã„ã¨è¡Œã£ã¦ã„ãŸã‚‚ã®ã®ã€ã„ã–çµåˆãƒ†ã‚¹ãƒˆã‚’ã™ã‚‹å ´åˆã«ã€é›†ç´„æ¸ˆã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€£æºã—ã¦ããŸã“ã¨ã‚‚ã‚ã‚Šã¾ã—ãŸã€‚</p><h1 id="å‹•ä½œæ¤œè¨¼"><a href="#å‹•ä½œæ¤œè¨¼" class="headerlink" title="å‹•ä½œæ¤œè¨¼"></a>å‹•ä½œæ¤œè¨¼</h1><p>ä¸‹å›³ã®ã‚ˆã†ãªç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¦å‹•ã‹ã—ã¦ã¿ã¾ã™ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã¯ãƒªãƒã‚¸ãƒˆãƒªã®READMEã‚’å‚è€ƒãã ã•ã„ã€‚</p><p>![](/images/20200727/1 (2).png)</p><p>æœ€åˆã®Kinesisã«ã¯awscliçµŒç”±ã§3ä»¶ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥ã—ã¾ã™ã€‚</p><figure class="highlight bash"><figcaption><span>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aws kinesis --profile my_profile put-record --stream-name aggregate --partition-key 123 --data MTIzNDU2Nzg5MA==</span><br><span class="line">aws kinesis --profile my_profile put-record --stream-name aggregate --partition-key 124 --data MTIzNDU2Nzg5MA==</span><br><span class="line">aws kinesis --profile my_profile put-record --stream-name aggregate --partition-key 125 --data MTIzNDU2Nzg5MA==</span><br></pre></td></tr></table></figure><p>ãã†ã™ã‚‹ã¨ã€1ã¤ç›®ã®LambdaãŒèµ·å‹•ã•ã‚Œã¾ã™ã€‚3ã¤ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å—ã‘å–ã‚Šã€<code>flushing records reason=drain, records=%!s(int=1)</code> ã«ã‚ã‚‹é€šã‚Šã€3ä»¶ãŒ1ãƒ¬ã‚³ãƒ¼ãƒ‰ã«é›†ç´„ã•ã‚Œã¦æ¬¡ã®Kinesisã«Produceã•ã‚Œã¾ã—ãŸã€‚ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã‚ˆã£ã¦ã¯1ä»¶ã ã£ãŸã‚Š2ä»¶ã ã£ãŸã‚Šã—ã¾ã™ãŒã€2ä»¶ä»¥ä¸Šã§ã‚ã‚Œã°å‹•ä½œç¢ºèªã¯ã§ãã¾ã™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">2020-05-16T16:59:25.659+09:00 START RequestId: da2b6674-a147-4804-9e6c-5d78f633e426 Version: $LATEST</span><br><span class="line">2020-05-16T16:59:25.664+09:00 ã€Start Aggregation Lambdaã€‘ 3</span><br><span class="line">2020-05-16T16:59:25.664+09:00 2020&#x2F;05&#x2F;16 07:59:25 starting producer stream&#x3D;aggregate-test</span><br><span class="line">2020-05-16T16:59:25.664+09:00 2020&#x2F;05&#x2F;16 07:59:25 stopping producer backlog&#x3D;%!s(int&#x3D;0)</span><br><span class="line">2020-05-16T16:59:25.664+09:00 2020&#x2F;05&#x2F;16 07:59:25 backlog drained</span><br><span class="line">2020-05-16T16:59:25.664+09:00 2020&#x2F;05&#x2F;16 07:59:25 flushing records reason&#x3D;drain, records&#x3D;%!s(int&#x3D;1)</span><br><span class="line">2020-05-16T16:59:25.690+09:00 2020&#x2F;05&#x2F;16 07:59:25 stopped producer</span><br><span class="line">2020-05-16T16:59:25.690+09:00 END RequestId: da2b6674-a147-4804-9e6c-5d78f633e426</span><br></pre></td></tr></table></figure><p>2ã¤ç›®ã®Lambdaã¯ã€é›†ç´„ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’1ä»¶å—ã‘å–ã‚Šã€é›†ç´„è§£é™¤ã—ãŸçµæœ3ã¤ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¨™æº–å‡ºåŠ›ã—ã¦ã„ã¾ã™ã€‚ãƒ€ãƒŸãƒ¼ã§é€ä¿¡ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã¯å…¨ã¦åŒã˜ãªã®ã§3è¡ŒåŒã˜å†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">2020-05-16T17:01:36.865+09:00 START RequestId: 5f7eb56c-a83c-42c3-927d-0e2703528c6b Version: $LATEST</span><br><span class="line">2020-05-16T17:01:36.870+09:00 ã€Start DeAggregation Lambdaã€‘ 1</span><br><span class="line">2020-05-16T17:01:36.870+09:00 input 1234567890</span><br><span class="line">2020-05-16T17:01:36.870+09:00 input 1234567890</span><br><span class="line">2020-05-16T17:01:36.870+09:00 input 1234567890</span><br><span class="line">2020-05-16T17:01:36.870+09:00 END RequestId: 5f7eb56c-a83c-42c3-927d-0e2703528c6b</span><br></pre></td></tr></table></figure><p>ç°¡å˜ã§ã¯ã‚ã‚Šã¾ã™ãŒAggregation/DeAggregationã®å‹•ä½œç¢ºèªãŒå–ã‚Œã¾ã—ãŸã€‚</p><h1 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h1><ul><li>KPL Aggregated Record Formatã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€Kinesisã®åˆ©ç”¨æ–™é‡‘ã‚’ä¸‹ã’ã‚‹ã“ã¨ãŒã§ãã‚‹</li><li>Goã§Lambdaã§ã‚‚ã€KPL/KCLç›¸å½“ã®é›†ç´„ãƒ»é›†ç´„è§£é™¤ã¯å®Ÿè£…ã§ãã‚‹</li><li>ç‰¹ã«DeAggregateã™ã‚‹å‡¦ç†ã¯ã€å¾Œã€…ã®äºˆæœŸã›ã¬é€£æºã«å‚™ãˆã¦é˜²å¾¡çš„ã«å®Ÿè£…ã—ã¦ãŠãã¨è‰¯ã„</li></ul><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li>A deep-dive into lessons learned using Amazon Kinesis Streams at scale<ul><li><a href="https://read.acloud.guru/deep-dive-into-aws-kinesis-at-scale-2e131ffcfa08" target="_blank" rel="noopener">https://read.acloud.guru/deep-dive-into-aws-kinesis-at-scale-2e131ffcfa08</a></li></ul></li><li>KPL ã®ä¸»è¦ãªã‚³ãƒ³ã‚»ãƒ—ãƒˆ<ul><li><a href="https://docs.aws.amazon.com/ja_jp/streams/latest/dev/kinesis-kpl-concepts.html" target="_blank" rel="noopener">https://docs.aws.amazon.com/ja_jp/streams/latest/dev/kinesis-kpl-concepts.html</a></li></ul></li><li>KPL Aggregated Record Format<ul><li><a href="https://github.com/awslabs/amazon-kinesis-producer/blob/master/aggregation-format.md" target="_blank" rel="noopener">https://github.com/awslabs/amazon-kinesis-producer/blob/master/aggregation-format.md</a></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://future-architect.github.io/tags/Serverless%E9%80%A3%E8%BC%89/&quot;&gt;ã‚µãƒ¼ãƒãƒ¬ã‚¹é€£è¼‰ä¼ç”»&lt;/a&gt;ã®8å›ç›®ã§ã™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;a href=&quot;#ã¯ã˜ã‚ã«&quot; cl
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="IoT" scheme="https://future-architect.github.io/tags/IoT/"/>
    
      <category term="AWS" scheme="https://future-architect.github.io/tags/AWS/"/>
    
      <category term="Go" scheme="https://future-architect.github.io/tags/Go/"/>
    
      <category term="Serverless" scheme="https://future-architect.github.io/tags/Serverless/"/>
    
      <category term="Serverlessé€£è¼‰" scheme="https://future-architect.github.io/tags/Serverless%E9%80%A3%E8%BC%89/"/>
    
      <category term="Lambda" scheme="https://future-architect.github.io/tags/Lambda/"/>
    
  </entry>
  
  <entry>
    <title>å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶ãƒ–ãƒ­ã‚°é€£è¼‰ã‚’å§‹ã‚ã¾ã™</title>
    <link href="https://future-architect.github.io/articles/20200726/"/>
    <id>https://future-architect.github.io/articles/20200726/</id>
    <published>2020-07-25T15:00:00.000Z</published>
    <updated>2020-08-12T04:07:38.752Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/20200726/beach-3121393_1280.png" alt=""><br><a href="https://pixabay.com/ja/users/lethutrang101-6596164/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3121393" target="_blank" rel="noopener">Trang Le</a>ã«ã‚ˆã‚‹<a href="https://pixabay.com/ja/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3121393" target="_blank" rel="noopener">Pixabay</a>ã‹ã‚‰ã®ç”»åƒ</p><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>ã“ã‚“ã«ã¡ã¯ã€æŠ€è¡“ãƒ–ãƒ­ã‚°é‹å–¶ã®çœŸé‡ã§ã™ã€‚</p><p>ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼æŠ€è¡“ãƒ–ãƒ­ã‚°ã§<strong>å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶</strong>ã¨ã„ã†ãƒ†ãƒ¼ãƒã®é€£è¼‰ã‚’é–‹å‚¬ã—ã¾ã™ã€‚<a href="https://future-architect.github.io/articles/20200529/">æ˜¥ã®å…¥é–€ç¥­ã‚Š</a>ã«ç¶šãã€å¤§å‹ã®é€£è¼‰ãªã®ã§ãƒ–ãƒ­ã‚°é‹å–¶è€…ã¨ã—ã¦ãƒ¯ã‚¯ãƒ¯ã‚¯ãƒ‰ã‚­ãƒ‰ã‚­ã—ã¦ã„ã¾ã™ã€‚</p><ul><li><strong>è‡ªåˆ†ãŒå¥½ããªæŠ€è¡“ã‚„èˆˆå‘³ãŒã‚ã‚‹ãƒ†ãƒ¼ãƒ</strong> ã«ã¤ã„ã¦ <strong>è‡ªç”±ã«ç ”ç©¶</strong>ï¼ˆåŸ·ç­†ï¼‰ã™ã‚‹é€£è¼‰ä¼ç”»ã§ã™</li><li>8/03ï½8/21ã®å¹³æ—¥ï¼ˆ15æ ï¼‰</li><li>ã“ã®4æœˆã«å…¥ç¤¾ã—ã¦ãã‚ŒãŸãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãªãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰ã€ãƒ™ãƒ†ãƒ©ãƒ³å‹¢ã¾ã§å¹…åºƒã„åŸ·ç­†é™£ã§ã™</li></ul><p>ã“ã®é€£è¼‰ã‚’é€šã—ã¦ã€ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ç¤¾å“¡ãŒã©ã†ã„ã†ã“ã¨ã«èˆˆå‘³ã‚’æŒã£ã¦ã€æ·±å €ã‚Šã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã‹ã®ä¸€é¢ãŒä¼ã‚ã‚Œã°è‰¯ã„ãªã¨æ€ã£ã¦ã¾ã™ã€‚<br>ã¾ãŸã€ã„ã¤ã‚‚ã¨ã¯ä¸€é¢¨å¤‰ã‚ã£ãŸæœ‰ç›Šãªæƒ…å ±ã‚’ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã«ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã—ã€çš†æ§˜ã®ãŠå½¹ã«ç«‹ã¦ã‚Œã°ã¨ç¥ˆã£ã¦ã„ã¾ã™ã€‚</p><p><strong>2020/08/11 è¿½è¨˜</strong>: 8/10ã®å±±ã®æ—¥ã‚’å¿˜ã‚Œã¦ã„ã¦ã€å¹³æ—¥ã¨è¨€ã„ãªãŒã‚‰ç¥æ—¥ã‚‚ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã—ã¡ã‚ƒã£ã¦ã¾ã—ãŸã€‚ç”³ã—è¨³ãªã„ã§ã™..ã€‚ã™ã§ã«è¨˜äº‹ã‚’ä½œã£ã¦ãã‚Œã¦ã„ãŸã®ã§ã€8/11ã«2æ—¥åˆ†å…¬é–‹ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p><h1 id="ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«"><a href="#ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«" class="headerlink" title="ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«"></a>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h1><p>æ¬¡ã®15äººãŒæŠ•ç¨¿ã—ã¾ã™ã€‚ã©ã‚Œã‚‚å¤ä¼‘ã¿æ„Ÿï¼ˆï¼Ÿï¼‰ãŒã§ã¦ã„ã¾ã™ã­ã€‚</p><table><thead><tr><th>æ—¥ä»˜</th><th>åŸ·ç­†è€…</th><th>ã‚¿ã‚¤ãƒˆãƒ«</th></tr></thead><tbody><tr><td>8/3</td><td>çœŸé‡éš¼è¨˜</td><td><a href="/articles/20200803/">ç”£æ¥­ç”¨æ©Ÿå™¨å‘ã‘ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯Modbusã§æ¸©æ¹¿åº¦ã‚»ãƒ³ã‚·ãƒ³ã‚°</a></td></tr><tr><td>8/4</td><td>ä¼Šè—¤çœŸå½¦</td><td><a href="/articles/20200804/">GoPlusè‡ªç”±ç ”ç©¶</a></td></tr><tr><td>8/5</td><td>ä¼Šè—¤å¤ªæ–‰</td><td><a href="/articles/20200805/">Terraformã§æ¥½ã‚’ã—ãŸã„</a></td></tr><tr><td>8/6</td><td>æ°¸äº•å„ªæ–—</td><td><a href="/articles/20200806/">åˆã‚ã¦ã®OSSã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æ´»å‹•ã€œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¿»è¨³ã‚„ã£ã¦ã¿ãŸã€‚ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚¹ã‚¿ãƒƒãƒ•ã‚‚ã‚„ã£ã¦ã¿ãŸã€‚ã€œ</a></td></tr><tr><td>8/7</td><td>è¾»å¤§å¿—éƒ</td><td><a href="/articles/20200807/">Goã¨SuffixArray</a></td></tr><tr><td>8/8</td><td>-</td><td></td></tr><tr><td>8/9</td><td>-</td><td></td></tr><tr><td>8/10</td><td>ç‹ç´¹å®‡</td><td><a href="articles/20200810/">è‡ªå‹•å£²è²·ã¯è©æ¬ºï¼Ÿæœ¬ç‰©ã‚’è‡ªä½œã—ã¦ã¿ã‚ˆã†</a></td></tr><tr><td>8/11</td><td>çŸ¢é‡é¢¯å¤ª</td><td><a href="/articles/20200811/">ãƒ€ã‚¤ã‚¨ãƒƒãƒˆé£Ÿã®ãƒ–ãƒ¬ã‚¤ã‚¯ã‚¹ãƒ«ãƒ¼ï¼ä½æ¸©èª¿ç†å™¨ã‚’è‡ªä½œã—ã¦é¶ã‚€ã­è‚‰ã‚’ç¾å‘³ã—ãé£Ÿã¹ã‚‹</a></td></tr><tr><td>8/12</td><td>åŠ è—¤å‘¨å¹³</td><td><a href="/articles/20200812/">Marpã§ä¼šç¤¾ã®ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ä½œã£ã¦ã¿ã‚‹</a></td></tr><tr><td>8/13</td><td>è¥¿ç”°å¥½å­</td><td>GCPã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®Regioné›†ç´„ã‚’è€ƒãˆã‚‹</td></tr><tr><td>8/14</td><td>æ‘ç”°é–æ‹“</td><td>ã¼ãã®ãªã¤ã‚„ã™ã¿5 -Istioã€ã‚­ãƒŸãŒãã‚ŒãŸã‚‚ã®-</td></tr><tr><td>8/15</td><td>-</td><td></td></tr><tr><td>8/16</td><td>-</td><td></td></tr><tr><td>8/17</td><td>ä»æœ¨ç¾æ¥</td><td>SlackÃ—GASã®æ—¥å ±ãƒ†ãƒ³ãƒ—ãƒ¬BOTã‚’å®Ÿå‹™ã«å°å…¥ã—ã¦ã¿ãŸ</td></tr><tr><td>8/18</td><td>å¯Œå±± é¾ä¹‹ä»‹</td><td>ç§ã‚’è‹¦ã—ã‚ãŸDynamoDB</td></tr><tr><td>8/19</td><td>æŸæœ¨ç¥¥å­</td><td>denoã¨firebaseã§ã¤ãã‚‹ãƒ‡ãƒ¼ã‚¿ç®¡ç†ç”»é¢</td></tr><tr><td>8/20</td><td>æ —ç”°çœŸ</td><td>Pythonãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãŸã‚ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–‹ç™º</td></tr><tr><td>8/21</td><td>æ­¦ç”°å¤§è¼</td><td>ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªé–‹ç™º - å„ªã‚ŒãŸãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚’ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã§å®Ÿç¾ã™ã‚‹ -</td></tr></tbody></table><p>â€»æ­£ç¢ºãªã‚¿ã‚¤ãƒˆãƒ«ã¯ç›´å‰ã§å¤‰æ›´ã™ã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ãŒã€ã”äº†æ‰¿ãã ã•ã„ï¼</p><p>ã¾ãŸã€ä»Šå›ã¯<strong>ã€Œè£œæ¬ ã€åˆ¶åº¦</strong>ã‚’å†…éƒ¨ã§å°å…¥ã—ã¾ã—ãŸã€‚ã©ã†ã—ã¦ã‚‚ä½“èª¿é¢ãƒ»æ¥­å‹™é¢ã§æŠ•ç¨¿ãŒå³ã—ããªã£ãŸãƒ¡ãƒ³ãƒãƒ¼ãŒã„ãŸæ™‚ã¯ã€è£œæ¬ ãƒ¡ãƒ³ãƒãƒ¼ã®è¨˜äº‹ãŒè£œå¡«ã•ã‚Œã€ã‚¿ã‚¤ãƒˆãƒ«ã¨å†…å®¹ãŒã‚¬ãƒ©ãƒªã¨å¤‰ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p><h1 id="æœ€å¾Œã«"><a href="#æœ€å¾Œã«" class="headerlink" title="æœ€å¾Œã«"></a>æœ€å¾Œã«</h1><p>ã“ã®ä¼ç”»ã¯ LINEã•ã‚“ã®<a href="https://engineering.linecorp.com/ja/blog/line-engineering-blog-freedom-study-summer-vacation-homework/" target="_blank" rel="noopener">LINE Engineering Blog ã€Œå¤ä¼‘ã¿ã®è‡ªç”±ç ”ç©¶ -Summer Homework-ã€ å®Ÿæ–½ã®ãŠçŸ¥ã‚‰ã›</a> ã«å¤§ã„ã«å½±éŸ¿ã‚’å—ã‘ã¦ã„ã¾ã™ã€‚ã„ã¤ã‚‚ãƒ–ãƒ­ã‚°ã‚’æ‹è¦‹ã•ã›ã¦ã‚‚ã‚‰ã£ã¦ã„ã¾ã™ã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚</p><p>ä»–ã«ã‚‚é€£è¼‰ä¼ç”»ãŒã–ãã–ãã‚ã‚Šã¾ã™ã€‚ãœã²ã€æ°—ã«ãªã‚‹ãƒ†ãƒ¼ãƒã®è¨˜äº‹ã‚’CHECK! ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ã€‚</p><ul><li><a href="https://future-architect.github.io/articles/20200529/">æ˜¥ã®å…¥é–€ç¥­ã‚Š</a></li><li><a href="/tags/%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E5%85%A5%E9%96%80/">ã‚¤ãƒ³ãƒ•ãƒ©å…¥é–€</a></li><li><a href="/tags/GCP%E9%80%A3%E8%BC%89/">GCPé€£è¼‰</a></li><li><a href="/tags/GoTips%E9%80%A3%E8%BC%89/">Go Tipsé€£è¼‰</a></li><li><a href="/tags/GoCDK/">Go Cloud</a></li><li><a href="/tags/Auth0/">Auth0</a></li><li><a href="/tags/DynamoDB%C3%97Go/">DynamoDBÃ—Go</a></li><li><a href="/tags/%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E8%A8%98%E4%BA%8B%E9%9B%86%E4%B8%AD%E6%8A%95%E7%A8%BF/">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨˜äº‹é›†ä¸­æŠ•ç¨¿</a></li><li><a href="/tags/Serverless%E9%80%A3%E8%BC%89/">Serverlessé€£è¼‰</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/20200726/beach-3121393_1280.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;a href=&quot;https://pixabay.com/ja/users/lethutrang101-6596164/?utm_source=lin
      
    
    </summary>
    
    
      <category term="Culture" scheme="https://future-architect.github.io/categories/Culture/"/>
    
    
      <category term="TechBlog" scheme="https://future-architect.github.io/tags/TechBlog/"/>
    
      <category term="å¤ä¼‘ã¿è‡ªç”±ç ”ç©¶" scheme="https://future-architect.github.io/tags/%E5%A4%8F%E4%BC%91%E3%81%BF%E8%87%AA%E7%94%B1%E7%A0%94%E7%A9%B6/"/>
    
  </entry>
  
  <entry>
    <title>AWSã‚µãƒ¼ãƒ“ã‚¹ãƒˆãƒªã‚¬ã«ã‚ˆã‚‹Lambdaèµ·å‹•</title>
    <link href="https://future-architect.github.io/articles/20200722/"/>
    <id>https://future-architect.github.io/articles/20200722/</id>
    <published>2020-07-21T15:00:00.000Z</published>
    <updated>2020-07-27T00:26:25.444Z</updated>
    
    <content type="html"><![CDATA[<p><a href="/tags/Serverless%E9%80%A3%E8%BC%89/">ã‚µãƒ¼ãƒãƒ¬ã‚¹é€£è¼‰ä¼ç”»</a>ã®7å›ç›®ã§ã™ã€‚</p><h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>ã“ã‚“ã«ã¡ã¯ã€‚TIGã®DXãƒãƒ¼ãƒ ã«æ‰€å±ã—ã¦ã„ã‚‹åŠ éƒ¨ã§ã™ã€‚</p><p>æ˜¨ä»Šæ§˜ã€…ãªã‚·ã‚¹ãƒ†ãƒ ã§åˆ©ç”¨ã•ã¦ã„ã‚‹AWSã®Lambdaã§ã™ãŒã€ã‚µãƒ¼ãƒãƒ¬ã‚¹ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚Šä½•ã‹ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ã«é–¢æ•°ã‚’èµ·å‹•ã•ã›ã‚‹æ–¹æ³•ãŒä¸€èˆ¬çš„ã‹ã¨æ€ã„ã¾ã™ã€‚Lambdaã¯AWSã®æ§˜ã€…ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’ãƒˆãƒªã‚¬ã¨ã—ã¦èµ·å‹•ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã€è‡ªåˆ†ãŸã¡ã®åˆ©ç”¨ã—ã¦ã„ã‚‹AWSã‚µãƒ¼ãƒ“ã‚¹ã¨çµ„ã¿åˆã‚ã›ã¦å®Ÿè£…ã™ã‚‹ã‚‹ã“ã¨ã§ãã®çœŸä¾¡ã‚’ç™ºæ®ã—ã¾ã™ã€‚</p><p>AWSã«å°‘ã—è©³ã—ã„äººã§ã‚ã‚Œã°Lambdaã‚’AWSã®ã‚µãƒ¼ãƒ“ã‚¹ãƒˆãƒªã‚¬ã§èµ·å‹•ã•ã›ã‚‹äº‹ãŒã§ãã‚‹ã“ã¨ã¯çŸ¥ã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ã„ã–å®Ÿè£…ã™ã‚‹ã¨ãªã‚‹ã¨å…·ä½“çš„ã«ã©ã†ã„ã£ãŸæ‰‹é †ã§ã€ãªã‚“ã®è¨­å®šãŒå¿…è¦ã‹ã¨ã„ã†ã¨ã“ã‚ãŒã‚ã‹ã‚‰ãªã„ã¨ã„ã†äººã‚‚ã„ã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚Lambdaã«ã¯èµ·å‹•å‹ãŒã„ãã¤ã‹ã‚ã£ãŸã‚Šã€ãƒˆãƒªã‚¬ã¨ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚ˆã£ã¦èµ·å‹•è¨­å®šã‚‚ç•°ãªã£ã¦ãã¾ã™ã€‚ç§è‡ªèº«ã‚‚æ¥­å‹™ã§åˆ©ç”¨ã™ã‚‹ã¾ã§ã¯ã„ã‚ã‚†ã‚‹çŸ¥è­˜å‹¢ã§ã—ãŸã€‚</p><p>ã“ã®è¨˜äº‹ã§ã¯AWSã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒƒã‚¯ç’°å¢ƒã§ã‚ã‚‹LocalStackã‚’ç”¨ã„ã¦ã€çš†ã•ã‚“ã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚‚è©¦ã›ã‚‹ã‚ˆã†å„èµ·å‹•å‹ã®è¨­å®šæ–¹æ³•ã‚’è¿½ã£ã¦ã„ãã¾ã™ã€‚</p><h1 id="Lambdaã®èµ·å‹•å‹"><a href="#Lambdaã®èµ·å‹•å‹" class="headerlink" title="Lambdaã®èµ·å‹•å‹"></a>Lambdaã®èµ·å‹•å‹</h1><p>ã¾ãšã¯Lambdaã®èµ·å‹•å‹ã«ã¤ã„ã¦è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚Lambdaã®èµ·å‹•å‹ã«ã¯åŒæœŸã€éåŒæœŸã€ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹ã®3ã¤ãŒã‚ã‚Šã¾ã™ã€‚</p><ol><li><strong>åŒæœŸ</strong><ul><li>ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹é–¢æ•°ã‚’å¾…ã£ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™</li><li>AWSå´ã§ã®ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã¯ãªãå®Ÿè¡Œã¯1å›ã¨ãªã‚‹</li><li>ä»£è¡¨çš„ãªã‚µãƒ¼ãƒ“ã‚¹<ul><li>API Gateway</li><li>Cognito</li><li>Alexa</li></ul></li></ul></li><li><strong>éåŒæœŸ</strong><ul><li>Lambdaã¯å‡¦ç†ã®ãŸã‚ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚­ãƒ¥ãƒ¼ã«å…¥ã‚Œã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã™ãã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™</li><li>å‘¼ã³å‡ºã—ã«å¤±æ•—ã—ãŸå ´åˆã¯è‡ªå‹•çš„ã«2å›ãƒªãƒˆãƒ©ã‚¤ãŒå®Ÿæ–½ã•ã‚Œã‚‹</li><li>ä»£è¡¨çš„ãªã‚µãƒ¼ãƒ“ã‚¹<ul><li>CloudWatch Events</li><li>Cloud Watch Logs</li><li>Code Commit</li><li>S3</li><li>SNS</li><li>Kinesis Firehose<br>etcâ€¦</li></ul></li></ul></li><li><strong>ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹</strong><ul><li>Lambdaã‚µãƒ¼ãƒ“ã‚¹ãŒé€£æºå…ƒã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚µãƒ¼ãƒ“ã‚¹ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°ã—ã€å¿…è¦ã«å¿œã˜ã¦Lambdaé–¢æ•°ã‚’å‘¼ã³å‡ºã™</li><li>BatchSizeã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€1å›ã®Lambdaé–¢æ•°èµ·å‹•æ™‚ã®ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—æ•°ã‚’æŒ‡å®šã™ã‚‹</li><li>Lambdaé–¢æ•°ãŒå¤±æ•—ã™ã‚‹ã¨ã€å¯¾è±¡ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã‚‹ã¾ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸé–¢æ•°ã‚’ãƒªãƒˆãƒ©ã‚¤ã™ã‚‹(ãƒªãƒˆãƒ©ã‚¤å›æ•°ã¯è¨­å®šã§æŒ‡å®šå¯èƒ½)</li><li>ä»£è¡¨çš„ãªã‚µãƒ¼ãƒ“ã‚¹<ul><li>Kinesis Data Stream</li><li>Dynamo DB Stream</li></ul></li></ul></li></ol><h1 id="å„èµ·å‹•å‹ã®è¨­å®šæ–¹æ³•"><a href="#å„èµ·å‹•å‹ã®è¨­å®šæ–¹æ³•" class="headerlink" title="å„èµ·å‹•å‹ã®è¨­å®šæ–¹æ³•"></a>å„èµ·å‹•å‹ã®è¨­å®šæ–¹æ³•</h1><p>åŸºæœ¬çš„ãªæµã‚Œã¨ã—ã¦ã¯ã©ã®èµ·å‹•å‹ã‚‚ä¸‹è¨˜ã®ã‚ˆã†ãªåŒã˜æµã‚Œã«ãªã‚Šã¾ã™ã€‚</p><ol><li>Lambdaã®ä½œæˆ</li><li>ãƒˆãƒªã‚¬ã¨ãªã‚‹ãƒªã‚½ãƒ¼ã‚¹ã®ä½œæˆ</li><li>Lambdaã¨ãƒˆãƒªã‚¬ã¨ãªã‚‹ãƒªã‚½ãƒ¼ã‚¹ã®ç´ä»˜ã‘</li></ol><p>æ‰‹é †3ã®Lambdaã®ãƒˆãƒªã‚¬è¨­å®šãŒå„èµ·å‹•å‹ã§å¤‰ã‚ã£ã¦ãã¾ã™ã€‚ãã‚Œã§ã¯å„èµ·å‹•å‹ã®è¨­å®šæ–¹æ³•ã‚’å®Ÿè·µã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p><h2 id="äº‹å‰æº–å‚™"><a href="#äº‹å‰æº–å‚™" class="headerlink" title="äº‹å‰æº–å‚™"></a>äº‹å‰æº–å‚™</h2><p>LocalStackã‚’<a href="https://github.com/localstack/localstack" target="_blank" rel="noopener">ã“ã¡ã‚‰</a>ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚LocalStackèµ·å‹•ã‚³ãƒãƒ³ãƒ‰(macOSã®å ´åˆ)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TMPDIR=/private<span class="variable">$TMPDIR</span> docker-compose up -d</span><br></pre></td></tr></table></figure><p>LocalStackã®è©³ç´°ã«ã¤ã„ã¦ã¯<a href="https://future-architect.github.io/articles/20191115/">ã“ã¡ã‚‰ã®ãƒ–ãƒ­ã‚°</a>ã§è§£èª¬ã—ã¦ã„ã‚‹ã®ã§èˆˆå‘³ã®ã‚ã‚‹æ–¹ã¯èª­ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚</p><h2 id="åŒæœŸå‹"><a href="#åŒæœŸå‹" class="headerlink" title="åŒæœŸå‹"></a>åŒæœŸå‹</h2><p>ã§ã¯ã¾ãšåŒæœŸå‹ã®å‘¼ã³å‡ºã—ã‹ã‚‰è¨­å®š/å®Ÿè£…æ–¹æ³•ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ä»Šå›ã¯ã‚ˆãã‚ã‚‹API Gateway â€“&gt; Lambdaã¨ã„ã†æ§‹æˆã‚’å‚è€ƒã«é€²ã‚ã¦ã„ãã¾ã™ã€‚</p><p><img src="/images/20200722/2020-07-17T17.05.46.png" alt=""></p><p>ãã‚Œã§ã¯æ—©é€Ÿæ§‹ç¯‰ã—ã¦ãã¾ã—ã‚‡ã†ã€‚ã¾ãšã¯ã€APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™Lambdaã‚’ä½œæˆã—ã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>ãƒ†ã‚¹ãƒˆç”¨ã‚³ãƒ¼ãƒ‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"context"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/events"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/lambda"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleRequest</span><span class="params">(ctx context.Context, request events.APIGatewayProxyRequest)</span> <span class="params">(events.APIGatewayProxyResponse, error)</span></span> &#123;</span><br><span class="line">q := request.QueryStringParameters</span><br><span class="line">name := q[<span class="string">"name"</span>]</span><br><span class="line">body := <span class="string">"hello "</span> + name</span><br><span class="line"><span class="keyword">return</span> events.APIGatewayProxyResponse&#123;</span><br><span class="line">Body:       body,</span><br><span class="line">StatusCode: <span class="number">200</span>,</span><br><span class="line">&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">lambda.Start(handleRequest)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã‚½ãƒ¼ã‚¹ã‚’buildã—ã¦ã€zipã§åœ§ç¸®ã—Lambdaã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">aws lambda create-function \</span><br><span class="line">  --endpoint-url=http://localhost:4574 \</span><br><span class="line">  --<span class="keyword">function</span>-name api-gateway-test \</span><br><span class="line">  --runtime go1.x \</span><br><span class="line">  --handler main \</span><br><span class="line">  --zip-file fileb://main.zip \</span><br><span class="line">  --role r1</span><br></pre></td></tr></table></figure><p>Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã—ãŸã‚‰API GateAwayã‚’ä½œæˆã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aws apigateway create-rest-api \</span><br><span class="line">  --endpoint-url=http://localhost:4567 \</span><br><span class="line">  --name <span class="string">'API Gateway Test'</span></span><br></pre></td></tr></table></figure><p>è¿”ã£ã¦ããŸidã®å€¤ã‚’å¾Œã®ã‚³ãƒãƒ³ãƒ‰ã§åˆ©ç”¨ã™ã‚‹ã®ã§å¤‰æ•°ã«å…¥ã‚Œã¦ãŠãã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rest_api_id=******</span><br></pre></td></tr></table></figure><p>API Gatewayã‚’ä½œæˆã—ãŸã‚‰ãƒ«ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ã®é…ä¸‹ã«APIãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ ã—ã¾ã™<br>ãã®ãŸã‚ã«ã€ã¾ãšãƒ«ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ã®IDã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚<br>rest-api-idã«ã¯å…ˆã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ã£ã¦ããŸidã‚’åˆ©ç”¨ã—ã¾ã™ã€‚<br>ãƒ«ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ã®IDã‚’ç¢ºèª</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aws apigateway get-resources \</span><br><span class="line">  --endpoint-url=http://localhost:4567 \</span><br><span class="line">  --rest-api-id <span class="variable">$&#123;rest_api_id&#125;</span></span><br></pre></td></tr></table></figure><p>parent-idã«ã¯ä¸€ã¤å‰ã®ã‚³ãƒãƒ³ãƒ‰ã§è¿”ã£ã¦ããŸidã®å€¤ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">aws apigateway create-resource \</span><br><span class="line">  --endpoint-url=http://localhost:4567 \</span><br><span class="line">  --rest-api-id <span class="variable">$&#123;rest_api_id&#125;</span> \</span><br><span class="line">  --parent-id ****** \</span><br><span class="line">  --path-part hello</span><br></pre></td></tr></table></figure><p>ä½œæˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aws apigateway put-method \</span><br><span class="line">  --endpoint-url=http://localhost:4567 \</span><br><span class="line">  --rest-api-id <span class="variable">$&#123;rest_api_id&#125;</span> \</span><br><span class="line">  --resource-id ****** \</span><br><span class="line">  --http-method GET \</span><br><span class="line">  --authorization-type <span class="string">"NONE"</span></span><br></pre></td></tr></table></figure><p>ã“ã“ã¾ã§è¨­å®šã§ããŸã‚‰ã‚ˆã†ã‚„ãAPI Gatewayã¨Lambdaã®ç´ä»˜ã‘ã®è¨­å®šã«ãªã‚Šã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">aws apigateway put-integration \</span><br><span class="line">  --endpoint-url=http://localhost:4567 \</span><br><span class="line">  --rest-api-id <span class="variable">$&#123;rest_api_id&#125;</span> \</span><br><span class="line">  --resource-id ****** \</span><br><span class="line">  --http-method GET \</span><br><span class="line">  --<span class="built_in">type</span> AWS_PROXY \</span><br><span class="line">  --integration-http-method GET \</span><br><span class="line">  --uri arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/<span class="built_in">functions</span>/arn:aws:lambda:us-east-1:000000000000:<span class="keyword">function</span>:api-gateway-test \</span><br><span class="line">  --passthrough-behavior WHEN_NO_MATCH</span><br></pre></td></tr></table></figure><p>æœ€å¾Œã«APIã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦å®Œäº†ã§ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aws apigateway create-deployment \</span><br><span class="line">  --endpoint-url=http://localhost:4567 \</span><br><span class="line">  --rest-api-id <span class="variable">$&#123;rest_api_id&#125;</span> \</span><br><span class="line">  --stage-name prod</span><br></pre></td></tr></table></figure><p>curlã‚³ãƒãƒ³ãƒ‰ã§æƒ³å®šã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã£ã¦ãã‚‹ã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -i http://localhost:4567/restapis/<span class="variable">$&#123;rest_api_id&#125;</span>/prod/_user_request_/hello?name=lambda</span><br><span class="line">hello lambda</span><br></pre></td></tr></table></figure><h2 id="éåŒæœŸå‹"><a href="#éåŒæœŸå‹" class="headerlink" title="éåŒæœŸå‹"></a>éåŒæœŸå‹</h2><p>ç¶šã„ã¦S3ã¨Lambdaã®é€£æºã§ã™ã€‚API Gatewayã«æ¯”ã¹ã‚‹ã¨ã ã„ã¶è¨­å®šãŒç°¡å˜ã§ã™ã€‚S3ã«ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã€LambdaãŒèµ·å‹•ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ãã¾ã™ã€‚</p><p><img src="/images/20200722/2020-07-17T17.05.34.png" alt=""></p><p>å…ˆç¨‹ã¨åŒã˜ã‚ˆã†ã«ã¾ãšã¯Lambdaé–¢æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‹ã‚‰å®Ÿæ–½ã—ã¦ã„ãã¾ã™ã€‚<br>ãƒˆãƒªã‚¬ã®èµ·å‹•ãŒç¢ºèªã§ãã‚Œã°ã‚ˆã„ã®ã§ã€LambdaãŒèµ·å‹•ã—ãŸã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã‚ˆã†ãªã‚½ãƒ¼ã‚¹ã‚’ç”¨æ„ã—ã¾ã™ã€‚<br>ãƒ†ã‚¹ãƒˆç”¨ã‚½ãƒ¼ã‚¹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"context"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/events"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/lambda"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handler</span><span class="params">(ctx context.Context, event events.S3Event)</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"S3 trigger Lambda"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">lambda.Start(handler)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ãƒ†ã‚¹ãƒˆç”¨ã‚½ãƒ¼ã‚¹ã§Lambdaã‚’ä½œæˆã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">aws lambda create-function \</span><br><span class="line">  --endpoint-url=http://localhost:4574 \</span><br><span class="line">  --<span class="keyword">function</span>-name s3-trigger-test \</span><br><span class="line">  --runtime go1.x \</span><br><span class="line">  --handler main \</span><br><span class="line">  --zip-file fileb://main.zip \</span><br><span class="line">  --role r1</span><br></pre></td></tr></table></figure><p>ç¶šã„ã¦ä»Šå›ã®Lambdaèµ·å‹•ã¨ãªã‚‹S3ãƒã‚±ãƒƒãƒˆã®ä½œæˆã§ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aws --endpoint-url=http://localhost:4572 s3 mb s3://<span class="built_in">test</span>-bucket</span><br><span class="line">make_bucket: <span class="built_in">test</span>-bucket</span><br></pre></td></tr></table></figure><p>ç¶šã„ã¦ä½œæˆã—ãŸS3ã«å¯¾ã—ã¦Lambdaèµ·å‹•ã®æ¨©é™ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">aws lambda add-permission \</span><br><span class="line">  --endpoint-url=http://localhost:4574 \</span><br><span class="line">  --region us-east-1 \</span><br><span class="line">  --<span class="keyword">function</span>-name s3-trigger-test \</span><br><span class="line">  --statement-id s3-put-event \</span><br><span class="line">  --principal s3.amazonaws.com \</span><br><span class="line">  --action <span class="string">"lambda:InvokeFunction"</span> \</span><br><span class="line">  --<span class="built_in">source</span>-arn arn:aws:s3:::<span class="built_in">test</span>-bucket</span><br></pre></td></tr></table></figure><p>ä½œæˆã—ãŸS3ãƒã‚±ãƒƒãƒˆã«å¯¾ã™ã‚‹æ“ä½œã®é€šçŸ¥ã‚’è¨­å®šã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aws s3api put-bucket-notification-configuration \</span><br><span class="line">  --endpoint-url=http://localhost:4572 \</span><br><span class="line">  --bucket <span class="built_in">test</span>-bucket \</span><br><span class="line">  --notification-configuration file://s3test-event.json</span><br></pre></td></tr></table></figure><p>è¨­å®šJsonãƒ•ã‚¡ã‚¤ãƒ«</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"LambdaFunctionConfigurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"LambdaFunctionArn"</span>: <span class="string">""</span>,</span><br><span class="line">      <span class="attr">"Events"</span>: [<span class="string">"s3:ObjectCreated:*"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã§S3ãƒã‚±ãƒƒãƒˆã«å¯¾ã™ã‚‹PUTæ“ä½œã§LambdaãŒèµ·å‹•ã™ã‚‹è¨­å®šãŒã§ãã¾ã—ãŸã€‚<br>è©¦ã—ã«ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’S3ã«PUTã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆPUT</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aws s3 cp sample.txt s3://<span class="built_in">test</span>-bucket \</span><br><span class="line">  --endpoint-url=http://localhost:4572 \</span><br><span class="line">  --profile localstack</span><br></pre></td></tr></table></figure><p>éåŒæœŸãªã®ã§LambdaãŒå®Ÿè¡Œã•ã‚ŒãŸã®ã‹ã©ã†ã‹ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’PUTã—ãŸæ™‚ç‚¹ã§ã¯ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚<br>Lambdaã®å®Ÿè¡Œã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€CloudWatchLogã‚’ç¢ºèªã—ã¦Lambdaã®èµ·å‹•ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚<br>ã¾ãšã¯ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ç‰¹å®šã‚’ã—ã¾ã™ã€‚log-group-nameã¯ã€Œ/aws/lambda/&lt;Lambdaãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³å&gt;ã€ã¨ãªã‚Šã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aws logs describe-log-streams \</span><br><span class="line">  --endpoint-url=http://localhost:4586 \</span><br><span class="line">  --<span class="built_in">log</span>-group-name=/aws/lambda/s3-trigger-test</span><br></pre></td></tr></table></figure><p>ä¸Šè¨˜ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ã«ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"logStreams"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"firstEventTimestamp"</span>: <span class="number">1585829767164</span>, </span><br><span class="line">            <span class="attr">"lastEventTimestamp"</span>: <span class="number">1585829767749</span>, </span><br><span class="line">            <span class="attr">"creationTime"</span>: <span class="number">1585829767942</span>, </span><br><span class="line">            <span class="attr">"uploadSequenceToken"</span>: <span class="string">"1"</span>, </span><br><span class="line">            <span class="attr">"logStreamName"</span>: <span class="string">"+52222/12/12/[$LATEST]ec3fbc60"</span>, </span><br><span class="line">            <span class="attr">"lastIngestionTime"</span>: <span class="number">1585829767947</span>, </span><br><span class="line">            <span class="attr">"arn"</span>: <span class="string">"arn:aws:logs:us-east-1:0:log-group:/aws/lambda/s3-trigger-test:log-stream:+52222/12/12/[$LATEST]ec3fbc60"</span>, </span><br><span class="line">            <span class="attr">"storedBytes"</span>: <span class="number">331</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ åãŒç¢ºèªã§ããŸã‚‰ã€ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ä¸­èº«ã‚’ç¢ºèªã—ã¦ã„ãã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aws logs get-log-events \</span><br><span class="line">  --endpoint-url=http://localhost:4586 \</span><br><span class="line">  --<span class="built_in">log</span>-group-name=/aws/lambda/s3-trigger-test \</span><br><span class="line">  --<span class="built_in">log</span>-stream-name <span class="string">'+52222/12/12/[$LATEST]ec3fbc60'</span></span><br></pre></td></tr></table></figure><p>ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹ã¨messageãŒæƒ³å®šé€šã‚Šã«è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã­ã€‚æˆåŠŸã§ã™ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"nextForwardToken"</span>: <span class="string">"f/00000000000000000000000000000000000000000000000000000003"</span>, </span><br><span class="line">    <span class="attr">"events"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"ingestionTime"</span>: <span class="number">1585829767947</span>, </span><br><span class="line">            <span class="attr">"timestamp"</span>: <span class="number">1585829767164</span>, </span><br><span class="line">            <span class="attr">"message"</span>: <span class="string">"\u001b[32mSTART RequestId: 43bd5e82-0bfc-1c43-b8cf-085bc34c3d36 Version: $LATEST\u001b[0m"</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"ingestionTime"</span>: <span class="number">1585829767947</span>, </span><br><span class="line">            <span class="attr">"timestamp"</span>: <span class="number">1585829767359</span>, </span><br><span class="line">            <span class="attr">"message"</span>: <span class="string">"S3 trigger Lambda"</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"ingestionTime"</span>: <span class="number">1585829767947</span>, </span><br><span class="line">            <span class="attr">"timestamp"</span>: <span class="number">1585829767554</span>, </span><br><span class="line">            <span class="attr">"message"</span>: <span class="string">"\u001b[32mEND RequestId: 43bd5e82-0bfc-1c43-b8cf-085bc34c3d36\u001b[0m"</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"ingestionTime"</span>: <span class="number">1585829767947</span>, </span><br><span class="line">            <span class="attr">"timestamp"</span>: <span class="number">1585829767749</span>, </span><br><span class="line">            <span class="attr">"message"</span>: <span class="string">"\u001b[32mREPORT RequestId: 43bd5e82-0bfc-1c43-b8cf-085bc34c3d36\tInit Duration: 103.67 ms\tDuration: 2.44 ms\tBilled Duration: 100 ms\tMemory Size: 1536 MB\tMax Memory Used: 20 MB\t\u001b[0m"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ], </span><br><span class="line">    <span class="attr">"nextBackwardToken"</span>: <span class="string">"b/00000000000000000000000000000000000000000000000000000000"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹"><a href="#ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹" class="headerlink" title="ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹"></a>ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹</h2><p>æœ€å¾Œã¯ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ™ãƒ¼ã‚ºã®Lambdaèµ·å‹•ã®è¨­å®šã§ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰Kinesisã¸ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’PUTã—ã¦Lambdaã‚’èµ·å‹•ã•ã›ã¾ã—ã‚‡ã†ã€‚</p><p><img src="/images/20200722/2020-07-17T17.05.23.png" alt=""></p><p>ä¾‹ã«ã‚ˆã£ã¦ãƒ†ã‚¹ãƒˆç”¨ã®Lambdaã‚’ä½œæˆã—ã¾ã™ã€‚<br>ä»Šå›ã¯PUTã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹ãŒãƒ­ã‚°ã«å‡ºåŠ›ã•ã‚Œã‚‹ã‚ˆã†ãªã‚½ãƒ¼ã‚¹ã‚’ç”¨æ„ã—ã¾ã™ã€‚</p><figure class="highlight go"><figcaption><span>ãƒ†ã‚¹ãƒˆç”¨Lambdaã‚³ãƒ¼ãƒ‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"context"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/events"</span></span><br><span class="line"><span class="string">"github.com/aws/aws-lambda-go/lambda"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handler</span><span class="params">(ctx context.Context, kinesisEvent events.KinesisEvent)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> _, record := <span class="keyword">range</span> kinesisEvent.Records &#123;</span><br><span class="line">kinesisRecord := record.Kinesis</span><br><span class="line">dataBytes := kinesisRecord.Data</span><br><span class="line">dataText := <span class="keyword">string</span>(dataBytes)</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">"%s Data = %s \n"</span>, record.EventName, dataText)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">lambda.Start(handler)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3å›ç›®ãªã®ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã¯å‰²æ„›ã—ã¾ã™ã€‚ã„ã¾ã¾ã§ã®ã‚³ãƒãƒ³ãƒ‰ã¨åŒã˜ã«ãªã‚Šã¾ã™ã€‚LambdaãŒä½œæˆã§ããŸã‚‰æ¬¡ã¯ãƒˆãƒªã‚¬èµ·å‹•ã®ã‚‚ã¨ã¨ãªã‚‹KinesisStreamã‚’ä½œæˆã—ã¾ã™ã€‚</p><figure class="highlight sh"><figcaption><span>KinesisStreamä½œæˆ</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws kinesis --endpoint-url=http://localhost:4568 create-stream --stream-name lambda-test --shard-count 1</span><br></pre></td></tr></table></figure><p>å¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹ãŒä½œæˆã§ããŸã‚‰Kinesisã¨Lambdaã®ç´ä»˜ã‘ã®è¨­å®šã‚’ã—ã¾ã™ã€‚</p><figure class="highlight sh"><figcaption><span>ã‚¤ãƒ™ãƒ³ãƒˆãƒˆãƒªã‚¬ã®è¨­å®š</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aws lambda create-event-source-mapping \</span><br><span class="line">  --endpoint-url=http://localhost:4574 \</span><br><span class="line">  --event-source-arn arn:aws:kinesis:us-east-1:000000000000:stream/lambda-test  \</span><br><span class="line">  --<span class="keyword">function</span>-name kinesis-trigger-test</span><br></pre></td></tr></table></figure><p>event source mappingã®è¨­å®šã§ã¯ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ¬ã‚³ãƒ¼ãƒ‰é€ä¿¡å…ˆã‚’SQSã«è¨­å®šã§ããŸã‚Šã€ãƒãƒƒãƒå‡¦ç†ã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ•°ãªã©è‰²ã€…ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p><p>ãã‚Œã§ã¯Kinesisã«ãƒ†ã‚¹ãƒˆãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’putã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p><figure class="highlight sh"><figcaption><span>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸PUT</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws kinesis --endpoint-url=http://localhost:4568 put-record --stream-name lambda-test --partition-key 123 --data <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’PUTã—ãŸæ™‚ç‚¹ã§ã¯LambdaãŒèµ·å‹•ã—ãŸã‹ã‚ã‹ã‚‰ãªã„ã®ã§ã€S3ã®æ™‚åŒæ§˜CloudWatchã‚’ç¢ºèªã—ã«ã„ãã¾ã™ã€‚</p><p>æ‰‹é †ã¯å…ˆç¨‹ã¨åŒã˜ã«ãªã‚Šã¾ã™ã€‚<br>ã¾ãšã¯ã€ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ç¢ºèªã§ã™ã€‚</p><figure class="highlight sh"><figcaption><span>ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ç¢ºèª</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aws logs describe-log-streams \</span><br><span class="line">  --endpoint-url=http://localhost:4586 \</span><br><span class="line">  --<span class="built_in">log</span>-group-name=/aws/lambda/kinesis-trigger-test</span><br></pre></td></tr></table></figure><p>ãƒ­ã‚°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ç¢ºèªãŒã§ããŸã‚‰ãƒ­ã‚°ã‚’ç¢ºèªã—ã¾ã™ã€‚</p><figure class="highlight sh"><figcaption><span>ã‚‰ãƒ­ã‚°ã‚’ç¢ºèª</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aws logs get-log-events \</span><br><span class="line">  --endpoint-url=http://localhost:4586 \</span><br><span class="line">  --<span class="built_in">log</span>-group-name /aws/lambda/kinesis-trigger-test \</span><br><span class="line">  --<span class="built_in">log</span>-stream-name <span class="string">'+52222/12/21/[$LATEST]8d33a723'</span></span><br></pre></td></tr></table></figure><p>ãƒ­ã‚°ãŒç¢ºèªã§ãã¾ã—ãŸã­ã€‚Kinesisã«PUTã—ãŸtestã¨ã„ã†æ–‡å­—åˆ—ã‚‚è¿”ã£ã¦ãã¦ã„ã¾ã™ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"nextForwardToken"</span>: <span class="string">"f/00000000000000000000000000000000000000000000000000000003"</span>, </span><br><span class="line">    <span class="attr">"events"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"ingestionTime"</span>: <span class="number">1585830597603</span>, </span><br><span class="line">            <span class="attr">"timestamp"</span>: <span class="number">1585830596901</span>, </span><br><span class="line">            <span class="attr">"message"</span>: <span class="string">"\u001b[32mSTART RequestId: 38463daf-5f85-1220-65eb-9607f3f807fe Version: $LATEST\u001b[0m"</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"ingestionTime"</span>: <span class="number">1585830597603</span>, </span><br><span class="line">            <span class="attr">"timestamp"</span>: <span class="number">1585830597075</span>, </span><br><span class="line">            <span class="attr">"message"</span>: <span class="string">" Data = test "</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"ingestionTime"</span>: <span class="number">1585830597603</span>, </span><br><span class="line">            <span class="attr">"timestamp"</span>: <span class="number">1585830597250</span>, </span><br><span class="line">            <span class="attr">"message"</span>: <span class="string">"\u001b[32mEND RequestId: 38463daf-5f85-1220-65eb-9607f3f807fe\u001b[0m"</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"ingestionTime"</span>: <span class="number">1585830597603</span>, </span><br><span class="line">            <span class="attr">"timestamp"</span>: <span class="number">1585830597425</span>, </span><br><span class="line">            <span class="attr">"message"</span>: <span class="string">"\u001b[32mREPORT RequestId: 38463daf-5f85-1220-65eb-9607f3f807fe\tInit Duration: 54.77 ms\tDuration: 3.63 ms\tBilled Duration: 100 ms\tMemory Size: 1536 MB\tMax Memory Used: 21 MB\t\u001b[0m"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ], </span><br><span class="line">    <span class="attr">"nextBackwardToken"</span>: <span class="string">"b/00000000000000000000000000000000000000000000000000000000"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="çµ‚ã‚ã‚Šã«"><a href="#çµ‚ã‚ã‚Šã«" class="headerlink" title="çµ‚ã‚ã‚Šã«"></a>çµ‚ã‚ã‚Šã«</h2><p>é•·æ–‡ã”ä»˜ãåˆã„ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚ä»Šå›ã¯Lambdaã®å„èµ·å‹•å‹ã®ä¸­ã‹ã‚‰ä»£è¡¨çš„ãªãƒªã‚½ãƒ¼ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆã«ã‚ˆã‚‹Lambdaã®èµ·å‹•è¨­å®šã‚’ãŠã•ã‚‰ã„ã—ã¦ãã¾ã—ãŸã€‚</p><p>ã“ã®ã‚ãŸã‚Šã®è¨­å®šã«é–¢ã—ã¦ã¯çŸ¥ã£ã¦ã„ã‚Œã°é›£ã—ã„ã“ã¨ã¯ãªã„ã®ã§ã™ãŒã€åˆè¦‹ã ã¨å°‘ã—è‹¦åŠ´ã™ã‚‹éƒ¨åˆ†ã‹ãªã¨æ€ã„ã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯CLIã«ã‚ˆã‚‹è¨­å®šã‚’ã—ã¦ã„ãã¾ã—ãŸãŒã€ã‚‚ã¡ã‚ã‚“CloudFormationã‚„Terraformãªã©ã®Infrastructure as Codeã§ã‚‚è¨­å®šã™ã¹ãå†…å®¹ã¯åŸºæœ¬çš„ã«åŒã˜ã«ãªã‚Šã¾ã™ã€‚</p><p>ä¸€åº¦ãƒã‚¹ã‚¿ãƒ¼ã—ã¦ã—ã¾ãˆã°ã©ã†ã¨ã„ã†ã“ã¨ç„¡ã„ã“ã¨ãªã®ã§ã€ãœã²ä¸€åº¦Localstackã‚’åˆ©ç”¨ã—ã¦è©¦ã—ã«å®Ÿè£…ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;/tags/Serverless%E9%80%A3%E8%BC%89/&quot;&gt;ã‚µãƒ¼ãƒãƒ¬ã‚¹é€£è¼‰ä¼ç”»&lt;/a&gt;ã®7å›ç›®ã§ã™ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;a href=&quot;#ã¯ã˜ã‚ã«&quot; class=&quot;headerlink&quot; title=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;/a&gt;
      
    
    </summary>
    
    
      <category term="Infrastructure" scheme="https://future-architect.github.io/categories/Infrastructure/"/>
    
    
      <category term="AWS" scheme="https://future-architect.github.io/tags/AWS/"/>
    
      <category term="Go" scheme="https://future-architect.github.io/tags/Go/"/>
    
      <category term="DynamoDB" scheme="https://future-architect.github.io/tags/DynamoDB/"/>
    
      <category term="LocalStack" scheme="https://future-architect.github.io/tags/LocalStack/"/>
    
      <category term="Serverless" scheme="https://future-architect.github.io/tags/Serverless/"/>
    
      <category term="Serverlessé€£è¼‰" scheme="https://future-architect.github.io/tags/Serverless%E9%80%A3%E8%BC%89/"/>
    
      <category term="Lambda" scheme="https://future-architect.github.io/tags/Lambda/"/>
    
  </entry>
  
  <entry>
    <title>Pythonãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãŸã‚ã®GraalVM</title>
    <link href="https://future-architect.github.io/articles/20200721/"/>
    <id>https://future-architect.github.io/articles/20200721/</id>
    <published>2020-07-20T15:00:00.000Z</published>
    <updated>2020-07-22T01:42:56.075Z</updated>
    
    <content type="html"><![CDATA[<p>ã¡ã‚‡ã†ã©ä¸€å¹´ãã‚‰ã„å‰ã«GraalVMãŒå•†ç”¨åˆ©ç”¨å¯èƒ½ãªå®‰å®šç‰ˆã«é”ã—ã€Enterpriseç‰ˆã‚‚ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã¨ã„ã†ãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚</p><ul><li><a href="https://www.publickey1.jp/blog/19/graalvmgraalvm_190javajavascriptgraalvm_enterprise_edition.html" target="_blank" rel="noopener">publickey: GraalVMã€ã¤ã„ã«æœ¬ç•ªåˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€ŒGraalVM 19.0ã€ç™»å ´ã€Javaã‚„JavaScriptãªã©å¤šè¨€èªå¯¾å¿œãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã€‚å•†ç”¨ç‰ˆã®GraalVM Enterprise Editionã‚‚ãƒªãƒªãƒ¼ã‚¹</a></li></ul><p>GraalVMã«ã¯Pythonæ©Ÿèƒ½ã‚‚ã‚ã‚‹ã¨å®£ä¼ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã®ã€è©³ã—ã„èª¬æ˜ãŒè¡Œã‚ã‚Œã‚‹ã“ã¨ãŒãªãã€ãã‚ŒãŒä½•è€…ã§ã€ã©ã®ã‚ˆã†ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ã€ã©ã“ã‚’ç›®æŒ‡ã—ã¦ã„ã‚‹ã®ã‹ã€ãã¡ã‚“ã¨ç­”ãˆã‚‰ã‚Œã‚‹äººã¯ï¼ˆæ—¥æœ¬ã©ã“ã‚ã‹ä¸–ç•Œã§ã‚‚ï¼‰ã»ã¼ã„ãªã„ã§ã—ã‚‡ã†ã€‚GraalVMãã®ã‚‚ã®ã®èª¬æ˜ã¯ã¡ã‚‡ãã¡ã‚‡ãå‡ºã¦ãã‚‹ã‚ˆã†ã«ãªã£ã¦ããŸã¨æ€ã„ã¾ã™ãŒã€ãã®Pythonã®æ©Ÿèƒ½ã«ã¤ã„ã¦ã¯ã‚ã¾ã‚Šèª¬æ˜ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€Pythonéƒ¨åˆ†ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ç´¹ä»‹ã—ã¾ã™ã€‚</p><h1 id="Graal-Pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"><a href="#Graal-Pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" class="headerlink" title="Graal.Pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"></a>Graal.Pythonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h1><p><a href="https://www.graalvm.org/getting-started/" target="_blank" rel="noopener">GraalVMã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a>ã‚’ã¾ãšè¡Œã„ã€æ¬¡ã«Graal.Pythonã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p><p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯Windows/macOS/Linuxå‘ã‘ã«ãƒã‚¤ãƒŠãƒªãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚’å±•é–‹ã—ã¦ãƒ‘ã‚¹ã‚’é€šã™ãªã©ã™ã‚‹ã ã‘ã§ã™ã€‚ã“ã®è¨˜äº‹ã®åŸ·ç­†æ™‚ç‚¹ã§ã€20.1ãŒæœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ãªã‚Šã¾ã™ã€‚</p><p><a href="https://github.com/graalvm/graalvm-ce-builds/releases" target="_blank" rel="noopener">https://github.com/graalvm/graalvm-ce-builds/releases</a></p><p>Windowsã¨Linuxãªã‚‰å±•é–‹ã—ãŸãƒ•ã‚©ãƒ«ãƒ€ï¼ˆgraalvm-ce-java11-20.1.0ï¼‰ã‚’JAVA_HOMEã«ã€ãã®ä¸‹ã®binãƒ•ã‚©ãƒ«ãƒ€ã‚’PATHã«è¿½åŠ ã—ã¦ã‚ã’ã‚Œã°GraalVMå®Œäº†ã§ã™ã€‚</p><p>macOSã¯Javaã«å¯¾ã™ã‚‹ã¡ã‚‡ã£ã¨ã—ãŸã‚µãƒãƒ¼ãƒˆãŒã‚ã‚‹ã®ã§ã€ã¡ã‚‡ã£ã¨æ‰‹é †ãŒç•°ãªã‚Šã€\ <code>/Library/Java/JavaVirtualMachines</code> ãƒ•ã‚©ãƒ«ãƒ€ã«å±•é–‹ã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã‚’ãŠãã¾ã™ã€‚\ <code>/usr/libexec/java_home -V</code>\ ã‚³ãƒãƒ³ãƒ‰ã§ãŠã„ãŸãƒ•ã‚©ãƒ«ãƒ€ãŒèªè­˜ã•ã‚Œã‚Œã°JAVA_HOMEã®è¨­å®šã¯ä¸è¦ã§ã™ã€‚ãŸã ã€ã“ã®ä¸­ã®binãƒ•ã‚©ãƒ«ãƒ€ã¸ã®ãƒ‘ã‚¹ã¯é€šã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ãªãŠã€binãƒ•ã‚©ãƒ«ãƒ€ã¸ã®ãƒ‘ã‚¹ã§ã™ãŒã€ã‚‚ã‚ã‚‚ã‚å½±éŸ¿ãŒå¤§ãã„ã®ã§ã€å¯èƒ½ãªã‚‰direnvãªã©ã‚’ä½¿ã£ã¦å¿…è¦ãªãƒ¯ãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€å†…ã§ã®ã¿ãƒ‘ã‚¹ã‚’é€šã™ã¨ã‹ã€å¿…è¦ãªã¨ãã«æ‰‹å‹•ã§ãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹ãªã©ã—ãŸæ–¹ãŒè‰¯ã„ã§ã™ã€‚</p><p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒçµ‚ã‚ã‚‹ã¨guã‚³ãƒãƒ³ãƒ‰ãŒåˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<code>gu available</code>ã§è¿½åŠ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">% gu available</span><br><span class="line">Downloading: Component catalog from www.graalvm.org</span><br><span class="line">ComponentId              Version             Component name      Origin </span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">llvm-toolchain           20.1.0              LLVM.org toolchain  github.com</span><br><span class="line">native-image             20.1.0              Native Image        github.com</span><br><span class="line">python                   20.1.0              Graal.Python        github.com</span><br><span class="line">R                        20.1.0              FastR               github.com</span><br><span class="line">ruby                     20.1.0              TruffleRuby         github.com</span><br><span class="line">wasm                     20.1.0              GraalWasm           github.com</span><br></pre></td></tr></table></figure><p>Pythonã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã®ã§ã€æ¬¡ã®ã‚ˆã†ã«ã‚¿ã‚¤ãƒ—ã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% gu install python</span><br></pre></td></tr></table></figure><h1 id="GraalVMã¨ã¯ä½•è€…ã‹"><a href="#GraalVMã¨ã¯ä½•è€…ã‹" class="headerlink" title="GraalVMã¨ã¯ä½•è€…ã‹"></a>GraalVMã¨ã¯ä½•è€…ã‹</h1><p>å…ˆã»ã©ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ãƒ‘ã‚¹ã‚’é€šã™ã®ã¯ã‚„ã‚ã¦ãŠã„ãŸæ–¹ãŒã‚ˆã„ã€ã¨ãŠä¼ãˆã—ã¾ã—ãŸã€‚Pythonä»¥å¤–ã«native-imageã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸçŠ¶æ…‹ã§ã™ãŒã€/binãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚ã€€</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> % ls /Library/Java/JavaVirtualMachines/graalvm-ce-java11-20.1.0/Contents/Home/bin </span><br><span class="line">graalpythonjavacjdbjimagejmodjstackllipack200rmiregistry</span><br><span class="line">gujavadocjdeprscanjinfojpsjstatnative-imagepolyglotserialver</span><br><span class="line">jarjavapjdepsjjsjrunscriptjstatdnoderebuild-imagesunpack200</span><br><span class="line">jarsignerjcmdjfrjlinkjsjvisualvmnpmrmic</span><br><span class="line">javajconsolejhsdbjmapjshellkeytoolnpxrmid</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã‚’ã¿ã‚‹ã¨ã‚ã‹ã‚‹ã‚ˆã†ã«javacã‚„jarã€javaã¨ã„ã£ãŸã‚³ãƒãƒ³ãƒ‰ãŒã„ã‚‹ã®ãŒã‚ã‹ã‚Šã¾ã™ã€‚GraalVMã¯ã€ã¡ã‚‡ã£ã¨ã‚ªãƒ«ã‚¿ãƒŠãƒ†ã‚£ãƒ–ãªJDKã®é¡”ã‚’ã—ã¦ã„ã‚‹ã®ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã®å¾Œã«ã‚‚èª¬æ˜ã¯å‡ºã¦ãã¾ã™ãŒã€Javaã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¨ã—ã¦ã‚‚åˆ©ç”¨ã—ã¾ã™ã€‚ãã‚Œä»¥å¤–ã«ã¯node, npm, npxã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ã‚‚è¦‹ãˆã¾ã™ã€‚ã¤ã¾ã‚Šã€Node.jsã®äº’æ›å‡¦ç†ç³»ã‚‚å…¥ã£ã¦ã„ã‚‹ã®ã§ã™ã€‚ä¸‹æ‰‹ã«ãƒ‘ã‚¹ã‚’é€šã™ã¨ã€æ—¢å­˜ã®Javaã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„ã‚‰ã€Node.jsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒãŠã‹ã—ããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãªã®ã§ã€å¿…è¦ãªãƒ•ã‚©ãƒ«ãƒ€ã§ã®ã¿æœ‰åŠ¹ã«ã—ãŸæ–¹ãŒè‰¯ã„ã§ã™ã€‚</p><p>GraalVMã§ã™ãŒã€ä¸€ã¤ã®VMã®ä¸­ã§ã€JavaScriptã‚„Rã¨ã„ã£ãŸã•ã¾ã–ã¾ãªè¨€èªã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚Rã§ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§Pythonã§ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚’ã—ã¦ãƒ»ãƒ»ãƒ»ãªã©è¨€èªè·¨ãã§å„è¨€èªã®å¾—æ„ãªéƒ¨åˆ†ã‚’ç”Ÿã‹ã—ãŸã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒã§ãã‚‹ã®ã‚’ç›®æŒ‡ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚</p><h1 id="Graal-Pythonã®çŠ¶æ³"><a href="#Graal-Pythonã®çŠ¶æ³" class="headerlink" title="Graal.Pythonã®çŠ¶æ³"></a>Graal.Pythonã®çŠ¶æ³</h1><p>Graal.Pythonã®ä¸€æ¬¡æƒ…å ±ã¯<a href="https://www.graalvm.org/docs/reference-manual/languages/python/" target="_blank" rel="noopener">ã“ã“</a>ã«ãªã‚Šã¾ã™ã€‚</p><p>graalpythonã‚’èµ·å‹•ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºã¾ã™ã€‚Python 3.8.2äº’æ›ã¨è¨€ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ãªã‹ãªã‹æ–°ã—ã„ã§ã™ã­ã€‚å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã‹æ˜¨å¹´ã®æƒ…å ±ã‚’ã¿ã‚‹ã¨ã€19ç³»ã¯3.7ã ã£ãŸã‚ˆã†ãªã®ã§ã€é †å½“ã«æ›´æ–°ã•ã‚Œã¦ã„ã¾ã™ã€‚ãªãŠã€ã“ã®èµ·å‹•ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚‚å…¥ã£ã¦ã„ã¾ã™ãŒã€ã¾ã early stageã§å®‰å®šç‰ˆã§ã¯ãªã„ã§ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">% graalpython</span><br><span class="line">Python 3.8.2 (Fri May 15 05:42:24 PDT 2020)</span><br><span class="line">[GraalVM CE, Java 11.0.7] on darwin</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">Please note: This Python implementation is <span class="keyword">in</span> the very early stages, and can run little more than basic benchmarks at this point.</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/graalvm/graalpython" target="_blank" rel="noopener">README</a>ã«ã‚ˆã‚Œã°ã€scipyãªã©ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç¾¤ã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆã—ã‚ˆã†ã¨ã„ã†ã®ãŒç›®ä¸‹ã®ç›®æ¨™ã‚‰ã—ã„ã§ã™ã€‚</p><p>venvã‚’ä½¿ã£ãŸç’°å¢ƒã®åˆ†é›¢ã‚‚å¯èƒ½ã§ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% graalpython -m venv .venv</span><br><span class="line">% <span class="built_in">source</span> .venv/bin/activate</span><br></pre></td></tr></table></figure><p>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯å‹•ä½œç¢ºèªæ¸ˆã¿ï¼Ÿã®ã‚‚ã®ã ã‘ginstallãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚pipã‚‚venvã®ä¸­ã«ã¯ä½œã‚‰ã‚Œã‚‹ã®ã§ã™ãŒã€sslãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ããªã„ã®ã§ãƒ»ãƒ»ãƒ»ã¿ãŸã„ãªè­¦å‘ŠãŒå‡ºã¦ã€ã†ã¾ãä½¿ãˆã¾ã›ã‚“ã§ã—ãŸã€‚é©å½“ã«æ€ã„ã¤ããƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã„ã‚ã„ã‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†ã¨ã—ãŸã®ã§ã™ãŒã€docutilsã¨ã‹Sphinxã¯ãƒ€ãƒ¡ã§ã€pytestã ã‘ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããŸãŒã€ã†ã¾ãå‹•ã‹ãšã€ã¿ãŸã„ãªæ„Ÿã˜ã§ã™ã€‚æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒã£ã¦ãã¦ãã®ã¾ã¾å‹•ã‹ã™ã€ã¨ã„ã†ã®ã¯ã¾ã é›£ã—ã„ã§ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ graalpython -m ginstall install numpy</span><br></pre></td></tr></table></figure><p>æ˜¨å¹´ã®è¨˜äº‹ã§ã™ãŒã€mocobetaã•ã‚“ãŒJanomeã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«ãƒˆãƒ©ã‚¤ã—ãŸè¨˜äº‹ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã®ã¨ãã¨çŠ¶æ³ã¯å¤‰ã‚ã£ã¦ã„ã¾ã›ã‚“ã€‚</p><ul><li><a href="https://medium.com/@mocobeta/graalvm-graalpython-%E3%81%A7-janome-%E3%82%92%E7%84%A1%E7%90%86%E7%9F%A2%E7%90%86%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F%E3%83%A1%E3%83%A2-c07020f8193f" target="_blank" rel="noopener">GraalVM (graalpython) ã§ janome ã‚’ç„¡ç†çŸ¢ç†å‹•ã‹ã—ã¦ã¿ãŸãƒ¡ãƒ¢</a></li></ul><h2 id="polyglotã‚µãƒãƒ¼ãƒˆ"><a href="#polyglotã‚µãƒãƒ¼ãƒˆ" class="headerlink" title="polyglotã‚µãƒãƒ¼ãƒˆ"></a>polyglotã‚µãƒãƒ¼ãƒˆ</h2><p><code>--polyglot</code>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã¨ã€ã„ã‚ã„ã‚ãªè¨€èªãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚æ¬¡ã®ã‚µãƒ³ãƒ—ãƒ«ã¯READMEã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™ãŒã€Pythonã‹ã‚‰JavaScriptã®æ­£è¦è¡¨ç¾ã®ã‚¯ãƒ©ã‚¹ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã ã‘ã§ã¯å®Ÿç”¨æ€§ã¯ãªã•ãã†ã§ã™ãŒãƒ»ãƒ»ãƒ»</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> polyglot</span><br><span class="line">re = polyglot.eval(string=<span class="string">"RegExp()"</span>, language=<span class="string">"js"</span>)</span><br><span class="line">pattern = re.compile(<span class="string">".*(?:we have (?:a )?matching strings?(?:[!\\?] )?)(.*)"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> pattern.exec(<span class="string">"This string does not match"</span>):</span><br><span class="line">    <span class="keyword">raise</span> SystemError(<span class="string">"that shouldn't happen"</span>)</span><br><span class="line"></span><br><span class="line">md = pattern.exec(<span class="string">"Look, we have matching strings! This string was matched by Graal.js"</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> md:</span><br><span class="line">    <span class="keyword">raise</span> SystemError(<span class="string">"this should have matched"</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Here is what we found: '%s'"</span> % md[<span class="number">1</span>])</span><br></pre></td></tr></table></figure><h2 id="Jython"><a href="#Jython" class="headerlink" title="Jython"></a>Jython</h2><p>Pythonã®äº’æ›å®Ÿè£…ã§æœ‰åãªã‚‚ã®ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ãŒã€Javaã§å®Ÿè£…ã•ã‚ŒãŸã‚‚ã®ãŒJythonã§ã™ã€‚RPAãƒ„ãƒ¼ãƒ«ã®SikuliXã¨ã‹ã§ã‚‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªã¨ã—ã¦çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ãŸã‚Šã—ã¾ã™ã€‚Jythonã¯2.7äº’æ›ã§å®Ÿè£…ã•ã‚Œã¦ãŠã‚Šã€3ç³»ã®å®Ÿè£…ã¯å®‰å®šç‰ˆãŒå‡ºã¦ã„ã¾ã›ã‚“ã€‚Graal.Pythonã¯Javaã§å®Ÿè£…ã•ã‚ŒãŸ3.xç³»å®Ÿè£…ã§ã€Jythonã¨å‡ºè‡ªã¯ä¼¼ã¦ã„ã¾ã™ã€‚ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§Jythonã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãƒ¢ãƒ¼ãƒ‰ã‚‚æœ‰åŠ¹ã«ã§ãã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% graalpython --jvm --experimental-options --python.EmulateJython</span><br></pre></td></tr></table></figure><p><a href="https://github.com/graalvm/graalpython/blob/master/docs/user/JYTHON.md" target="_blank" rel="noopener">ã“ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã®é€šã‚Š</a>ã§ã™ãŒã€ã“ã‚“ãªæ„Ÿã˜ã§ã€AWTã‚’ä½¿ã£ã¦ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> % graalpython --jvm --experimental-options --python.EmulateJython </span><br><span class="line">Python 3.8.2 (Sat Jun 13 16:19:51 JST 2020)</span><br><span class="line">[GraalVM CE, Java 11.0.7] on darwin</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">Please note: This Python implementation is <span class="keyword">in</span> the very early stages, and can run little more than basic benchmarks at this point.</span><br><span class="line">&gt;&gt;&gt; import java.awt as awt</span><br><span class="line">&gt;&gt;&gt; win = awt.Frame()</span><br><span class="line">&gt;&gt;&gt; win.setSize(200, 200)</span><br><span class="line">&gt;&gt;&gt; win.setTitle(<span class="string">"Hello from Python!"</span>)</span><br><span class="line">&gt;&gt;&gt; win.getSize().toString()</span><br><span class="line"><span class="string">'java.awt.Dimension[width=200,height=200]'</span></span><br><span class="line">&gt;&gt;&gt; win.show()</span><br></pre></td></tr></table></figure><img src="/images/20200721/thumbnail.png" class="img-small-size"><p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯nativeãƒ¢ãƒ¼ãƒ‰ã§AoTã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’ã—ã¾ã™ã€‚CPythonã¨å¤‰ã‚ã‚‰ãªã„æ„Ÿè¦šã§ä½¿ãˆã¾ã™ã€‚JVMãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹ã¨JITã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«ãªã‚Šã¾ã™ãŒã€ã¡ã‚‡ã£ã¨ã—ãŸã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã®æ–¹ãŒæ™‚é–“ãŒã‹ã‹ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ãŸã ã€Jythonã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯JVMãƒ¢ãƒ¼ãƒ‰ã§ãªã„ã¨ãƒ€ãƒ¡ã§ã™ã€‚</p><p>ã‚¢ãƒ—ãƒªã¸ã®çµ„ã¿è¾¼ã¿ã®å ´åˆã€Jythonã§æä¾›ã—ã¦ã„ãŸã‚¯ãƒ©ã‚¹ã‚’ãã®ã¾ã¾æä¾›ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ãŸã‚ã€ã„ã‚ã„ã‚å¤‰æ›´ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<a href="https://www.graalvm.org/docs/reference-manual/embed/#Function_Python" target="_blank" rel="noopener">ãã®ãŸã‚ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã‚‚å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚Jythonã§Pythonã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦æä¾›ã—ã¦ã„ãŸã‚¢ãƒ—ãƒªã‹ã‚‰ã™ã‚‹ã¨ã€å¤‰æ›´ã®æ‰‹é–“ã¯å¿…è¦ãªã‚‚ã®ã®ã€Pythonä»¥å¤–ã«ã‚‚JavaScriptã‚„Rubyã‚‚å‹•ãã‚ˆã†ã«ãªã‚‹ã®ã§ã€ä¹—ã‚Šæ›ãˆã‚‹ãƒ¡ãƒªãƒƒãƒˆã¯ã‚ã‚Šã¾ã™ã€‚Python 2ç³»ã‚’æ­¢ã‚ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã—ã€‚</p><h2 id="ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹"><a href="#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹" class="headerlink" title="ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹"></a>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h2><p>ç´°ã‹ã„è¨ˆç®—ã§ç¹°ã‚Šè¿”ã—å›æ•°ãŒå¤šããªã‚‹ã‚‚ã®ã¯CPythonã‚ˆã‚Šã‚‚æ—©ããªã‚‹ã¨ã®ã“ã¨ã§ã™ã€‚</p><ul><li><a href="https://qiita.com/kotauchisunsun/items/7b7eb1e759e3e4526e62" target="_blank" rel="noopener">Pythonæ¨™æº–å®Ÿè£…ã‚ˆã‚Šé€Ÿã„ï¼ï¼ŸOracleãŒä½œã£ãŸGraalPythonã‚’Jythonãƒ»CPythonã¨ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã—ã¦ã¿ãŸï¼ï¼</a></li></ul><h1 id="ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸åŒ–"><a href="#ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸åŒ–" class="headerlink" title="ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸åŒ–"></a>ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸åŒ–</h1><p>GraalVMã¨ã„ãˆã°ãƒã‚¤ãƒ†ã‚£ãƒ–ãªå®Ÿè¡Œãƒã‚¤ãƒŠãƒªï¼ˆãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰ä½œæˆãªã®ã§Pythonã§ã‚‚ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ãŸã€‚ã¾ãšã¯native-imageã®å‡¦ç†ç³»ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% gu install native-image</span><br></pre></td></tr></table></figure><p>åŸºæœ¬çš„ãªä½¿ã„æ–¹ã¨ã—ã¦ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ã®ã¯Javaã§æ¬¡ã®ã‚ˆã†ãªæ‰‹é †ã§ä½œã‚Šã¾ã™ã€‚</p><ul><li>javacã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</li><li>(jarãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ)</li><li>.classã‚‚ã—ãã¯.jarãƒ•ã‚¡ã‚¤ãƒ«ã‚’native-imageã‚³ãƒãƒ³ãƒ‰ã§ãƒã‚¤ãƒ†ã‚£ãƒ–åŒ–</li></ul><p>Javaç³»ä»¥å¤–ã®è¨€èªã‚’ä½¿ã£ãŸäº‹ä¾‹ã‚„ä½¿ã„æ–¹ã®ç´¹ä»‹ã¨ã„ã†ã®ãŒ<a href="https://www.graalvm.org/docs/reference-manual/native-image/" target="_blank" rel="noopener">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã‚’è¦‹ã¦ã‚‚ã»ã¨ã‚“ã©ãªã„ã®ã§ã™ãŒã€ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦<a href="https://github.com/graalvm/graalvm-demos/tree/master/native-list-dir" target="_blank" rel="noopener">ä¸€ã¤ã ã‘</a>ã‚ã‚Šã¾ã—ãŸã€‚</p><ul><li>ListDir.java: Javaã‹ã‚‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸ä½œæˆ</li><li>ExtListDir.java: ä»–ã®è¨€èª(JavaScript)ã‚’ä½¿ã£ãŸã‚µãƒ³ãƒ—ãƒ«</li></ul><p>ä»–ã®è¨€èªã‚’ä½¿ã£ãŸã‚µãƒ³ãƒ—ãƒ«ã‚‚.javaãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚ã“ã‚Œã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚æ¬¡ã®ã‚ˆã†ã«èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><blockquote><p>GraalVM native-image supports JVM-based languages, e.g., Java, Scala, Clojure, Kotlin. The resulting native image can, optionally, execute dynamic languages like JavaScript, Ruby, R, or Python, but it does not pre-compile their code itself.</p></blockquote><p>ã“ã‚Œã‚’å‹•çš„è¨€èªç›®ç·šã§å†æ§‹æˆã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><ul><li>Pythonãªã©ã®å‹•çš„è¨€èªã¯ã€Œå®Ÿè¡Œã¯ã§ãã‚‹ã€ãŒã€ãã‚Œã¯JVMãƒ™ãƒ¼ã‚¹ã®è¨€èªï¼ˆJava, Scala, Clojure, Kotlinï¼‰ã‚’ãƒ›ã‚¹ãƒˆã«ã—ã¦ã€ãã“ã‹ã‚‰å‘¼ã³å‡ºã™å½¢</li><li>å‹•çš„è¨€èªã®ã‚³ãƒ¼ãƒ‰ã¯äº‹å‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œãªã„</li></ul><p>ã“ã‚Œã¯ã¤ã¾ã‚Šã€å‹•çš„è¨€èªã®å‡¦ç†ç³»ã¯ãƒã‚¤ãƒ†ã‚£ãƒ–åŒ–ã•ã‚Œã‚‹ãŒã€ãã‚Œã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã¯ã‚³ãƒ¼ãƒ‰ä¸­ã®æ–‡å­—åˆ—ã®ã¾ã¾ã€ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚<a href="https://www.ibm.com/developerworks/jp/java/library/j-jython/index.html" target="_blank" rel="noopener">Jythonã®jpythoncã‚³ãƒãƒ³ãƒ‰</a>ã®ã‚ˆã†ã«ã€Pythonã‚’.classã«ã™ã‚‹æ©Ÿèƒ½ã§ã‚‚å…¥ã‚Œã°ã€Pythonã‚’ç›´æ¥ãƒã‚¤ãƒ†ã‚£ãƒ–åŒ–ã¨ã„ã†é“ã‚‚é–‹ã‘ã‚‹ã‚“ã§ã—ã‚‡ã†ãŒã€ç¾çŠ¶ã§ã¯ãã‚Œã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚</p><p>ExtListDir.javaã‚’Pythonã«æ›¸ãæ›ãˆãŸã®ãŒæ¬¡ã®ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚<code>Context.create()</code>ã¨ãã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®<code>eval()</code>ã«<code>&quot;python&quot;</code>ã‚’æ¸¡ã™ã“ã¨ã§ã€Pythonã®ã‚³ãƒ¼ãƒ‰ãŒè§£é‡ˆã•ã‚Œã¾ã™ã€‚</p><figure class="highlight java"><figcaption><span>ExtListDir.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.graalvm.polyglot.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Stream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExtListDir</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> java.io.IOException </span>&#123;</span><br><span class="line"><span class="keyword">final</span> Context context = Context.create(<span class="string">"python"</span>);</span><br><span class="line">String s = <span class="string">"f'&#123;name&#125;: &#123;size&#125;'"</span>;</span><br><span class="line">      String root = <span class="string">"."</span>;</span><br><span class="line"><span class="keyword">if</span> (args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">root = args[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(args.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">s = args[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">"Walking path: "</span> + Paths.get(root));</span><br><span class="line">System.out.println(<span class="string">"Python function body: "</span> + s);</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> Value lambda = context.eval(<span class="string">"python"</span>,</span><br><span class="line">            <span class="string">"lambda name, size: "</span> + s);</span><br><span class="line"><span class="keyword">try</span> (Stream&lt;Path&gt; paths = Files.walk(Paths.get(root))) &#123;</span><br><span class="line">paths.filter(Files::isRegularFile).forEach((Path p) -&gt; &#123;</span><br><span class="line">File f = p.toFile();</span><br><span class="line">Value v = lambda.execute(f.getName(), f.length());</span><br><span class="line">System.out.println(v);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã“ã‚Œã‹ã‚‰ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒã‚¤ãƒŠãƒªã‚’ä½œæˆã—ã¦ã¿ã¾ã™ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .classãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ</span></span><br><span class="line">% javac ExtListDir.java</span><br><span class="line"><span class="comment"># å‹•ä½œç¢ºèªã§å®Ÿè¡Œã—ã¦ã¿ã‚‹</span></span><br><span class="line">% java ExtListDir</span><br><span class="line">% ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸ä½œæˆ</span><br><span class="line">% native-image --language:python ExtListDir</span><br></pre></td></tr></table></figure><p>ã™ã”ãæ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚MacBookAir 2020ã®Core i5ã§ã™ã€‚13åˆ†ã‹ã‹ã£ã¦ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚µã‚¤ã‚ºã‚‚240MBã‚’è¶…ãˆã¾ã—ãŸã€‚ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿éƒ¨åˆ†ã‚’ãŒã‚“ã°ã£ã¦ãƒã‚¤ãƒ†ã‚£ãƒ–åŒ–ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚</p><p>ãªãŠã€pure Javaãªå ´åˆã®ä½¿ã„å‹æ‰‹ã¯æ‚ªããªã„ãªã€ã¨æ€ã„ã¾ã—ãŸã€‚javac&amp;javaã§ã„ã¤ã‚‚ã®ã‚ˆã†ã«å‹•ä½œç¢ºèªãŒã§ãã€ãã®å¾Œnative-imageã‚’ä½¿ã£ã¦ã‚¤ãƒ¡ãƒ¼ã‚¸ä½œæˆã—ã¦ã‚‚40ç§’ã‹ã‹ã‚‰ãšã€ã‚µã‚¤ã‚ºã‚‚Javaã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒä¸è¦ãª6MBã®ãƒã‚¤ãƒŠãƒªã«ãªã‚Šã¾ã™ã€‚æ™®æ®µã®é–‹ç™ºã¯ã„ã¤ã‚‚ã®ã‚ˆã†ã«javacã¨javaã§é«˜é€Ÿã«ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å›ã—ã€æœ€å¾Œã«DockeråŒ–ã™ã‚‹ã¨ãã¯native-imageã‚’ä½¿ã„ã¤ã¤å°ã•ãªDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã¨ã„ã†æµã‚Œã§é–‹ç™ºãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯Javaã«ã¨ã£ã¦ã¯ã¨ã¦ã‚‚è‰¯ã„ã‚‚ã®ã§ã™ã­ã€‚</p><h1 id="ã¾ã¨ã‚"><a href="#ã¾ã¨ã‚" class="headerlink" title="ã¾ã¨ã‚"></a>ã¾ã¨ã‚</h1><p>GraalPythonã‚’è©¦ã—ã¾ã—ãŸã€‚</p><ul><li>ã¾ã å®Ÿé¨“ãƒªãƒªãƒ¼ã‚¹</li><li>ã„ã‚ã‚“ãªè¨€èªã‚’çµ„ã¿åˆã‚ã›ã¦å®Ÿè¡Œã™ã‚‹polyglotã®å‡¦ç†ç³»ã®ä¸€ã¤ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹</li><li>GraalVM 20ç³»ã¯Python 3.8ãƒ™ãƒ¼ã‚¹</li><li>æ©Ÿæ¢°å­¦ç¿’ã«å¯¾å¿œã™ã‚‹éƒ¨åˆ†ã‚’ç›®æŒ‡ã—ã¦é–‹ç™ºã•ã‚Œã¦ã„ã‚‹ãŒã€Jythonãƒ¢ãƒ¼ãƒ‰ãŒã‚ã£ãŸã‚Šã€2.7ã§æ­¢ã¾ã£ã¦ã„ã‚‹Jythonã®å¾Œç¶™ã¨ã—ã¦ã‚‚æœŸå¾…ã§ãã‚‹</li><li>ã¾ã ä½¿ãˆãªã„å…¬å¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚å¤šãã€æ—¢å­˜ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚æ°—è»½ã«ä½¿ãˆãªã„</li><li>GraalVMã®ãƒã‚¤ãƒ†ã‚£ãƒ–åŒ–ã¯æ™‚é–“ã‚‚ã‹ã‹ã‚Šãƒã‚¤ãƒŠãƒªã‚‚ã§ã‹ããªã‚Šã€GraalVMã®å‹•çš„è¨€èªå‹¢ã¯ãƒ¡ãƒªãƒƒãƒˆã¯ãªã„</li></ul><p>GraalVMã¯PythonãŒä½¿ãˆã‚‹ã€GraalVMã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒä½¿ãˆã‚‹ã€ã®äºŒã¤ã®æ–‡ç« ã‚’èª­ã‚€ã¨ã€PythonãŒãƒã‚¤ãƒ†ã‚£ãƒ–ã«ãªã‚Šãã†ãªå°è±¡ã‚‚æŒã£ã¦ã—ã¾ã„ãŒã¡ã§ã™ãŒã€ãã†ã§ã¯ãªã„ã€ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ã¨ã¯ã„ãˆã€Python2.7æ™‚ä»£ã®Jythonä¸¦ã«é–‹ç™ºãŒé€²ã‚ã°ã€ç”¨é€”ã¯ã„ã‚ã„ã‚åºƒãŒã‚‹ã¨æ€ã„ã¾ã™ã€‚æ¥½ã—ã¿ã§ã™ã­ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ã¡ã‚‡ã†ã©ä¸€å¹´ãã‚‰ã„å‰ã«GraalVMãŒå•†ç”¨åˆ©ç”¨å¯èƒ½ãªå®‰å®šç‰ˆã«é”ã—ã€Enterpriseç‰ˆã‚‚ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã¨ã„ã†ãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.publickey1.jp/blog/19/graalvmgraalvm_
      
    
    </summary>
    
    
      <category term="Programming" scheme="https://future-architect.github.io/categories/Programming/"/>
    
    
      <category term="Java" scheme="https://future-architect.github.io/tags/Java/"/>
    
      <category term="Python" scheme="https://future-architect.github.io/tags/Python/"/>
    
      <category term="GraalVM" scheme="https://future-architect.github.io/tags/GraalVM/"/>
    
  </entry>
  
  <entry>
    <title>Zuoraé€£è¼‰ Vol.4 Workflowã®è©±</title>
    <link href="https://future-architect.github.io/articles/20200720/"/>
    <id>https://future-architect.github.io/articles/20200720/</id>
    <published>2020-07-19T15:00:00.000Z</published>
    <updated>2020-07-22T14:29:23.731Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ã¯ã˜ã‚ã«"><a href="#ã¯ã˜ã‚ã«" class="headerlink" title="ã¯ã˜ã‚ã«"></a>ã¯ã˜ã‚ã«</h1><p>ã“ã‚“ã«ã¡ã¯ã€‚TIGã®ç”ºç”°ã§ã™ã€‚</p><p>Zuora Central Platformï¼ˆZuoraç¤¾ãŒæä¾›ã™ã‚‹ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åã®æ­£å¼åç§°/ä»¥é™ <strong>Zuora</strong> ã¨è¨˜è¼‰ã„ãŸã—ã¾ã™ï¼‰ã®é€£è¼‰ã®ç¬¬4å›ã¯Workflowã§ã™ã€‚</p><p>Workflowã¯<a href="https://future-architect.github.io/articles/20200716/">å‰å›ã®è¨˜äº‹</a>ã§èª¬æ˜ã—ãŸé€šçŸ¥æ©Ÿèƒ½ã¨åŒã˜ãã€æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã‚’è¨­è¨ˆã™ã‚‹éš›ã«å¿…ãšç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€Workflowã¯é€šçŸ¥æ©Ÿèƒ½ã¨ã®çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚</p><p>ä»–ã®Zuoraè¨˜äº‹ã¯<a href="https://future-architect.github.io/tags/Zuora/">ã“ã¡ã‚‰</a>ã‚’å‚ç…§ãã ã•ã„ã€‚</p><h1 id="ç›®æ¬¡"><a href="#ç›®æ¬¡" class="headerlink" title="ç›®æ¬¡"></a>ç›®æ¬¡</h1><ul><li><a href="./#æ¦‚è¦">æ¦‚è¦</a></li><li><a href="./#Workflowé–‹ç™ºæ–¹æ³•">Workflowé–‹ç™ºæ–¹æ³•</a></li><li><a href="./#Workflowè¨­å®š">Workflowè¨­å®š</a></li><li><a href="./#Workflowå®Ÿè¡Œæ–¹æ³•">Workflowå®Ÿè¡Œæ–¹æ³•</a></li><li><a href="./#Task">Task</a></li><li><a href="./#Swimlane">Swimlane</a></li><li><a href="./#æœ€å¾Œã«">æœ€å¾Œã«</a></li><li><a href="./#é–¢é€£ãƒªãƒ³ã‚¯é›†">é–¢é€£ãƒªãƒ³ã‚¯é›†</a></li></ul><h1 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h1><p>Workflowã®æ¦‚è¦ã¯<a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow" target="_blank" rel="noopener">Workflow - Zuora</a>ã‹ã‚‰å¼•ç”¨ã—ã¾ã™ã€‚</p><blockquote><p>Zuora Workflow is a Zuora product for designing, configuring, and deploying business workflows in Zuora. With Workflow, you can automate a set of business processes that otherwise need to be performed manually and repetitively.<br>è¨³ï¼šZuoraãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ã€Zuoraã§ãƒ“ã‚¸ãƒã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è¨­è¨ˆã€æ§‹æˆã€ãŠã‚ˆã³å±•é–‹ã™ã‚‹ãŸã‚ã®Zuoraè£½å“ã§ã™ã€‚ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€æ‰‹å‹•ã§ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ä¸€é€£ã®ãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚</p></blockquote><p>ã¨ã‚ã‚‹ã‚ˆã†ã«ã€Zuoraã«å®Ÿéš›ã®æ¥­å‹™ã«åˆã‚ã›ãŸåˆ¶å¾¡ã‚’åŠ ãˆã‚‹ãŸã‚ã«å¿…é ˆã®æ©Ÿèƒ½ã§ã™ã€‚æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹ã®è‡ªå‹•åŒ–ã‚„æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã®è¨­è¨ˆã«ã¯å¿…ãšWorkflowã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚</p><h1 id="Workflowé–‹ç™ºæ–¹æ³•"><a href="#Workflowé–‹ç™ºæ–¹æ³•" class="headerlink" title="Workflowé–‹ç™ºæ–¹æ³•"></a>Workflowé–‹ç™ºæ–¹æ³•</h1><ol><li>Zuoraãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã¦<code>ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </code> &gt; <code>ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</code> ã‚’é¸æŠã€‚  Workflowã®TOPç”»é¢ã§ã‚ã‚‹<code>OVERVIEW</code>ã‚¿ãƒ–ã«é·ç§»ã™ã‚‹ã€‚ã“ã“ã§ã¯Workflowã®å®Ÿè¡ŒçŠ¶æ³ã‚„ã‚µãƒãƒªã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚<br><img src="/images/20200720/thumbnail.png" alt=""></li><li>WORKFLOWã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯ã§ã€Workflowä¸€è¦§ç”»é¢ã«é·ç§»ã™ã‚‹ã€‚å³ä¸Šã®è¡¨ç¤ºåˆ‡æ›¿ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒªã‚¹ãƒˆå½¢å¼ã®ä¸€è¦§ã«ã§ãã¾ã™ã€‚ç·¨é›†ã—ãŸã„Workflowã®<code>Edit</code>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã“ã¨ã§ã€Workflowç·¨é›†ç”»é¢ã¸ã¨é·ç§»ã™ã‚‹ã€‚<br><img src="/images/20200720/workflow_settings2.png" alt=""></li><li>Workflowç·¨é›†ç”»é¢: Workflowã¯<strong>Task</strong>ã¨å‘¼ã°ã‚Œã‚‹å€‹ã€…ã®æ©Ÿèƒ½ã‚’ç¹‹ã’åˆã‚ã›ã‚‹ã“ã¨ã§å®Œæˆã™ã‚‹ã€‚<br><img src="/images/20200720/workflow_settings3.png" alt=""></li><li>â–¶ãƒœã‚¿ãƒ³ãŒã‚ã‚‹TaskãŒé–‹å§‹Taskã¨ãªã£ã¦ã„ã‚‹<code>+</code>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã“ã¨ã§å¾Œç¶šTaskã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚<br><br><img src="/images/20200720/workflow_settings5.png" class="img-small-size"><br></li><li>é–‹å§‹Taskç§»è¡Œã®Task<ul><li><code>ğŸ–Š</code>ãƒœã‚¿ãƒ³ï¼šTaskã®è¨­å®šãƒ»ç·¨é›†</li><li><code>x</code>ãƒœã‚¿ãƒ³ï¼šTaskã®å‰Šé™¤</li><li><code>+</code>ãƒœã‚¿ãƒ³ï¼šå¾Œç¶šTaskã‚’è¿½åŠ <br><br><img src="/images/20200720/workflow_settings6.png" class="img-small-size"><br></li></ul></li><li>Taskã®è¿½åŠ :   å„Taskã®<code>+</code>ã‚’ã‚¯ãƒªãƒƒã‚¯å¾Œã€TaskæˆåŠŸæ™‚ã¯<code>On Success</code>ã€Taskã‚¨ãƒ©ãƒ¼æ™‚ã¯<code>On Failure</code>ã‚’é¸æŠã—ã¦è¿½åŠ ã—ãŸã„Taskã‚’é¸æŠã™ã‚‹ã€‚å„Taskã®æ©Ÿèƒ½ã«ã¤ã„ã¦ã¯<a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow" target="_blank" rel="noopener">Workflow - Zuora</a>ã‚’å‚ç…§ã€‚<br><img src="/images/20200720/workflow_settings7.png" class="img-middle-size"><br></li></ol><h1 id="Workflowè¨­å®š"><a href="#Workflowè¨­å®š" class="headerlink" title="Workflowè¨­å®š"></a>Workflowè¨­å®š</h1><ol><li>Workflowã®è¨­å®šã«ã¯Workflowå…¨ä½“ã®è¨­å®šã‚’ã€Workflowã”ã¨ã®è¨­å®šãŒã‚ã‚‹<ul><li><strong>Workflowå…¨ä½“è¨­å®š</strong>ï¼š<code>SETTINGS</code>ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯: Workflowã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚’ã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€Workflowé–‹ç™ºãƒ¦ãƒ¼ã‚¶ã®è¨­å®šã€å¤–éƒ¨SMTPã‚µãƒ¼ãƒã®è¨­å®šãŒå¯èƒ½ã€‚åˆæœŸè¨­å®šä»¥å¤–ã§è§¦ã‚‹ã“ã¨ã¯ã»ã¨ã‚“ã©ãªã„ã¨æ€ã‚ã‚Œã‚‹ã€‚<br><img src="/images/20200720/workflow_settings8.png" alt=""></li><li><strong>Workflowã”ã¨ã®è¨­å®š</strong>ï¼šå„Workflowç·¨é›†ç”»é¢ã§<code>SETTINGS</code>ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯<br><img src="/images/20200720/workflow_settings9.png" alt=""></li><li><strong>Workflow Information:</strong> Workflowåã€èª¬æ˜ã®è¨­å®š</li><li><strong>Workflow Triggers:</strong> Workflowã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã‚’é¸æŠ<ul><li><strong>On Demand:</strong> ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã¨Workflowä¸€è¦§ç”»é¢ã‚„ç·¨é›†ç”»é¢ã‹ã‚‰å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚</li><li><strong>Callout:</strong> ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã¨APIã«ã‚ˆã‚‹Workflowã®å®Ÿè¡ŒãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚</li><li><strong>Scheduled:</strong> Cronå½¢å¼ã§ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œã®è¨­å®šãŒã§ãã‚‹ã€‚</li></ul></li><li><strong>Workflow Email Notifications:</strong> ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€WorkflowæˆåŠŸæ™‚ã€ã‚¨ãƒ©ãƒ¼æ™‚ç­‰ã«ãƒ¡ãƒ¼ãƒ«ã«ã‚ˆã‚‹é€šçŸ¥ãŒã§ãã‚‹ã€‚è¤‡æ•°ã‚¢ãƒ‰ãƒ¬ã‚¹å¯ã€‚</li><li><strong>Execution Priority:</strong> Workflowã®å„ªå…ˆåº¦ã‚’è¨­å®šã€‚åŒæ™‚ã«å®Ÿè¡Œä¸­ã®WorkflowãŒã‚ã£ãŸå ´åˆã«ã¯ã€å„ªå…ˆåº¦ãŒé«˜ã„WorkflowãŒå„ªå…ˆã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã€‚</li><li><strong>Workflow Configuration:</strong> è¨­å®šä¸å¯</li><li><strong>Callout Config:</strong> Workflowã‚’ã‚³ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆAPIã§å®Ÿè¡Œã™ã‚‹å ´åˆã®æƒ…å ±ã«ã¤ã„ã¦ç¢ºèªã§ãã‚‹ã€‚</li><li><strong>Mapped Input Fields and Params:</strong>  Workflowå†…ã§åˆ©ç”¨å¯èƒ½ãªå¤‰æ•°ã¯ã“ã“ã§å®šç¾©ã™ã‚‹ã€‚<br>ã‚³ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆAPIã«ã‚ˆã£ã¦å‘¼ã°ã‚ŒãŸéš›ã«ã€ã“ã“ã§è¨­å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆBodyã«è¨­å®šã™ã‚‹ã“ã¨ã§å€¤ã®å—ã‘æ¸¡ã—ãŒã§ãã‚‹ã€‚</li></ul></li></ol><h1 id="Workflowå®Ÿè¡Œæ–¹æ³•"><a href="#Workflowå®Ÿè¡Œæ–¹æ³•" class="headerlink" title="Workflowå®Ÿè¡Œæ–¹æ³•"></a>Workflowå®Ÿè¡Œæ–¹æ³•</h1><p>Workflowã®å®Ÿè¡Œæ–¹æ³•ã¯ä»¥ä¸‹3é€šã‚Šã§ã™ã€‚</p><ol><li><a href="./#â‘ ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰å®Ÿè¡Œ">ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰å®Ÿè¡Œ</a></li><li><a href="./#â‘¡ã‚³ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå®Ÿè¡Œ">ã‚³ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå®Ÿè¡Œ</a></li><li><a href="./#â‘¢ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ</a></li></ol><p><a href="./#Workflowè¨­å®š">Workflowè¨­å®š</a>ã®Workflowã”ã¨ã®è¨­å®šã®<strong>Workflow Triggers</strong>ã«ã¦ãƒã‚§ãƒƒã‚¯ã—ãŸå®Ÿè¡Œæ–¹æ³•ãŒæœ‰åŠ¹ã¨ãªã‚Šã¾ã™ã€‚</p><h2 id="â‘ ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰å®Ÿè¡Œ"><a href="#â‘ ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰å®Ÿè¡Œ" class="headerlink" title="â‘ ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰å®Ÿè¡Œ"></a>â‘ ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰å®Ÿè¡Œ</h2><ul><li>Workflowä¸€è¦§ç”»é¢ã«ã¦ã€å®Ÿè¡Œã—ãŸã„Workflowã®<code>â–¶Run</code>ã‚’ã‚¯ãƒªãƒƒã‚¯<br><img src="/images/20200720/workflow_settings2.png" alt=""></li><li>ã¾ãŸã¯Workflowç·¨é›†ç”»é¢ã§é–‹å§‹Taskã®â–¶ã‚’ã‚¯ãƒªãƒƒã‚¯<br><br><img src="" alt=""><img src="/images/20200720/workflow_run2.png" class="img-small-size"></li></ul><h2 id="â‘¡ã‚³ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå®Ÿè¡Œ"><a href="#â‘¡ã‚³ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå®Ÿè¡Œ" class="headerlink" title="â‘¡ã‚³ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå®Ÿè¡Œ"></a>â‘¡ã‚³ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå®Ÿè¡Œ</h2><p><a href="https://www.zuora.com/developer/api-reference/#operation/POST_Run_Workflow" target="_blank" rel="noopener">ã“ã¡ã‚‰ã®API</a>ã«ã‚ˆã‚‹å®Ÿè¡Œã€‚ <a href="./#Workflowè¨­å®š">Workflowè¨­å®š</a>ã®Workflowã”ã¨ã®è¨­å®šã®<strong>Callout Config</strong>ã«ã¦URLã‚„Requestæƒ…å ±ãŒç¢ºèªã§ãã¾ã™ã€‚</p><pre><code class="sh">curl --location --request POST <span class="string">'https://workflow.apps.zuora.com/api/v1/workflows/{workflow_id}/run'</span> \--header <span class="string">'Content-Type: application/json; charset=utf-8'</span> \--header <span class="string">'API-Token: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span> \--data-raw <span class="string">'{</span><span class="string">    "{params}":"xxxxxx"</span><span class="string">}'</span></code></pre><p>Bodyã«è¨­å®šã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯<a href="./#Workflowè¨­å®š">Workflowè¨­å®š</a>ã®Workflowã”ã¨ã®è¨­å®šã®<strong>Mapped Input Fields and Params</strong>ã«ã¦è¨­å®šã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™ã€‚</p><img src="/images/20200720/workflow_run3.png" style="border:solid 1px #000000"><pre><code class="sh">--data-raw <span class="string">'{</span><span class="string">    "SubscriptionId":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span><span class="string">}'</span>â€»Workflowå†…ã§ã¯ã€<span class="string">'{{ Data.Workflow.SubscriptionId }}'</span>ã®ã‚ˆã†ã«å–å¾—ã™ã‚‹ã€‚</code></pre><h2 id="â‘¢ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ"><a href="#â‘¢ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ" class="headerlink" title="â‘¢ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ"></a>â‘¢ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ</h2><p><a href="./#Workflowè¨­å®š">Workflowè¨­å®š</a>ã®Workflowã”ã¨ã®è¨­å®šã®<strong>Workflow Triggers</strong>ã«ã¦<strong>Scheduled</strong>ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã¨ã€<strong>Scheduled Config</strong>é …ç›®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p><img src="/images/20200720/workflow_run4.png" class="img-middle-size" style="border:solid 1px #000000"><p>è¨­å®šã¯<code>Interval</code>æ¬„ã«ã¦cronå½¢å¼ã§è¨­å®šãŒå¯èƒ½ã ãŒã€è¨­å®šé …ç›®ã®å„ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³é …ç›®ã‚’é¸æŠã™ã‚‹ã“ã¨ã§ã‚‚è¨­å®šãŒå¯èƒ½ã§ã™ã€‚</p><h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><p>Workflowã¯Taskã®çµ„ã¿åˆã‚ã›ã¦é–‹ç™ºã™ã‚‹ã€‚Taskã«ã¤ã„ã¦ã¯<a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow" target="_blank" rel="noopener">Workflow - Zuora</a>ã«å„Taskã®æ©Ÿèƒ½èª¬æ˜ã‚ã‚Šã¾ã™ã€‚ã‚ˆãä½¿ã†ã¨æ€ã‚ã‚Œã‚‹Taskã‚’ç´¹ä»‹ã—ã¾ã™ã€‚</p><ol><li><a href="./#â‘ Object-Query">Object Query</a></li><li><a href="./#â‘¡Data-Query">Data Query</a></li><li><a href="./#â‘¢CSVTranslator">CSVTranslator</a></li><li><a href="./#â‘£Callout">Callout</a></li></ol><h2 id="â‘ Object-Query"><a href="#â‘ Object-Query" class="headerlink" title="â‘ Object Query"></a>â‘ Object Query</h2><p><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/Workflow_tasks/AB_Query" target="_blank" rel="noopener">https://knowledgecenter.zuora.com/Central_Platform/Workflow/Workflow_tasks/AB_Query</a></p><p>Zuoraã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠã—ã¦ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã‚’è¡Œã†Taskã§ã™ã€‚</p><ul><li>é¸æŠ<br><img src="/images/20200720/workflow_task4.png" class="img-middle-size" style="border:solid 1px #000000"><br><img src="/images/20200720/workflow_task5.png" class="img-middle-size" style="border:solid 1px #000000"></li><li><code>FIELDS</code>ã‚¿ãƒ–ã§ã€é¸æŠã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§å–å¾—ã—ãŸã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é¸æŠ<br><img src="/images/20200720/workflow_task6.png" class="img-middle-size" style="border:solid 1px #000000"></li><li><code>CONDITIONS</code>ã‚¿ãƒ–ã§ã€å–å¾—æ¡ä»¶ã‚’è¨­å®šã™ã‚‹<br><img src="/images/20200720/workflow_task7.png" class="img-middle-size" style="border:solid 1px #000000"></li></ul><h2 id="â‘¡Data-Query"><a href="#â‘¡Data-Query" class="headerlink" title="â‘¡Data Query"></a>â‘¡Data Query</h2><p><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/Workflow_tasks/AC_data_query" target="_blank" rel="noopener">https://knowledgecenter.zuora.com/Central_Platform/Workflow/Workflow_tasks/AC_data_query</a></p><p>SQL(<a href="https://knowledgecenter.zuora.com/Central_Platform/Query/ZOQL" target="_blank" rel="noopener">ZOQL</a>ã¨ã„ã†ã‚‰ã—ã„)ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’è¡Œã†Taskã€‚Object Queryã‚ˆã‚ŠæŸ”è»Ÿãªãƒ‡ãƒ¼ã‚¿å–å¾—ãŒã§ãã¾ã™ã€‚</p><img src="/images/20200720/workflow_task1.png" class="img-middle-size" style="border:solid 1px #000000"><p>SQLã‚’æ›¸ãã ã‘ã§ã€å–å¾—ã—ãŸçµæœã¯CSVã€TSVã€DSVã€JSONã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¦å¾Œç¶šTaskã«æ¸¡ã™ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚</p><img src="/images/20200720/workflow_task2.png" style="border:solid 1px #000000"><p>è¶…ãˆã‚‹ã“ã¨ã¯ãã†ãã†ãªã„ã¨ã¯æ€ã†ãŒã€Data Queryã«ã¯åˆ¶é™ãŒã‚ã‚‹ãŸã‚æ³¨æ„ã—ã¾ã—ã‚‡ã†ã€‚</p><img src="/images/20200720/workflow_task3.png" style="border:solid 1px #000000"><table><thead><tr><th align="left">LIMIT(åˆ¶é™)</th><th align="left">VALUE(é–¾å€¤)</th></tr></thead><tbody><tr><td align="left">Max Execution Time(æœ€å¤§å®Ÿè¡Œæ™‚é–“)</td><td align="left">120åˆ†</td></tr><tr><td align="left">Max Number of Input Records(å…¥åŠ›ãƒ¬ã‚³ãƒ¼ãƒ‰æœ€å¤§æ•°)</td><td align="left">500K</td></tr><tr><td align="left">Max Number of Output Records(å‡ºåŠ›ãƒ¬ã‚³ãƒ¼ãƒ‰æœ€å¤§æ•°)</td><td align="left">100K</td></tr><tr><td align="left">Number of Concurrent Queries(åŒæ™‚ã‚¯ã‚¨ãƒªæ•°)</td><td align="left">5</td></tr><tr><td align="left">Max Memory per Query(1ã‚¯ã‚¨ãƒªæ¯ã®æœ€å¤§ãƒ¡ãƒ¢ãƒªæ•°)</td><td align="left">2G</td></tr></tbody></table><h2 id="â‘¢CSVTranslator"><a href="#â‘¢CSVTranslator" class="headerlink" title="â‘¢CSVTranslator"></a>â‘¢CSVTranslator</h2><p>Data Queryãªã©ã§å–å¾—ã—ãŸçµæœã‚’JSONæ§‹é€ ã‚„XMLæ§‹é€ ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®Taskã§ã™ã€‚</p><img src="/images/20200720/workflow_task10.png" class="img-middle-size" style="border:solid 1px #000000"><img src="/images/20200720/workflow_task9.png" class="img-middle-size" style="border:solid 1px #000000"><p>å¤‰æ›ã ã‘ã§ãªãã€å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Filterã—ãŸã‚Šã€MergeãŒã§ãã¾ã™ã€‚<br><img src="/images/20200720/workflow_task11.png" alt=""></p><p><strong><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/Workflow_tasks/BG_Logic_JSON_Transform" target="_blank" rel="noopener">JSONTransform</a></strong>ã¨ã„ã†ã€Data Queryãªã©ã§å–å¾—ã—ãŸçµæœã‚’JSONæ§‹é€ ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®Taskã§ã™ã€‚</p><img src="/images/20200720/workflow_task8.png" class="img-middle-size" style="border:solid 1px #000000"><p>ã‚¯ã‚¨ãƒªã§å–å¾—ã—ãŸçµæœã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚¹ãƒˆã—ãŸJSONæ§‹é€ ãªã©ã«ã™ã‚‹éš›ã«ã¯ã“ã¡ã‚‰ã‚’åˆ©ç”¨ã™ã‚‹ã€‚ä¸»ã«JSONataã¨ã„ã†å¼ã‚’é§†ä½¿ã—ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚</p><img src="/images/20200720/workflow_task12.png" style="border:solid 1px #000000"><p>JSONataå¼ã«ã‚ˆã‚‹å®Ÿè£…ã¯è‹¥å¹²ã¨ã£ã¤ãã«ãã„ãŒã€<a href="https://try.jsonata.org/SJZDsyHTr" target="_blank" rel="noopener">JSONata Exerciser</a>ã¨ã„ã†ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€çµæœã‚’ç¢ºèªã—ãªãŒã‚‰å®Ÿè£…ãŒå¯èƒ½ã§ã™ã€‚</p><h2 id="â‘£Callout"><a href="#â‘£Callout" class="headerlink" title="â‘£Callout"></a>â‘£Callout</h2><p><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/Workflow_tasks/IC_Notifications_Callout" target="_blank" rel="noopener">https://knowledgecenter.zuora.com/Central_Platform/Workflow/Workflow_tasks/IC_Notifications_Callout</a></p><p>Workflowå†…ã§å–å¾—ãƒ»åŠ å·¥ã—ãŸçµæœã‚’CalloutAPIã‚’å‘¼ã³å‡ºã—ã¦é€£æºã™ã‚‹ãŸã‚ã®Taskã§ã™ã€‚</p><img src="/images/20200720/workflow_task14.png" class="img-middle-size" style="border:solid 1px #000000"><img src="/images/20200720/workflow_task13.png" style="border:solid 1px #000000"><ul><li>BODYã‚¿ãƒ–ã§Request.Bodyã«è¨­å®šã™ã‚‹å€¤ã‚’å®šç¾©ã™ã‚‹ã€‚ã“ã¡ã‚‰ã¯<a href="https://shopify.github.io/liquid/" target="_blank" rel="noopener">Liquidå¼</a>ã‚’åˆ©ç”¨ã—ã¦è¨­å®šã™ã‚‹ã€‚(<code>HELP</code>ã‚¿ãƒ–å‚ç…§)</li></ul><img src="/images/20200720/workflow_task15.png" style="border:solid 1px #000000"><ul><li>AUTHENTICATIONã‚¿ãƒ–ã§ã€Calloutå‘¼ã³å‡ºã—æ™‚ã®èªè¨¼ã«ã¤ã„ã¦è¨­å®šã™ã‚‹ã€‚èªè¨¼æ–¹å¼ã¯Basicèªè¨¼ã€OAuth2.0ã‚„hmacãªã©åˆ©ç”¨å¯èƒ½ã§ã™ã€‚</li></ul><img src="/images/20200720/workflow_task16.png" style="border:solid 1px #000000"><h1 id="Swimlane"><a href="#Swimlane" class="headerlink" title="Swimlane"></a>Swimlane</h1><p>Workflowé–‹ç™ºæ™‚ã«ãƒ‡ãƒãƒƒã‚°ã‚’ã—ãŸã„å ´åˆã«åˆ©ç”¨ã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚è©³ç´°ã¯<a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/Using_Workflow/C_Monitor_and_Troubleshoot_a_Workflow" target="_blank" rel="noopener">ã“ã¡ã‚‰</a>å‚ç…§ãã ã•ã„ã€‚</p><ul><li>Workflowç·¨é›†ç”»é¢ã®<code>TASKS</code>ã‚¿ãƒ–ã‚’é–‹ãã¨ã€å„ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œå±¥æ­´ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€ãƒ‡ãƒãƒƒã‚°ã—ãŸã„Taskã®è¡Œã®ä¸€ç•ªå·¦ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚«ãƒ©ãƒ ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦<code>Swimlane</code>ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã€‚</li><li>Swimlaneã¯ä¸€åº¦ã§ã‚‚Workflowã‚’å®Ÿè¡Œã—ã¦Taskå±¥æ­´ãŒå­˜åœ¨ã—ãªã„ã¨ç¢ºèªã§ããªã„ã€‚<br><img src="/images/20200720/workflow_swimlane2.png" alt=""></li><li>Swimlaneç”»é¢ã§ã¯ã€å„ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡ŒçŠ¶æ³ã¨ã€Workflowå†…ã®å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ã‚„ãƒ‡ãƒãƒƒã‚°ãŒè¡Œãˆã‚‹ã€‚<br><img src="/images/20200720/workflow_swimlane3.png" alt=""></li><li>Workflowå†…ã§æ‰±ã†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ã€‚é¸æŠã—ãŸTaskæ™‚ç‚¹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚<br><img src="/images/20200720/workflow_swimlane4.png" alt=""></li><li>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹Taskã¯èµ¤ã„è¡¨ç¤º<br><br><img src="/images/20200720/workflow_swimlane5.png" class="img-small-size" style="border:solid 1px #000000"><br></li><li>ã‚¨ãƒ©ãƒ¼ã®å†…å®¹ã¯Infoã§ç¢ºèªã§ãã‚‹ã€‚<code>Workflow Task Config</code>ã‚„<code>Instance Config</code>ã§è¨­å®šå¤‰æ›´ã—ã¦<code>Rerun</code>ã§ã€ãã®Taskã‹ã‚‰å†å®Ÿè¡ŒãŒã§ãã‚‹ã€‚<img src="/images/20200720/workflow_swimlane6.png" style="border:solid 1px #000000"></li><li>Data Queryã‚„Calloutã«ã‚ˆã‚‹Workflowå†…ã§ã®APIå®Ÿè¡Œã®çµæœã¯ã€<code>API Calls</code>ã§Requestã‚„Responseå†…å®¹ãŒç¢ºèªã§ãã‚‹ã€‚<img src="/images/20200720/workflow_swimlane7.png" style="border:solid 1px #000000"><img src="/images/20200720/workflow_swimlane8.png" style="border:solid 1px #000000"></li></ul><h1 id="æœ€å¾Œã«"><a href="#æœ€å¾Œã«" class="headerlink" title="æœ€å¾Œã«"></a>æœ€å¾Œã«</h1><p>äºˆæœŸã›ã¬å‹•ãã‚’ã•ã›ãªã„ãŸã‚ã«ã¯ã€Workflowå…¨ä½“ã®å‹•ãã‚„å€‹ã€…ã®Taskã®å‹•ä½œã‚’ã‚ˆãç†è§£ã—ãŸä¸Šã§ä½¿ã„ã“ãªã™å¿…è¦ã¯ã‚ã‚Šã¾ã™ãŒã€Workflowã¯Zuoraã¨ã®é€£æºã‚’è¡Œã£ãŸã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰ã‚„ã€Zuoraã®åŸºæœ¬æ©Ÿèƒ½ã‹ã‚‰å¤–ã‚ŒãŸåˆ¶å¾¡ã‚’è¡Œã†å ´åˆã«ã¯ã€å¿…ãšå¿…è¦ã¨ãªã‚‹æ©Ÿèƒ½ã«ãªã‚Šã¾ã™ã€‚</p><h1 id="é–¢é€£ãƒªãƒ³ã‚¯é›†"><a href="#é–¢é€£ãƒªãƒ³ã‚¯é›†" class="headerlink" title="é–¢é€£ãƒªãƒ³ã‚¯é›†"></a>é–¢é€£ãƒªãƒ³ã‚¯é›†</h1><p><strong>Workflowé–‹ç™ºãƒªãƒ³ã‚¯é›†</strong>: </p><ul><li><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow" target="_blank" rel="noopener">Workflow - Zuora</a><ul><li>Workflowã®æ¦‚è¦ã€ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã€ä½¿ç”¨ä¾‹ã€Taskã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ãªã©ã«ã¤ã„ã¦æ²è¼‰</li></ul></li><li><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/C_Get_Started_with_Workflow/General_steps_for_using_Workflow" target="_blank" rel="noopener">General steps for using Workflow - Zuora</a><ul><li>Workflowã®é–‹ç™ºæ‰‹é †ã«ã¤ã„ã¦æ²è¼‰</li></ul></li><li><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/Using_Workflow/A_Edit_a_Workflow" target="_blank" rel="noopener">Edit a Workflow - Zuora</a><ul><li>Workflowé–‹ç™ºç”»é¢ã§ã®ç·¨é›†æ–¹æ³•ã«ã¤ã„ã¦æ²è¼‰</li></ul></li><li><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/C_Get_Started_with_Workflow/C_Workflow_User_Interface" target="_blank" rel="noopener">Workflow User Interface - Zuora</a><ul><li>Workflowç”»é¢ã®UIã«ã¤ã„ã¦ã®èª¬æ˜ãŒæ²è¼‰</li></ul></li><li><a href="https://knowledgecenter.zuora.com/Central_Platform/Workflow/Using_Workflow/C_Monitor_and_Troubleshoot_a_Workflow" target="_blank" rel="noopener">Monitor and Troubleshoot a Workflow - Zuora</a><ul><li>Workflowå®Ÿè¡Œã—ãŸéš›ã®å±¥æ­´ã®ç¢ºèªã€ãƒ‡ãƒãƒƒã‚°æ–¹æ³•ã«ã¤ã„ã¦æ²è¼‰</li></ul></li></ul><p><strong>Workflowé–‹ç™ºã«ä¾¿åˆ©ãªãƒªãƒ³ã‚¯é›†</strong>: </p><ul><li><a href="https://shopify.github.io/liquid/" target="_blank" rel="noopener">Liquid template language</a><ul><li>Workflowã®ä¸€éƒ¨ã®Taskã®è¨­å®šã§ã¯Liquidå¼ã¨ã„ã†ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨€èªã‚’åˆ©ç”¨ã—ã¦ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ›¸ãã“ã¨ã«ãªã‚‹</li></ul></li><li><a href="https://try.jsonata.org/SJZDsyHTr" target="_blank" rel="noopener">JSONata Exerciser</a><ul><li>Workflowã®ä¸€éƒ¨ã®Taskã§JSONataå¼ã§JSONãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ä¸Šè¨˜ã¯JSONataã®ãƒ†ã‚¹ã‚¿ãƒ¼ã¨ã—ã¦åˆ©ç”¨å¯èƒ½</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;a href=&quot;#ã¯ã˜ã‚ã«&quot; class=&quot;headerlink&quot; title=&quot;ã¯ã˜ã‚ã«&quot;&gt;&lt;/a&gt;ã¯ã˜ã‚ã«&lt;/h1&gt;&lt;p&gt;ã“ã‚“ã«ã¡ã¯ã€‚TIGã®ç”ºç”°ã§ã™ã€‚&lt;/p&gt;
&lt;p&gt;Zuora Central Platformï¼ˆZuoraç¤¾ãŒæä¾›ã™ã‚‹ã‚µãƒ–ã‚¹ã‚¯ãƒª
      
    
    </summary>
    
    
      <category term="Infrastructure" scheme="https://future-architect.github.io/categories/Infrastructure/"/>
    
    
      <category term="Workflow" scheme="https://future-architect.github.io/tags/Workflow/"/>
    
      <category term="Zuora" scheme="https://future-architect.github.io/tags/Zuora/"/>
    
      <category term="SaaS" scheme="https://future-architect.github.io/tags/SaaS/"/>
    
      <category term="ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³" scheme="https://future-architect.github.io/tags/%E3%82%B5%E3%83%96%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3/"/>
    
  </entry>
  
</feed>
