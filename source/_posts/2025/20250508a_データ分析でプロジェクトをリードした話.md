---
title: "データ分析でプロジェクトをリードした話"
date: 2025/05/08 00:00:00
postid: a
tag:
  - データ分析
  - Excel
  - 可視化
category:
  - DataScience
thumbnail: /images/2025/20250508a/thumbnail.png
author: 岡田陸
lede: "昨年1年間は「データを駆使して仕事を進める」という少しいままでと色の違う経験をしました。この記事では、その中で得た知見や工夫した点を共有します。"
---
# はじめに

はじめまして、製造エネルギー事業部に所属している岡田と申します。現在、〆切に追われて出張先へ向かう飛行機の中で焦って本稿を書いています>_<

私は2020年4月に新卒で入社し、一貫してシステムの構築～保守というシステム構築における王道パターンのキャリアを歩んできました。

しかし、昨年1年間は「データを駆使して仕事を進める」という少しいままでと色の違う経験をしました。この記事では、その中で得た知見や工夫した点を、「[春の入門祭り2025](/articles/20250413a/)」にあわせて共有します。

# データ分析の目的

当たり前ですが、データ分析の目的は「分析すること」ではなく「達成したい目的(課題)に対してデータの観点からアシストをすること」と捉えていますす。

クライアントが「〇〇したいが、何故かできない」のような状況の際に、データという観点からどのようなアシストができるのかを見つけるツールのようなイメージです。そのため、分析自体になにか価値があるというわけではなく、分析によって実現したいことへ近づけた際に初めて分析の価値が生まれます。

たとえば、スーパーを運営しているクライアントから「利益率を上げたいが、これ以上上がる見込みがない。投資する余力はあるが、どこに投資していいのかがわからない。」という相談を受けたとします。

そのとき、（スーパーのデータに全てアクセスできると仮定したとき）読者のあなたはどのような分析が出来るでしょうか？

- 各レジの単位時間あたりの売上を見て、偏りがあれば偏らせないような施策を打つ
- 廃棄している商品の割合を商品別に出し、廃棄が多い商品は早めに割引する施策を打つ
- レジ員ごとの単位時間あたりの処理数を出し、効率が悪いレジ員はクビを(ry

...などなど、データという観点から業務のボトルネックとなっている箇所を特定し、そこに対してなんらかのアプローチを打つことで利益率を上げることが出来るでしょう。

# データ分析による施策の効果見積もり

また、データ分析はボトルネックの特定だけではなく、複数の施策案があったとき、どの施策がどの程度の効果があるかを見積もることもできます。

すごく簡単な例で例えると、「100人の従業員を今より2時間早く帰社させたときに、人件費はどれだけ削減出来るか？」という問いがあった際は、100人それぞれの時給単価×2時間を合計するような20行ほどのSQLを書けば分すぐに見積もることができます。

このように、現在の実績データをもとに、将来どの程度の効果がかるのかを見積もり数値化出来ることもデータ分析の面白いところかもしれません。

# 机上の空論と現場とのすり合わせ

ここまでの話は、データ上のみの話で、いわば机上の空論です。

では、机上の空論による改善案を実際に現場に実行させようとするとどうなるでしょうか？現場からは非難の嵐になるでしょう。現場の実情は、データから見えることとは大きく違う可能性があります。

そのため、データによって出た案をまずは現場の方々に見せ、認識があっているかを事前にすり合わせます。現場の方々との感覚をすり合わせながら軌道修正した案を実行することで、現場の方々も納得しながら高い効果を発揮できるようになります。

# んで、実際に分析ってどうやるの？

ここまでは、データ分析における前提や、進め方について記載しました。

- データ分析というものになんとなく興味があるが、実際なにをどうするのかイメージがついていない
- とりあえずデータは手元にあり、なんか面白い分析をやってみたい

...のような方に、超簡単にできるデータ分析のワザを記載します。

これを読んだら今日からあなたもデータ分析マスターです。

### 1.調査するデータの構造を理解する

まずは、入口にして一番大事なところです。

最初にデータを扱う際は、まずデータの構造について自身が腹落ちするまで理解する必要があります。

最初に1から100まで完璧に理解をする必要はありませんが、最低でも主要テーブルと、主要テーブルの中のプライマリーキー、フォーリンキー（外部キー）、主要な属性項目については頭に叩き込んでおきましょう。また、カラム（横軸）だけではなく、レコード（縦軸）の発行の粒度についても理解が出来るとなお可です。

これらが十分に理解できたとき、データ分析を始める下地は十分整っていることでしょう。

### 2.実際にSQLで、調査したいデータを出力する

前工程である程度テーブル構造について理解ができたら、まずは試しにデータを出してみましょう。

最初は簡単に、1つのトランをそのままselectしてくるのでも構いません（ただし、全selectはデータ量によっては障害を起こす可能性もあるのでlimit句や日付指定等で、過剰なデータを要求しないよう気をつけてください。）

ただし、Excelは100万行程度までしか受け付けられないため、大きなデータのときはあらかじめ観点を絞って集約関数やウィンドウ関数等を用いてデータ量を圧縮してから出力しましょう。

### 3.Excelに貼り付けて、自由に分析する

次は、A5ERやDBeaverなどのクライアントツールで出力された結果をコピーし、Excelにそのまま貼り付けます。
（今回は、適当に用意した表を用いて説明をします。）

貼り付けた直後にCTRL+Tを押すとテーブルとなり、リボンのテーブルデザインから「ピボットテーブルで集計」を押してみましょう。

<img src="/images/2025/20250508a/image.png" alt="image.png" width="594" height="278" loading="lazy">

<font color="gray">表をテーブルに変換</font>

<img src="/images/2025/20250508a/image_2.png" alt="image.png" width="806" height="519" loading="lazy">

<font color="gray">「ピボットテーブルで集計」を押し、ピボットテーブル化。

作成先をテーブルを新規シートではなく、表のすぐ右隣にしておくと便利。</font>

そうすると準備完了です。ピボットテーブルで横軸・縦軸をそれぞれ設定し、「値」のところは適当な項目を設定し右クリックで「個数」「合計」など、好きなものを選択してもらえれば、自由に分析結果を出すことができます。

<img src="/images/2025/20250508a/image_3.png" alt="image.png" width="945" height="579" loading="lazy">

<font color="gray">「種類」を列に、「年齢」を行にドラッグし、値を種類の個数とすると、犬と猫の年齢別の数が出てきます。</font>

この例だとサンプルが少なすぎて傾向等は見えませんが、データ量が大きくなると相関やボリュームゾーンが見えてくるようになります。

最後に、グラフを出してみましょう。（性別のカラムを追加しました）

今回は、犬と猫それぞれで性別にどのような偏りがあるかを見てみましょう。

<img src="/images/2025/20250508a/image_4.png" alt="image.png" width="1200" height="775" loading="lazy">

<font color="gray">行を種類、列を性別とし、リボンの「ピボットグラフ」から「100％積み上げ縦棒」を選択すると、犬と猫それぞれの性別の割合を示すグラフが出てきます。</font>

こうグラフ化することで、「犬はメスの割合が多いのか～」ということがわかると思います。
（※データは適当に作成したため、現実世界におけるオスメスの割合とは一致しません）

さて、ここまでの分析操作ができれば、今日からあなたもクライアントや上司から一目置かれるデータ分析マスターです。

# おわりに

今回は、入門者向けにデータ分析に関する簡単なやり方を記載してみました。

私も最初は「自分にデータ分析なんて出来るんだろうか」とモヤモヤしていましたが、やってみると楽しく、統計の勉強を進めるキッカケにもなったので、興味のある方は是非挑戦してみてください。

手元にデータがあれば、ぜひ簡単なところからデータ分析を始めてみませんか？
